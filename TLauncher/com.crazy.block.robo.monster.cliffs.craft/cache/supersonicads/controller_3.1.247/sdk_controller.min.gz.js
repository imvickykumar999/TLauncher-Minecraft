!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Analytics=e()}}((function(){return function e(t,n,i){function r(o,s){if(!n[o]){if(!t[o]){var l="function"==typeof require&&require;if(!s&&l)return l(o,!0);if(a)return a(o,!0);var d=new Error("Cannot find module '"+o+"'");throw d.code="MODULE_NOT_FOUND",d}var c=n[o]={exports:{}};t[o][0].call(c.exports,(function(e){return r(t[o][1][e]||e)}),c,c.exports,e,t,n,i)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(e,t,n){t.exports=function(e){var t,n=["ironBeastAnalyticsProvider"],r=[],a=["noFill","clusterSelected","initAd"],o={},s={},l=this,d=[];function c(t){return n=t.eventName,0===Object.keys(e).length&&a.indexOf(n)>-1||function(e,t){if(!e||!t)return!1;for(var n in e)if(e.hasOwnProperty(n)&&(!(n in t)||t[n]!==e[n]))return!1;return!0}(e[t.eventName],t);var n}function u(e){l.extend(s||{},e)}return l.extend=function(){for(var e,t,n=arguments.length,i=1,r=arguments[0]||{};i<n;i++)if(null!=(e=arguments[i]))for(t in e)void 0!==e[t]&&(r[t]=e[t]);return r},l.report=function(e,n){e&&(n.eventName=e,c(n=extend(n||{},s))||(t?(function(e,t){window.isWebWrapper&&window.SSA_CORE.SDKController.log("WebWrapper | Event fired with data | "+JSON.stringify({name:e,params:t}))}(e,n),function(e){for(var t=r.length,n=0;n<t;n++)e(r[n])}((function(e){e.fireDataEvent(n)}))):d.push({eName:e,data:n,eType:"event"})))},{setProvidersHandlers:function(e){if(e){"string"==typeof e&&(e=[e]),n=[];for(var t=e.length,i=0;i<t;i++)n.push(e[i])}},setProvidersConfig:function(e){o=e},init:function(e){t||(e&&u(e),function(){r=[];for(var e=n.length,t=0;t<e;t++){var i=n[t];if("function"==typeof window[i]){var a=new window[i];a.init(o),r.push(a)}}}(),t=!0,function(){for(var e in d){var t=d[e]||{};l.report(t.eName,t.data)}d=[]}())},updateBaseData:u,createAnalytic:function(e){return new i(l,e||{})}}};var i=e("./analyticsHelper.js");window.ironBeastAnalyticsProvider=e("./providers/ironBeastAnalyticsProvider.js"),window.QAAnalyticsProvider=e("./providers/QAAnalyticsProvider.js"),window.KuduAnalyticsProvider=e("./providers/KuduAnalyticsProvider.js")},{"./analyticsHelper.js":2,"./providers/KuduAnalyticsProvider.js":3,"./providers/QAAnalyticsProvider.js":4,"./providers/ironBeastAnalyticsProvider.js":5}],2:[function(e,t,n){t.exports=function(e,t){var n=e||{},i=(t=t||{}).baseData||{},r={},a=n.extend,o={};function s(e){return e&&e.name&&e.id}return o.report=function(e,t){if(!s(e))return!1;(t=t||{}).eventId=e.id,t=a({},i,t),n.report(e.name,t)},o.report=function(e,t){if(!s(e))return!1;(t=t||{}).eventId=e.id,t=a({},i,t),n.report(e.name,t)},o.trackTimingStart=function(e,t){if(!s(e))return!1;var n=e.name;return t=t||Date.now(),r[n]=t,!0},o.trackTimingStop=function(e,t){if(!s(e))return!1;var o,l,d=e.name;if(t||(t={}),t.eventId=e.id,t&&t.timeStamp?(l=t.timeStamp,delete t.timeStamp):l=Date.now(),t&&t.eNameStart&&t.eNameStart.name?(o=r[t.eNameStart.name],delete t.eNameStart):r[d]&&(o=r[d],r[d]=null),o){var c=l-o;if(c<0)return!1;var u=a({},i);return(t=a(u,t||{})).timingValue=c,n.report(d,t),!0}},o.updateBaseData=function(e){for(var t in e)i[t]=e[t];return!0},o.resetBaseData=function(e){if(e=e.map((e=>e.toLowerCase())),Array.isArray(e)&&e)for(var t in i)-1===e.indexOf(t.toLowerCase())&&delete i[t]},o.unsetParamFromBaseData=function(e){i.hasOwnProperty(e)&&delete i[e]},o.incrementSessionNumber=function(){return i.sessionDepth?i.sessionDepth++:i.sessionDepth=1,!0},o}},{}],3:[function(e,t,n){t.exports=function(){var e,t,n="POST",i="https://logs.ironsrc.mobi/logs",r="supersonic.adunitanalytics.ad_unit_events",a=["generalmessage","emptyowreason","landingid","callfailreason","rvnomoreoffersreason"];function o(e,t){switch(e){case"landingid":t=parseInt(t);break;case"generalmessage":case"emptyowreason":t=function(e){return void 0===e?"undefined":null===e?"null":e.toString()}(t)}return t}function s(n){var i=new XMLHttpRequest;i.open("POST",e,!0),i.onerror=function(){n&&n.retry>=0&&n.retry<2&&(n.retry++,t(n))},i.send(JSON.stringify(n))}function l(e){var t;try{t=btoa(JSON.stringify(e))}catch(n){e.data.applicationUserId="badName",e.data.userId="badName",e.data.eventName="errorEvent",t=btoa(JSON.stringify(e))}var n=i+"?data="+t,r=new XMLHttpRequest;r.open("GET",n,!0),r.send()}return{init:function(r){r&&r.method===n?(n,e="https://postlog.supersonic.com/logs",t=s):("GET",e=i,t=l)},fireDataEvent:function(e){e&&(e=function(e){if(!e)return e;for(var t=Object.keys(e),n=t.length;n--;){var i=t[n],r=i.toLowerCase(),s=e[i];-1!==a.indexOf(r)&&(s=o(r,s)),e[r]=s,i!==r&&delete e[i]}return e}(e),t({table:r,data:e}))}}}},{}],4:[function(e,t,n){t.exports=function(){var e,t={};function n(e,t){var i=[];for(var r in e)if(e.hasOwnProperty(r)){var a=t?t+"["+r+"]":r,o=e[r];i.push("object"==typeof o?n(o,a):encodeURIComponent(a)+"="+encodeURIComponent(o))}return i.join("&")}return{init:function(){e="http://qa.analytics.qa"},fireDataEvent:function(i){if(i){t.data=i;var r=n(t);delete t.data,function(e){if(!e)return;(new Image).src=e}(e+"?"+r)}}}}},{}],5:[function(e,t,n){t.exports=function(){var e,t={table:"supersonic.adunitanalytics.ad_unit_events"};return{init:function(t){e=t.isSecured?"https://secure.ironbeast.io":"http://supersonic.ironbeast.io"},fireDataEvent:function(n){if(n){var i;t.data=n;try{i=btoa(JSON.stringify(t))}catch(e){t.data.applicationUserId="badName",t.data.userId="badName",t.data.eventName="errorEvent",i=btoa(JSON.stringify(t))}delete t.data,function(e){if(!e)return;(new Image).src=e}(e+"?data="+i)}}}}},{}]},{},[1])(1)})),function e(t,n,i){function r(o,s){if(!n[o]){if(!t[o]){var l="function"==typeof require&&require;if(!s&&l)return l(o,!0);if(a)return a(o,!0);var d=new Error("Cannot find module '"+o+"'");throw d.code="MODULE_NOT_FOUND",d}var c=n[o]={exports:{}};t[o][0].call(c.exports,(function(e){return r(t[o][1][e]||e)}),c,c.exports,e,t,n,i)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.AdPlayerAdmFactory=void 0;n.AdPlayerAdmFactory=class{constructor(e){this.admParams=e}create(){const{adViewId:e,demandSourceName:t,adMarkup:n,userData:i}=this.admParams,{cid:r,crid:a}=n.seatbid.bid[0],{sdkAbName:o,appKey:s,bundleId:l,deviceData:d}=i,{osv:c,sdkv:u,apilvl:f,deviceId:p,os:g}=d;return{id:this.createId(),frames:this.prepareFrames(n),productType:"NativeAd",landingId:n.seatbid.ext.landingId,adViewId:e,cid:r,crid:a,demandSourceName:t,osv:c,os:g,sdkv:u,apilvl:f,sdkAbName:o,appKey:s,bundleId:l,deviceId:p}}createId(){const{cid:e,crid:t}=this.admParams.adMarkup.seatbid.bid[0];return`${e}_${t}`}prepareFrames(e){const{media:t}=e.seatbid.bid[0].ext.assets,n=this.imageMedia(t);return n?[{type:"fullScreenImage",assets:{portrait:n.config.url,landscape:n.config.url},shouldSendClickEvent:!1}]:[]}imageMedia(e){return null==e?void 0:e.find((e=>"img"===e.type))}}},{}],2:[function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.AdPlayerLoader=void 0;const r=e("./types/NativeAdTypes"),a=e("./utils");class o{static load(e){return i(this,void 0,void 0,(function*(){const t=(0,a.createUniqueId)(r.NATIVE_AD_PREFIX),{nativeAd:n,adMarkup:i}=e,{demandSourceName:o}=n.loadMessage.params;n.adPlayerListener.start(n,`AdPlayerMessage.${t}`,i);const s=yield this.prepareAdPlayer(n,t,o);return s.success?t:(n.analytic.report("loadAssetFailed",{callfailreason:"Ad-Player",generalmessage:s.reason}),void n.adPlayerListener.stop())}))}static prepareAdPlayer(e,t,n){return i(this,void 0,void 0,(function*(){const i={assetType:"adunitAsset",demandSourceName:e.id,productType:"NativeAd",retryAttempts:2,retryInterval:1};try{e.controllerFacade.cache.setRetryListener(e.id,(t=>{o.sendRetryCacheAdPlayerEvent(e.analytic,t)})),yield e.controllerFacade.adPlayer.fetchAdPlayerFiles(i);const r=e.controllerFacade.adPlayer.getAdPlayerUrl({adViewId:t,topic:`AdPlayerMessage.${t}`,fromCache:!0,productConfig:{demandSourceName:n,productType:"NativeAd"}});return yield e.controllerFacade.adPlayer.loadAdView(r,t)}catch(e){return{success:!1,reason:`${e}`}}}))}static sendRetryCacheAdPlayerEvent(e,t){const n=t.success?"adUnitRetrySuccess":"adUnitRetryFail",i=`${t.file}[${t.currentRetryAttempt} of ${t.totalRetryAttempts}]`;e.report(n,{generalmessage:i})}}n.AdPlayerLoader=o},{"./types/NativeAdTypes":16,"./utils":17}],3:[function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const r=i(e("./ControllerFacade")),a=i(e("./NativeAdApi"));n.default=class{createNativeAdApi(e){const{controller:t,core:n}=e,i=new r.default({controller:t,core:n});return new a.default(i)}}},{"./ControllerFacade":4,"./NativeAdApi":12}],4:[function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0});const r=e("./common/types/Events"),a=e("./types/NativeAdTypes");n.default=class{constructor(e){this.controller=e.controller,this.core=e.core,this.analytics=new o(e),this.adPlayer=new s(e),this.cache=new l(e)}callSDKFunction(e,t,n,i){this.controller.callSDKFunction(e,t,n,i)}onReceivedLoadReport(e){return i(this,void 0,void 0,(function*(){const t=`NativeCallback.${a.NATIVE_AD_PREFIX}.loadReport.${e}`;return new Promise((e=>{const n=this.core.PubSub.subscribe(t,((t,i)=>{if(this.core.PubSub.unsubscribe(n),!i)return void this.log('NativeAd | invalid message, missing callback method for "loadReport"');e([i,t])}))}))}))}getUserData(){return{deviceData:Object.assign({deviceId:this.controller.getDeviceId()},this.controller.getFormattedDeviceData()),appKey:this.controller.getSDKDataByKey("applicationKey"),bundleId:this.controller.getSDKDataByKey("bundleId"),sdkAbName:this.controller.getSDKDataByKey("sdkAbName")}}getDeviceOs(){return this.controller.getDeviceOs()}sendActionClick(e){return i(this,void 0,void 0,(function*(){return new Promise((t=>{this.controller.callSDKFunction("openUrl",e,"actionClickSuccess","actionClickFail");const n=()=>{this.core.PubSub.unsubscribe(i),this.core.PubSub.unsubscribe(r)},i=this.core.PubSub.subscribe("NativeCallback.actionClickSuccess",(()=>{n(),t({success:!0})})),r=this.core.PubSub.subscribe("NativeCallback.actionClickFail",(e=>{var i;n();t({success:!1,reason:null!==(i=e.errMsg)&&void 0!==i?i:"Unknown reason"})}))}))}))}log(e,t,n){this.controller.log(e,t,n)}sendPixels(...e){for(const t of e){const e=new Image;e.onload=()=>this.log(`loaded pixel, ${t}`),e.onerror=()=>this.log(`loaded pixel, ${t}`),e.src=t}}};class o{constructor(e){this.controller=e.controller,this.core=e.core}createAnalytic(e){const t=this.core.Analytics.createAnalytic({baseData:e});return{report(e,n){const i="object"==typeof e?e:{name:e,id:r.controllerEvents[e]};t.report(i,n)},updateBaseData(e){t.updateBaseData(e)}}}initAnalytics(e){this.controller.initAnalytics({productType:e})}}class s{constructor(e){this.controller=e.controller,this.core=e.core}loadAdView(e,t){const{PubSub:n}=this.core,i=`${t}.loadAdView.success`,r=`${t}.loadAdView.failure`;return new Promise((a=>{const o=n.subscribe(`NativeCallback.${i}`,(()=>{this.unsub(o,s),a({success:!0})})),s=n.subscribe(`NativeCallback.${r}`,(e=>{this.unsub(o,s);const{errMsg:t}=e;a({success:!1,reason:t})})),l={functionName:"loadWithUrl",functionParams:{adViewId:t,urlForWebView:e}};this.controller.callSDKFunction("adViewAPI",l,i,r)}))}fetchAdPlayerFiles(e){return i(this,void 0,void 0,(function*(){yield this.controller.getAdPlayerAssets().prepareAdPlayerAssetsWrapper(e)}))}unsub(...e){for(const t of e)this.core.PubSub.unsubscribe(t)}getAdPlayerUrl(e){const{adViewId:t,topic:n,productConfig:i,fromCache:r}=e;return`${this.controller.adPlayerUrl.getAdPlayerUrl(r,this.controller.getDeviceOs(),i,{shouldBuildAdUnitUrlForExternal:!0})}&adViewId=${t}&controllerMsgTopic=${n}`}subscribeToMessages(e,t){const n=this.core.PubSub.subscribe(`NativeCallback.${e}`,(e=>i(this,void 0,void 0,(function*(){const n=e,i=Object.assign(Object.assign({},n.arguments),{adViewId:n.adViewId,method:n.method,callback:e=>{const t={id:n.id,adViewId:n.adViewId,data:e};this.controller.callSDKFunction("adViewAPI",{functionName:"sendMessage",functionParams:{params:JSON.stringify(t)}})}});yield t(i)}))));return()=>this.core.PubSub.unsubscribe(n)}removeAdView(e){return new Promise((t=>{const{PubSub:n}=this.core,i=`${e}.removeAdView.success`,r=`${e}.removeAdView.failure`,a={functionName:"removeAdView",functionParams:{adViewId:e}};this.controller.callSDKFunction("adViewAPI",a,i,r);const o=n.subscribe(`NativeCallback.${i}`,(()=>{this.unsub(o,s),t({success:!0})})),s=n.subscribe(`NativeCallback.${r}`,(e=>{this.unsub(o,s);t({success:!1,reason:e.errMsg})}))}))}}class l{constructor(e){this.controller=e.controller,this.core=e.core}setRetryListener(e,t){const n=()=>{this.core.PubSub.unsubscribe(r),this.core.PubSub.unsubscribe(a)};function i(t){return t.demandSourceName===e&&!!t.file&&!!t.currentRetryAttempt&&!!t.totalRetryAttempts}const r=this.core.PubSub.subscribe("Cache.assetRetrySuccess",(e=>{const r=e;i(r)&&(n(),t(Object.assign(Object.assign({},r),{success:!0})))})),a=this.core.PubSub.subscribe("Cache.assetRetryFailed",(e=>{const r=e;i(r)&&(n(),t(Object.assign(Object.assign({},r),{success:!1})))}));return n}}},{"./common/types/Events":14,"./types/NativeAdTypes":16}],5:[function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0});const r=e("../AdPlayerAdmFactory");n.default=class{setClickCommand(e){this.clickCommand=e}start(e,t,n){this.unsubscribe=e.controllerFacade.adPlayer.subscribeToMessages(t,(t=>i(this,void 0,void 0,(function*(){switch(t.method){case"GetConfig":this.onGetConfig(e,n,t);break;case"AdClicked":yield this.onClick(e);break;case"Analytics":this.onAnalytics(e,t);break;case"log":this.onLog(e,t)}}))))}stop(){var e;null===(e=this.unsubscribe)||void 0===e||e.call(this),this.unsubscribe=void 0}onGetConfig(e,t,n){const i=new r.AdPlayerAdmFactory({demandSourceName:e.loadMessage.params.demandSourceName,adViewId:n.adViewId,adMarkup:t,userData:e.controllerFacade.getUserData()}).create();n.callback(i)}onClick(e){return i(this,void 0,void 0,(function*(){if(!this.clickCommand)return void e.handleIllegalState({msg:"Requested to click on nativeAd (mediaView), but it did not receive click command"});const{command:t,sdkCallback:n}=this.clickCommand;yield e.mediaViewClick(t,n)}))}onAnalytics(e,t){switch(t.action){case"setCustomData":e.analytic.updateBaseData(t.eventParam.data);break;case"fireEvent":e.analytic.report(t.eventParam.eName,t.eventParam.data)}}onLog(e,t){const{origin:n,msg:i,debugLevel:r}=t;e.controllerFacade.log(decodeURI(i),r,n)}}},{"../AdPlayerAdmFactory":1}],6:[function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((i=i.apply(e,t||[])).next())}))},r=this&&this.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const o=a(e("./AdPlayerListener")),s=e("./State/CreatedState");n.default=class{constructor(e){this.adPlayerListener=new o.default,this.id=e.id,this.loadMessage=e.loadMessage,this.controllerFacade=e.controllerFacade,this.listener=e.listener,this.analytic=this.controllerFacade.analytics.createAnalytic({productType:"NativeAd",demandSourceId:this.id,demandSourceName:this.loadMessage.params.demandSourceName,isBiddingInstance:this.loadMessage.params.inAppBidding}),this.state=new s.CreatedState}load(e){return i(this,void 0,void 0,(function*(){this.controllerFacade.log("NativeAd | load"),yield this.state.load(this,e)}))}register(e){this.controllerFacade.log("NativeAd | register"),this.state.register(this,e)}visibilityChanged(e,t){this.controllerFacade.log("NativeAd | visibilityChanged"),this.state.visibilityChanged(this,e,t)}click(e,t){return i(this,void 0,void 0,(function*(){this.controllerFacade.log("NativeAd | click"),yield this.state.click(this,e,t)}))}mediaViewClick(e,t){return i(this,void 0,void 0,(function*(){this.controllerFacade.log("NativeAd | media view click"),yield this.state.mediaViewClick(this,e,t)}))}privacyClick(){this.controllerFacade.log("NativeAd | privacy click"),this.state.privacyClick(this)}destroy(){this.controllerFacade.log("NativeAd | destroy"),this.analytic.report("adDestroyed",{}),this.killMediaView()}killMediaView(){if(this.adPlayerListener.stop(),this.adViewId){this.controllerFacade.adPlayer.removeAdView(this.adViewId).then((e=>{e.success||this.analytic.report("mediaViewDestroyFailed",{generalmessage:e.reason})})),this.adViewId=void 0}}setState(e){this.state=e}handleIllegalState(e){const{eventName:t,msg:n,response:i}=e;if(this.analytic.report(null!=t?t:"illegalState",{generalmessage:n}),i){const{sdkCallback:e,isCallback:t}=i,a=r(i,["sdkCallback","isCallback"]);this.controllerFacade.callSDKFunction(e,Object.assign(Object.assign({},a),{params:{success:!1,reason:n}}))}}createAssetBitmap(e){function t(e){return e?"1":"0"}return`${t(e.title)}${t(e.advertiser)}${t(e.body)}${t(e.cta)}${t(e.icon)}${t(e.media)}`}}},{"./AdPlayerListener":5,"./State/CreatedState":7}],7:[function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.CreatedState=void 0;const r=e("../../AdPlayerLoader"),a=e("./FailedState"),o=e("./LoadedState");n.CreatedState=class{load(e,t){return i(this,void 0,void 0,(function*(){try{e.analytic.report("loadAd",{});const n=this.parseAdm(e.loadMessage.params.adm);this.validateAdm(n);const i=yield this.loadAssets(e,n);e.listener.onAssetsLoaded(t,e.loadMessage.msgId,i);const[r,a]=yield e.controllerFacade.onReceivedLoadReport(e.id);this.handleLoadReport(e,r,a,n)}catch(n){const i=`failed to load native-ad. ${n}`;e.controllerFacade.log(`NativeAd | load failed, ${i}`,1),e.analytic.report("loadAdFailed",{generalmessage:i}),e.listener.onLoadFailure(t,e.loadMessage.msgId,i),e.setState(new a.FailedState)}}))}handleLoadReport(e,t,n,i){const{msgId:r,params:s}=n;if(Object.values(s).some((e=>null==e?void 0:e.success))){e.controllerFacade.log(`NativeAd | load success, report: ${JSON.stringify(s)}`);const n=this.createAssetBitmap(e,s);return e.analytic.report("loadAdSuccess",{generalmessage:n}),e.listener.onLoadSuccess(t,r),void e.setState(new o.LoadedState(i))}e.controllerFacade.log(`NativeAd | load failed, non-success report: ${JSON.stringify(s)}`,1),e.analytic.report("loadAdFailed",{generalmessage:"failed to load native ad, empty report"}),e.listener.onLoadFailure(t,r,"cannot load empty ad"),e.setState(new a.FailedState)}createAssetBitmap(e,t){var n,i,r,a,o,s,l,d,c,u,f,p;const g={title:null!==(i=null===(n=t.title)||void 0===n?void 0:n.success)&&void 0!==i&&i,body:null!==(a=null===(r=t.body)||void 0===r?void 0:r.success)&&void 0!==a&&a,advertiser:null!==(s=null===(o=t.advertiser)||void 0===o?void 0:o.success)&&void 0!==s&&s,cta:null!==(d=null===(l=t.cta)||void 0===l?void 0:l.success)&&void 0!==d&&d,icon:null!==(u=null===(c=t.icon)||void 0===c?void 0:c.success)&&void 0!==u&&u,media:null!==(p=null===(f=t.media)||void 0===f?void 0:f.success)&&void 0!==p&&p};return e.createAssetBitmap(g)}parseAdm(e){try{const t=e.replace(/\+/g,"%20"),n=decodeURIComponent(t);return JSON.parse(n)}catch(e){throw new Error(`failed to parse adm. ${e}`)}}validateAdm(e){var t,n;const i=null==e?void 0:e.seatbid,{auction:r}=null!==(t=null==i?void 0:i.ext)&&void 0!==t?t:{},{id:a}=null!=r?r:{},o=null===(n=null==i?void 0:i.bid)||void 0===n?void 0:n[0],{cid:s,crid:l,ext:d}=null!=o?o:{},{assets:c,clickTags:u,callbacks:f}=null!=d?d:{},{clickURL:p,pixelURL:g}=null!=u?u:{},{impressions:v}=null!=f?f:{},m=[s,l,c,p,g,v,a];for(const e of m)if(!e)throw new Error("invalid adm.");const h=[v,g];for(const e of h)if(0===e.length)throw new Error("invalid adm.");if(0===Object.keys(c).length)throw new Error("invalid adm.")}loadAssets(e,t){return i(this,void 0,void 0,(function*(){const{assets:n}=t.seatbid.bid[0].ext,i=yield this.loadAdView(e,t);return e.adViewId=i,{title:n.title,advertiser:n.advertiser,body:n.body,cta:n.cta,media:i?{adViewId:i}:void 0,icon:n.icon}}))}loadAdView(e,t){return i(this,void 0,void 0,(function*(){const{media:n}=t.seatbid.bid[0].ext.assets;if(n&&!this.isInvalidMedia(n))return yield r.AdPlayerLoader.load({nativeAd:e,adMarkup:t})}))}isInvalidMedia(e){return void 0===(null==e?void 0:e.find((e=>"img"===e.type)))}register(e){e.handleIllegalState({msg:"Requested to register nativeAd, before finish loading"})}visibilityChanged(e,t,n){e.handleIllegalState({msg:"Requested to show a nativeAd, before finish loading",response:{isCallback:!0,sdkCallback:n,msgId:t.msgId}})}click(e,t,n){return i(this,void 0,void 0,(function*(){e.handleIllegalState({msg:"Requested to click on nativeAd, before finish loading",response:{isCallback:!0,sdkCallback:n,msgId:t.msgId}})}))}mediaViewClick(e,t,n){return i(this,void 0,void 0,(function*(){e.handleIllegalState({msg:"Requested to click on nativeAd (mediaView), before finish loading",response:{isCallback:!1,sdkCallback:n,command:t,adId:e.id}})}))}privacyClick(e){e.handleIllegalState({msg:"Requested to click on privacy button, before finish loading"})}}},{"../../AdPlayerLoader":2,"./FailedState":8,"./LoadedState":9}],8:[function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.FailedState=void 0;n.FailedState=class{load(e){return i(this,void 0,void 0,(function*(){e.handleIllegalState({msg:"trying to load a failed ad"})}))}register(e){e.handleIllegalState({msg:"Requested to register nativeAd, but it failed to load"})}visibilityChanged(e,t,n){e.handleIllegalState({msg:"Requested to show a nativeAd, but it failed to load",response:{isCallback:!0,sdkCallback:n,msgId:t.msgId}})}click(e,t,n){return i(this,void 0,void 0,(function*(){e.handleIllegalState({msg:"Requested to click on nativeAd, but it failed to load",response:{isCallback:!0,sdkCallback:n,msgId:t.msgId}})}))}mediaViewClick(e,t,n){return i(this,void 0,void 0,(function*(){e.handleIllegalState({msg:"Requested to click on nativeAd (mediaView), but it failed to load",response:{isCallback:!1,sdkCallback:n,command:t,adId:e.id}})}))}privacyClick(e){e.handleIllegalState({msg:"Requested to click on privacy button, but it failed to load ad"})}}},{}],9:[function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((i=i.apply(e,t||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.LoadedState=void 0;const r=e("./RegisteredState");n.LoadedState=class{constructor(e){this.adm=e}load(e){return i(this,void 0,void 0,(function*(){e.handleIllegalState({msg:"trying to load a loaded ad"})}))}register(e,t){const{assetViews:n,adViewClickCommand:i}=t.params,a=e.createAssetBitmap(n);e.analytic.report("adRegistered",{generalmessage:a}),n.media?e.adPlayerListener.setClickCommand(i):e.killMediaView(),e.setState(new r.RegisteredState(this.adm))}visibilityChanged(e,t,n){e.handleIllegalState({msg:"Requested to show a nativeAd, but it is not registered",response:{isCallback:!0,sdkCallback:n,msgId:t.msgId}})}click(e,t,n){return i(this,void 0,void 0,(function*(){e.handleIllegalState({msg:"Requested to click on nativeAd, but it is not registered",response:{isCallback:!0,sdkCallback:n,msgId:t.msgId}})}))}mediaViewClick(e,t,n){return i(this,void 0,void 0,(function*(){e.handleIllegalState({msg:"Requested to click on nativeAd (mediaView), but it is not registered",response:{isCallback:!1,sdkCallback:n,command:t,adId:e.id}})}))}privacyClick(e){e.handleIllegalState({msg:"Requested to click on privacy button, but ad is not registered"})}}},{"./RegisteredState":10}],10:[function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.RegisteredState=void 0;const a=r(e("./ShownState"));n.RegisteredState=class{constructor(e){this.adm=e}load(e){return i(this,void 0,void 0,(function*(){e.handleIllegalState({msg:"trying to load a registered ad"})}))}register(e){e.handleIllegalState({msg:"trying to register a registered ad"})}visibilityChanged(e,t,n){const{msgId:i,params:r}=t;if(this.isNotImpression(r,e)){const t={success:!1,reason:"visibility flags are not truthy"};return void e.controllerFacade.callSDKFunction(n,{msgId:i,params:t})}const o=this.adm.seatbid.bid[0].ext.callbacks.impressions.map((e=>e.url));e.controllerFacade.sendPixels(...o),e.analytic.report("adVisible",{}),e.controllerFacade.callSDKFunction(n,{msgId:i,params:{success:!0}}),e.setState(new a.default(this.adm))}isNotImpression(e,t){switch(t.controllerFacade.getDeviceOs()){case"ios":return this.isNotIOSImpression(e);case"android":return this.isNotAndroidImpression(e)}}isNotIOSImpression(e){return e.isHidden||!e.isKeyWindow}isNotAndroidImpression(e){return!e.isShown||!e.isWindowVisible&&!e.isVisible}click(e,t,n){return i(this,void 0,void 0,(function*(){e.handleIllegalState({msg:"Requested to click on nativeAd, but it is not shown",response:{isCallback:!0,sdkCallback:n,msgId:t.msgId}})}))}mediaViewClick(e,t,n){return i(this,void 0,void 0,(function*(){e.handleIllegalState({msg:"Requested to click on nativeAd (mediaView), but it is not shown",response:{isCallback:!1,sdkCallback:n,command:t,adId:e.id}})}))}privacyClick(e){e.handleIllegalState({msg:"Requested to click on privacy button, but ad is not shown"})}}},{"./ShownState":11}],11:[function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((i=i.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const a=r(e("../../common/Debouncer")),o="[data]";n.default=class{constructor(e){this.debouncer=new a.default,this.adm=e}load(e){return i(this,void 0,void 0,(function*(){e.handleIllegalState({msg:"trying to load a shown ad"})}))}register(e){e.handleIllegalState({msg:"trying to register a shown ad"})}visibilityChanged(e,t,n){e.controllerFacade.callSDKFunction(n,{msgId:t.msgId,params:{success:!1,reason:"trying to show an already shown ad"}})}click(e,t,n){return i(this,void 0,void 0,(function*(){this.shouldDebounce(e,t.params.viewName)?e.controllerFacade.callSDKFunction(n,{msgId:t.msgId,params:{success:!1,reason:"debounce click"}}):(yield this.handleClick(e,t.params.viewName),e.controllerFacade.callSDKFunction(n,{msgId:t.msgId,params:{success:!0}}))}))}mediaViewClick(e,t,n){return i(this,void 0,void 0,(function*(){const i="adPlayerView";this.shouldDebounce(e,i)||(yield this.handleClick(e,i),e.controllerFacade.callSDKFunction(n,{adId:e.id,command:t,params:{success:!0}}))}))}shouldDebounce(e,t){return this.debouncer.isDebouncing()?(e.analytic.report("debounceClick",{generalmessage:t}),!0):(this.debouncer.start(800),!1)}handleClick(e,t){return i(this,void 0,void 0,(function*(){e.analytic.report("adClicked",{generalmessage:t});const{pixelURL:n,clickURL:i}=this.adm.seatbid.bid[0].ext.clickTags;e.controllerFacade.sendPixels(...n);const r=yield e.controllerFacade.sendActionClick({url:i,method:"external_browser"});r.success||e.analytic.report("openUrlError",{generalmessage:r.reason})}))}privacyClick(e){e.analytic.report("privacyLinkClicked",{});const t=this.createPrivacyLink(e);e.controllerFacade.sendActionClick({url:t,method:"external_browser"})}createPrivacyLink(e){var t,n,i;const r=this.adm.seatbid.bid[0],a={bannerid:r.crid,campaignid:r.cid,creativeid:null!==(t=r.creativeId)&&void 0!==t?t:0,bundleid:null!==(i=null===(n=e.controllerFacade.getUserData())||void 0===n?void 0:n.bundleId)&&void 0!==i?i:""},s=`https://ironsource.mobi/privacypolicy.html?data=${o}`,l=btoa(JSON.stringify(a));return s.replace(o,l)}}},{"../../common/Debouncer":13}],12:[function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((i=i.apply(e,t||[])).next())}))},r=this&&this.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const o=a(e("./NativeAd/NativeAd"));n.default=class{constructor(e){this.ads=new Map,this.controllerFacade=e,this.controllerFacade.analytics.initAnalytics("NativeAd"),this.analytic=e.analytics.createAnalytic({productType:"NativeAd"}),this.analytic.report("initAd",{})}load(e,t){return i(this,void 0,void 0,(function*(){const n=new o.default({id:e.adId,loadMessage:e,listener:this.createListener(),controllerFacade:this.controllerFacade});this.ads.set(e.adId,n),yield n.load(t)}))}createListener(){const e=this.controllerFacade;return{onAssetsLoaded(t,n,i){const r={msgId:n,params:Object.assign({success:!0},i)};e.callSDKFunction(t,r)},onLoadFailure(t,n,i){const r={msgId:n,params:{success:!1,reason:i}};e.callSDKFunction(t,r)},onLoadSuccess(t,n){const i={msgId:n,params:{success:!0}};e.callSDKFunction(t,i)}}}register(e){const t=this.ads.get(e.adId);t?t.register(e):this.handleIllegalState({msg:"Requested to register nativeAd, but it is not loaded"})}visibilityChanged(e,t){const n=this.ads.get(e.adId);n?n.visibilityChanged(e,t):this.handleIllegalState({msg:"Requested to show a nativeAd, but it is not loaded",response:{isCallback:!0,msgId:e.msgId,sdkCallback:t}})}destroy(e){const t=this.ads.get(e.adId);if(t)this.ads.delete(e.adId),t.destroy();else{const e="Requested to destroy a nativeAd, but it is not loaded";this.handleIllegalState({msg:e})}}click(e,t){return i(this,void 0,void 0,(function*(){const n=this.ads.get(e.adId);if(n)yield n.click(e,t);else{const n="Requested to click on nativeAd, but it is not loaded";this.handleIllegalState({msg:n,response:{isCallback:!0,msgId:e.msgId,sdkCallback:t}})}}))}privacyClick(e){const t=this.ads.get(e.adId);if(t)t.privacyClick();else{const e="Requested to click on privacy button, but it is not loaded";this.handleIllegalState({msg:e})}}handleIllegalState(e){const{eventName:t,msg:n,response:i}=e;if(this.analytic.report(null!=t?t:"illegalState",{generalmessage:n}),i){const{sdkCallback:e,isCallback:t}=i,a=r(i,["sdkCallback","isCallback"]);this.controllerFacade.callSDKFunction(e,Object.assign(Object.assign({},a),{params:{success:!1,reason:n}}))}}}},{"./NativeAd/NativeAd":6}],13:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});n.default=class{constructor(){this.debouncing=!1}start(e){this.debouncing=!0,setTimeout((()=>{this.debouncing=!1}),e)}isDebouncing(){return this.debouncing}}},{}],14:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.controllerEvents=void 0,n.controllerEvents={initAd:1,showAdFail:5,adVisible:8,loadAd:21,loadAdFailed:22,loadAdSuccess:23,adClicked:33,loadAssetFailed:35,illegalState:36,adRegistered:37,adDestroyed:38,mediaViewDestroyFailed:39,openUrlError:114,debounceClick:122,adUnitRetrySuccess:170,adUnitRetryFail:171,privacyLinkClicked:236}},{}],15:[function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0}),n.apiFactory=void 0;const r=i(e("./ApiFactory"));n.apiFactory=new r.default},{"./ApiFactory":3}],16:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.NATIVE_AD_PREFIX=void 0,n.NATIVE_AD_PREFIX="nativeAd"},{}],17:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createUniqueId=void 0,n.createUniqueId=function(e=""){return`${e}.${Date.now()}.${Math.random()}`}},{}],18:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.__assign=void 0,n.__asyncDelegator=function(e){var t,n;return t={},i("next"),i("throw",(function(e){throw e})),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,r){t[i]=e[i]?function(t){return(n=!n)?{value:l(e[i](t)),done:"return"===i}:r?r(t):t}:r}},n.__asyncGenerator=function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(e,t||[]),a=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(e){r[e]&&(i[e]=function(t){return new Promise((function(n,i){a.push([e,t,n,i])>1||s(e,t)}))})}function s(e,t){try{(n=r[e](t)).value instanceof l?Promise.resolve(n.value.v).then(d,c):u(a[0][2],n)}catch(e){u(a[0][3],e)}var n}function d(e){s("next",e)}function c(e){s("throw",e)}function u(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}},n.__asyncValues=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=o(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise((function(i,r){(function(e,t,n,i){Promise.resolve(i).then((function(t){e({value:t,done:n})}),t)})(i,r,(t=e[n](t)).done,t.value)}))}}},n.__await=l,n.__awaiter=function(e,t,n,i){return new(n||(n=Promise))((function(r,a){function o(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((i=i.apply(e,t||[])).next())}))},n.__classPrivateFieldGet=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},n.__classPrivateFieldSet=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},n.__createBinding=void 0,n.__decorate=function(e,t,n,i){var r,a=arguments.length,o=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(o=(a<3?r(o):a>3?r(t,n,o):r(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},n.__exportStar=function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||a(t,e,n)},n.__extends=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},n.__generator=function(e,t){var n,i,r,a,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){o=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1];break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a);break}r[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},n.__importDefault=function(e){return e&&e.__esModule?e:{default:e}},n.__importStar=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return d(t,e),t},n.__makeTemplateObject=function(e,t){Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t;return e},n.__metadata=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},n.__param=function(e,t){return function(n,i){t(n,i,e)}},n.__read=s,n.__rest=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n},n.__spread=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(s(arguments[t]));return e},n.__spreadArray=function(e,t){for(var n=0,i=t.length,r=e.length;n<i;n++,r++)e[r]=t[n];return e},n.__spreadArrays=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<n;t++)for(var a=arguments[t],o=0,s=a.length;o<s;o++,r++)i[r]=a[o];return i},n.__values=o;
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},i(e,t)};var r=function(){return n.__assign=r=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},r.apply(this,arguments)};n.__assign=r;var a=Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]};function o(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function s(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,r,a=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(e){r={error:e}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return o}function l(e){return this instanceof l?(this.v=e,this):new l(e)}n.__createBinding=a;var d=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}},{}],19:[function(e,t,n){t.exports=function(e){var t={v:1,controllerId:1,applicationKey:1,applicationUserId:0,debug:0,language:0,disableCache:0,applicationUserGender:0,applicationUserAgeGroup:0,demoCampaigns:0,appOrientation:1,mobileCarrier:0,connectionType:1,iphoneAppOnIpadDevice:0,deviceOs:1,SDKVersion:1,deviceOSVersion:1,deviceOEM:0,deviceVolume:0,immersiveMode:0,att:0,"deviceIds[IFA]":0,"deviceIds[IDFV]":0,"deviceIds[SERIAL]":0,"deviceIds[AndroidID]":0,"deviceIds[IMEI]":0,"deviceIds[AID]":0,displaySizeWidth:0,displaySizeHeight:0,deviceWidthDP:0,deviceHeightDP:0,deviceScreenScale:0,deviceLanguage:0,deviceModel:0,diskFreeSize:1,country:0,campaignId:0,customParams:0,isLimitAdTrackingEnabled:0,SDKPluginType:0,bundleId:0,jb:0,gpi:0,allowArbitraryLoads:0,allowArbitraryLoadsInWebContent:0,mcc:0,mnc:0,xCodeVersion:0,xCodeBuildVersion:0,xCodeSdkName:0,xCodeSdkBuild:0,appVersion:0,batteryLevel:0,maxVideoLength:0,itemName:0,itemCount:0,timestamp:0,localTime:0,timezoneOffset:0,itemSignature:0,showDeliveryLimitationsLog:0,minimumOfferCommission:0,minimumOfferCommissionSignature:0,applicationUserCreationDate:0,applicationUserCreationDateSignature:0,mraid:0,numOfCampaigns:0,cdnCn:0,sdkAbName:0,segmentId:0,segmentName:0,consent:0,omidSupported:0,omidVersion:0,omidPartnerVersion:0,mediationType:0};return{init:function(){"android"===e.getConfig().mobileSDKSettings.deviceOs&&(t.deviceApiLevel=0)},getCommonRequiredData:function(){return t}}}},{}],20:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});let i=new(e("../modules/StoreConfig"));t.exports=class{constructor(e,t,n,i,r){this.core=e,this.controller=t,this.constants=n,this.dsConfig=i,this.isBidding=r}parse(e){var t=e.seatbid.ext;return this.extendControllerConfigSettings(t),this.extendDSConfigSettings(t),this.extendNetworkConfigSettings(e),this.extendMicroJobLandingIDSettings(t),this.overrideCacheSettings(e),this.extendStoreSettings(e),this.extendABMapExtSettings(t),t}extendControllerConfigSettings(e){e.shouldStartMuted=this.controller.AdUtils.isCampaignShouldStartMuted(this.controller.getConfig().controllerConfig,this.dsConfig.productType);var t=this.controller.AdUtils.delayUntilCloseVisible(this.controller.getConfig().controllerConfig,this.dsConfig.productType),n=this.controller.AdUtils.delayUntilTimerVisible(this.controller.getConfig().controllerConfig,this.dsConfig.productType),i=this.controller.AdUtils.endScreenSettings(this.controller.getConfig().controllerConfig,this.dsConfig.productType);this.core.Utils.isDefined(t)&&(e.DEC=t),this.core.Utils.isDefined(n)&&(e.DECT=n),this.core.Utils.isDefined(i)&&this.core.Utils.extend(e,{"2EC":i})}extendDSConfigSettings(e){this.core.Utils.extend(!0,e,this.dsConfig.overrideFeedSettings)}extendNetworkConfigSettings(e){var t,n;const i=null!==(n=null===(t=e.seatbid.bid[0])||void 0===t?void 0:t.ext.adSource)&&void 0!==n?n:e.seatbid.ext.adSource;e.seatbid.ext=this.core.Utils.extend(!0,e.seatbid.ext,this.controller.SupplyConfigurations.getFeaturesConfigByAdSource(i))}extendMicroJobLandingIDSettings(e){e.sdkToggles&&delete(e=this.core.Utils.extend(!0,e,e.sdkToggles)).sdkToggles}_shouldOverrideCacheSettingsToPrecache(){return this.dsConfig.productType===this.constants.BN?this.controller.isBannerMultipleInstances(this.dsConfig.productType):this.isBidding}overrideCacheSettings(e){let t=e.seatbid.ext;this._shouldOverrideCacheSettingsToPrecache()&&!this.controller.Utils.isWebWrapper()&&(t.numOfBannersToInitSuccess=1,t.numOfBannersToCache=1)}extendStoreSettings(e){var t,n;const{ext:r,bid:a}=e.seatbid,o=null===(n=null===(t=a[0])||void 0===t?void 0:t.ext.store)||void 0===n?void 0:n.id;this.core.Utils.extend(r,i.getSettingsToOverride(o,r))}extendABMapExtSettings(e){var t;const n=null!==(t=this.controller.getConfig().mobileSDKSettings.ext)&&void 0!==t?t:{};this.core.Utils.extend(!0,e,n)}}},{"../modules/StoreConfig":192}],21:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),t.exports=function(e,t,n){const{portrait:i,landscape:r}=t.appInfo.orientation,a={android:function(e,t){return e.ext.forceOrientation.toLowerCase()},ios:function(t,i){return!function(t){var n,i;const r=null!==(i=null===(n=t.settings.sdkToggles)||void 0===n?void 0:n.ignoreAppOrientationInForceCampaigns)&&void 0!==i&&i;return e.log(`shouldIgnoreAppOrientationInForcedCampaign: ${Boolean(r)}`,e.LogLevels.verbose),r}(t)&&n.getOrientation()&&n.isAppOrientation(t.ext.forceOrientation.toLowerCase())?(e.log(`forced campaign | application is locked on the same orientation - sending  default: ${i}`,e.LogLevels.verbose),i):t.ext.forceOrientation.toLowerCase()}};function o(e){return e&&e.controllerConfig&&["499b4845","406ff65d"].some((t=>t===e.controllerConfig.applicationKey))}return{getAdDisplayOrientation:function(s,l){if(!l)return;let d="undefined",c=t.defaultOrientation[l.productType];return o(s)&&l.settings&&(l.settings.orientation=i),!function(e,t){return t.ext&&t.ext.forceOrientation&&(!o(e)||o(e)&&t.ext.forceOrientation.toLowerCase()===r)}(s,l)?c=function(e){return e.settings&&e.settings.orientation}(l)?l.settings.orientation:n.getOrientation():(c=a[s.mobileSDKSettings.deviceOs](l,c),d=c),"string"==typeof c&&c.toLowerCase()===t.appInfo.orientation.none&&(c=t.defaultOrientation[l.productType]),e.log(`adOrientation | forceByCampaign:${d} , forceBySession:${l.settings.orientation} ,forceByNative:${n.getOrientation()} , ChosenOrientation:${c}`,e.LogLevels.info),c?c.toLowerCase():""}}}},{}],22:[function(e,t,n){"use strict";var i=e("../types");const r=e("./Constants");t.exports=function(e,t){const n="MRAID",a="VAST",o="EXTERNAL",s="INTERACTIVE_END_CARD",l="INTERNAL",d="AT_MP",c="IEC_MP",u="PLAYABLE",f="IMAGE_INTERSTITIAL",p="STATIC_BANNER",g="OTHER",v="imageInterstitial",m={};function h(e){if(e){if(!e.id){I(e,S(e)||"",y(e)||"")}return e.id&&e.id.toString()}}function b(e){var t,n,i;return null!==(n=null===(t=null==e?void 0:e.settings)||void 0===t?void 0:t.adSource)&&void 0!==n?n:null===(i=null==e?void 0:e.ext)||void 0===i?void 0:i.adSource}function S(e){if(!e)return;const t=e.crid||e.bannerId||e.bannerID;return t&&t.toString()}function y(e){if(!e)return;return(e.creativeId||"0").toString()}function A(e){return e&&e.ext&&e.ext.store&&e.ext.store.id}function C(e){return null==e?void 0:e.adAssetsCacheStatus}function I(e,t,n){e.id=`${t}_${n}`}function D(e,t){if(!e)return"";return function(e){return m[e]||m.other}(w(e,t))}m[n]="MR",m[a]="VA",m[o]="EX",m[s]="IEC",m[l]="AT",m[d]="AT_MP",m[c]="IEC_MP",m[u]="PL",m[f]="IM",m[p]="SB",m[g]="OT";var w=function(t,r){const m=t&&t.ext;let h="";return m?(h=function(e){return e&&e.type&&e.type===v}(m)?f:e.VastUtils.isVastCampaign(t)?a:P(m)?u:O(m)?n:F(m)?d:function(e){return e&&e.type&&e.type===i.AdType.IECMarketplace}(m)?c:T(m)?o:x(m)?s:U(m)?l:function(e){return e&&e.type&&e.type===i.AdType.StaticBanner}(m)?p:g,h):h};function P(e){return e&&e.type&&"playableAd"===e.type}function O(e){return e&&e.type&&"MRAID"===e.type}function F(e){return e&&e.type&&e.type===i.AdType.AppTrailerMarketplace}function T(e){return e&&e.videoData&&e.videoData.videoType&&"ssa-external-video-player"===e.videoData.videoType}function x(e){return e.type===i.AdType.CustomEndCard}function U(e){return e&&e.videoData&&e.videoData.videoType&&"ssa-internal-video-player"===e.videoData.videoType}function N(t){const n={};return n.id=h(t),n.title="",n.credits=t.credits,n.staticContent=e.AdAssets.extractStaticFiles(t),n.lastUpdateTime=t.lastUpdateTime,n.inventoryIndex=t.inventoryIndex,n.isCacheable=t.isCacheable=n.staticContent.length>0,n}function L(e){const{deviceOs:n}=t.getApiData({deviceOs:1});e.standaloneView=n===r.deviceOs.ios,e.translucentView=n===r.deviceOs.android}function V(e,t){const n={};return t&&t.ext&&t.ext.opportunityID&&(n.opportunityId=t.ext.opportunityID),e&&e.requestID&&(n.requestId=e.requestID),n}return{getAdId:h,getAdIdsOfAds:function(e){if(!e||!Array.isArray(e))return[];const t=[];for(let n=0;n<e.length;n++)t.push(h(e[n]));return t},generateUniqueAdId:function(e){return`${e.productType}.${e.demandSourceName}.${h(e)}.${Date.now()}`},getAdSource:b,getBannerId:S,getCreativeId:y,getAdType:D,formatParamsToAdId:function(e){if(e){if(!e.id){const t=S(e);t&&I(e,t,r.legacyCreativeId.toString())}return e}},formatAdsForPrecache:function(e){return e.map(((e,t)=>N(e))).filter((e=>e.isCacheable))},isCacheableAd:function(e){return e&&e.hasOwnProperty("isCacheable")},getStoreAppId:function(e){if(e.ext.clickTags.storeAppId)return e.ext.clickTags.storeAppId;let t="";const n=e.ext.clickTags.clickURL;return n&&(t=function(e){let t=e.match(/id\d+/g),n="";t&&(t=t[t.length-1],t=t.match(/\d+/g),n=Array.isArray(t)?t[0]:"");return n}(n)||"",t&&(e.ext.clickTags.storeAppId=t)),t},formatVastAdForPrecache:function(e,t){let n;return n=N(e),n.preProcessing=t,n.isCacheable=e.isCacheable=!0,n},setViewType:function(e,t,n){var i;t&&t.ext&&((i=t.ext)&&i.layoutData&&(i.layoutData.portrait&&i.layoutData.portrait.frameUrl&&i.layoutData.portrait.closeButtonUrl||i.layoutData.landscape&&i.layoutData.landscape.frameUrl&&i.layoutData.landscape.closeButtonUrl))&&L(e),n&&(e.viewType=n)},removeViewTypeFromSetting:function(e){e.viewType&&delete e.viewType},getViewType:function(e){return e&&e.settings?e.settings.viewType:null},getRequestOppParams:V,updateEventWithAdParams:function(t,n,i){return n&&((i=e.Utils.extend(i,V(t,n))).bannerId=S(n),i.creativeId=y(n),i.adSource=i.adSource||b(n),i.campaignType=D(n,t),i.storeId=A(n),i.custom_g=C(n)),i},isPlayableCampaign:P,isPlayablePrecachedAd:function(e){const t=e.ext;return P(t)&&t.videoData&&t.videoData.videoSource&&!!t.videoData.videoSource.htmlURL},isInteractiveEndCardCampaign:x,isInternalCampaign:U,isAppTrailerMarketPlaceCampaign:F,isMRAIDCampaign:O,isExternalCampaign:T,isCampaignShouldStartMuted:function(e,t){return!(!e||!e[r.sspProductNames[t]]||!0!==e[r.sspProductNames[t]].startVideoOnMute)},delayUntilCloseVisible:function(t,n){if(t&&t[r.sspProductNames[n]]&&e.Utils.isDefined(t[r.sspProductNames[n]].DEC))return t[r.sspProductNames[n]].DEC},endScreenSettings:function(e,t){var n;return null===(n=null==e?void 0:e[r.sspProductNames[t]])||void 0===n?void 0:n["2EC"]},delayUntilTimerVisible:function(t,n){if(t&&t[r.sspProductNames[n]]&&e.Utils.isDefined(t[r.sspProductNames[n]].DECT))return t[r.sspProductNames[n]].DECT},extendAdObjectWithConfig:function(t,n,i,r){n.settings=e.Utils.extend(!0,n.settings,r),n.ext&&n.ext.forceOrientation&&(n.settings.orientation=n.ext.forceOrientation.toLowerCase()),n=e.Utils.extend(!0,n,i,{url:t})},extendSettingsWithStandaloneViewSupport:L,extractEventData:function(e){if(!e||!e.ext)return{};let t={requestId:e.requestID,opportunityId:e.ext.opportunityID,bannerId:S(e),creativeId:y(e),campaignType:D(e,e.ext),rvPlayMethod:e.displayMode,displayStrategy:e.displayStrategy,dynamicDemandSource:e.ext.dynamicDemandSource,auctionId:e.ext.auctionId,adunitVersion:e.adunitVersion,adunitbn:e.adunitbn,isBiddingInstance:e.isInAppBidding,isOneFlow:e.isOneFlow,productType:e.productType,demandSourceName:e.originalDemandSourceName,sessionDepth:e.settings&&e.settings.sessionDepth,strategyId:e.settings&&e.settings.strategyId,landingId:e.settings&&e.settings.landingId,adSource:b(e),storeId:A(e),custom_g:C(e)};return Object.keys(t).reduce((function(e,n){return void 0!==t[n]&&(e[n]=t[n]),e}),{})},mraidWaitForVisible:function(t,n){var i;if(t&&t[r.sspProductNames[n]]&&e.Utils.isDefined(null===(i=t[r.sspProductNames[n]])||void 0===i?void 0:i.mraidReadyOnlyInVisible))return t[r.sspProductNames[n]].mraidReadyOnlyInVisible},getConfirmCloseMsg:function(e){let t=r.confirmCloseMsg;return e.settings.labels&&e.settings.labels.confirmCloseMsg&&e.settings.labels.confirmCloseMsg.during&&(t=e.settings.labels.confirmCloseMsg.during),t}}}},{"../types":213,"./Constants":33}],23:[function(e,t,n){t.exports=function(e,t,n){return{decideOnAdvertisingId:function(i,r){t.isIOS()&&(e.VersionUtils.isLower(i.deviceOSVersion,"10")||function(e){return e["deviceIds[IFA]"]&&e["deviceIds[IFA]"]!==n.advertisingId.invalidAdvertisingId}(i))&&(void 0===r.sid||r.sid||(i["deviceIds[IDFV]"]=null))}}}},{}],24:[function(e,t,n){t.exports=function(t,n){var i="AndroidLifeCycleEventHandlers | ",r=e("./NativeLifeCycleEventsConstants.js"),a={};function o(e){var n={};e&&(n.eventParams=e),t.PubSub.publish(r.serviceCallback+"."+r.AndroidEvents.onDestroy,[n])}function s(e){}function l(e){}function d(e){}function c(e,t){var r;return r="_isEventSupported: "+e+" supportedEvents: "+t,n.log(i+r),e&&t.indexOf(e)>-1}return{publishEvent:function(e,t){a[r.AndroidEvents.onDestroy]=o,a[r.AndroidEvents.onStop]=s,a[r.AndroidEvents.onStart]=l,a[r.AndroidEvents.onResume]=d,c(e,Object.keys(a))&&a[e](t)}}}},{"./NativeLifeCycleEventsConstants.js":57}],25:[function(e,t,n){t.exports={analyticsCategories:{nomediaFileDownloadFail:{name:"nomediaFileDownloadFail",id:210},nomediaFileDownloadSuccess:{name:"nomediaFileDownloadSuccess",id:211}},noMediaFileUrl:"/users/android/.nomedia",logMessage:{tag:"AndroidNomediaFileHandler | ",fileInCache:"nomedia file already in cache",saveFileToCache:"save nomedia file to cache"},errorMessage:{fileAlreadyExist:"file_already_exist"}}},{}],26:[function(e,t,n){t.exports=function(t){var n,i=e("./AndroidNomediaFileConstants.js"),r=i.noMediaFileUrl;return{init:function(e){n=e},updateNomediaFileToCache:function(){var e=t.getConfig(),a=t.Cache.getRootCacheStructure(),o=function(e){return e.mobileSDKSettings.protocol+"//"+e.mobileSDKSettings.cdn+r}(e);a&&-1!==t.Cache.getFileIndexInCache(a.cache,o)?t.log(i.logMessage.tag+i.logMessage.fileInCache):(t.log(i.logMessage.tag+i.logMessage.saveFileToCache),t.saveFileToCache("./",o).then((function(){n.report(i.analyticsCategories.nomediaFileDownloadSuccess)}),(function(e){e!==i.errorMessage.fileAlreadyExist&&n.report(i.analyticsCategories.nomediaFileDownloadFail,{generalMessage:e})})))}}}},{"./AndroidNomediaFileConstants.js":25}],27:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i={messageFromAdPlayer:{apsAttribution:"SDKController.apsAttribution"},messageToNative:{apsAttribution:{name:"androidSandboxApi",success:"apsAttribution.success",failure:"apsAttribution.failure"}}};n.default=i},{}],28:[function(e,t,n){"use strict";var i,r=(i=e("./AndroidSandboxConstants"))&&i.__esModule?i:{default:i};const a=e("../../modules/DemandSource/EventCategories")();t.exports=class{constructor(e){this.controller=e.controller,this.core=e.core,this.analytics=e.analytics,this.shouldReceiveMessage=e.shouldReceiveMessage}init(){"ios"!==this.controller.getDeviceOs()&&this.initAttributionListeners()}initAttributionListeners(){this.core.PubSub.subscribe(r.default.messageFromAdPlayer.apsAttribution,(e=>this.onAttribution(e)));const{failure:e,success:t}=r.default.messageToNative.apsAttribution;this.core.PubSub.subscribe("NativeCallback."+t,(e=>this.onAttributionSuccess(e))),this.core.PubSub.subscribe("NativeCallback."+e,(e=>this.onAttributionFailure(e)))}onAttribution(e){const t=e;if(!this.shouldReceiveMessage(t))return;const{type:n,coordinates:i,url:o,demandSourceName:s,productType:l}=t,{name:d,success:c,failure:u}=r.default.messageToNative.apsAttribution;this.analytics.report(a.apsAttribution,{custom_a:n});const f={type:"attribution",demandSourceName:s,productType:l,params:{type:n,coordinates:i,url:o}};this.controller.callSDKFunction(d,f,c,u)}onAttributionFailure(e){const t=e;this.shouldReceiveMessage(t)&&this.analytics.report(a.apsAttributionFailed,{generalmessage:t.params.reason,custom_a:t.params.type})}onAttributionSuccess(e){const t=e;this.shouldReceiveMessage(t)&&this.analytics.report(a.apsAttributionSuccess,{custom_a:t.params.type})}}},{"../../modules/DemandSource/EventCategories":146,"./AndroidSandboxConstants":27}],29:[function(e,t,n){t.exports={NativeAPI:{getAUIDFailed:"getAUIDFailed",getAUIDSuccess:"getAUIDSuccess",setAUIDFailed:"setAUIDFailed",setAUIDSuccess:"setAUIDSuccess"}}},{}],30:[function(e,t,n){t.exports=function(t,n,i){var r,a,o="AppUserIdService | ",s=!1,l=e("../modules/SDKController/EventCategories")(),d=e("./AppUserIdConstants");function c(e){var r=new jQuery.Deferred;(function(e){return e&&!t.Utils.isEmptyObject(e)&&"{}"!==e})(e)?r.resolve(e):function(e,r){var a,s,l,c=[],u=4e3,f=d.NativeAPI.setAUIDSuccess,g=d.NativeAPI.setAUIDFailed;if(!e||!r)return;c.push(t.PubSub.subscribe(i.CB+"."+f,(function(e){if(clearTimeout(l),!(a=n.isIOS()?e&&e.key&&e.key===p()&&e.value&&decodeURIComponent(e.value):e&&e[p()]&&decodeURIComponent(e[p()]))||t.Utils.isEmptyObject(a)||"{}"===a)return r.reject("Invalid set AUID response."),void t.PubSub.clearHandlers(c);n.log(o+"_setAUIDKeyInNative succeeded, response: "+a,n.LogLevels.info),r.resolve(a),t.PubSub.clearHandlers(c)}))),c.push(t.PubSub.subscribe(i.CB+"."+g,(function(e){clearTimeout(l),s=e&&!n.checkRequiredCallbackParams(["errMsg"],e,g).didSucceed?n.checkRequiredCallbackParams(["errMsg"],e,g).errMsg:e&&e.errMsg,n.log(o+"_setAUIDKeyInNative failed, errorMsg: "+s,n.LogLevels.info),r.reject(g+": "+s),t.PubSub.clearHandlers(c)}))),l=setTimeout((function(){n.log(o+"_setAUIDFromNative failed, errorMsg: timeout",n.LogLevels.info),r.reject(g+": timeout"),t.PubSub.clearHandlers(c)}),u),n.callSDKFunction("setUserData",{key:p(),value:e},f,g)}(t.Utils.generateIdentifier(1),r);return r.promise()}function u(e,i){r=e,t.Analytics.updateBaseData({auid:r}),i||n.getTokenService().updateToken({auid:r})}function f(e){a.report(l.auidFail,{callfailreason:e})}function p(){var e=n.SupplyConfigurations.getNetworkConfigValueByKey("auid_key");return e||"auid"}return{init:function(e){var r,l,g,v,m,h,b,S,y;s||(a=e,(r=n.SupplyConfigurations.getValueByKey("auid"))?function(e){u(e,!0)}(r):(m=[],h=4e3,b=new jQuery.Deferred,S=d.NativeAPI.getAUIDSuccess,y=d.NativeAPI.getAUIDFailed,m.push(t.PubSub.subscribe(i.CB+"."+S,(function(e){if(clearTimeout(v),!(l=e&&e[p()]&&decodeURIComponent(e[p()])))return b.reject("Invalid get AUID response"),void t.PubSub.clearHandlers(m);n.log(o+"_getAUIDFromNative succeeded, response: "+l,n.LogLevels.info),b.resolve(l),t.PubSub.clearHandlers(m)}))),m.push(t.PubSub.subscribe(i.CB+"."+y,(function(e){clearTimeout(v),g=e&&!n.checkRequiredCallbackParams(["errMsg"],e,y).didSucceed?n.checkRequiredCallbackParams(["errMsg"],e,y).errMsg:e&&e.errMsg,n.log(o+"_getAUIDFromNative failed, errorMsg: "+g,n.LogLevels.info),b.reject(y+": "+g),t.PubSub.clearHandlers(m)}))),v=setTimeout((function(){n.log(o+"_getAUIDFromNative failed, errorMsg: timeout",n.LogLevels.info),b.reject(y+": timeout"),t.PubSub.clearHandlers(m)}),h),n.callSDKFunction("getUserData",{key:p()},S,y),b.promise()).then(c).then(u).fail(f),s=!0)},getAUID:function(){return r}}}},{"../modules/SDKController/EventCategories":178,"./AppUserIdConstants":29}],31:[function(e,t,n){t.exports=function(e){var t={},n=!1;function i(e,n){var i=t[e],r=[];return i&&i[n]?r=i[n]:i[n]=r,r}return{init:function(i){n||(i,t[e.RV]={},t[e.IS]={},t[e.BN]={},n=!0)},addToBlacklistedCampaigns:function(e,t,n){if(e&&t&&n){var r=i(e,t);r&&-1===r.indexOf(n)&&r.push(n)}},getBlacklistedCampaigns:function(e,t){var n=[];return e&&t&&(n=i(e,t)),n},isEmpty:function(e,t){var n=i(e,t);return!n||0===n.length}}}},{}],32:[function(e,t,n){t.exports=function(e,t,n){var i,r,a="FilterCampaigns | ",o={deviceOs:1,"deviceIds[IFA]":0,"deviceIds[AID]":0},s=1500,l=e.Utils,d={};function c(i){var r,o,l,d=new jQuery.Deferred,c="checkInstalledAppsSuccess",u="checkInstalledAppsFailed",f={appIds:i,requestId:Date.now().toString()},p=function(){e.PubSub.unsubscribe(r),e.PubSub.unsubscribe(o)};return r=e.PubSub.subscribe(n.CB+"."+c,(function(e){e.requestId===f.requestId&&(clearTimeout(l),p(),t.log(a+"successfully check apps installed "+JSON.stringify(e.result)),d.resolve(e.result))})),o=e.PubSub.subscribe(n.CB+"."+u,(function(e){clearTimeout(l),p(),t.log(a+"failed to check apps installed"+JSON.stringify(e)),d.reject()})),l=setTimeout((function(){p(),d.reject("SDK check apps installed timeout request")}),s),t.callSDKFunction("checkInstalledApps",f,c,u),d.promise()}function u(n){var a={deviceId:"ios"===(i=t.getApiData(o)).deviceOs?i["deviceIds[IFA]"]:i["deviceIds[AID]"],os:i.deviceOs,campaignIds:{}},s=r.urlPaths&&r.urlPaths.campaignsStatus;s?(e.Utils.each(n,(function(e,t){var n,i;a.campaignIds[t.campaignId]=(t.isInstalled?(n=50,i=100):(n=0,i=50),Math.floor(Math.random()*(i-n))+n)})),jQuery.ajax({url:s,data:a,type:"GET",dataType:"jsonp",success:function(e){t.log("Success update campaigns status to server",t.LogLevels.verbose)},error:function(e,n){t.log("Success update campaigns status to server: response:"+e+".status: "+n,t.LogLevels.verbose)}})):t.log("No url in settings to update server on campaigns status",t.LogLevels.verbose)}function f(e,n){var i=!0;return e||(t.log("filter apps installed flag is false",t.LogLevels.verbose),i=!1),n&&0!==n.length||(t.log("get 0 campaigns to filter",t.LogLevels.verbose),i=!1),t.isLegacy({ios:"5.14",android:"5.16"})&&(t.log("NewController: Old controller version. filter campaigns by app installed is not supported in this version of SDK.",t.LogLevels.verbose),i=!1),i}function p(n,i,r){var a=new jQuery.Deferred;return e.Utils.isEmptyObject(i)?a.resolve():function(n){return t.isAppsInstalledInfoRestricted()?e.Utils.returnResolvedPromise(d):c(n)}(r).then(g.bind(null,n,i,a)).then(u).fail((function(e){t.log("failed filter campaigns by app installed. "+e,t.LogLevels.verbose),a.resolve()})),a.promise()}function g(n,i,r,o){e.Utils.each(o,(function(e,t){var n=i[e];n&&(t.bannerIds=n)}));var s=function(n,i){var r=[];return e.Utils.each(i,(function(e,i){if(i.isInstalled){for(var a=[],o=0;o<n.length;o++){var s=t.AdUtils.getAdId(n[o]);i.bannerIds&&-1===i.bannerIds.indexOf(s)?a.push(n[o]):r.push(n[o])}n.length=0;for(var l=0;l<a.length;l++)n.push(a[l])}})),t.log(a+"after ads filtering"),{newCampaigns:n,installedCampaigns:r}}(n,o);return n=s.newCampaigns,r.resolve(s.installedCampaigns),o}return{filterByAppInstalled:function(e,n,i){if(i=i||[],!f((r=n).filterAppsInstalled,e))return l.returnResolvedPromise();for(var a={},o=e.length,s=[],d=0;d<o;d++){var c=e[d],u=t.AdUtils.getAdId(c),g=c&&c.ext,v=g&&g.appData;g&&v&&v.appId&&(0===i.length||-1===i.indexOf(g.type))&&(a[v.appId]||(a[v.appId]=[]),a[v.appId].push(u),-1===s.indexOf(v.appId)&&s.push(v.appId))}return p(e,a,s)},filterByAppInstalledOW:function(e,n){if(r=n,!f(!0,e))return l.returnResolvedPromise();for(var i={},a=e.length,o=[],s=0;s<a;s++){var d=e[s],c=t.AdUtils.getAdId(d),u=d.appData;u&&u.filterIfInstalled&&(u.appId&&(i[u.appId]||(i[u.appId]=[]),i[u.appId].push(c),-1===o.indexOf(u.appId)&&o.push(u.appId)))}return p(e,i,o)},checkIfAppInstallOnDevice:c}}},{}],33:[function(e,t,n){var i=e("../constants/featureCompatibilityMap");t.exports={CB:"NativeCallback",WebControls:"WebControls",RV:"RewardedVideo",OW:"OfferWall",IS:"Interstitial",BN:"Banner",RIS:"RIS",taskManager:"TaskManagerDS",libs:"libs",fakeOWLoader:"fakeOWLoader",timeunit:6e4,closeAndBackDisabledTimer:1e4,closeAndBackDisabledTimerOW:8e3,vastResponseTimeout:8e3,vastMinimumResponseTimeout:500,legacyCreativeId:0,domainUrls:{local:"local.ssacdn.com",prod:"www.supersonicads.com"},environment:{develop:"dev",production:"prod",stage:"stage"},errors:{missing:"Missing required parameter: ",invalid:"Invalid parameter: ",unknown:"Unknown parameter: ",appInfo:"Failed to retrieve application info",device:"Failed to retrieve device status",filemap:"Failed to retrieve file map",showAdFailedReasons:{preloadNoAd:"No ad on preload function",showNoAd:"No ad on show function",taskManagerPreload:"taskManager failed to preload",taskManagerEngage:"taskManager failed to engage",onAdVisibleFailed:"onAdVisible failed",screenVisibleTimeout:"Screen visible timeout",userClosedBeforeAdVisible:"userClosedBeforeAdVisible"},noFill:"We did not receive any campaigns in inventory"},noMoreOffersReason:{refreshFeedAfterClosingAd:"Refresh Feed after closing ad",noMoreOffersToShowInFeed:"Finish view all campaigns (engageEnd)"},DebugLevels:{0:"NONE",1:"ERROR",2:"INFO",3:"VERBOSE"},videoStates:{none:0,play:1,stop:2},confirmCloseMsg:{close:"Are you sure you want to quit the offer?",yes:"OK",no:"Cancel"},confirmCloseMsgMap:{0:"during",1:"after"},protocol:{http:"http:",https:"https:",file:"file:"},styleAccordingToProtocol:{secured:"secured",unsecured:"unsecured"},labels:{noInternet:"No internet connection. Please connect and try again.",noOffers:"Sorry, There are no offers at the moment"},closeButtonStates:{close:"close",confirm:"confirm",back:"back",confirmNextFrame:"confirmNextFrame",nextFrame:"nextFrame",ignore:"ignore",closeBanner:"closeBanner",closeBannerDuringShowPatch:"closeBannerDuringShowPatch"},openUrlMethods:{storeKit:"storeKit",external_browser:"external_browser",store:"store",webview:"webview"},deviceOs:{android:"android",ios:"ios"},deviceOEM:{amazon:"amazon"},nativeInterfaceMethod:{displayWebView:"displayWebView"},nativeCallBacks:{hideSuccess:"onHideSuccess",hideFailed:"onHideFailed",displayWebviewSuccess:"onDisplayWebviewSuccess",displayWebviewFailed:"onDisplayWebviewFailed:"},offerWallSetting:{immersive:"immersive",OLXD:"OLXD",OWVersion:"OWVersion",defaultOWVersion:"1.12.183"},appInfo:{orientation:{landscape:"landscape",portrait:"portrait",none:"none"}},sspProductNames:{RewardedVideo:"rewardedVideo",Interstitial:"interstitial",OfferWall:"offerWall",Banner:"banner"},demandSourceType:{demandSource:"demandSource",instance:"instance"},demandSourceStates:{notInitiated:0,initFail:1,initiated:2,available:3,notAvailable:4,exhausted:5,cappedPerSession:6,initPending:7,loadPending:8},templateStyle:{template4:{minDialogBtnWidth:187,baseDialogBtnWidth:187,maxDialogBtnWidth:187,maxDialogBtnTextWidth:165},defaultTemplate:{minDialogBtnWidth:75,baseDialogBtnWidth:100,maxDialogBtnWidth:133,maxDialogBtnTextWidth:115}},viewsStates:{normal:0},baseDataKeys:["deviceId","controllerVersion","sdkVersion","deviceOs","deviceOsVersion","devicesizecategory","deviceOEM","deviceModel","browser","env","applicationId","applicationUserId","deviceApiLevel","usertype","appVersion","auid","platformABGroup","applicationKey","controllerbn","abTest","lat","pluginType","productType","mediationType","SDKpluginType","bundleId","isOneFlow","isBiddingInstance","demandSourceName","demandSourceId"],iphoneXDeviceModels:["iPhone10,3","iPhone10,6","iPhone11,6","iPhone11,4","iPhone11,2","iPhone11,8","iPhone12,1","iPhone12,3","iPhone12,5","iPhone13,1","iPhone13,2","iPhone13,3","iPhone13,4","iPhone14,2","iPhone14,3","iPhone14,4","iPhone14,5"],iphoneXDeviceResolution:{type1:{width:375,height:812},type2:{width:414,height:896},type3:{width:390,height:844},type4:{width:428,height:926}},notchSettings:{safeAreaInsetsMin:24,viewportCounter:10},requiredDeviceInfo:["appOrientation","connectionType","deviceOs","SDKVersion","deviceOSVersion","deviceModel","diskFreeSize"],requiredAppInfo:["applicationKey","applicationUserId"],optionalAppInfo:["campaignId","showDeliveryLimitationsLog","numOfCampaigns","disableCache","disableSession","country","language","itemName","itemCount","itemSignature","timestamp","demoCampaigns","mraid","admin","page","pageSize","landingId","maxVideoLength","minimumOfferCommission","minimumOfferCommissionSignature","useClientSideCallbacks","applicationUserGender","applicationUserAgeGroup","applicationUserCreationDate","applicationUserCreationDateSignature","placementId","SDKPluginType","skd"],abTests:{CnCcCdn:"CC2",CnNonCcCdn:"NCC2",CnUser:"CN",NonCnUser:"NCN",WithoutCC:"WOCC",abt:"abt",controllerConfigGroup:"controllerConfigGroup"},xCodeData:{xCodeVersion:"xCodeVersion",xCodeBuildVersion:"xCodeBuildVersion",xCodeSdkName:"xCodeSdkName",xCodeSdkBuild:"xCodeSdkBuild"},abtParamByProductType:{RewardedVideo:"rewardedVideo",Interstitial:"interstitial",Banner:"banner",OfferWall:"offerwall"},deviceLimitations:["iPod5,1","iPad2,1","iPad4,8","iPad3,5","iPad3,6","iPad4,5","iPhone4,1","iPhone7,1","iPad4,4","iPad4,2","iPad2,2","iPad2,5","iPad4,1","iPad3,4","iPad3,3","iPad4,7","iPad3,1","iPad2,4"],applicationsLimitations:["49726195"],testAppBundleIds:["com.supersonic.mediation.test","com.ironsrcmobile.UltraApp","com.ironsrcmobile.UltraAppSDK5","com.ironsrcmobile.UltraApp-enterprise","com.supersonic.automationapp","com.ironsrcmobile.Bridge","com.ironsource.othermediationtester","com.ironsrc.ISMedAdapters"],defaultOrientation:{RewardedVideo:"application",Interstitial:"application",OfferWall:"application",Banner:"application",general:"device",undefined:"application"},vastRequestPlaceholders:{moatEnabled:"{MT_ENABLED}",requestId:"{REQ_ID}",opportunityId:"{OPP_ID}"},featureCompatibilityMap:i,blockedProductsPerApiLevel:{RewardedVideo:{android:/^10/,ios:/^7/},OfferWall:{android:/^10/,ios:/^7/},Interstitial:{android:/^10/,ios:/^7/},Banner:{android:/^10/,ios:/^7|8|9/}},storeSearchKeys:{ios:["itunes.apple.com"],android:["market://","play.google.com"]},gatewayDestinationMap:{RV:{production:"//rv-gateway.supersonicads.com/gateway/sdk/request",staging:"//staging-rv-gateway.sonic-us.supersonicads.com/gateway/sdk/request"},IS:{production:"//is-gateway.supersonicads.com/gateway/sdk/request/",staging:"//staging-is-gateway.sonic-us.supersonicads.com/gateway/sdk/request/"},OW:{production:"//ow-gateway.supersonicads.com/gateway/offerwall/request",staging:"//staging-ow-gateway.sonic-us.supersonicads.com/gateway/offerwall/request"},BN:{production:"//banner-gateway.supersonicads.com/gateway/sdk/request",staging:"//staging-banner-gateway.sonic-us.supersonicads.com/gateway/sdk/admin/request"}},requiredSDKDataKeys:{applicationKey:"applicationKey",applicationUserId:"applicationUserId",appOrientation:"appOrientation",deviceLanguage:"deviceLanguage",bundleId:"bundleId",sdkAbName:"sdkAbName"},HTTPMethods:{GET:"GET",POST:"POST"},adClosedErrorReason:{unexpectedCloseActivityDestroy:"unexpectedClose_ActivityDestroy"},viewTypes:{externalView:"external"},assetType:{adunitAsset:"adunitAsset",adAsset:"adAsset"},adViewIdString:"adViewId",bannerAdViewId:"Banner.SupersonicAds",DEFAULT_AMOUNT_OF_INVENTORIES:1,iOS_UIModalPresentationFullScreen:0,adTypes:{CPVI:"CPVI",customEndCard:"customEndCard",imageInterstitial:"imageInterstitial",MRAID:"MRAID",playableAd:"playableAd"},extraOffers:{minimalAndroidApiLevel:21,fetchTimeout:1e4,minimumAdsForExtraOffersInventory:2},viewableChangeReasons:{storeKitOpen:"storeKitOpen",storeKitClose:"storeKitClose"},storeKit:{minimalSupportedOSVersion:11,loadFailuresToPreventRetry:["Invalid Parameters","Unsupported Orientation"],loadingTimeoutMessage:"StoreKit load timeout"},authorizationStatus:"att",advertisingId:{invalidAdvertisingId:"00000000-0000-0000-0000-000000000000"},advertiserIdParamsToUpdate:["deviceIds[IFA]","deviceIds[IDFV]","isLimitAdTrackingEnabled","att","idfa","idfv","lat"],adPlayerDirectory:"ad-player",cacheAdsDirectory:"ads",numOfBannersToInitSuccess:"numOfBannersToInitSuccess",numOfBannersToCache:"numOfBannersToCache",cacheConfiguration:"cacheConfig",defaultTimeoutForCachingAds:3e4,isBNAutoRemove:"isBNAutoRemove",offScreenViewConfig:{maximalVersionToSupport:12.5}}},{"../constants/featureCompatibilityMap":119}],34:[function(e,t,n){t.exports=function(e,t,n){function i(e){return!(e?e.productType:null)}function r(e,t){return t=t||{},e&&e.demandSourceName?(t.demandSourceName=e.demandSourceName,t.demandSourceId=e.demandSourceId,t.isInAppBidding=e.isInAppBidding,t):t}return{isLegacy:i,extendCallbackParamsWithDemandConfig:r,extendCallbackParamsWithProductConfig:function(e,t){return t=r(e,t),e&&e.productType&&(t.productType=e.productType),t},extendCallbackParamsWithParentProductConfig:function(n,i){if(i=r(n,i),n&&n.productType){var a=t[n.productType];a&&(i.productType=e.Utils.isFunction(a.getProductType)?a.getProductType():n.productType)}return i},shouldReceiveMessage:function(e,t){return!(!e||!t)&&(!(!e.productType||!e.demandSourceName)&&(t.productType===e.productType&&(i(e)||t.demandSourceName===e.demandSourceName)))},setManualRewardedVideoTypeForNative:function(e){return e&&e.productType&&e.productType===n.RV&&(e.productType=n.IS),e}}}},{}],35:[function(e,t,n){t.exports={CB:"NativeCallback",deviceDataNativeFunction:"deviceDataAPI",getDeviceData:"getDeviceData",failCallback:"handleDeviceDataFailed",successCallback:"handleDeviceDataSuccess",sdkNotSupportedErrMsg:"DeviceDataService | module not supported by SDK",notInitiatedErrMsg:"DeviceDataService | module not initiated or not supported by SDK",alreadyInitiatedErrMsg:"DeviceDataService | init | module is already initiated",intervalAlreadySet:"DeviceDataService | _startPullingDataWithInterval | interval already set",notValidInterval:"DeviceDataService | _startPullingDataWithInterval | interval is not valid, must be higher than 15 seconds",minimumIntervalAllow:5}},{}],36:[function(e,t,n){t.exports=function(t,n){var i,r,a=e("./DeviceDataConstants"),o=e("../constants/featureCompatibilityMap"),s=!1,l={},d=!1;function c(){n.callSDKFunction(a.deviceDataNativeFunction,{deviceDataFunction:a.getDeviceData},a.successCallback,a.failCallback)}function u(e){var t=e&&e.errMsg?e.errMsg:"";n.log("DeviceDataService |  getDeviceData fail, params : "+JSON.stringify(e)+"with errorMessage: "+t)}function f(e){n.log("DeviceDataService |  getDeviceData success, params :"+JSON.stringify(e)),e&&(l=e)}function p(){s?(clearInterval(i),i=void 0):n.log(a.notInitiatedErrMsg)}function g(e){if(n.log("DeviceDataService | _startPullingDataWithInterval | interval:"+e),s){var t=function(e){var t=parseInt(e);if(isNaN(t))return-1;return t}(e);t<a.minimumIntervalAllow?n.log(a.notValidInterval):i?n.log(a.intervalAlreadySet):(r=t,i=setInterval(c,1e3*t))}else n.log(a.notInitiatedErrMsg)}return{init:function(e){if(n.isLegacy(o.pullingNativeDeviceData))n.log(a.sdkNotSupportedErrMsg);else if(s)n.log(a.alreadyInitiatedErrMsg);else{var i=n.SupplyConfigurations.getNetworkConfigValueByKey("pullingDeviceDataInterval")||n.getConfig().controllerConfig.pullingDeviceDataInterval||-1;t.PubSub.subscribe(a.CB+"."+a.successCallback,f),t.PubSub.subscribe(a.CB+"."+a.failCallback,u),t.PubSub.subscribe(a.CB+".enterBackground",(function(e){n.log("DeviceDataService | entered BG | should pause interval"),p()})),t.PubSub.subscribe(a.CB+".enterForeground",(function(e){n.log("DeviceDataService | entered FG | should resume interval"),g(r)})),e,c(),s=!0,g(i)}},getDeviceData:function(){return s||n.log(a.notInitiatedErrMsg),l},pullData:c,startPullingDataWithInterval:g,stopPullingData:p,setPullDataOnLoadAd:function(e){e&&!d&&(d=!0)},shouldPullDataOnLoadAd:function(){return d}}}},{"../constants/featureCompatibilityMap":119,"./DeviceDataConstants":35}],37:[function(e,t,n){t.exports=function(e,t,n,i){var r=e.AdUtils,a=null;return{set:function(e){e&&e.productType===i.BN&&a&&a.productType!==i.BN?t.report(n.setAdDisplayAlreadyAdShown,{productType:e.productType,generalMessage:a.productType+" | "+e.productType}):a=e},get:function(){return a||null},reset:function(){a=null},getDisplayedAdType:function(){return a?a.productType:null},getDisplayedAdDemandName:function(){return a?a.demandSourceName:null},getDisplayedAdSettings:function(){return a?a.settings:null},getDisplayedAdStoreId:function(){return a&&a.ext&&a.ext.store&&a.ext.store.id?a.ext.store.id:null},isDisplayed:function(){return null!==a},isAdDisplayed:function(e){return a&&e&&r.getAdId(a)===r.getAdId(e)}}}},{}],38:[function(e,t,n){t.exports=function(e){var t={},n=e||{};return{getABTestConfiguration:function(e,i){var r=t[e]&&t[e].abtest&&t[e].abtest.default,a=t[e]&&t[e].abtest&&t[e].abtest[r]||{},o=t[e]&&t[e].abtest&&t[e].abtest[i]||{};return n.extend(!0,{},a,o)},setConfig:function(e){t=e||{}}}}},{}],39:[function(require,module,exports){function ExtraOffers(constants,fetcherService,environmentConfiguration){var minimumAdsForExtraOffersInventory=constants.extraOffers.minimumAdsForExtraOffersInventory,supportedProductTypes=[constants.RV,constants.IS],supportedAdTypes=[constants.adTypes.CPVI,constants.adTypes.customEndCard,constants.adTypes.imageInterstitial];function _isEnabled(e){return!!(e&&e.extraOffers&&e.extraOffers.enabled)}function _isProductTypeSupported(e){return-1!==supportedProductTypes.indexOf(e)}function _isAdTypeSupported(e){return-1!==supportedAdTypes.indexOf(e)}function _isSupported(e,t,n,i){return!(e===constants.deviceOs.android&&t<constants.extraOffers.minimalAndroidApiLevel)&&(_isEnabled(i)&&_isProductTypeSupported(n.productType)&&_isAdTypeSupported(n.ext.type))}function _fetchExtraOffersInventory(e,t,n,i,r){var a=_buildRequiredDataForExtraOffersRequest(t,n,i,r);e=window.SSA_CORE.Utils.extend(!0,{},e,a);var o=new jQuery.Deferred;return fetcherService.fetchFeed(environmentConfiguration().getConfig().schema+constants.gatewayDestinationMap.BN.production,e,constants.extraOffers.fetchTimeout).done((function(e){if(_isInvalidExtraOffersResponse(e))o.reject(e.errorCode.toString());else if(_isInventoryEligible(e))o.resolve(e);else{var t="Invalid extra offers inventory, length: "+e.seatbid.bid.length;o.reject(t)}})).fail((function(e,t){o.reject(t)})),o.promise()}function _isInvalidExtraOffersResponse(e){return!(!e||!e.hasOwnProperty("errorCode"))}function _buildRequiredDataForExtraOffersRequest(e,t,n,i){return{extraOffers:!0,currProductType:e||"",blacklistedCampaigns:t||"",currReqId:n||"",currOppId:i||""}}function _isInventoryEligible(e){return!!(e&&e.seatbid&&e.seatbid.bid&&e.seatbid.bid.length>=minimumAdsForExtraOffersInventory)}function _test(){var re=/(\(\))$/,args=[].slice.call(arguments),name=args.shift(),is_method=re.test(name),target;return name=name.replace(re,""),target=eval(name),is_method?target.apply(this,args):target}return{isSupported:_isSupported,fetchExtraOffersInventory:_fetchExtraOffersInventory,test:_test}}module.exports=ExtraOffers},{}],40:[function(e,t,n){t.exports=function(e){return{isFeatureSupportedInNativeSDK:function(t){var n=!1;return t&&e&&e.nativeFeatures&&(n=Array.isArray(e.nativeFeatures)&&e.nativeFeatures.indexOf(t)>-1),n}}}},{}],41:[function(e,t,n){t.exports=function(e,t,n,i){var r,a=t||"",o=i||6e4,s="Invalid API response",l=function(t){var i=!0;return e.each(n,(function(e){i=i&&void 0!==t[e]})),i};return{getInventory:function(e,t,n){r=new jQuery.Deferred;var i=t||a;return jQuery.ajax({url:i,data:e,type:"GET",dataType:n||"jsonp",timeout:o}).then((function(e){e&&e.errorCode&&e.errorMessage?r.reject({errorMessage:e.errorMessage,errorCode:e.errorCode}):l(e)?r.resolve(e):r.reject({errorMessage:s})}),(function(e,t,n){var i={errorMessage:"Error fetching inventory. Error data: "+t};r.reject(i)})),r.promise()},isValidResponseStructure:l}}},{}],42:[function(e,t,n){t.exports=function(e,t){var n,i="eventResult",r="resultReason",a={hit:1,miss:2};function o(o){function s(e,t){if(!e)return"";if(t)for(var n=t.length,i=0;i<n;i++)e=e.replace("{{"+t[i].key+"}}",encodeURIComponent(t[i].value));return e=e.replace(/\{\{[\w\d\s]*\}\}/g,"ok")}function l(i,r){var a,o=n[i];if("object"==typeof o){o.length>0&&(o=o[0]);var l=function(e,t){var n;return e&&e.url&&(n={url:s(e.url,t),type:e.type}),n}(o,r);l&&(a=l,t.firePixel(a),e.log("Send event: "+JSON.stringify(a),e.LogLevels.info))}}return n=o,{track:function(e){var t;if(e&&n)switch(e.trackingType){case"request":l("requestTracking",null);break;case"responseHit":l("responseTracking",[{key:i,value:a.hit}]);break;case"responseMiss":t=e.data,l("responseTracking",[{key:i,value:a.miss},{key:r,value:t}])}}}}return{init:function(e){return new o(e)}}}},{}],43:[function(e,t,n){t.exports=function(){var e=[];return{addToFilteredListCampaigns:function(t){t&&-1===e.indexOf(t)&&e.push(t)},getFilteredListCampaigns:function(){return e}}}},{}],44:[function(e,t,n){t.exports=function(e){function t(){return document.getElementById("displayedFrame")}return{getDisplayedAdFrame:t,isFrameDisplayed:function(e){var n=t();return e&&n&&e===n},getAdUnitClassObj:function(t){var n="ssaAdUnit",i={class:n+" ",selector:"."+n};return t&&t.productType?(i.class+=t.productType+" ",i.selector+="."+t.productType,t.demandSourceName&&(i.class+=t.demandSourceName+" ",i.selector+="."+t.demandSourceName),i):(e.log("In getAdUnitClass with no ad",e.LogLevels.error),i)},hideFrame:function(){var e=t();e&&e.classList.add("hidden")},displayFrame:function(){var e=t();e&&e.classList.remove("hidden")}}}},{}],45:[function(e,t,n){t.exports={NativeAPI:{updateConsentInfo:".updateConsentInfo"}}},{}],46:[function(e,t,n){t.exports=function(t,n,i){var r=e("./GDPRConstants.js"),a=!1,o=i.CB;function s(e){"string"!=typeof e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(n.getConfig().applicationSettings.consent=e)}return{init:function(){a||(t.PubSub.subscribe(o+r.NativeAPI.updateConsentInfo,(function(e){if(e&&e.gdprConsentStatus)return n.log("updateConsentInfo | controller | params: "+JSON.stringify(e),n.LogLevels.info),void s(e.gdprConsentStatus);n.log("updateConsentInfo | controller | without params or gdprConsentStatus key",n.LogLevels.info)})),a=!0)},setConsent:s,getConsent:function(){return n.getConfig().applicationSettings.consent}}}},{"./GDPRConstants.js":45}],47:[function(e,t,n){function i(e,t){var n="NativeCallback",i=!1,r=[],a={GET:"GET",POST:"POST"},o={requestUnknown:"requestUnknown",requestStarted:"requestStarted",responseReceived:"responseReceived",requestError:"requestError"};function s(){var i=["identifier","status"];e.PubSub.subscribe(n+".httpRequestStatusChanged",(function(e){t.checkRequiredCallbackParams(i,e,"httpRequestStatusChanged").didSucceed&&l(e)}))}function l(e){t.log("HTTPService - request status changed",t.LogLevels.verbose);var n=p(e.identifier);if(n)if(e.status===o.requestStarted)d(n);else if(e.status===o.responseReceived){var i={headers:e.responseParams.headers,statusCode:e.responseParams.statusCode,ranOnNative:!0};c(n,e.data?decodeURIComponent(e.data):void 0,i)}else u(n,e.errMsg)}function d(n){t.log("onRequestStarted "+n.identifier,t.LogLevels.verbose),e.Utils.isFunction(n.onRequestStarted)&&n.onRequestStarted()}function c(n,i,r){t.log("_onResponseReceived "+n.identifier,t.LogLevels.verbose),f(n),e.Utils.isFunction(n.onResponseReceived)&&n.onResponseReceived(i,r)}function u(n,i){t.log("onRequestError "+i,t.LogLevels.verbose),f(n),e.Utils.isFunction(n.onRequestError)&&n.onRequestError(i)}function f(e){if(e){var t=r.indexOf(e);t>-1&&r.splice(t,1)}}function p(e){var t=r.filter((function(t){return t.identifier===e}));return 1===t.length?t[0]:null}function g(){return+new Date+""+Math.random()}function v(e){return i&&!1!==e.allowNative}function m(t,n){return n=e.Utils.extend(n,{url:t},{identifier:g()}),e.Utils.isDefined(n.background)||(n.background=!1),n}function h(n){t.log("_sendNativeEngineRequest",t.LogLevels.verbose);var i={};e.Utils.each(n,(function(t,n){if(!e.Utils.isFunction(n)){var r={};r[t]=n,i=e.Utils.extend(i,r)}})),t.callSDKFunction("sendHttpRequest",i,"httpRequestStatusChanged","httpRequestStatusChanged")}function b(e){var n;t.log("_sendWebEngineRequest",t.LogLevels.verbose);var i=e;d(e);var r=function(t,n){var i={headers:t.getAllResponseHeaders(),statusCode:t.status,ranOnNative:!1};c(e,n,i)},a=jQuery.ajax(i);a.done((function(e,t,n){var i=n.responseText;r(n,i)})),a.fail((function(t,i,a){n=a,0===t.status?u(e,n&&""!==n?n:"unknown error"):r(t)}))}function S(e){r.push(e),v(e)?h(e):b(e)}function y(e,t){t||(t={}),t.type=a.GET,S(m(e,t))}function A(){return i}function C(){i=!0,s()}var I={GETRequest:y,getIsNativeEngineExist:A,init:C};return I}t.exports=i},{}],48:[function(e,t,n){var i=e("./containers/ContainerCreationStateHandler");t.exports=function(e,t,n,r){var a="IframeManager | ",o=e.AdUtils;function s(t,n,i,r){o.extendAdObjectWithConfig(n,t,i,r),e.getNotchService().onSetConfig(t)&&(m("Extend ad object isTransparentLayout=true"),t.settings.isTransparentLayout=!0),e.RingerSwitchService.isInitiated()&&(m("Extend ad object ringerMuteOnStart=true"),t.settings.ringerMuteOnStart=!0)}function l(e){return document.querySelector('[data-ad-view-id="'+e.adViewId+'"]')}function d(e,i,r,a){m("createAndLoadAdFrame"),s(e,i,r,a),function(e){var n=e.productType===t.OW?o.getAdId(e):o.generateUniqueAdId(e);e.adViewId=n}(e),l(e)||function(e,t){var i=e.adViewId;m("loading ad to frame: "+i+" "+e.productType);var r=n.getAdUnitClassObj(e).class;t&&(r+="hidden ");var a=document.createElement("iframe");a.setAttribute("src",e.url),r.trim().split(/\s+/).forEach((function(e){a.classList.add(e)})),a.dataset.adViewId=i,a.dataset.close="true",document.body.append(a)}(e,a.preload)}function c(e){var t=!!l(e);return m("isContainerLoaded: "+t),t}function u(){var e=document.querySelector(".loaderOW");e.classList.add("loaderOWFadeOut"),setTimeout((function(){m("hideLoader - enter timeOut"),document.querySelector(".loaderOW").classList.add("hidden"),e.offsetWidth=e.offsetWidth}),600),document.getElementById("ssaLoaderWrap").classList.add("hidden")}function f(e,t,n,i){u(),n(!1),r.set(t),e.classList.remove("hidden"),e.setAttribute("id","displayedFrame"),i()}function p(t,n,i,r){"true"!==t.dataset.loaded?(i(!0),e.log(a+"display with loader, frame "+t.id),n&&n.productType&&(g(n.productType),t.setAttribute("id","displayedFrame"))):f(t,n,i,r)}function g(e,n){e===t.OW?document.querySelector(".loaderOW").classList.remove("loaderOWFadeOut","hidden"):document.getElementById("ssaLoaderWrap").classList.remove("hidden")}function v(e,t,n){t&&(n=n||parent).postMessage(e,t.replace(/([^:]+:\/\/[^\/]+).*/,"$1"))}function m(t){e.log(a+t)}return{createAndLoadAdFrame:d,updateAdUnitUrl:function(t,n,i,r){var o;s(t,n,i,r),(o=l(t))?(m("updated iframe url for product "+i.productType),o.src=t.url):r.forceCreation?(m("cannot find iframe to update, creating new one"),d(t,n,i,r)):e.log(a+"cannot find iframe to update url")},displayAdView:function(e,t,n,i){var a=l(e);"true"===a.dataset.loaded?(m("display frame"),window.jQuery.when(i(e,!1)).done((function(){f(a,e,t,n)})).fail((function(t){e.showAdCallbacks&&e.showAdCallbacks.onShowFailed(t)}))):(m("display frame with loader"),r.set(e),window.jQuery.when(i(e,true)).done((function(){p(a,e,t,n)})).fail((function(t){e.showAdCallbacks&&e.showAdCallbacks.onShowFailed(t)})))},handleScreenVisible:function(e,t){e&&g(t.productType);var i=n.getDisplayedAdFrame();i&&(m("ad unit open error"),i.classList.add("hidden"),i.removeAttribute("id"))},unloadAdView:function(e){var n=e.adViewId;m("unloading ad from frame | id:"+n+" pt: "+e.productType);var i=document.querySelector('[data-ad-view-id="'+n+'"]');i&&(e.engaged&&i.removeAttribute("id"),e.productType===t.OW?setTimeout((function(){i&&i.parentNode&&i.parentNode.removeChild(i)}),0):i&&i.parentNode&&i.parentNode.removeChild(i))},displayLoader:g,hideLoader:u,hideView:n.hideFrame,displayView:n.displayFrame,isContainerLoaded:c,onAdUnitLoaded:function(t,i,r){var a=l(t);if(a)if("true"!==a.dataset.loaded){a.dataset.loaded="true";var o=n.isFrameDisplayed(a);m("ad loaded: "+e.AdUtils.getAdId(t)+" | "+o?"frame Displayed: true":"frame Displayed: false|"+n.getAdUnitClassObj(t).selector),o&&f(a,t,i,r)}else m("already received the loaded event for frame")},getAdViewByAd:l,sendMessageToDisplayedAdView:function(e){var t=n.getDisplayedAdFrame();t&&v(JSON.stringify(e),"*",t.contentWindow)},sendMessageToAllAdViews:function(e){document.querySelectorAll(".ssaAdUnit").forEach((function(t){v(JSON.stringify(e),"*",t.contentWindow)}))},getDisplayedAdView:n.getDisplayedAdFrame,isViewDisplayed:n.isFrameDisplayed,getContainerID:function(){return"1"},getContainerCreationHandler:function(t){m("_getContainerCreationHandler: ");var n=new i(e.log),r=n.getCreationStates(),a=c(t)?r.createdSuccessfully:r.notCreated;return n.setState(a),n}}}},{"./containers/ContainerCreationStateHandler":97}],49:[function(e,t,n){t.exports=function(e){var t=[];function n(e){return function(t){return t&&t.productType===e}}function i(e){return function(t){return t.demandSourceName===l(e)&&t.productType===e.productType}}function r(e){var n=0,r=t.filter(i(e));return r.length>0&&(n=r[0].counter),n}function a(e){for(var t=0,n=0;n<e.length;n++){t+=e[n].counter}return t}function o(e){return a(t.filter(n(e)))}function s(e){return a(t.filter(n(e)).filter((function(e){return e&&function(e){return!0===e.isBiddingInstance}(e)})))}function l(e){return e.originalDemandSourceName||e.demandSourceName}function d(e){var n,r=t.filter(i(e));return n=r.length>0?r[0]:function(e){var n={demandSourceName:l(e),productType:e.productType,isBiddingInstance:e.isInAppBidding,counter:0};return t.push(n),n}(e),n}return{getTotalImpressionsByProduct:o,getTokenCounters:function(){return{biddingRVImpressions:s(e.RV),biddingISImpressions:s(e.IS),totalRVSessionImpressions:o(e.RV),totalISSessionImpressions:o(e.IS)}},getPayloadCounters:function(t){return{instanceImpressions:r(t),totalRVSessionImpressions:o(e.RV),totalISSessionImpressions:o(e.IS)}},increaseImpressionsCounterByInstanceParams:function(e){var t=d(e);t&&t.counter++}}}},{}],50:[function(e,t,n){function i(e){var t=e,n=[],i=-1;function r(){return n.length}function a(){return n}function o(e){Array.isArray(e)&&(i=0,n=e)}function s(){return n[i]}function l(e){var t,a=u(e);return a>-1&&(t=n.splice(a,1)[0])&&(p()?i=-1:i<a?i=(i+1)%r():i>a&&i--),t}function d(e){var t=u(e);if(t>-1)return n[t]}function c(e,t){var i=u(t);if(i>-1)return n[i]=e,n[i]}function u(e){if(void 0===e)return-1;for(var t=0,i=r(),a=e.toString();t<i&&e;t++)if(n[t].id===a)return t;return-1}function f(){return!p()&&(i+1)%r()!==i}function p(){return 0===r()}function g(){n=[],i=-1}var v={getOffers:a,getCurrentOffer:s,getOfferById:d,setOffers:o,removeOfferById:l,replaceOfferById:c,isNextOfferAvailable:f,isEmpty:p,size:r,reset:g};return v}t.exports=i},{}],51:[function(e,t,n){t.exports=function(e,t){function n(e,t,n){e&&e.removeEventListener(t,n)}return{unbind:n,bind:function(e,t,i){e&&(n(e,t,i),e.addEventListener(t,i))},scrollTop:function(e,n){if(void 0===n)return e.pageYOffset;e===t||9===e.nodeType?e.scrollTo(e.scrollX,n):e.pageYOffset=n},fadeIn:function(e,t){if(e)var n=0,i=setInterval((function(){n<.99?(n+=.11,e.style.opacity=n):(clearInterval(i),e.style.opacity=100)}),t/10)},fadeOut:function(e,t,n){if(e)var i=1,r=setInterval((function(){i>.0101?(i-=.11,e.style.opacity=i):(clearInterval(r),e.style.opacity=0,"function"==typeof n&&n())}),t/10)}}}},{}],52:[function(e,t,n){t.exports=function(e,t){var n,i;function r(e){return i&&e===t.IS}return{setLastDisplayedAdCampaignId:function(e,t,a){i=a&&a.sendLastCampaignId,r(t)&&(n=e)},getLastDisplayedAdCampaignId:function(){return n},shouldAddLastDisplayedAdCampaignIdToPayload:r}}},{}],53:[function(e,t,n){function i(e){var t,n,i,r,a,o,s="acknowledgeMessage",l={none:0,error:1,info:2,verbose:3},d={0:"NONE",1:"ERROR",2:"INFO",3:"VERBOSE"};function c(t,n){var r=e.isDefined(t)?t:"Controller",a=e.isDefined(n)?d[n]:d[i];return i?"SupersonicAds "+r+" ["+a+"] :":""}function u(l,d,u){var f,p;(window.productionDebug&&o&&o({url:"http://iron-debug-controller.com?log="+l,type:"pixel"}),d&&d>i)||(e.isString(l)||(l=JSON.stringify(l)),e.isFunction(n)&&("android"===t||e.isWebWrapper())?n.call(a,c(u,d)+l):"android"!==t&&(f=c(u,d)+l,(p={eventName:"log",prefix:"logmessage"}).parameters={message:f,acknowledgeWith:s,declineWith:"errorTest"},r&&r.postMessage(p)))}return{init:function(e,s,d,c){a=window.console||{},t=e,i=d,r=s,o=c,d?(n=a.log,a.log=function(e){u(e,l.verbose)}):a.log=function(){}},log:u,debugMsg:c,LogLevels:l,DebugLevels:d}}var r;t.exports=function(e){return r||(r=new i(e)),r}},{}],54:[function(e,t,n){function i(){var e,t={init:function(e,t,n){return this.receiveMessage((function(n){t.call(e,n)}),n),this},postMessage:function(e,t,n){t&&(n=n||parent).postMessage(e,t.replace(/([^:]+:\/\/[^\/]+).*/,"$1"))},receiveMessage:function(t,n){t&&(e=function(e){"string"==typeof n&&e.origin!==n||"[object Function]"===Object.prototype.toString.call(n)&&!1===n(e.origin)||("function"!=typeof n||n(e.data))&&t(e)}),window.addEventListener?window[t?"addEventListener":"removeEventListener"]("message",e,!1):window[t?"attachEvent":"detachEvent"]("onmessage",e)}};return t}t.exports=i},{}],55:[function(e,t,n){function i(){var t=e("./Inventory.js"),n={},i=[],r,a;function o(){a=4}function s(){if(I())return Math.max(1,r-1)}function l(){if(0!==Object.keys(n).length)return n[s()]}function d(e){return I()&&D()?e?n[e].size():n[s()].size():0}function c(e){return I()&&D()?e?n[e].getOffers():n[s()].getOffers():[]}function u(){Array.isArray(i)&&i.length>a&&delete n[i.shift()]}function f(e,t){if(Array.isArray(e)&&0!==e.length){var i=void 0!==t?t:C();void 0===n[i]&&(i=C());for(var r=0;r<e.length;r++)e[r].inventoryId=i;return n[i].setOffers(e),i}}function p(e){if(I()&&D())return e?n[e].getCurrentOffer():n[s()].getCurrentOffer()}function g(e,t){if(I()&&D())return t?n[t].removeOfferById(e):n[s()].removeOfferById(e)}function v(e,t){if(I()&&D())return t?n[t].getOfferById(e):n[s()].getOfferById(e)}function m(e,t,i){if(I()&&D())return i?n[i].replaceOfferById(e,t):n[s()].replaceOfferById(e,t)}function h(e){return!(!I()||!D())&&(e?n[e].isNextOfferAvailable():n[s()].isNextOfferAvailable())}function b(e){return!I()||!D()||(e?n[e].isEmpty():n[s()].isEmpty())}function S(){i=[],n={},r=void 0}function y(e){var t=void 0!==e?e:s();t&&n[t]&&delete n[t]}function A(){return n}function C(){return n[r=r||1]=new t(r),i.push(r),r++,u(),r-1}function I(){return 0!==i.length&&void 0!==r}function D(){return void 0!==n[s()]}function w(){return a}function P(){return r}o();var O={getOffers:c,getCurrentOffer:p,getOfferById:v,setOffers:f,removeOfferById:g,replaceOfferById:m,isNextOfferAvailable:h,isEmpty:b,size:d,reset:S,getActiveInventoryId:s,getActiveInventory:l,removeInventory:y,getInventories:A,getAmountOfInventoriesAllowed:w,getAvailableInventoryId:P};return O}t.exports=i},{"./Inventory.js":50}],56:[function(e,t,n){t.exports=function(e,t,n){var i={successCallbackPrefix:"scallback_",failureCallbackPrefix:"fcallback_",ssaSchemePrefix:"supersonicads",acknowledgeMessage:"acknowledgeMessage",CB:"NativeCallback"};function r(r,a,o,s){if(t.Utils.isString(r)&&""!==r&&e){e.DemandUtils&&e.RewardedVideo&&a&&(a=e.DemandUtils.setManualRewardedVideoTypeForNative(a));var l=t.Utils.isDefined(o)&&t.Utils.isString(o)?o:"",d=t.Utils.isDefined(s)&&t.Utils.isString(s)?s:"";!function(e,r,a){e.prefix=i.ssaSchemePrefix,t.Utils.isDefined(e.parameters)||(e.parameters={});e.parameters=t.Utils.extend(e.parameters,{acknowledgeWith:t.Utils.isDefined(r)?r:i.acknowledgeMessage,declineWith:t.Utils.isDefined(a)?a:"errorTest"}),n.postMessage(e)}({eventName:r,parameters:t.Utils.extend({success:l,fail:d},a)})}}function a(){return Date.now()+""+Math.random()}return{callSDKFunction:r,callSDKService:function(e,t,n,i,a){n&&(n.functionName=t),r(e,n,i,a)},callSDKFunctionWithCallback:function(n,o,s,l){if(e.log("NativeAPIAdapter | _callSDKFunctionWithCallback | Native API: "+n),t.Utils.isFunction(s)||t.Utils.isFunction(l)){var d=i.successCallbackPrefix+a(),c=i.failureCallbackPrefix+a(),u=t.PubSub.subscribe(i.CB+"."+d,(function(e){t.PubSub.unsubscribe(u),t.PubSub.unsubscribe(f),s(e)})),f=t.PubSub.subscribe(i.CB+"."+c,(function(i){e.log("NativeAPIAdapter | callSDKFunctionWithCallback | received failure callback for function: "+c),i&&i.errMsg&&e.log("Error calling "+n,e.LogLevels.error),t.PubSub.unsubscribe(f),t.PubSub.unsubscribe(u),l(i)}));r(n,o,d,c)}else e.log("NativeAPIAdapter | failed to call sdk function - no callbacks parameters")},acknowledgeMessage:function(e){n.acknowledgeMessage(e)}}}},{}],57:[function(e,t,n){t.exports={CB:"NativeCallback",serviceCallback:"serviceCallback",NativeAPI:{onNativeLifeCycleEvent:"onNativeLifeCycleEvent"},AndroidEvents:{onStart:"onStart",onResume:"onResume",onPause:"onPause",onStop:"onStop",onDestroy:"onDestroy"}}},{}],58:[function(e,t,n){t.exports=function(t,n,i){var r="LifeCycleEventsService | ",a=e("./NativeLifeCycleEventsConstants.js"),o=[],s=new(e("./AndroidLifeCycleEventHandlers.js"))(t,n);function l(){t.PubSub.subscribe(a.CB+"."+a.NativeAPI.onNativeLifeCycleEvent,(function(e){n.log(r+"received new event: "+JSON.stringify(e)),e&&function(e,t){if(!d(e))return;s.publishEvent(e,t)}(e.lifeCycleEvent,e)}))}function d(e){return e&&o.indexOf(e)>-1}return{init:function(){l()},startNotify:function(e){n.log(r+"startNotify | event: "+e),d(e)||o.push(e)},stopNotify:function(e){n.log(r+"stopNotify | event: "+e),d(e)&&o.splice(o.indexOf(e),1)}}}},{"./AndroidLifeCycleEventHandlers.js":24,"./NativeLifeCycleEventsConstants.js":57}],59:[function(e,t,n){t.exports=function(t){return{create:function(n){var i=n.deviceOs;return i===t.deviceOs.ios&&null===n.safeAreaInsets?new(e("../patches/PatchesIphoneX.js"))(n,t):new(e("./NotchService.js"))(n.safeAreaInsets,t,i)}}}},{"../patches/PatchesIphoneX.js":207,"./NotchService.js":60}],60:[function(e,t,n){t.exports=function(e,t,n){var i=!1;function r(){return n!==t.deviceOs.android&&i}return function(){if(n===t.deviceOs.android)return;var r=t.notchSettings.safeAreaInsetsMin;i=e.top>r||e.bottom>r||e.right>r||e.left>r}(),{hasNotch:r,onEngageEnd:function(){n!==t.deviceOs.android&&r()&&0},onSetConfig:function(e){return n!==t.deviceOs.android&&(r()&&function(e){return e.settings&&e.settings.standaloneView}(e))},className:"NotchService"}}},{}],61:[function(e,t,n){t.exports={omidControllerFunction:"omidAPIController",omidNativeFunction:"omidAPI",activateSuccessKey:"omidActivateSuccess",activateFailKey:"omidActivateFail",startSessionSuccessKey:"omidStartSessionSuccess",startSessionFailKey:"omidStartSessionFail",finishSessionSuccessKey:"omidFinishSessionSuccess",finishSessionFailKey:"omidFinishSessionFail",impressionOccurredSuccessKey:"omidimpressionOccurredSuccess",impressionOccurredFailKey:"omidimpressionOccurredFail",getOmidDataSuccessKey:"omidGetDataSuccess",getOmidDataFailKey:"omidGetDataFail",startSession:"startSession",finishSession:"finishSession",impressionOccurred:"impressionOccurred",omidFailedToLoadBundleMessage:"Failed to load OMID JS Bundle",omidFailedToDownloadMessage:"Failed to download and cache OMID JS Bundle",omidFailureInStartSession:"Failure in starting session",omidFailureInFinishSession:"Failure in finishing session",omidFailureInImpressionOccurred:"Failure in impression occurred",omidAdIdNotFound:" omidParams no contain adViewId. ",omidPromiseIsPending:"promise is still pending",omidStartSessionAlreadyStarted:"omid ad session is already started",omidFinishSessionAlreadyCalled:"finish session already called",omidSessionNotStarted:"session not started",omidProductTypeNotSupported:" omidParams container unsupported product type = ",omidproductTypeNotFound:" omidParams no contain product type. ",omidBundleFilePrefix:"omid-daemon-",omidBundleFileType:".js",stopOMIDServiceDelay:1e3,omidPartnerName:"Ironsrc",omidPartnerVersion:"6",omidServiceName:"omid",omidBundleDefaultVersionKey:"default",omidVersionMapping:{"1.2.22-Ironsrc":"1.0.0","1.3.12-Ironsrc":"1.3.12","1.4.0-Ironsrc":"1.4.0","1.4.2-Ironsrc":"1.4.2",default:"1.0.0"},omidVersionRequiresWebviewPerAd:{"1.2.22-Ironsrc":!1,"1.3.12-Ironsrc":!0,"1.4.0-Ironsrc":!0,"1.4.2-Ironsrc":!0,default:!1},omidVersionIsControllerDownloadOMSDK:{"1.2.22-Ironsrc":!0,"1.3.12-Ironsrc":!1,"1.4.0-Ironsrc":!1,"1.4.2-Ironsrc":!1,default:!1}}},{}],62:[function(e,t,n){e("./OMIDConstants");t.exports=function(t,n){var i,r=e("./OmidHelper"),a=e("./OmidAdSession"),o=new r(t,n),s=e("./Constants.js"),l=e("./OMIDConstants"),d=!1,c="",u=s.omidPartnerVersion,f="",p=null,g=null,v=null,m={};function h(){if(!d){if(g&&"pending"===g.state())return g;g=new window.jQuery.Deferred,n.log("OMIDService - activate",n.LogLevels.verbose);var e=t.PubSub.subscribe(s.CB+"."+l.activateSuccessKey,(function(p){c=p&&p.omidVersion?p.omidVersion:"",u=p&&p.omidPartnerVersion?p.omidPartnerVersion:s.omidPartnerVersion,d=!0,t.PubSub.clearHandlers([e,r]),t.PubSub.subscribe("SDKController.OMIDStartSession",(function(e){!o.isSupportingMultipleAdSession()&&e.adViewId&&(e.webViewid=e.adViewId),function(e){o.fireNonFailureEvent("SDKController.onOmidStartSessionRequired",e,c);var i=new window.jQuery.Deferred,r=o.isActivated(A(),d,l.startSession,c);if(!r.result)return t.PubSub.publish("SDKController.onOmidServiceFailure",[r.reason]),i.reject(r.reason);var s=o.validateStartSessionParams(e,c);if(!s.result)return t.PubSub.publish("SDKController.onOmidServiceFailure",[s.reason]),i.reject(s.reason);var u=o.validateAdViewId(e,l.impressionOccurred,c);if(!u.result)return t.PubSub.publish("SDKController.onOmidServiceFailure",[u.reason]),i.reject(u.reason),i;var f=e&&e.adViewId,p=m[f],g="";p&&"pending"===p.getStartPromise().state()?(g=o.getErrorMsgPromiseIsPending(l.startSession,c,e),t.PubSub.publish("SDKController.onOmidServiceFailure",[g]),p.getStartPromise()):p&&p.isSessionStarted()?(g=o.getErrorStartSessionAlreadyStarted(l.startSession,c,e),t.PubSub.publish("SDKController.onOmidServiceFailure",[g]),t.Utils.returnRejectedPromise(g)):function(e,t,i,r){n.log("OMIDService - startSession",n.LogLevels.verbose);var s=new a(t,e);!o.isSupportingMultipleAdSession()&&r.webViewid&&(s.setWebViewId(r.webViewid),r.adViewId=s.webViewId),m[e]=s,s.setStartPromise(i),n.callSDKFunction(l.omidNativeFunction,{omidFunction:l.startSession,omidParams:r},l.startSessionSuccessKey,l.startSessionFailKey),s.getStartPromise()}(f,e.productType,i,e)}(e=o.setAdViewIdForOldOmidVersions(e,c))})),t.PubSub.subscribe("SDKController.OMIDImpressionOccurred",(function(e){!function(e){var i=new window.jQuery.Deferred,r=o.isActivated(A(),d,l.impressionOccurred,c);if(!r.result)return i.reject(r.reason),i;var a=S(e,l.impressionOccurred,c);if(!a.adSession)return t.PubSub.publish("SDKController.onOmidServiceFailure",[a.reason]),i.reject(a.reason),i;var s=a.adSession;if(s.getImpressionPromise()&&"pending"===s.getImpressionPromise().state()){var u=o.getErrorMsgPromiseIsPending(l.impressionOccurred,c,e);return t.PubSub.publish("SDKController.onOmidServiceFailure",[u]),s.getImpressionPromise()}s.setImpressionPromise(i),n.callSDKFunction(l.omidNativeFunction,{omidFunction:l.impressionOccurred,omidParams:e},l.impressionOccurredSuccessKey,l.impressionOccurredFailKey),s.getImpressionPromise()}(e=o.setAdViewIdForOldOmidVersions(e,c))})),t.PubSub.subscribe("SDKController.OMIDFinishSession",(function(e){b(e=o.setAdViewIdForOldOmidVersions(e,c))})),v=c,h=C(v),f=i.getExternalLibrariesUrl()+l.omidServiceName+"/"+h+"/"+l.omidServiceName+l.omidBundleFileType,n.log(l.omidNativeFunction+" activate success: "+JSON.stringify(p),n.LogLevels.verbose),g.resolve();var v,h})),r=t.PubSub.subscribe(s.CB+"."+l.activateFailKey,(function(i){t.PubSub.clearHandlers([e,r]);var a=i&&i.errMsg?i.errMsg:"";n.log(l.omidNativeFunction+" activate session fail: "+JSON.stringify(i),n.LogLevels.verbose),t.PubSub.publish("SDKController.onOmidServiceFailure",[a]),g.reject()}));return n.callSDKFunction(l.omidNativeFunction,{omidFunction:"activate",omidParams:{}},l.activateSuccessKey,l.activateFailKey),g.promise()}n.log("OMIDService - activate OMID is already initialized",n.LogLevels.verbose)}function b(e){o.fireNonFailureEvent("SDKController.onOmidFinishSessionRequired",e,c),n.log("OMIDService - finishSession",n.LogLevels.verbose);var i=new window.jQuery.Deferred,r=o.isActivated(A(),d,l.finishSession,c);if(!r.result)return i.reject(r.reason),i;var a=S(e,l.finishSession,c);if(!a.adSession)return t.PubSub.publish("SDKController.onOmidServiceFailure",[a.reason]),i.reject(a.reason),i;var s=a.adSession;if(!s.isSessionStarted()){var u=o.getErrorMsgSessionNotStarted(l.finishSession,c,e);return t.PubSub.publish("SDKController.onOmidServiceFailure",[u]),i.reject(u),i}return s.getFinishPromise()&&"pending"===s.getFinishPromise().state()?(n.log("OMIDService.tryFinishSession - "+l.omidFinishSessionAlreadyCalled,n.LogLevels.verbose),s.getFinishPromise()):(s.setFinishPromise(i),n.callSDKFunction(l.omidNativeFunction,{omidFunction:l.finishSession,omidParams:e},l.finishSessionSuccessKey,l.finishSessionFailKey),s.getFinishPromise())}function S(e,t,n){var i=o.validateAdViewId(e,l.impressionOccurred,n);if(!i.result)return{reason:i.reason};var r=e.adViewId,a=m[r];return a?{adSession:a,reason:null}:{reason:"adSession not found for adViewId = "+r}}function y(){return l.omidVersionIsControllerDownloadOMSDK[c]?l.omidVersionIsControllerDownloadOMSDK[c]:l.omidVersionIsControllerDownloadOMSDK[l.omidBundleDefaultVersionKey]}function A(){return!y()||window.OmidDaemon&&"function"==typeof window.OmidDaemon.start&&"function"==typeof window.OmidDaemon.stop}function C(e){var t=l.omidVersionMapping[e];return t||(t=l.omidVersionMapping[l.omidBundleDefaultVersionKey],n.log("OMID.Service.Warnnig: version from mapping not found .choose.default - "+t)),t}function I(){return d?f:""}function D(){t.PubSub.subscribe(s.CB+"."+l.startSessionSuccessKey,(function(e){!function(e){if(m[e.adViewId]){var t=m[e.adViewId];t.getStartPromise().resolve(),n.log(l.omidNativeFunction+" Start session success | adViewId = "+t.adViewId,n.LogLevels.verbose),o.fireNonFailureEvent("SDKController.onOmidStartSessionSuccess",t.getDescription(),c)}else n.log("Error: missing adViewId in start session success callback")}(e=o.setAdViewIdForOldOmidVersions(e,c))})),t.PubSub.subscribe(s.CB+"."+l.startSessionFailKey,(function(e){!function(e){if(e.adViewId||(e.adViewId="1"),m[e.adViewId]){var i=e&&e.errMsg?e.errMsg:"";m[e.adViewId].getStartPromise().reject(i),O(),n.log(l.omidNativeFunction+" Start session fail: "+JSON.stringify(e),n.LogLevels.verbose),t.PubSub.publish("SDKController.onOmidServiceFailure",[i])}else n.log("Error: missing adViewId in start session success callback")}(e=o.setAdViewIdForOldOmidVersions(e,c))})),t.PubSub.subscribe(s.CB+"."+l.impressionOccurredSuccessKey,(function(e){!function(e){n.log(l.omidNativeFunction+" Impression Occurred success: "+JSON.stringify(e),n.LogLevels.verbose),e.adViewId||(e.adViewId="1"),m[e.adViewId]?m[e.adViewId].getImpressionPromise().resolve():n.log("Error: missing adViewId in impression Occurred success session callback")}(e=o.setAdViewIdForOldOmidVersions(e,c))})),t.PubSub.subscribe(s.CB+"."+l.impressionOccurredFailKey,(function(e){!function(e){n.log(l.omidNativeFunction+" Impression Occurred fail: "+JSON.stringify(e),n.LogLevels.verbose);var i=e&&e.errMsg?e.errMsg:"";t.PubSub.publish("SDKController.onOmidServiceFailure",[i]),e.adViewId||(e.adViewId="1"),m[e.adViewId]?m[e.adViewId].getImpressionPromise().reject():n.log("Error: missing adViewId in impression Occurred fail session callback")}(e=o.setAdViewIdForOldOmidVersions(e,c))})),t.PubSub.subscribe(s.CB+"."+l.finishSessionSuccessKey,(function(e){!function(e){if(n.log(l.omidNativeFunction+" Finish session success: "+JSON.stringify(e),n.LogLevels.verbose),e.adViewId||(e.adViewId="1"),m[e.adViewId]){var t=m[e.adViewId];t.getFinishPromise().resolve(),o.fireNonFailureEvent("SDKController.onOmidFinishSessionSuccess",t.getDescription(),c),delete m[t.adViewId]}else n.log("Error: missing adViewId in finish session success callback")}(e=o.setAdViewIdForOldOmidVersions(e,c))})),t.PubSub.subscribe(s.CB+"."+l.finishSessionFailKey,(function(e){!function(e){if(n.log(l.omidNativeFunction+" Finish session fail: "+JSON.stringify(e),n.LogLevels.verbose),e.adViewId||(e.adViewId="1"),m[e.adViewId]){var i=m[e.adViewId];O();var r=e&&e.errMsg?e.errMsg:"";t.PubSub.publish("SDKController.onOmidServiceFailure",[r]),i.getFinishPromise().reject(r),delete m[i.adViewId]}else n.log("Error: missing adViewId in finish session success callback")}(e=o.setAdViewIdForOldOmidVersions(e,c))}))}function w(){n.log("SDKController.onLoadSuccessOmidBundle"),window.OmidDaemon&&window.OmidDaemon.start({partnerName:l.omidPartnerName,partnerVersion:u})}function P(){n.log("SDKController.onLoadFailureOmidBundle"),t.PubSub.publish("SDKController.onOmidServiceFailure",[l.omidFailedToLoadBundleMessage])}function O(){window.OmidDaemon&&window.OmidDaemon.reset()}return{isSupported:function(e,t){return function(e){return e&&e.omidEnabled}(e)},isNativeServiceActivated:function(){return d},getVersionData:function(){return{omidVersion:c,omidPartnerVersion:u}},finishSession:function(e){e=o.setAdViewIdForOldOmidVersions(e,c);var t=window.jQuery.Deferred();return m[e.adViewId]?b(e).then((function(){t.resolve(!0)})).fail(t.reject):t.resolve(!1),t.promise()},isAdOmidSupported:function(e,t){return!!function(e){return e&&e.ext&&e.ext.ivt&&e.ext.ivt.omid}(e)&&o.isProductSupported(e.productType||t)},downloadOmidJsBundle:function(){if(!d)return t.Utils.returnResolvedPromise();if(y()&&A())return t.Utils.returnResolvedPromise();if(p&&"rejected"!==p.state())return p;p=new window.jQuery.Deferred;var e=I();return n.libsManager.updateFileVersionByFilePathForThirdPartyLibraries(l.omidServiceName,e,C(c)).then(n.libsManager.manageDownloadLibsFileByFiletype.bind(null,l.omidServiceName)).then((function(){!function(){var e=i.getCacheLibsPath()+l.omidServiceName+l.omidBundleFileType,n=y();if(A()||!u||!n)return t.Utils.returnResolvedPromise();t.Utils.getScript(e,w,P)}(),p.resolve()}),(function(){t.PubSub.publish("SDKController.onOmidServiceFailure",[l.omidFailedToDownloadMessage]),p.reject()})),t.Utils.returnResolvedPromise()},init:function(e){i=e,D(),h()},getOmidBundleUrl:I,getOmidData:function(){if(v=new window.jQuery.Deferred,!d)return n.log("cannot get omid data beacuse omid service not activated"),v.reject(),v;var e=t.PubSub.subscribe(s.CB+"."+l.getOmidDataSuccessKey,(function(n){t.PubSub.clearHandlers([e,i]),v.resolve(n)})),i=t.PubSub.subscribe(s.CB+"."+l.getOmidDataFailKey,(function(r){n.log("_onGetOmidDataFail: "+JSON.stringify(r),n.LogLevels.verbose),t.PubSub.clearHandlers([e,i]),v.reject()}));return n.callSDKFunction(l.omidNativeFunction,{omidFunction:"getOmidData",omidParams:{}},l.getOmidDataSuccessKey,l.getOmidDataFailKey),v.promise()}}}},{"./Constants.js":33,"./OMIDConstants":61,"./OmidAdSession":64,"./OmidHelper":65}],63:[function(e,t,n){t.exports=function(e){var t,n={iframe:"#adSandbox",url:"",adData:"",templateClass:"obfuscationIframe",src:"{{url}}",frameBorder:"0",scrolling:"no",style:{},id:""},i={};return{init:function(r,a){if((i=e.extend(n,r)).adData&&""!==i.adData){var o=i.src.replace("{{url}}",i.url);for(var s in(t=document.createElement("iframe")).setAttribute("src",o),t.setAttribute("id",i.id),t.setAttribute("class",i.templateClass),t.setAttribute("scrolling",i.scrolling),t.setAttribute("frameborder",i.frameBorder),i.style)i.style.hasOwnProperty(s)&&(t.style[s]=i.style[s]);t.onload=function(){a(t)},document.documentElement.appendChild(t)}},removeIframe:function(e){if(e){var t=document.getElementById(e);t&&t.parentNode.removeChild(t)}}}}},{}],64:[function(e,t,n){t.exports=class{constructor(e="",t="1"){this.productType=e,this.adViewId=t,this.startPromise=null,this.finishPromise=null,this.impressionPromise=null,this.webViewId=""}setWebViewId(e){this.webViewId=e}setStartPromise(e){this.startPromise=e}setImpressionPromise(e){this.impressionPromise=e}setFinishPromise(e){this.finishPromise=e}getImpressionPromise(){return this.impressionPromise}getFinishPromise(){return this.finishPromise}isSessionStarted(){return this.startPromise&&"resolved"===this.startPromise.state()}isSessionFinished(){return this.finishPromise&&"resolved"===this.finishPromise.state()}getStartPromise(){return this.startPromise}getDescription(){return{productType:this.productType,adViewId:this.adViewId}}}},{}],65:[function(e,t,n){const i=e("./Constants.js"),r=e("./OMIDConstants"),a=e("../constants/SDKFeatureNames");t.exports=class{constructor(e,t){this.core=e,this.controller=t}validateStartSessionParams(e,t){let n="",i={result:!0};return e.adType||(n=r.omidControllerFunction+" | "+r.omidFailureInStartSession+" | "+r.omidproductTypeNotFound+" | omidVersion= "+t,i={result:!1,reason:n}),this.isProductSupported(e.adType)||(n=r.omidControllerFunction+" | "+r.omidFailureInStartSession+" | "+r.omidProductTypeNotSupported+e.adType+" | omidVersion= "+t,i={result:!1,reason:n}),i}setAdViewIdForOldOmidVersions(e,t){return this.isSupportingMultipleAdSession()||((e=e||{}).adViewId="1"),e}isSupportingMultipleAdSession(){return this.controller.CompatibilityService.isFeatureSupportedInNativeSDK(a.bannersOpenMeasurement)}validateAdViewId(e,t,n){let i={result:!0};if(!e||!e.adViewId){const e=this.getFlowMsg(t);i={result:!1,reason:r.omidControllerFunction+" | "+e+" | "+r.omidAdIdNotFound+" | omidVersion= "+n}}return i}getFlowMsg(e){const t={[r.startSession]:r.omidFailureInStartSession,[r.finishSession]:r.omidFailureInFinishSession,[r.impressionOccurred]:r.omidFailureInImpressionOccurred,default:"unknown flow: "};return t[e]||t.default+e}getErrorStartSessionAlreadyStarted(e,t,n){return r.omidControllerFunction+" | "+this.getFlowMsg(e)+" | "+r.omidStartSessionAlreadyStarted+" | omidVersion= "+t+" | productType= "+n.productType||""}getErrorMsgPromiseIsPending(e,t,n){return r.omidControllerFunction+" | "+this.getFlowMsg(e)+" | "+r.omidPromiseIsPending+" | omidVersion= "+t+" | productType= "+n.productType||""}getErrorMsgSessionNotStarted(e,t,n){return r.omidControllerFunction+" | "+this.getFlowMsg(e)+" | "+r.omidSessionNotStarted+" | omidVersion= "+t+" | productType= "+n.productType||""}isActivated(e,t,n,i){let a={result:!0};if(!e||!t){a={result:!1,reason:r.omidControllerFunction+" | "+this.getFlowMsg(n)+" |  didLoadOMSDKService "+e+" omidServiceActivated "+t+" | omidVersion= "+i}}return a}fireNonFailureEvent(e,t,n){const i="adViewId= "+(r.omidVersionRequiresWebviewPerAd[n]?"1":t.adViewId||"")+" | productType= "+(t.productType||"");this.core.PubSub.publish(e,[i])}isProductSupported(e){return!!e&&(e!==i.BN||this.controller.CompatibilityService.isFeatureSupportedInNativeSDK(a.bannersOpenMeasurement))}}},{"../constants/SDKFeatureNames":118,"./Constants.js":33,"./OMIDConstants":61}],66:[function(e,t,n){t.exports=function(t,n){var i=new(e("../modules/StoreConfig"));return{open:function(e){if(e&&e.type&&"openUrl"===e.type){var r,a=e.callback;e.method=function(e){return e.method?e.method:t.isIOS()?e.appId?n.openUrlMethods.storeKit:n.openUrlMethods.external_browser:i.isGoogleStoreUrl(e.url)||i.isAlternativeAndroidStoreUrl(e.url)?n.openUrlMethods.external_browser:n.openUrlMethods.store}(e);var o=function(e){var i={default:{}};return i[n.openUrlMethods.storeKit]={appId:e.appId,viewUniqueId:t.StoreKitService.getViewUniqueId(e)},i[n.openUrlMethods.external_browser]={},i[n.openUrlMethods.store]={},i[n.openUrlMethods.webview]={controls:!0},i[e.method]||i.default}(e);return r=window.SSA_CORE.Utils.extend({url:e.url,method:e.method,package_name:e.package_name},o),t.openUrl(r,a),!0}return!1},openForOW:function(e){if(e&&e.type&&"openUrl"===e.type){var i={},r=e.callback;return i=e.externalBrowser?{url:e.url,controls:!0,method:"external_browser"}:e.method===n.openUrlMethods.external_browser?{url:e.url,method:"external_browser"}:e.install?"ios"===t.getApiData({deviceOs:1}).deviceOs?{url:e.url,controls:!0,method:"external_browser"}:{url:e.url,controls:!0,method:"store"}:{url:e.url,controls:!0,method:"webview"},t.openUrl(i,r),!0}return!1}}}},{"../modules/StoreConfig":192}],67:[function(e,t,n){t.exports={NativeAPI:{failCallback:"handleAppOrientationDataFailed",successCallback:"handleAppOrientationDataSuccess",oldApiSuccessCallback:"getOrientationSuccess"},ControllerNativeAPI:{getAppOrientationData:"getAppOrientationData",oldSetOrientation:"setOrientation",oldGetOrientation:"getOrientation",setAppOrientation:"setAppOrientation"},analyticsCategories:{failCallback:{name:"AppOrientationFailed",id:263},successCallback:{name:"AppOrientationSuccess",id:264}},iosOrientationsMap:{UIInterfaceOrientationPortrait:2,UIInterfaceOrientationPortraitUpsideDown:4,UIInterfaceOrientationLandscapeLeft:16,UIInterfaceOrientationLandscapeRight:8},iosOrientations:{2:"Portrait",4:"PortraitUpsideDown",16:"LandscapeLeft",8:"LandscapeRight"},appOrientationAPI:"appOrientationAPI"}},{}],68:[function(e,t,n){t.exports=function(t,n,i){var r,a=e("./OrientationConstants.js"),o=!1,s=i.CB;function l(e){n.log("_setAppOrientation | send orientation: "+e,n.LogLevels.info),n.callSDKFunction(a.ControllerNativeAPI.setAppOrientation,{appOrientation:e})}return{init:function(e){o||(t.PubSub.subscribe(s+"."+a.NativeAPI.successCallback,(function(e){r.report(a.analyticsCategories.successCallback),e||(n.log("getAppOrientationData | Orientation data structure not exist.",n.LogLevels.info),r.report(a.analyticsCategories.failCallback))})),t.PubSub.subscribe(s+"."+a.NativeAPI.failCallback,(function(e){n.log("getAppOrientationData failed, errorMsg:"+e.errMsg,n.LogLevels.info),r.report(a.analyticsCategories.failCallback)})),t.PubSub.subscribe("AppOrientationManager.appOrientationChanged",(function(e){e&&e.appOrientation&&(n.log("appOrientationChanged | updating native with orientation: "+e.appOrientation,n.LogLevels.info),l(e.appOrientation))})),r=e,o=!0)},getAppOrientationData:function(){n.callSDKFunction(a.ControllerNativeAPI.getAppOrientationData,{},a.NativeAPI.successCallback,a.NativeAPI.failCallback)},setOrientation:function(e){n.callSDKFunction(a.ControllerNativeAPI.oldSetOrientation,{orientation:e})},oldGetOrientation:function(){var e=new jQuery.Deferred,r=t.PubSub.subscribe(s+"."+a.NativeAPI.oldApiSuccessCallback,(function(n){if(t.PubSub.unsubscribe(r),"resolved"!==e.state()){clearTimeout(o);var a=n&&n.orientation||i.appInfo.orientation.portrait;e.resolve(a)}})),o=setTimeout((function(){e.resolve(i.appInfo.orientation.portrait)}),2e3);return n.callSDKFunction(a.ControllerNativeAPI.oldGetOrientation,null,a.NativeAPI.oldApiSuccessCallback,a.NativeAPI.oldApiSuccessCallback),e.promise()},setAppOrientation:l}}},{"./OrientationConstants.js":67}],69:[function(e,t,n){t.exports=function(){var t=e("./OrientationConstants.js");function n(e){var n=parseInt(e.replace(/^"|"$/g,"")),i=[],r=n.toString(2);if(r.length>Object.keys(t.iosOrientations).length+1||"0"!==r.substr(r.length-1,1))return[];for(var a in t.iosOrientations)(n|a)===n&&i.push(t.iosOrientations[a]);return i}var i=function(e,t){return t.some((function(t){return e.indexOf(t)>=0}))};return{convertOrientationsArrayToNumber:function(e){var n=0;return e.forEach((function(e){n+=Number(function(e,t){return Object.keys(e).filter((function(n){return e[n]===t}))}(t.iosOrientations,e))})),n},convertNumberToOrientations:n,isContainPortrait:function(e){return i(n(e),[t.iosOrientations[2],t.iosOrientations[4]])},isContainLandscape:function(e){return i(n(e),[t.iosOrientations[8],t.iosOrientations[16]])},sharedOrientationBetweenOrientations:function(e,t){var i=n(e),r=n(t),a=i.filter((function(e){return r.indexOf(e)>-1}));return a||(a=[]),a}}}},{"./OrientationConstants.js":67}],70:[function(e,t,n){t.exports=function(t,n){var i,r=e("./Constants.js"),a=e("./PermissionsConstants.js"),o=a.nativeFunction,s={};return{getPermissions:function(){if(i&&"pending"===i.status)return i;i=new jQuery.Deferred;var e,o=t.PubSub.subscribe(r.CB+"."+a.handleGetPermissionsSuccess,(function(e){n.log(a.handleGetPermissionsSuccess+": "+JSON.stringify(e)),t.PubSub.unsubscribe(o),t.PubSub.unsubscribe(s),i.resolve(e)})),s=t.PubSub.subscribe(r.CB+"."+a.handleGetPermissionsFailure,(function(e){n.log(a.handleGetPermissionsFailure+": "+JSON.stringify(e)),t.PubSub.unsubscribe(s),t.PubSub.unsubscribe(o),i.reject(e)}));return n.callSDKFunction(a.nativeFunction,{functionName:a.NativeAPI.getPermissions,functionParams:(e=n.getConfig().mobileSDKSettings.deviceOs===r.deviceOs.ios?r.deviceOs.ios:r.deviceOs.android,{permissions:a.supportedPermissions[e]})},a.handleGetPermissionsSuccess,a.handleGetPermissionsFailure),i.promise()},isPermissionGranted:function(e){if(!e)return!1;if(s[e]&&"pending"===s[e].status)return s[e];s[e]=new jQuery.Deferred;var i=t.PubSub.subscribe(r.CB+"."+a.handleIsPermissionGrantedSuccess,(function(e){if(e&&e.permission){var r=e.permission;s[r]?(n.log(a.handleIsPermissionGrantedSuccess+": "+JSON.stringify(e)),t.PubSub.unsubscribe(i),t.PubSub.unsubscribe(l),s[r].resolve(e)):n.log("Unrecognised permission name "+r,n.LogLevels.error)}})),l=t.PubSub.subscribe(r.CB+"."+a.handleIsPermissionGrantedFailure,(function(e){if(e&&e.permission){n.log(o+a.NativeAPI.isPermissionGranted+JSON.stringify(e),n.LogLevels.verbose);var r=e.permission;s[r]?(t.PubSub.unsubscribe(l),t.PubSub.unsubscribe(i),s[r].reject(e)):n.log("Unrecognised permission name "+r,n.LogLevels.error)}else e&&e.errMsg&&n.log("Error calling isPermissionGranted "+e.errMsg,n.LogLevels.error)}));return n.callSDKFunction(a.nativeFunction,{functionName:a.NativeAPI.isPermissionGranted,functionParams:{permission:e}},a.handleIsPermissionGrantedSuccess,a.handleIsPermissionGrantedFailure),s[e].promise()}}}},{"./Constants.js":33,"./PermissionsConstants.js":71}],71:[function(e,t,n){t.exports={CB:"NativeCallback",NativeAPI:{getPermissions:"getPermissions",isPermissionGranted:"isPermissionGranted"},nativeFunction:"permissionsAPI",supportedPermissions:{ios:["NSCameraUsageDescription","NSLocationAlwaysUsageDescription","NSLocationWhenInUseUsageDescription","NSLocationAlwaysAndWhenInUseUsageDescription","NSMicrophoneUsageDescription"],android:[]},handleGetPermissionsSuccess:"handleGetPermissionsSuccess",handleGetPermissionsFailure:"handleGetPermissionsFailure",handleIsPermissionGrantedSuccess:"handleIsPermissionGrantedSuccess",handleIsPermissionGrantedFailure:"handleIsPermissionGrantedFailure"}},{}],72:[function(e,t,n){t.exports=function(e){return{firePixel:function(t){if(void 0!==t.url&&""!==t.url){if("pixel"===t.type){var n=new Image;""===t.at||isNaN(parseInt(t.at))?n.src=t.url:(n.src=t.url,n.time=t.at)}}else e.log("Missing callback data. At: directive ssaPixel"+(new Date).getTime(),e.LogLevels.info)}}}},{}],73:[function(e,t,n){function i(e){var t={},n,i,r={init:function(){i=jQuery,n=this},publish:function(n,r){i=i||jQuery;try{(Array.isArray(t[n])?[...t[n]]:[]).forEach((function(e){e.apply(i,r||[])}))}catch(t){if(e.Utils.isDefined(t)){e.log({type:"in PubSub "+n,data:t.message,trace:t.stack});var a={name:t.name,message:t.stack};window.onerror(t.name+": "+t.message,null,null,null,a)}}},subscribe:function(e,n){return t[e]||(t[e]=[]),t[e].push(n),[e,n]},unsubscribe:function(n){if(n){var i=n[0];t[i]&&e.Utils.each(t[i],(function(e){t[i][e]===n[1]&&t[i].splice(e,1)}))}},subscribeOnce:function(e,t){var n=this,i=this.subscribe(e,(function(){t(),n.unsubscribe(i)}))},clearHandlers:function(t){e.Utils.each(t,(function(e,t){n.unsubscribe(t)}))}};return r}t.exports=i},{}],74:[function(e,t,n){t.exports={CB:"NativeCallback",NativeAPI:{startListenerSuccessKey:"startListenerSuccess",startListenerFailKey:"startListenerFailed",stopListenerSuccessKey:"stopListenerSuccess",stopListenerFailKey:"stopListenerFailed",initSuccessKey:"initSuccess",initFailKey:"initFailed",statusChanged:"ringerSwitchStatusChanged"},ControllerNativeAPI:{startListener:"startListener",stopListener:"stopListener",init:"init"},analyticsCategories:{startListenerFail:{name:"startListenerFail",id:263},stopListenerFail:{name:"stopListenerFail",id:264},initFail:{name:"initRingerFail",id:265}},notifyAdunitOnState:"ringerSwitchState",ringerNativeFunction:"ringerSwitchAPI"}},{}],75:[function(e,t,n){t.exports=function(t,n){var i,r,a,o=e("./RingerSwitchConstants.js"),s=!0,l=!1,d=1e3,c=!1;function u(e){n.postAdUnitEvent({name:o.notifyAdunitOnState,isRingerSwitchSilent:e})}return{init:function(){l||(t.PubSub.subscribe(o.CB+"."+o.NativeAPI.statusChanged,(function(e){e&&(s=e.ringerSwitchSilent,c&&!s?r=setTimeout((function(){u(s)}),i):(r&&clearTimeout(r),u(s)))})),t.PubSub.subscribe(o.CB+"."+o.NativeAPI.startListenerSuccessKey,(function(e){n.log("Ringer | start detecting function performed successfully.",n.LogLevels.info)})),t.PubSub.subscribe(o.CB+"."+o.NativeAPI.startListenerFailKey,(function(e){a.report(o.analyticsCategories.startListenerFail),e&&n.log("Ringer start detecting failed to perform, errorMsg:"+e.errMsg,n.LogLevels.info)})),t.PubSub.subscribe(o.CB+"."+o.NativeAPI.stopListenerSuccessKey,(function(e){n.log("Ringer stop detecting successfully.",n.LogLevels.info)})),t.PubSub.subscribe(o.CB+"."+o.NativeAPI.stopListenerFailKey,(function(e){a.report(o.analyticsCategories.stopListenerFail),e&&n.log("Ringer stop detecting failed to perform, errorMsg:"+e.errMsg,n.LogLevels.info)})),t.PubSub.subscribe(o.CB+"."+o.NativeAPI.initSuccessKey,(function(e){n.log("Ringer prepare detector successfully.",n.LogLevels.info)})),t.PubSub.subscribe(o.CB+"."+o.NativeAPI.initFailKey,(function(e){a.report(o.analyticsCategories.initFail),e&&n.log("Ringer prepare detector failed to perform, errorMsg:"+e.errMsg,n.LogLevels.info)})),n.log("Ringer | calling init native function",n.LogLevels.info),n.callSDKFunction(o.ringerNativeFunction,{functionName:o.ControllerNativeAPI.init},o.NativeAPI.initSuccessKey,o.NativeAPI.initFailKey),a=t.Analytics.createAnalytic({baseData:{}}),l=!0)},startListener:function(e){n.postAdUnitEvent({name:o.notifyAdunitOnState,isRingerSwitchSilent:s}),c=e&&e.shouldSetRingerUpdateDelay,i=e&&e.ringerUpdateDelay||d,n.log("Ringer | Set listener config to should delay?"+c+", with delay "+i,n.LogLevels.verbose),n.callSDKFunction(o.ringerNativeFunction,{functionName:o.ControllerNativeAPI.startListener},o.NativeAPI.startListenerSuccessKey,o.NativeAPI.startListenerFailKey)},stopListener:function(){c=!1,i=d,n.callSDKFunction(o.ringerNativeFunction,{functionName:o.ControllerNativeAPI.stopListener},o.NativeAPI.stopListenerSuccessKey,o.NativeAPI.stopListenerFailKey)},isInitiated:function(){return l}}}},{"./RingerSwitchConstants.js":74}],76:[function(e,t,n){t.exports=function(t,n,i){var r=e("../storeKit/SKANModel")(),a=e("../storeKit/SKANConstants"),o=e("../../constants/SDKFeatureNames");function s(e){if(!n.isIOS())return!1;var t=parseFloat(n.getConfig().mobileSDKSettings.deviceOSVersion)>=a.SKAdImpression.minimalSupportedIOSVersion,i=n.CompatibilityService.isFeatureSupportedInNativeSDK(o.SKAdImpression),r="Banner"!==e.productType;return!!(t&&i&&function(e){return!!(e.ext&&e.ext.SKANData&&e.ext.SKANData.VTA)}(e)&&r)}function l(e,t,i,o){n.callSDKService(a.SKAdImpression.jsInterface,e,{impressionData:r.extractDataForSKAdImpression(t)},i,o)}return{startImpression:function(e,n,r){if(e&&s(e)){var o=e.adViewId||Date.now(),d=a.SKAdImpression.startImpressionSuccess+"."+o,c=a.SKAdImpression.startImpressionFailed+"."+o,u=[];u.push(t.PubSub.subscribe(i.CB+"."+d,(function(){t.PubSub.clearHandlers(u),t.Utils.isFunction(n)&&n()}))),u.push(t.PubSub.subscribe(i.CB+"."+c,(function(e){t.PubSub.clearHandlers(u),t.Utils.isFunction(r)&&r(e)}))),l(a.SKAdImpression.startImpression,e,d,c)}},endImpression:function(e,n,r){if(e&&s(e)){var o=e.adViewId||Date.now(),d=a.SKAdImpression.endImpressionSuccess+"."+o,c=a.SKAdImpression.endImpressionFailed+"."+o,u=[];u.push(t.PubSub.subscribe(i.CB+"."+d,(function(){t.PubSub.clearHandlers(u),t.Utils.isFunction(n)&&n()}))),u.push(t.PubSub.subscribe(i.CB+"."+c,(function(e){t.PubSub.clearHandlers(u),t.Utils.isFunction(r)&&r(e)}))),l(a.SKAdImpression.endImpression,e,d,c)}}}}},{"../../constants/SDKFeatureNames":118,"../storeKit/SKANConstants":111,"../storeKit/SKANModel":112}],77:[function(e,t,n){var i=e("./SKOverlayConstants"),r=i.configKeys;t.exports=function(e,t,n,a,o,s,l,d){if(e&&t){var c=e,u=t,f=n||i.position.bottom,p=o||{},g=!!a,v=s||function(){var e={};return e[i.delayConfigKeys.initialDelay]=0,e[i.delayConfigKeys.subsequentDelay]=0,e}(),m=l||i.flow.presentOnSKClose,h=d||"",b=null,S=null;return{getOverlayId:function(){return c},getAdvertisedAppId:function(){return u},getConfigObjectForSDK:function(){var e={};return e[r.overlayId]=c,e[r.advertisedAppId]=u,e[r.position]=f,e[r.userDismissible]=g,e[r.SKANData]=p,e[r.customProductPage]=h,e},isQualityClickTriggered:function(){return b},setQualityClickTriggered:function(){b=!0},getDismissInitiatedSource:function(){return S},setDismissInitiatedSource:function(e){S=e},getPresentationDelay:function(e){return e?v[i.delayConfigKeys.initialDelay]:v[i.delayConfigKeys.subsequentDelay]},getFlow:function(){return m},getPpid:function(){return h}}}}},{"./SKOverlayConstants":78}],78:[function(e,t,n){var i=e("../../components/Constants");t.exports={minimalSupportedIOSVersion:14,supportedProductTypes:[i.RV,i.IS],configKeys:{overlayId:"overlayId",advertisedAppId:"advertisedAppId",position:"position",userDismissible:"userDismissible",SKANData:"SKANData",customProductPage:"customProductPageIdentifier"},position:{bottom:0,bottomRaised:1},flow:{presentOnSKClose:0,presentOnSKCloseAndQC:1,presentOnAdVisible:2},externalConfigKeys:{enableSKOverlay:"enableSKOverlay",SKOverlayPosition:"SKOverlayPosition",SKOverlayUserDismissible:"SKOverlayUserDismissible",delayInSecToPresentSKOverlay:"delayInSecToPresentSKOverlay",SKOverlayFlow:"SKOverlayFlow"},delayConfigKeys:{initialDelay:"initialDelay",subsequentDelay:"subsequentDelay"},overlayDismissInitiatedType:{user:0,SKOpen:1,adClose:2},messages:{SDK:{incoming:{overlayCreated:"overlayCreated",overlayCreateFailed:"overlayCreateFailed",overlayLoadFailed:"overlayLoadFailed",overlayWillStartPresentation:"overlayWillStartPresentation",overlayDidFinishPresentation:"overlayDidFinishPresentation",overlayWillStartDismissal:"overlayWillStartDismissal",overlayDidFinishDismissal:"overlayDidFinishDismissal",overlayRemoved:"overlayRemoved",overlayDismissFailure:"overlayDismissFailure",overlayRemovalFailure:"overlayRemovalFailure"},outgoing:{jsInterface:"SKOverlayAPI",createOverlay:"createOverlay",presentOverlay:"presentOverlay",dismissOverlay:"dismissOverlay",removeOverlay:"removeOverlay"}},adunit:{outgoing:{overlayCreateCalled:"overlayCreateCalled",overlayCreateSuccess:"overlayCreateSuccess",overlayCreateFailed:"overlayCreateFailed",overlayVisibleCalled:"overlayVisibleCalled",overlayVisibleSuccess:"overlayVisibleSuccess",overlayVisibleFailed:"overlayVisibleFailed",overlayDismissed:"overlayDismissed"}}}}},{"../../components/Constants":33}],79:[function(e,t,n){t.exports=function(t,n,i){var r=null,a=0,o=null,s=null,l=e("./SKOverlayConstants"),d=new(e("../../modules/DemandSource/EventCategories.js"));function c(e){s=window.timerService.startTimer(),r.report(d.overlayWillStartPresentation_c,{generalmessage:e.advertisedAppId,custom_a:e.overlayId?e.overlayId:-1,custom_b:a})}function u(e){r.report(d.overlayDidFinishPresentation_c,{generalmessage:e.advertisedAppId,custom_a:e.overlayId?e.overlayId:-1,custom_b:a,custom_c:s?window.timerService.stopTimer(s):-1,timingvalue:o?window.timerService.stopTimer(o):-1}),s=null,o=null}function f(e){r.report(d.presentOverlayFailed_c,{generalmessage:e.advertisedAppId,custom_a:e.overlayId?e.overlayId:-1,custom_b:a,callfailreason:e.errMsg,timingvalue:o?window.timerService.stopTimer(o):-1}),o=null}function p(e){r.report(d.overlayWillStartDismissal_c,{generalmessage:e.advertisedAppId,custom_a:e.overlayId?e.overlayId:-1,custom_b:a})}function g(e){r.report(d.overlayDidFinishDismissal_c,{generalmessage:e.advertisedAppId,custom_a:e.overlayId?e.overlayId:-1,custom_b:a}),a++}return{init:function(){r=t.Analytics.createAnalytic({baseData:{}}),t.PubSub.subscribe(i.CB+"."+l.messages.SDK.incoming.overlayWillStartPresentation,c),t.PubSub.subscribe(i.CB+"."+l.messages.SDK.incoming.overlayDidFinishPresentation,u),t.PubSub.subscribe(i.CB+"."+l.messages.SDK.incoming.overlayLoadFailed,f),t.PubSub.subscribe(i.CB+"."+l.messages.SDK.incoming.overlayWillStartDismissal,p),t.PubSub.subscribe(i.CB+"."+l.messages.SDK.incoming.overlayDidFinishDismissal,g)},onPresentOverlay:function(){o&&r.report(d.presentOverlayDuringPendingPresent,{timingvalue:window.timerService.stopTimer(o)}),o=window.timerService.startTimer()}}}},{"../../modules/DemandSource/EventCategories.js":146,"./SKOverlayConstants":78}],80:[function(e,t,n){t.exports=function(t,n,i){var r="SKOverlayManager | ",a=e("./SKOverlayConstants").configKeys,o=e("../../components/SKOverlay/SKOverlay"),s=e("./SKOverlayConstants"),l=e("../../components/storeKit/SKANModel")(),d=e("../../constants/SDKFeatureNames"),c=new(e("../../modules/DemandSource/EventCategories.js")),u=!1,f=[],p=null,g=null,v=null,m=null,h=null,b=null,S=!1,y=!1,A=null;function C(){return n.isIOS()&&n.getConfigurationHelper().getDeviceApiLevel()>=s.minimalSupportedIOSVersion&&n.CompatibilityService.isFeatureSupportedInNativeSDK(d.SKOverlay)}function I(e,a,l,d,c,u,p,g){var v=[],m=e,h=new o(m,a,l,d,c,u,p,g);if(h){var y=s.messages.SDK.incoming.overlayCreated+K(),A=s.messages.SDK.incoming.overlayCreateFailed+K();return v.push(t.PubSub.subscribe(i.CB+"."+y,(function(e){n.log(r+"_createOverlay | "+y+"   "+JSON.stringify(e)),function(e){if(!e)return void n.log(r+"Failed to add overlay to overlays array");f.push(e)}(h),U(s.messages.adunit.outgoing.overlayCreateSuccess,e),h.getFlow()===s.flow.presentOnSKCloseAndQC&&function(e){b=t.PubSub.subscribe("SDKController.qcTriggered",(function(){var t=T(e);t&&t.setQualityClickTriggered()}))}(m),h.getFlow()===s.flow.presentOnAdVisible&&x(h,!0),S=!1,t.PubSub.clearHandlers(v)}))),U(s.messages.adunit.outgoing.overlayCreateCalled,h.getConfigObjectForSDK()),N(s.messages.SDK.outgoing.createOverlay,h.getConfigObjectForSDK(),y,A),h}n.log(r+"_createOverlay | Failed to create an overlay - missing overlayId")}function D(e){var a=T(e);a||(n.log(r+"_dismissOverlay | Failed to dismiss an overlay with missing overlay"),h.report(c.overlayMissing,{custom_b:1}));var o=s.messages.SDK.incoming.overlayDismissFailure+K(),l=t.PubSub.subscribe(i.CB+"."+o,(function(n){var i={generalmessage:a?a.getAdvertisedAppId():-1,custom_a:e};h.report(c.overlayDismissFailure,i),t.PubSub.unsubscribe(l)}));h.report(c.dismissOverlay_c,{generalmessage:a?a.getAdvertisedAppId():-1,custom_a:e,custom_b:0}),N(s.messages.SDK.outgoing.dismissOverlay,{overlayId:e},null,o)}function w(e){return e?T(e.adViewId):null}function P(e){p=e}function O(){return p}function F(){return!!O()}function T(e){if(!e)return h.report(c.overlayMissing,{custom_b:3}),null;for(var t in Object.keys(f))if(f[t].getOverlayId()===e)return f[t];return h.report(c.overlayMissing,{custom_b:4}),null}function x(e,o){var l=e.getPresentationDelay(o);m=setTimeout((function(){!function(e){if(e){var o=[],l=s.messages.SDK.incoming.overlayDidFinishPresentation,d=s.messages.SDK.incoming.overlayLoadFailed;o.push(t.PubSub.subscribe(i.CB+"."+l,(function(a){n.log(r+"_presentOverlay |"+l+"   "+JSON.stringify(a)),n.getCurrentDisplayedAd()&&n.getCurrentDisplayedAdType()!==i.BN&&y?(P(e),t.PubSub.clearHandlers(o),U(s.messages.adunit.outgoing.overlayVisibleSuccess,a)):V(a.overlayId)}))),o.push(t.PubSub.subscribe(i.CB+"."+d,(function(e){n.log(r+"_presentOverlay | "+d+"   "+JSON.stringify(e)),t.PubSub.clearHandlers(o),U(s.messages.adunit.outgoing.overlayVisibleFailed,e)})));var u={advertisedAppId:e.getAdvertisedAppId()};u[a.customProductPage]=e.getPpid(),U(s.messages.adunit.outgoing.overlayVisibleCalled,u),h.report(c.presentOverlay_c,{generalmessage:e.getAdvertisedAppId(),custom_a:e.getOverlayId()});var f={};f[s.configKeys.overlayId]=e.getOverlayId(),n.SKOverlayEventDispatcher.onPresentOverlay(),N(s.messages.SDK.outgoing.presentOverlay,f,l,d)}else n.log(r+"_presentOverlay | Failed to present an overlay")}(e)}),1e3*l)}function U(e,i){n.postAdUnitEvent(t.Utils.extend({name:e},i))}function N(e,t,i,r){var a={};t&&0!==Object.keys(t).length&&(a={functionParams:t}),n.callSDKService(s.messages.SDK.outgoing.jsInterface,e,a,i,r)}function L(){m&&clearTimeout(m),m=void 0}function V(e){D(e),function(e){var a=T(e);a||(n.log(r+"_removeOverlay | Failed to remove an overlay with missing overlay"),h.report(c.overlayMissing,{custom_b:2}));var o=s.messages.SDK.incoming.overlayRemoved+K(),l=s.messages.SDK.incoming.overlayRemovalFailure+K(),d=t.PubSub.subscribe(i.CB+"."+o,(function(e){if(n.log(r+"_removeOverlay | "+o+"   "+JSON.stringify(e)),a){var i=f.indexOf(a);-1!==i&&f.splice(i,1)}t.PubSub.unsubscribe(d),t.PubSub.unsubscribe(u)})),u=t.PubSub.subscribe(i.CB+"."+l,(function(n){var i={callfailreason:n.errMsg,custom_a:e};h.report(c.overlayRemovalFailure,i),t.PubSub.unsubscribe(d),t.PubSub.unsubscribe(u)})),p={};p[s.configKeys.overlayId]=e,N(s.messages.SDK.outgoing.removeOverlay,p,o,l)}(e)}function M(e){return-1!==[i.RV,i.IS].indexOf(e)}function R(e){if(e){var n=e&&e.hasOwnProperty("timeInterval")?e.timeInterval:700,i=e&&e.hasOwnProperty("attempts")?e.attempts:1;i<=0||(A=setTimeout((function(){N(s.messages.SDK.outgoing.dismissOverlay,{},null,null),h.report(c.dismissOverlay_c,{custom_b:1}),R(e=t.Utils.extend(e,{attempts:i-1}))}),n))}}function k(e){var t=n.AdUtils.extractEventData(g);e&&(t.generalmessage=e.advertisedAppId,t.custom_b=e.userDismissible?1:0,t.custom_a=e.overlayId),t.custom_c=s.overlayDismissInitiatedType.adClose,h.report(c.overlayDismissed,t)}function K(){return(new Date).getTime()+Math.random()}return{init:function(){C()&&!u&&(u=!0,h=t.Analytics.createAnalytic({baseData:{}}),n.SKOverlayEventDispatcher.init(),t.PubSub.subscribe("SDKController.AdVisible",(function(e){var t;(e&&M(e.productType)&&(y=!0),!(t=e)||!t.settings||(t=n.Utils.flattenAd(t)).productType&&-1===s.supportedProductTypes.indexOf(t.productType)||!t.clickTags||!t.clickTags.storeAppId||t.hasOwnProperty(s.externalConfigKeys.enableSKOverlay)&&!t[s.externalConfigKeys.enableSKOverlay])||(clearTimeout(A),A=void 0,function(e){if(e&&e.settings&&e.ext){var t=e.ext.clickTags&&e.ext.clickTags.storeAppId,i=e.settings[s.externalConfigKeys.SKOverlayPosition],a=!e.settings.hasOwnProperty(s.externalConfigKeys.SKOverlayUserDismissible)||e.settings[s.externalConfigKeys.SKOverlayUserDismissible],o=e.settings[s.externalConfigKeys.delayInSecToPresentSKOverlay],d=e.settings[s.externalConfigKeys.SKOverlayFlow]||0,c=l.extractDataForSKOverlay(e),u=e.ext.appData&&e.ext.appData.ppid||"";n.log(r+"_createOverlay : "+JSON.stringify(c)),I(e.adViewId,t,i,a,c,o,d,u)}}(e),function(e){g=e}(e))})),t.PubSub.subscribe("SDKController.adClosed",(function(e){e.ad&&M(e.ad.productType)&&(y=!1),u&&R(e.ad.settings.dismissOverlayOnAdClose),f&&0!==f.length&&(L(),b&&(t.PubSub.unsubscribe(b),b=null),V(f[0].getOverlayId()))})),t.PubSub.subscribe(i.CB+"."+s.messages.SDK.incoming.overlayDidFinishDismissal,(function(e){n.log(r+s.messages.SDK.incoming.overlayDidFinishDismissal+"   "+JSON.stringify(e));var t=n.getCurrentDisplayedAd();t?function(e,t){var n=w(e);t.dismissInitiatedSource=n&&n.getDismissInitiatedSource()||s.overlayDismissInitiatedType.user,U(s.messages.adunit.outgoing.overlayDismissed,t),k(t),n&&n.setDismissInitiatedSource(null)}(t,e):k(e),P(null)})),t.PubSub.subscribe(i.CB+"."+s.messages.SDK.incoming.overlayCreateFailed,(function(e){n.log(r+s.messages.SDK.incoming.overlayCreateFailed+"   "+JSON.stringify(e));var t={};if(e&&e.overlayId){var i=T(e.overlayId);t=i&&i.getConfigObjectForSDK()}U(s.messages.adunit.outgoing.overlayCreateFailed,t)})),t.PubSub.subscribe("SDKController.aecskTriggered",(function(e){S=!0})))},isSKOverlaySupported:C,onSKClose:function(){if(C()&&!S){var e=w(g);if(e){if(v)return x(v,!1),void(v=null);e.getFlow()===s.flow.presentOnAdVisible&&x(e,!1),e.getFlow()===s.flow.presentOnSKClose&&x(e,!0),e.getFlow()===s.flow.presentOnSKCloseAndQC&&e.isQualityClickTriggered()&&x(e,!0)}}else S=!1},onSKOpen:function(){C()&&(F()?((v=O()).setDismissInitiatedSource(s.overlayDismissInitiatedType.SKOpen),D(v.getOverlayId())):L())},isSKOverlayVisible:function(){return F()}}}},{"../../components/SKOverlay/SKOverlay":77,"../../components/storeKit/SKANModel":112,"../../constants/SDKFeatureNames":118,"../../modules/DemandSource/EventCategories.js":146,"./SKOverlayConstants":78}],81:[function(e,t,n){t.exports=function(e,t,n){var i=n||{};function r(t){var n=e.getConfig().controllerConfig;return(n&&n.networkConfig||{})[t]}var a={getInventoryOnInit:!1,refreshInterval:30,precache:!0};function o(e){return null!=e&&("boolean"==typeof e||"true"===e||"false"===e)}return{getValueByKey:function(t){return(e.getConfig().controllerConfig||{})[t]},getValueByKeyAndProductType:function(n,i){var r=e.getConfig().controllerConfig;return(r&&r[t.sspProductNames[i]]||{})[n]},getNetworkConfigValueByKey:r,getFeaturesConfigByAdSource:function(e){var t=r("features"),n=i.extend(!0,{},t);delete n.MP;var a=e&&t&&t[e]||{};return i.extend(!0,{},n,a)},getOfferWallConfig:function(){var t,n=e.getConfig().controllerConfig,r={precache:o(n.precacheMobileOfferWall)?n.precacheMobileOfferWall:a.precache,getInventoryOnInit:o(n.getInventoryOnInit)?n.getInventoryOnInit:a.getInventoryOnInit,refreshInterval:(t=n.owRefreshInterval,null==t||isNaN(parseInt(t))||0===n.owRefreshInterval?a.refreshInterval:n.owRefreshInterval)};return a=i.extend(!0,a,r)},isNetworkConfigEmpty:function(){var t=e.getConfig().controllerConfig;return!t||!t.networkConfig}}}},{}],82:[function(e,t,n){function i(e,t,n,i){function r(e,t){return e[0]&&t[0]?(e=new Date(e[0]))<(t=new Date(t[0]))?-1:e>t?1:0:0}function a(e,t){return void 0===e&&(e=1),e=parseInt(e),t=parseInt(t),isNaN(e)||isNaN(t)?-1:e===t?0:e>t?1:-1}function o(e){try{return e()}catch(e){return!1}}function s(e){return"object"==typeof e&&e.hasOwnProperty("length")?Array.prototype.slice.call(e):[]}function l(e){if(c())return f(d(),e)}function d(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))}function c(){return crypto&&crypto.getRandomValues&&"function"==typeof crypto.getRandomValues&&Array.isArray(crypto.getRandomValues(new Uint8Array(1)))}function u(e,t){if(e.length<=t||t<=0)return"";for(var n=0,i=0;i<e.length;i++){n+=e.charCodeAt(i)}return n%Math.pow(16,t).toString(16)}function f(e,t){if(e.length<=t||t<=0)return e;var n=e.slice(0,-t);return n+u(n,t)}function p(e,...t){function n(e){return e&&"object"==typeof e&&!Array.isArray(e)}if(void 0===e&&(e={}),!t.length)return e;const i=t.shift();if(n(e)&&n(i))for(const t in i)n(i[t])?(n(e[t])||(e[t]={}),p(e[t],i[t])):e[t]=i[t];return p(e,...t)}function g(e,...t){return!0===(e=e||{})?p(...t):(Object.assign(e,...t),Object.keys(e).forEach((t=>{void 0===e[t]&&delete e[t]})),e)}function v(e,t){if(e)for(const n in e)t(n,e[n])}function m(e){var t=e.children[0],i=n.createElement("span");i.style.display="inline-block",t.replaceWith(i),i.appendChild(t);var r=t.parentElement.getBoundingClientRect().width;return t.parentElement.replaceWith(t),r}function h(e,t){var n,i,r=t.maxFontPixels,a=t.maxHeight,o=t.maxWidth,s=t.parentContainer?t.parentContainer.getBoundingClientRect().height:e.parentElement.getBoundingClientRect().height,l=t.parentContainer?t.parentContainer.getBoundingClientRect().width:e.parentElement.getBoundingClientRect().width;s=a||s,l=o||l;do{e.style.fontSize=r,r-=1,t.lineHeight&&(t.parentContainer.style.lineHeight=t.lineHeight+"em"),n=e.parentElement.getBoundingClientRect().height,i=e.parentElement.getBoundingClientRect().width}while(n>s||i>l&&r>3)}function b(t){if(t){var n=JSON.parse(JSON.stringify(t));return i(n,"ext",!1),i(n,"features",!1),i(n,"settings",!0),n}function i(t,n,i){t.hasOwnProperty(n)&&"object"==typeof t[n]&&delete(t=i?e.Utils.extend(!0,t,t[n]):e.Utils.extend(t,t[n]))[n]}}var S={textfill2:h,calculateTextElementWidth:m,each:v,extend:g,getScript:function(t,i,r){var a=n.createElement("script");a.src=t;var o=n.getElementsByTagName("head")[0],s=!1;a.onload=a.onreadystatechange=function(e){s||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(s=!0,i(e),a.onload=a.onreadystatechange=null,o.removeChild(a))},a.onerror=function(t){e.log(["script load error",t]),r&&r()},o.appendChild(a)},getQueryString:function(e,n,i){i=this.isDefined(i)?i:t.location.href,null===n&&(n=""),e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(i);return null===r?n:r[1]},getUrlInfo:function(e){var t=n.createElement("a");return t.href=e,{host:t.hostname,port:t.port,path:t.pathname,protocol:t.protocol}},changeUrlProtocol:function(e,t){var i=n.createElement("a");return i.href=e,i.protocol=t,i.href},serialize:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")},isDefined:function(e){return typeof e!==i},isFunction:function(e){return"function"==typeof e},isString:function(e){return"string"==typeof e},parseJSON:function(e){return this.isString(e)?JSON.parse(e):null},getParams:function(e){var t,n=[],r=e.split("/"),a=r.length;if(-1===e.indexOf("JSON:")){if(a>=2&&a%2==0)for(t=0;t<a;t+=2)n[r[t]]=r.length>=t+1?decodeURIComponent(r[t+1]):null}else{var o=e.split("JSON:");typeof o[1]!==i&&(n=this.parseJSON(o[1]))}return n},decodeValues:function(t){v(t,(function(n){t.hasOwnProperty(n)&&("string"==typeof t[n]&&(t[n]=decodeURIComponent(t[n])),"object"==typeof t[n]&&t[n]&&e.Utils.decodeValues(t[n]))}))},renderTemplate:function(e,t){return t?(v(t,(function(t,n){var i=new RegExp("{{"+t+"}}","g");e=e.replace(i,n)})),e):e},isVisible:function(e){return"none"!==e.style.display&&"hidden"!==e.style.visibility},returnResolvedPromise:function(){var e,t=new jQuery.Deferred;return arguments.length>0&&(e=[].slice.call(arguments)),t.resolve.apply(t.resolve,e),t.promise()},returnRejectedPromise:function(){var e,t=new jQuery.Deferred;return arguments.length>0&&(e=[].slice.call(arguments)),t.reject.apply(t.reject,e),t.promise()},replacePlaceHolder:function(e,t){var n;for(var i in t){n=t[i];var r=new RegExp(i+"|"+encodeURIComponent(i),"i");e=e.replace(r,"function"==typeof n?n():n)}return e},fileArrayIncludes:function(e,t){if(e||0===e.length)return!1;for(var n=0;n<e.length;n++)if(t===e[n])return!0;return!1},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},isEmptyObject:function(e){if(!e)return!0;if(this.isString(e)||this.isArray(e))return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},sortDataByDateKey:function(e){var t=[];for(var n in e)t.push([n,e[n]]);return t.sort(r)},isWebWrapper:function(){return t.isWebWrapper},apiVersionCompareTo:a,isNestedObjectExists:o,convertArrayLikeObjectToArray:s,generateIdentifier:l,replaceEndingWithCheckSum:f,flattenAd:b};return S}window.Utils=i,t.exports=i},{}],83:[function(e,t,n){t.exports=function(t,n){var i=e("../components/PixelTrackingService.js")(n),r=e("../components/FillRateTrackingService.js")(n,i),a=e("../components/ObfuscationService.js")(t.Utils),o=e("../modules/DemandSource/EventCategories")(),s=e("./Constants"),l="1.0.9",d="/common/sdk/",c=d+l+"/vastObfuscator",u=d+l+"/vast-vmap",f=c+".4f4eb4fb.min.html",p=c+".html",g=u+".4f4eb4fb.min.js",v=u+".js",m=n.DemandUtils;return{parseVast:function(e,l,d){var c,u,h=new jQuery.Deferred;if("prod"!==n.getEnv()?(c=e.settings.urltocdn+p,u=e.settings.urltocdn+v):(c=e.settings.urltocdn+f,u=e.settings.urltocdn+g),!(e.ext&&e.ext.vastData&&e.ext.vastData.xmlResponse))return h.reject({errMsg:"unsupported vast format"});var b=e.ext.vastData.xmlResponse,S={adData:b,style:"height:100%;",adUnitData:e,vastParserUrl:u},y={adData:b,url:c,templateClass:"obfuscationIframe",style:{width:"1px",height:"1px",border:"0"},id:e.vastIframeId};return function(e,n,l){var d,c;if("[object Array]"===Object.prototype.toString.call(e.ext.callbacks)){var u=e.controllerSpace&&e.controllerSpace.viewCount||0;d=e.ext.callbacks[u]}else d=e.ext.callbacks;var f=r.init(d),p=e.vastIframeId,g=t.PubSub.subscribe("SDKController.VastRequest",(function(e){e.vastIframeId&&e.vastIframeId===p&&(f.track({trackingType:"request"}),t.PubSub.unsubscribe(g))})),v=t.PubSub.subscribe("SDKController.VastResponse",(function(e){e.vastIframeId&&e.vastIframeId===p&&(clearTimeout(c),"hit"===e.result?(f.track({trackingType:"responseHit"}),a.removeIframe(p),t.PubSub.unsubscribe(v),n.resolve(e.data)):(f.track({trackingType:"responseMiss",data:e.data}),a.removeIframe(p),t.PubSub.unsubscribe(v),n.reject({errMsg:e.data})))})),h=l&&l>s.vastMinimumResponseTimeout?l:s.vastResponseTimeout;c=setTimeout((function(){t.PubSub.unsubscribe(v),t.PubSub.unsubscribe(g),t.PubSub.unsubscribe(b),clearTimeout(c),n.reject({isTimeLimitReached:!0,errMsg:"timeout"})}),h);var b=t.PubSub.subscribe("SDKController.VastErrorPixel",(function(e){e.vastIframeId&&e.vastIframeId===p&&(i.firePixel(e),a.removeIframe(p),t.PubSub.unsubscribe(b))})),S=t.PubSub.subscribe("SDKController.parseVastInfo",(function(n){if(n.vastIframeId&&n.vastIframeId===p){t.PubSub.unsubscribe(S);var i=m.extendCallbackParamsWithParentProductConfig(e,{action:"fireEvent",eventParam:{eName:o.parseVastInfo,label:{},data:{generalMessage:n.data}}});t.PubSub.publish("SDKController.Analytics",[i])}}))}(e,h,d.vastTimeOut),a.init(y,(function(e){t.Msg.postMessage("$$JSON:"+JSON.stringify(S),c,e.contentWindow)})),h.promise()},removeIframe:function(e){a.removeIframe(e)}}}},{"../components/FillRateTrackingService.js":42,"../components/ObfuscationService.js":63,"../components/PixelTrackingService.js":72,"../modules/DemandSource/EventCategories":146,"./Constants":33}],84:[function(e,t,n){var i;!function(e){e[e.LOWER=-1]="LOWER",e[e.EQUAL=0]="EQUAL",e[e.HIGHER=1]="HIGHER"}(i||(i={}));t.exports=class{constructor(){this.VERSION_DIGITS_COUNT=4}isHigher(e,t){return this.compare(e,t)===i.HIGHER}isLower(e,t){return this.compare(e,t)===i.LOWER}isEqual(e,t){return this.compare(e,t)===i.EQUAL}compare(e,t){try{const n=this.prepareVersionForComparison(e),i=this.prepareVersionForComparison(t);return this.compareVersionArrays(n,i)}catch(e){throw"Parse Error - VersionCompare"}}prepareVersionForComparison(e){const t=this.fix5_0_2CorruptedVersionIfNeeded(e.toString()),n=this.createVersionArray(t);return this.getExtendedLengthVersion(n)}fix5_0_2CorruptedVersionIfNeeded(e){return"5.02"===e&&(e="5.0.2"),e}createVersionArray(e){const t=e.split(".").map((e=>parseInt(e)));if(0===t.length)throw`version ${e} is not a valid numeric version`;return t}getExtendedLengthVersion(e){const t=e;for(;t.length<this.VERSION_DIGITS_COUNT;)t.push(0);return t}compareVersionArrays(e,t){for(let n=0;n<this.VERSION_DIGITS_COUNT;n++){if(e[n]>t[n])return i.HIGHER;if(e[n]<t[n])return i.LOWER}return i.EQUAL}}},{}],85:[function(e,t,n){t.exports=function(t){var n,i,r,a=e("../components/Constants.js"),o=null;return{init:function(e,t){o=new jQuery.Deferred,n=function(e){return e.settings&&e.settings.standaloneView}(e),a.viewsStates.normal,i=e.ext&&e.ext.viewUniqueId||"",r={standaloneView:n,viewUniqueId:i,adViewId:t},o.resolve({})},waitForAllViews:function(){return o.promise()},getDisplayWebViewParams:function(e){return r=t.Utils.extend(r,{display:e})}}}},{"../components/Constants.js":33}],86:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const i={dapi:{name:"dapi",fileName:"dapi.js",version:"2.0.2"},mraid:{name:"mraid",fileName:"mraid.js",version:"1.0.2"}};t.exports=class{constructor(e,t,n){const{uepfc:r=!0,adprot:a}=null!=t?t:{};this._controller=e,this._baseUrl=n,this._shouldDownloadProtocols=r,this._externalProtocols=this._controller.Utils.extend(!0,i,a)}protocolInfo(e){const t=this._externalProtocols[e];if(!t)throw new Error(`Protocol ${e} is not supported`);return Object.assign(Object.assign({},t),{downloadUrl:`${this._baseUrl}/${t.name}/${t.version}/${t.fileName}`,shouldDownload:this.shouldDownloadProtocols()})}shouldDownloadProtocols(){return this._shouldDownloadProtocols}}},{}],87:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});t.exports=class{constructor(e,t,n){this._controller=e,this._rootPath=t,this._analytics=n}fetchFile(e){const{fileName:t,url:n,version:i,name:r}=e,a=`${r}_${i}`;return new Promise(((e,i)=>{const r={filePath:`${a}/${t}`,url:n,rootPath:this._rootPath};this._controller.Cache.isFileInCache(t,a)?e(r):this._controller.cacheAsset(a,n).then((t=>{e(Object.assign(Object.assign({},t),{rootPath:this._rootPath}))})).fail((e=>{i(e)}))}))}rootPath(){return this._rootPath}}},{}],88:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});t.exports=class{constructor(e,t){this._cacheFolder=t;const n=location.origin+location.pathname.slice(0,location.pathname.lastIndexOf("/"));this._rootPath=n.slice(0,n.lastIndexOf("/")+1)+this._cacheFolder+"/"}getRootAbsolutePath(){return this._rootPath}}},{}],89:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ExternalProtocolFile=void 0;var i=e("../../types");class r{}r.DOWNLOADING="downloading",r.DOWNLOADED="downloaded",r.FAILED="failed",r.NONE="none";class a{}a.FEATURE_DISABLED_BY_FLAG="featureDisabledByFlag",a.FILE_NOT_DOWNLOADED="fileNotDownloaded",a.AD_PLAYER_IN_STREAMING_MODE="adPlayerInStreamingMode",a.RELATIVE_DEFAULT="reativeDefault",a.REMOTE_DEFAULT="remoteDefault",a.RELATIVE_PLAYABLE_AD="relativePlayableAd",a.REMOTE_PLAYABLE_AD="remotePlayableAd",a.RELATIVE_IEC="relativeIEC",a.REMOTE_IEC="remoteIEC";n.ExternalProtocolFile=class{constructor(e){var t;this._fileStatus=r.NONE,this._rootPath="";const{fileRepository:n,protocolInfo:i}=e;this._fileRepository=n,this._fileInfo={fileName:i.fileName,url:i.downloadUrl,filePath:"",version:i.version,name:i.name,shouldFetchFromCache:null===(t=i.shouldDownload)||void 0===t||t}}fileInfo(){return this._fileInfo}download(){return this._fileStatus=r.DOWNLOADING,this._fileRepository.fetchFile(this._fileInfo).then((e=>(this._fileInfo.filePath=e.filePath,this._rootPath=e.rootPath,this._fileStatus=r.DOWNLOADED,Promise.resolve(this)))).catch((e=>(this._fileStatus=r.FAILED,Promise.reject(this))))}url(e){var t;const n=`${this._rootPath}${this._fileInfo.filePath}`,i=null!==(t=this._fileInfo.url)&&void 0!==t?t:"",r=this._isFlowEligibleFromCache(e,this._fileStatus);return{path:r.decision?n:i,reason:r.reason}}_isFlowEligibleFromCache(e,t){if(!this._fileInfo.shouldFetchFromCache)return{decision:!1,reason:a.FEATURE_DISABLED_BY_FLAG};if(t!==r.DOWNLOADED)return{decision:!1,reason:a.FILE_NOT_DOWNLOADED};if(!this._isRelativePath(e.url))return{decision:!1,reason:a.AD_PLAYER_IN_STREAMING_MODE};if(e.type===i.AdType.PlayableAd){let t=this._isRelativePath(e.videoData.videoSource.htmlURL);return{decision:t,reason:t?a.RELATIVE_PLAYABLE_AD:a.REMOTE_PLAYABLE_AD}}if(e.type===i.AdType.CustomEndCard){let t=this._isRelativePath(e.layoutData.html);return{decision:t,reason:t?a.RELATIVE_IEC:a.REMOTE_IEC}}let n=!0===e.precache;return{decision:n,reason:n?a.RELATIVE_DEFAULT:a.REMOTE_DEFAULT}}_isRelativePath(e){return 0===(null==e?void 0:e.indexOf("../"))}}},{"../../types":213}],90:[function(e,t,n){"use strict";var i=e("./ExternalProtocolFile");t.exports=class{init({controller:e,config:t,baseFileRepository:n}){const r=t.protocolInfo("dapi");this._controller=e,this.dapiFile=new i.ExternalProtocolFile({protocolInfo:r,fileRepository:n});const a=t.protocolInfo("mraid");this.mraidFile=new i.ExternalProtocolFile({protocolInfo:a,fileRepository:n}),t.shouldDownloadProtocols()&&(this.dapiFile.download(),this.mraidFile.download())}prepareAd(e){var t,n,i,r,a,o;const s=null===(t=this.dapiFile)||void 0===t?void 0:t.url(e),l=null===(n=this.mraidFile)||void 0===n?void 0:n.url(e);e.dapiUrl={url:null!==(i=null==s?void 0:s.path)&&void 0!==i?i:"",reason:null!==(r=null==s?void 0:s.reason)&&void 0!==r?r:""},e.mraidUrl={url:null!==(a=null==l?void 0:l.path)&&void 0!==a?a:"",reason:null!==(o=null==l?void 0:l.reason)&&void 0!==o?o:""},this._controller.log("PrepareAd | sending external protocol urls | dapiUrl:"+JSON.stringify(s)+" , mraidUrl: "+JSON.stringify(l))}}},{"./ExternalProtocolFile":89}],91:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),t.exports=function(e){let t=[],n=e.controller;function i(e){let n=t.filter((function(t){return t.getContainerID()===e}));return n.length>0?n[0]:void 0}return{add:function(e){e&&t.push(e)},getAdViewById:i,isExist:function(e){return void 0!==i(e)},removeAdViewById:function(e){let n={};return t=t.filter((function(t){return t.getContainerID()!==e||(n=t,!1)})),n},toArray:function(){return t.slice()},size:function(){return t.length},printAll:function(){t.forEach((function(e){n.log("container  "+e.getContainerID())}))}}}},{}],92:[function(e,t,n){t.exports=function(e,t,n,i,r){var a="AdViewsManager | ";function o(t){return e.log(a+"_getAdViewByAd"),s(t).getAdViewByAd(t)}function s(e){if(l("_getManager"),e)return e.isWPAD?n:t;l("_getManager without ad")}function l(t){e.log(a+t)}return{createAndLoadView:function(i,r,o,s){i.isWPAD?function(e,t,i,r){l("_createAndLoadAdWebView"),n.loadAdUnitUrlToView(e,t,i,r)}(i,r,o,s):function(n,i,r,o){e.log(a+"_createAndLoadFrameView"),t.createAndLoadAdFrame(n,i,r,o)}(i,r,o,s)},displayAdView:function(t,n,i,r){e.log(a+"_displayAdView"),s(t).displayAdView(t,n,i,r)},unloadAdView:function(e){l("_unloadAdView"),e?s(e).unloadAdView(e):l("_unloadAdView | no ad")},updateFrameUrl:function(e,t,n,i){l("_updateFrameUrl"),s(e).updateAdUnitUrl(e,t,n,i)},getContainerState:function(){return l("_getContainerState"),i.getState()},displayContainer:function(e){if(l("_displayContainer"),s(e)===t)return i.display(e);var n=o(e).getContainerID();return i.display(e,n)},hideContainer:function(e){l("_hideContainer"),i.hide(e)},setContainerVisibility:function(e){l("_setContainerVisibility"),i.setVisibility(e)},unloadProductFromContainer:function(){l("_unloadProductFromContainer"),i.unloadProduct()},setContainerBGColorTransparent:function(){l("_setContainerBGColorTransparent"),i.setWebviewBGColorTransparent()},handleScreenVisible:function(e,t){l("_handleScreenVisible"),s(t).handleScreenVisible(e,t)},displayLoader:function(e){if(l("_displayLoader"),r.isDisplayed()){var n=r.get();s(n).displayLoader(e,n)}else t.displayLoader(e)},hideLoader:function(){if(l("_hideLoader"),r.isDisplayed()){var e=r.get();s(e).hideLoader(e)}else t.hideLoader()},isContainerLoaded:function(e){return l("_isContainerLoaded"),s(e).isContainerLoaded(e)},getContainerCreationHandler:function(e){return l("_getContainerCreationHandler"),s(e).getContainerCreationHandler(e)},onAdUnitLoaded:function(t,n,i){e.log(a+"_onAdUnitLoaded"),s(t).onAdUnitLoaded(t,n,i)},getAdViewByAd:o,triggerRedraw:function(){l("_triggerRedraw"),i.redraw()},sendMessageToAdView:function(e,t){return l("_sendMessageToAdView"),t?s(t).sendMessageToDisplayedAdView(e):(l("_sendMessage | ad undefined"),!1)},sendMessageToAllAdViews:function(e){l("_sendMessageToAllAdViews"),n.sendMessageToAllAdViews(e),t.sendMessageToAllAdViews(e)},getDisplayedAdView:function(e){return l("_getDisplayedAdView"),s(e).getDisplayedAdView(e)},hideView:function(){var e=r.get();s(e).hideView(e)},displayView:function(){var e=r.get();s(e).displayView(e)},isViewDisplayed:function(e,t){s(t).isViewDisplayed(e)}}}},{}],93:[function(e,t,n){t.exports=function(e,t,n){var i=n.style.backgroundColors;return{setSDKWebviewBGColor:function(t,n){t&&(e.log("ContainerManager | setSDKWebviewBGColor | color: "+t),e.callSDKFunction("setWebviewBackgroundColor",window.SSA_CORE.Utils.extend(n||{},{color:t})))},setControllerBGColor:function(t){t&&(e.log("ContainerManager | setControllerBGColor | color: "+t),document.body.style.background=t)},getSDKWebviewBGColorByProductType:function(e){switch(e){case t.IS:case t.WebControls:return i.transparent;case t.OW:case t.RV:default:return i.black}},getControllerBGColorByProductType:function(e){switch(e){case t.IS:case t.WebControls:return i.transparent;case t.OW:case t.RV:default:return i.darkGrey}},backgroundColors:i}}},{}],94:[function(e,t,n){t.exports=function(t,n,i,r){var a,o,s,l="BannerExternalAdViewService | ",d=e("./ExternalAdViewConstants.js"),c=e("./WPADUtils")(n),u=[],f=[],p=d.nativeFunction;function g(){var e=r.get();e&&e.productType&&e.productType===i.BN&&r.reset()}function v(e){return!!e&&(void 0!==e.isOffScreenView?!e.isHidden&&e.isKeyWindow:e.isViewVisible)}function m(e){return e&&e.adViewId}function h(e){var t;return t=!!function(e){return!(A()!==d.nativeFunction||m(e)&&!c.isBannerAdViewId(e.adViewId))}(e)||m(e)&&function(e){n.log("BannerExternalAdViewService | isIdentifierExistInIdsCollection | "+e);for(var t=!1,i=0;!t&&i<f.length;i++)f[i].id===e&&(t=!0);return t}(e.adViewId),n.log("BannerExternalAdViewService | "+A()+" | handling message? "+t+"  message:"+JSON.stringify(e)),t}function b(e){C("sendMessage | "+JSON.stringify(e));var r=t.PubSub.subscribe(i.CB+"."+d.handleSendMessageFailure,(function(e){h(e)&&(e&&e.errMsg&&n.log("Error calling "+d.handleSendMessageFailure+" with error "+e.errMsg,n.LogLevels.error),t.PubSub.unsubscribe(r))}));if("string"==typeof e){var a=e.indexOf("$$");-1!==a&&(e=function(e,t){var n={},i=e.substr(t+2),r=i.indexOf("="),a=i.substr(0,r);return n.name=e.substr(0,t),n[a]=i.substr(r+1),n}(e,a))}n.callSDKFunction(A(),{functionName:d.NativeAPI.sendMessage,functionParams:{params:JSON.stringify(e)}},d.handleSendMessageSuccess,d.handleSendMessageFailure)}var S=function(e,t){b(e)};function y(){f=[],s=!1}function A(){return p}function C(e){n.log(l+e)}return{init:function(e){s=!0,function(e){if(C("_setNativeServiceApi | "+e),!e)return;C("_setNativeServiceApi | "+e),p=e}(e),n.log("rony BannerExternalAdViewService | _init nativeservice : "+p),u.push(t.PubSub.subscribe(i.CB+"."+d.handleContainerIsVisible,(function(e){h(e)?!e.configs&&e.configs.productType&&e.configs.visibilityParams||(n.log("rony BannerExternalAdViewService | handeling isVisible"),n.log("BannerExternalAdViewService | "+d.handleContainerIsVisible),v(e.configs.visibilityParams)&&t.PubSub.publish(e.configs.productType+".isVisible",[e.configs])):n.log("rony BannerExternalAdViewService | not handeling isVisible")}))),u.push(t.PubSub.subscribe(i.CB+"."+d.handleContainerWasRemoved,(function(e){if(h(e)){n.log("BannerExternalAdViewService | "+d.handleContainerWasRemoved,n.LogLevels.error);for(var i=!1,r=0;!i&&r<f.length;r++)f[r].id===e.configs.externalAdViewId&&(i=!0,f.splice(r,1));i||n.log("BannerExternalAdViewService | "+d.handleContainerWasRemoved+"trying to remove container "+e.configs.externalAdViewId+" that does not exist",n.LogLevels.error),g(),t.PubSub.publish(e.configs.productType+".reset",[e.configs])}}))),u.push(t.PubSub.subscribe(i.CB+"."+d.NativeAPI.linkActivation,(function(e){h(e)&&(n.log("BannerExternalAdViewService |  "+d.NativeAPI.linkActivation+" params: "+JSON.stringify(e)),e.url&&t.Utils.decodeValues(e),t.PubSub.publish(i.CB+".linkActivationOnAd",[e]))}))),u.push(t.PubSub.subscribe(i.CB+"."+d.handleMessage,(function(e){h(e)&&function(e){try{var i=e.adViewId?e.adViewId:void 0,r=function(e,n){return function(i){var r={data:i,id:e};n&&(r=t.Utils.extend(r,{adViewId:n})),S(r,!0)}}(e.id,i);n.isAndroid()||t.Utils.decodeValues(e.arguments),i&&(e.arguments=t.Utils.extend(e.arguments,{adViewId:i})),e.arguments=t.Utils.extend(e.arguments,{callback:r}),t.PubSub.publish("SDKController."+e.method,[e.arguments])}catch(t){n.log("BannerExternalAdViewService | unable to parse message: "+e,n.LogLevels.error)}}(e)})))},destroy:function(){t.PubSub.clearHandlers(u)},loadWithUrl:function(e,r,a,o,s){C("_loadWithUrl | "+e),n.AdUtils.extendAdObjectWithConfig(e,r,a,o);var l=t.PubSub.subscribe(i.CB+"."+d.handleLoadWithUrlFailure,(function(i){h(i)&&(n.isAdDisplayed(r)?C("_loadWithUrl | isAdDisplayed=true"):(i&&i.errMsg&&(n.log("Error calling "+d.handleLoadWithUrlFailure+" with error "+i.errMsg+" url "+e,n.LogLevels.error),g(),t.PubSub.publish("SDKController.AdLoadError",[i])),t.PubSub.unsubscribe(l),s&&s(!1)))})),c=t.PubSub.subscribe(i.CB+"."+d.handleLoadWithUrlSuccess,(function(e){h(e)&&(s&&s(!0),C(d.handleLoadWithUrlSuccess),t.PubSub.unsubscribe(l),t.PubSub.unsubscribe(c))}));n.callSDKFunction(A(),{functionName:d.NativeAPI.loadWithUrl,functionParams:t.Utils.extend({urlForWebView:e},o)},d.handleLoadWithUrlSuccess,d.handleLoadWithUrlFailure)},updateAd:function(e,r,a,o){n.log("BannerExternalAdViewService | _updateAd | "+JSON.stringify(r));var s={name:"updateAd",param:r};n.AdUtils.extendAdObjectWithConfig(e,r,a,o);var l=t.PubSub.subscribe(i.CB+"."+d.handleUpdateAdFailure,(function(e){h(e)&&(e&&e.errMsg&&n.log("Error calling "+d.handleUpdateAdFailure+" with error "+e.errMsg,n.LogLevels.error),t.PubSub.unsubscribe(l))}));n.callSDKFunction(A(),{functionName:d.NativeAPI.updateAd,functionParams:{params:JSON.stringify(s)}},d.handleUpdateAdSuccess,d.handleUpdateAdFailure)},sendMessage:b,isContainerVisible:v,isExternalAdViewInitiated:function(){if(n.log("BannerExternalAdViewService | isExternalAdViewInitiated |"),a&&"pending"===a.status)return a;a=new window.jQuery.Deferred;var e=t.PubSub.subscribe(i.CB+"."+d.handleIsInitiated,(function(i){h(i)&&(n.log("BannerExternalAdViewService | "+d.handleIsInitiated+" "+JSON.stringify(i)),t.PubSub.unsubscribe(e),t.PubSub.unsubscribe(r),a.resolve(i))})),r=t.PubSub.subscribe(i.CB+"."+d.handleIsInitiatedFailure,(function(i){h(i)&&(i&&i.errMsg&&n.log("Error calling "+d.handleIsInitiatedFailure+" with error "+i.errMsg,n.LogLevels.error),t.PubSub.unsubscribe(r),t.PubSub.unsubscribe(e),a.reject(i))}));return n.callSDKFunction(A(),{functionName:d.NativeAPI.isExternalAdViewInitiated},d.handleIsInitiated,d.handleIsInitiatedFailure),a.promise()},addExternalAdViewIdAndSetStatus:function(e){C("_addExternalAdViewIdAndSetStatus");for(var t=e.externalAdViewId,i=e.isInReload,r=!1,a=0;a<f.length;a++){var o=f[a];o.id===t&&(r=!0,o.isInReload=i,C("_addExternalAdViewIdAndSetStatus | changed isInReload to "+i))}r?n.log("BannerExternalAdViewService | _addExternalAdViewIdAndSetStatus | "+t+" has been previously added",n.LogLevels.error):(0!==f.length&&(f=[]),f.push({id:t,isInReload:i}))},getViewVisibility:function(){if(C("_getViewVisibility | banner"),o&&"pending"===o.status)return o;o=new window.jQuery.Deferred;var e=t.PubSub.subscribe(i.CB+"."+d.handleGetViewVisibilitySuccess,(function(n){h(n)&&(C(d.handleGetViewVisibilitySuccess+" "+JSON.stringify(n)),t.PubSub.unsubscribe(e),t.PubSub.unsubscribe(r),o.resolve(n))})),r=t.PubSub.subscribe(i.CB+"."+d.handleGetViewVisibilityFailure,(function(i){h(i)&&(i&&i.errMsg&&n.log("BannerExternalAdViewService | Error calling "+d.handleGetViewVisibilityFailure+" with error "+i.errMsg,n.LogLevels.error),t.PubSub.unsubscribe(r),t.PubSub.unsubscribe(e),o.reject(i))}));return n.callSDKFunction(A(),{functionName:d.NativeAPI.getViewVisibility},d.handleGetViewVisibilitySuccess,d.handleGetViewVisibilityFailure),o.promise()},resetExternalAdViewsIdentifiers:y,removeExternalAdView:function(e,t,i){y(),n.callSDKFunctionWithCallback(A(),{functionName:d.NativeAPI.removeAdView,functionParams:{adViewId:e}},t,i)},getIsServiceInitiated:function(){return C("rony _getIsServiceInitiated: "+s),s}}}},{"./ExternalAdViewConstants.js":98,"./WPADUtils":102}],95:[function(e,t,n){t.exports=function(t,n,i,r){var a="BannerExternalContainer | ",o=e("./WPADUtils")(n),s=!1,l=!1,d=!1,c=!1,u=r,f=[];function p(e){l=e}function g(e){b("_setAdIsVisibleInContainer = "+e),s=e}function v(){return s}function m(){b("_resetReportAdVisibilityFlags"),p(!1),g(!1)}function h(){return b("_shouldReportAdVisible | containerID: "+u+" isAdLoadedInContainer: "+l+" | isAdVisibleInContainer "+s),l&&!s}function b(e){n.log(a+e)}return{setAdIsVisibleInContainer:g,resetReportAdVisibilityFlags:m,shouldReportAdVisibleForBanners:h,checkStatusOfAdView:function(){if(i.getIsServiceInitiated)return i.isExternalAdViewInitiated()},createAdUrlInAdView:function(e,t,n,r){b("_createAdUrlInAdView "+t.productType),m(),c=!0,i.getIsServiceInitiated&&i.loadWithUrl(e,t,n,r,(function(e){d=e,c=!1}))},updateAdInAdView:function(e,t,n,r){b("_updateAdInAdView "+t.productType),m(),i.getIsServiceInitiated&&i.updateAd(e,t,n,r)},sendMessageToExternalAdView:function(e){e&&u&&(e.adViewId||(e.adViewId=u)),i.getIsServiceInitiated&&i.sendMessage(e)},addExternalAdViewIdAndSetStatus:function(e){i.getIsServiceInitiated&&i.addExternalAdViewIdAndSetStatus(e)},onExternalViewLoaded:function(){b("_onExternalViewLoaded isAdVisibleInContainer="+v()),p(!0)},isAdInExternalViewLoaded:function(){return b("isAdInExternalViewLoaded "+l),l},onBannerViewLoaded:function(e,t){p(!0),i.getIsServiceInitiated&&i.getViewVisibility().then((function(n){i&&i.isContainerVisible(n)&&(e(),h()&&t())}))},resetExternalAdViewsIdentifiers:function(){i.getIsServiceInitiated&&i.resetExternalAdViewsIdentifiers()},getContainerID:function(){return b("_getContainerID: "+u),u},removeContainer:function(e,t){i.getIsServiceInitiated&&i.removeExternalAdView(u,e,t)},isVisible:v,isContainerLoaded:function(e){return!0===c&&t.PubSub.publish("BannerExternalContainer.duringCreation",[e]),d},init:function(){f.push(t.PubSub.subscribe("SDKController.AdVisible",(function(e){b("inside adVisibleHandler"),function(e){return b("_shouldRecieveMessage containerID: "+u+" adViewId: "+e.adViewId),!(!o.isBannerAd(e)||!o.isBannerAdViewId(u))||e.adViewId===u}(e)&&(b("got SDKController.AdVisible | setting visibility to true"),g(!0))})))},clean:function(){b("_clean"),t.PubSub.clearHandlers(f),i.getIsServiceInitiated&&i.destroy(),i=null}}}},{"./WPADUtils":102}],96:[function(e,t,n){t.exports=function({core:t,controller:n,constants:i,displayedAdManager:r,demandSourceId:a,originalDemandSourceName:o}){e("./ExternalAdViewConstants.js");var s="BannerHandlerDelegate | ",l=i.BN,d=[],c="";function u(e){var t=r.get();return t&&t.adViewId===e&&t.productType===i.BN}function f(e){e.productType=l,e.demandSourceName=a,e.originalDemandSourceName=o,e.displayedAd=r.get()}function p(e){n.log(s+e)}return{assignAdViewAndStartHandle:function(e){p("_assignAdViewAndStartHandle: "+e),e&&(c=e,d.push(t.PubSub.subscribe("removed."+c,(function(e){f(e),p("handle banner removed with id: "+e.adViewId+"for instance id: "+e.demandSourceId),u(e.adViewId)&&r.reset()}))),d.push(t.PubSub.subscribe("isVisible."+c,(function(e){f(e),!e.configs&&e.configs.productType&&e.configs.visibilityParams||(p("handle banner visible with id: "+e.adViewId+"for instance id: "+e.demandSourceId),function(e){if(!e)return!1;if(void 0!==e.isOffScreenView)return!e.isHidden&&e.isKeyWindow;return e.isViewVisible}(e.configs.visibilityParams)&&e.productType===i.BN&&t.PubSub.publish("Banner.isVisible",[e]))}))),d.push(t.PubSub.subscribe("destroy."+c,(function(e){f(e),p("handle banner destroy with id: "+e.adViewId+"for instance id: "+e.demandSourceId),e.isBNAutoRemove||function(e){t.PubSub.publish(i.BN+".reset",[e]);var a=r.get();u(e.adViewId)?n.OMIDService.finishSession(a).always((function(){t.PubSub.publish("SDKController.AdClose",[e])})):n.unloadAdViewByAdViewId(e.adViewId)}(e)}))),d.push(t.PubSub.subscribe("destroy."+a,(function(){t.PubSub.publish("destroy."+c,[{adViewId:c}])}))))},stopHandle:function(){p("stopHandle: "+c),t.PubSub.clearHandlers(d)}}}},{"./ExternalAdViewConstants.js":98}],97:[function(e,t,n){t.exports=function(e){var t,n={notCreated:0,duringCreation:1,createdSuccessfully:2,failedToCreate:3},i=n.notCreated,r=new window.jQuery.Deferred,a="failed to create native webview";function o(e){e!==i?(s("setState - new state: "+e),i=e,function(e){if(s("updatePromiseOnStateChange: "+e),"pending"!==r.state())return void s("updatePromiseOnStateChange - not in pending state - ignoring");e===n.createdSuccessfully?r.resolve():e===n.failedToCreate&&r.reject(a)}(e)):s("setState - already in state: "+e)}function s(t){e("ContainerCreationStateHandler | "+t)}return{getState:function(){return i},setState:o,getCreationStates:function(){return n},getCreationResultPromise:function(){return r.promise()},creationStarted:function(e){s("creationStarted"),o(n.duringCreation),t=setTimeout((function(){s("creation ended because of timeout"),o(n.failedToCreate)}),e||3e3)},creationEnded:function(e){s("creationEnded with result: "+e),clearTimeout(t),o(e?n.createdSuccessfully:n.failedToCreate)}}}},{}],98:[function(e,t,n){t.exports={CB:"NativeCallback",NativeAPI:{loadWithUrl:"loadWithUrl",updateAd:"updateAd",isExternalAdViewInitiated:"isExternalAdViewInitiated",sendMessage:"sendMessage",getViewVisibility:"handleGetViewVisibility",removeAdView:"removeAdView",linkActivation:"linkActivation"},nativeFunction:"bannerViewAPI",nativeFunctionAdViewAPI:"adViewAPI",handleContainerIsVisible:"containerIsVisible",handleContainerWasRemoved:"containerWasRemoved",performDestroyDisplayBanner:"performDestroyDisplayBanner",destroyBanner:"destroyBanner",cleanUpNonDisplayBanners:"cleanUpNonDisplayBanners",isBNAutoRemove:"isBNAutoRemove",handleIsInitiated:"containerAdViewStatus",handleIsInitiatedFailure:"containerAdViewStatusFailure",handleAdReplaced:"containerAdReplaced",handleMessage:"containerSendMessage",handleLoadWithUrlSuccess:"handleLoadWithUrlSuccess",handleLoadWithUrlFailure:"handleLoadWithUrlFailure",handleUpdateAdSuccess:"handleUpdateAdSuccess",handleUpdateAdFailure:"handleUpdateAdFailure",handleSendMessageSuccess:"handleSendMessageSuccess",handleSendMessageFailure:"handleSendMessageFailure",handleGetViewVisibilitySuccess:"handleGetViewVisibility",handleGetViewVisibilityFailure:"handleGetViewVisibilityFailure"}},{}],99:[function(e,t,n){t.exports=function(t,n,i,r){var a,o,s,l="ExternalAdViewService | ",d=e("../../constants/SDKFeatureNames"),c=e("./ExternalAdViewConstants.js"),u=e("./bannerLoadWhileShowHandler"),f=e("./WPADUtils")(n),p=[],g=c.nativeFunction;function v(){var e=r.get();e&&e.productType&&e.productType===i.BN&&r.reset()}function m(e){return!!e&&(void 0!==e.isOffScreenView?!e.isHidden&&e.isKeyWindow:e.isViewVisible)}function h(e){return e&&e.adViewId}var b={handleVisible:function(e){!function(e){var r=e.configs;!r&&r.productType&&r.visibilityParams||(n.log("ExternalAdViewService | "+c.handleContainerIsVisible),m(r.visibilityParams)&&r.productType===i.BN&&t.PubSub.publish(r.productType+".isVisible",[r]))}(e)},handleRemoved:function(e){n.log("ExternalAdViewService | bannerSingleInstancesHandler | "+c.handleContainerWasRemoved,n.LogLevels.error),v(),t.PubSub.publish(e.configs.productType+".reset",[e.configs])},handlePerformDestroy:function(e){n.log("ExternalAdViewService | bannerSingleInstancesHandler | handlePerformDestroy")}};function S(){return n.CompatibilityService.isFeatureSupportedInNativeSDK(d.bannerMultipleInstances)?u(t,n):b}function y(e){if(function(e){return I()===c.nativeFunction&&(!h(e)||f.isBannerAdViewId(e.adViewId))}(e))return!0;var t=h(e)&&D()===e.adViewId;return n.log("ExternalAdViewService | "+I()+" | handling message? "+t+"  message:"+JSON.stringify(e)),t}function A(e){w("sendMessage | "+JSON.stringify(e));var r=t.PubSub.subscribe(i.CB+"."+c.handleSendMessageFailure,(function(e){y(e)&&(e&&e.errMsg&&n.log("Error calling "+c.handleSendMessageFailure+" with error "+e.errMsg,n.LogLevels.error),t.PubSub.unsubscribe(r))}));if("string"==typeof e){var a=e.indexOf("$$");-1!==a&&(e=function(e,t){var n={},i=e.substr(t+2),r=i.indexOf("="),a=i.substr(0,r);return n.name=e.substr(0,t),n[a]=i.substr(r+1),n}(e,a))}n.callSDKFunction(I(),{functionName:c.NativeAPI.sendMessage,functionParams:{params:JSON.stringify(e)}},c.handleSendMessageSuccess,c.handleSendMessageFailure)}var C=function(e,t){A(e)};function I(){return g}function D(){return s}function w(e){n.log(l+e)}return{init:function(e,r){!function(e){if(w("_setNativeServiceApi | "+e),!e)return;g=e}(e),function(e){if(w("_setAdViewId | "+e),!e)return;s=e}(r),p.push(t.PubSub.subscribe(i.CB+"."+c.handleContainerIsVisible,(function(e){y(e)&&S().handleVisible(e)}))),p.push(t.PubSub.subscribe(i.CB+"."+c.handleContainerWasRemoved,(function(e){y(e)&&S().handleRemoved(e)}))),p.push(t.PubSub.subscribe(i.CB+"."+c.destroyBanner,(function(e){y(e)&&S().handlePerformDestroy(e)}))),p.push(t.PubSub.subscribe(i.CB+"."+c.NativeAPI.linkActivation,(function(e){y(e)&&(n.log("ExternalAdViewService |  "+c.NativeAPI.linkActivation+" params: "+JSON.stringify(e)),e.url&&t.Utils.decodeValues(e),t.PubSub.publish(i.CB+".linkActivationOnAd",[e]))}))),p.push(t.PubSub.subscribe(i.CB+"."+c.handleMessage,(function(e){y(e)&&function(e){try{var i=e.adViewId?e.adViewId:void 0,r=function(e,n){return function(i){var r={data:i,id:e};n&&(r=t.Utils.extend(r,{adViewId:n})),C(r,!0)}}(e.id,i);n.isAndroid()||t.Utils.decodeValues(e.arguments),e.arguments=t.Utils.extend(e.arguments,{callback:r}),i&&(e.arguments=t.Utils.extend(e.arguments,{adViewId:i})),t.PubSub.publish("SDKController."+e.method,[e.arguments])}catch(t){n.log("ExternalAdViewService | unable to parse message: "+e,n.LogLevels.error)}}(e)})))},destroy:function(){t.PubSub.clearHandlers(p)},loadWithUrl:function(e,r,a,o,s){w("_loadWithUrl | "+e),n.AdUtils.extendAdObjectWithConfig(e,r,a,o);var l,d,u,f=t.PubSub.subscribe(i.CB+"."+c.handleLoadWithUrlFailure,(function(i){y(i)&&(n.isAdDisplayed(r)?w("_loadWithUrl | isAdDisplayed=true"):(i&&i.errMsg&&(n.log("Error calling "+c.handleLoadWithUrlFailure+" with error "+i.errMsg+" url "+e,n.LogLevels.error),v(),t.PubSub.publish("SDKController.AdLoadError",[i])),t.PubSub.unsubscribe(f),s&&s(!1)))})),p=t.PubSub.subscribe(i.CB+"."+c.handleLoadWithUrlSuccess,(function(e){y(e)&&(s&&s(!0),w(c.handleLoadWithUrlSuccess),t.PubSub.unsubscribe(f),t.PubSub.unsubscribe(p))}));n.callSDKFunction(I(),{functionName:c.NativeAPI.loadWithUrl,functionParams:t.Utils.extend({urlForWebView:e},o,(l=parseFloat(n.getConfig().mobileSDKSettings.deviceOSVersion),d=l<=i.offScreenViewConfig.maximalVersionToSupport,u={shouldUseOffScreenViewInWebPresenter:!0,shouldUseOffScreenViewInAdContainer:d},u))},c.handleLoadWithUrlSuccess,c.handleLoadWithUrlFailure)},updateAd:function(e,r,a,o){n.log("ExternalAdViewService | _updateAd | "+JSON.stringify(r));var s={name:"updateAd",param:r};n.AdUtils.extendAdObjectWithConfig(e,r,a,o);var l=t.PubSub.subscribe(i.CB+"."+c.handleUpdateAdFailure,(function(e){y(e)&&(e&&e.errMsg&&n.log("Error calling "+c.handleUpdateAdFailure+" with error "+e.errMsg,n.LogLevels.error),t.PubSub.unsubscribe(l))}));n.callSDKFunction(I(),{functionName:c.NativeAPI.updateAd,functionParams:{params:JSON.stringify(s)}},c.handleUpdateAdSuccess,c.handleUpdateAdFailure)},sendMessage:A,isContainerVisible:m,isExternalAdViewInitiated:function(){if(n.log("ExternalAdViewService | isExternalAdViewInitiated |"),a&&"pending"===a.status)return a;a=new window.jQuery.Deferred;var e=t.PubSub.subscribe(i.CB+"."+c.handleIsInitiated,(function(i){y(i)&&(n.log("ExternalAdViewService | "+c.handleIsInitiated+" "+JSON.stringify(i)),t.PubSub.unsubscribe(e),t.PubSub.unsubscribe(r),a.resolve(i))})),r=t.PubSub.subscribe(i.CB+"."+c.handleIsInitiatedFailure,(function(i){y(i)&&(i&&i.errMsg&&n.log("Error calling "+c.handleIsInitiatedFailure+" with error "+i.errMsg,n.LogLevels.error),t.PubSub.unsubscribe(r),t.PubSub.unsubscribe(e),a.reject(i))}));return n.callSDKFunction(I(),{functionName:c.NativeAPI.isExternalAdViewInitiated},c.handleIsInitiated,c.handleIsInitiatedFailure),a.promise()},getViewVisibility:function(){if(w("_getViewVisibility | external container"),o&&"pending"===o.status)return o;if(o=new window.jQuery.Deferred,D()){var e=t.PubSub.subscribe(i.CB+"."+c.handleGetViewVisibilitySuccess,(function(n){y(n)&&(w(c.handleGetViewVisibilitySuccess+" "+JSON.stringify(n)),t.PubSub.unsubscribe(e),t.PubSub.unsubscribe(r),o.resolve(n))})),r=t.PubSub.subscribe(i.CB+"."+c.handleGetViewVisibilityFailure,(function(i){y(i)&&(i&&i.errMsg&&n.log("ExternalAdViewService | Error calling "+c.handleGetViewVisibilityFailure+" with error "+i.errMsg,n.LogLevels.error),t.PubSub.unsubscribe(r),t.PubSub.unsubscribe(e),o.reject(i))}));return n.callSDKFunction(I(),{functionName:c.NativeAPI.getViewVisibility,functionParams:{adViewId:D()}},c.handleGetViewVisibilitySuccess,c.handleGetViewVisibilityFailure),o.promise()}o.reject({errMsg:"adViewId is missing"})},removeExternalAdView:function(e,t,i){n.callSDKFunctionWithCallback(I(),{functionName:c.NativeAPI.removeAdView,functionParams:{adViewId:e}},t,i)},setBannerHandlerDelegate:function(e){e}}}},{"../../constants/SDKFeatureNames":118,"./ExternalAdViewConstants.js":98,"./WPADUtils":102,"./bannerLoadWhileShowHandler":105}],100:[function(e,t,n){var i=e("./ContainerCreationStateHandler"),r=e("./WPADUtils");t.exports=function(e,t,n,a){var o="ExternalContainer | ",s=new r(t),l=new i(t.log),d=!1,c=!1,u=a,f=null,p=[];function g(e){c=e}function v(e){S("_setAdIsVisibleInContainer = "+e),d=e}function m(){return d}function h(){S("_resetReportAdVisibilityFlags"),g(!1),v(!1)}function b(){return S("_getContainerID: "+u),u}function S(e){t.log(o+e)}return p.push(e.PubSub.subscribe("SDKController.AdVisible",(function(e){S("inside adVisibleHandler"),function(e){return S("_shouldReceiveMessage containerID: "+u+" adViewId: "+e.adViewId),!(!s.isBannerAd(e)||!s.isBannerAdViewId(u))||e.adViewId===u}(e)&&(S("got SDKController.AdVisible | setting visibility to true"),v(!0))}))),{setAdIsVisibleInContainer:v,resetReportAdVisibilityFlags:h,createAdUrlInAdView:function(t,i,r,a){S("_createAdUrlInAdView "+i.productType),h(),function(t){t.shouldCreateContainer=function(t){if(!e.Utils.isDefined(t.adSize))return!1;if(!e.Utils.isDefined(t.adSize.width)||!e.Utils.isDefined(t.adSize.height))return!1;return t.adSize.width>0&&t.adSize.height>0}(t)}(a),f&&f.assignAdViewAndStartHandle(b()),function(t){if(t||!t.productType)var n=e.PubSub.subscribe(t.productType+".GetConfig",(function(t){t.adViewId&&t.adViewId===u&&(e.PubSub.unsubscribe(n),l.creationEnded(!0))}))}(i),l.creationStarted(),n.loadWithUrl(t,i,r,a,(function(){S("native reported on webview creation")}))},sendMessageToExternalAdView:function(e){e&&u&&(e.adViewId||(e.adViewId=u)),n.sendMessage(e)},onExternalViewLoaded:function(e,t,i){g(!0),S("_onExternalViewLoaded"),e.displayOnAdReady&&n.getViewVisibility().then((function(e){n&&n.isContainerVisible(e)&&(m()||i())}))},isAdInExternalViewLoaded:function(){return S("isAdInExternalViewLoaded "+c),c},getContainerID:b,removeContainer:function(e,t){n.removeExternalAdView(u,e,t)},isVisible:m,isContainerLoaded:function(){return l.getState()===l.getCreationStates().createdSuccessfully},clean:function(){S("_clean"),e.PubSub.clearHandlers(p),f&&(f.stopHandle(),f=null),n.destroy(),n=null},getContainerCreationHandler:function(){return l},shouldReportAdVisible:function(){return c&&!d},setAdInstanceHandler:function(e){f=e}}}},{"./ContainerCreationStateHandler":97,"./WPADUtils":102}],101:[function(e,t,n){t.exports=function(e,t,n){var i={none:0,device:1,controller:2};function r(r,a,o,s){e.isIOS()&&(document.body.style.height=a.scrollHeight),n.setBackgroundColorByMode("Neutral",o),t.displayView(),e.callSDKFunction("setBackButtonState",{state:i.controller}),r(!1,!1,null),s();var l=document.getElementById("ssaNavigator");l.classList.remove("webNavigation"),l.classList.add("defaultNavigation"),e.isIOS()&&setTimeout((function(){e.callSDKFunction("navigationModeChange",{state:!1})}),70)}return{changeToNavigationMode:function(a,o,s,l,d){document.body.style.height="",n.setBackgroundColorByMode("Navigation","WebControls"),t.hideView(),t.hideLoader(),e.callSDKFunction("setBackButtonState",{state:i.device}),a(!1,null),function(t,n,i,a,o){function s(t){t.stopPropagation(),t.preventDefault(),e.callSDKFunction("removeCloseEventHandler"),e.callSDKFunction("controlSecondaryWebView",{action:"back"})}e.JQWrapper.bind(n,"touchend",(function(n){n.stopPropagation(),n.preventDefault(),e.JQWrapper.unbind(document.getElementById("ssaNavigatorBackButton"),"touchend",s),e.callSDKFunction("removeCloseEventHandler"),e.callSDKFunction("controlSecondaryWebView",{action:"close"}),r(t,i,a,o)})),e.JQWrapper.bind(document.getElementById("ssaNavigatorBackButton"),"touchend",s)}(a,o,s,l,d);var c=document.getElementById("ssaNavigator");c.classList.remove("defaultNavigation"),c.classList.add("webNavigation"),e.callSDKFunction("navigationModeChange",{state:!0})},returnFromNavigationMode:r}}},{}],102:[function(e,t,n){t.exports=function(t){var n=e("../../constants/SDKFeatureNames"),i=e("../../components/Constants.js"),r=e("../../components/OMIDConstants"),a="bannerAdView";function o(e){return e.productType===i.BN}return{generateAdViewId:function(e){return t.isBannerNoneLWS(e.productType)?a:t.AdUtils.generateUniqueAdId(e)},generateBannerAdViewId:function(){return i.bannerAdViewId},isBannerAdViewId:function(e){return-1!==e.indexOf(i.bannerAdViewId)},shouldDisplayAdOnExternalWebView:function(e,i){if(t.log("_shouldDisplayAdOnExternalWebView"),t.Utils.isWebWrapper())return!1;if(o(e))return!0;if(t.OMIDService.isAdOmidSupported(e)){var a=(s=t.OMIDService.getVersionData().omidVersion)&&r.omidVersionRequiresWebviewPerAd[s];return t.log("_shouldDisplayAdOnExternalWebView - OMID Ad - requires WPAD: "+a),a}var s;return function(e){return e&&!0===e.webviewPerAd}(i)?t.CompatibilityService.isFeatureSupportedInNativeSDK(n.webviewPerAdV1)?!i||0!==i.numOfBannersToInitSuccess||0!==i.numOfBannersToCache||(t.log("_shouldDisplayAdOnExternalWebView - numOfBannersToInitSuccess 0 , numOfBannersToCache 0"),!1):(t.log("_shouldDisplayAdOnExternalWebView - not supported for sdk version"),!1):(t.log("_shouldDisplayAdOnExternalWebView - wpad flag is off"),!1)},isBannerAd:o,getBannerAdViewId:function(){return a}}}},{"../../components/Constants.js":33,"../../components/OMIDConstants":61,"../../constants/SDKFeatureNames":118}],103:[function(e,t,n){t.exports=function(e,t,n,i,r,a){var o="Webview | ",s=!1,l=!1,d=!1,c=null,u={on:!1,productConfig:null};function f(){h("state- open: "+s+", viewable: "+l+"engaged "+d+" , productConfig: "+JSON.stringify(c))}function p(n,i){if(h("received event: "+n+" sendCloseRequest: "+JSON.stringify(u)),"close"===n&&v(i)){var r=t.DemandUtils.extendCallbackParamsWithParentProductConfig(i);e.PubSub.publish("SDKController.onAdWindowsClosed",[r]),t.callSDKFunction("onAdWindowsClosed",r)}}function g(){t.callSDKFunction("setForceClose",n.disable)}function v(e){return u.on&&u.productConfig===e?(u.on=!1,u.productConfig=null,f(),!0):(f(),!1)}function m(e){c=t.DemandUtils.extendCallbackParamsWithParentProductConfig(e,{}),d=!0,f()}function h(e){t.log(o+e)}return{setBackgroundColorByMode:function(e,t){"Navigation"===e?(r.setSDKWebviewBGColor(r.getSDKWebviewBGColorByProductType(t)),r.setControllerBGColor(r.getControllerBGColorByProductType(t))):"Neutral"===e&&(r.setControllerBGColor(r.getControllerBGColorByProductType(t)),r.setSDKWebviewBGColor(r.getSDKWebviewBGColorByProductType(t)))},display:function(n,o){if(n){if(t.isAndroid()||!s&&!l){var c=a.getAdDisplayOrientation(t.getConfig(),n);t.OrientationService.setOrientation(c)}else h("avoiding setOrientation for new displayed ad");if(s||l)return h("be might here because of next offer, engaged is "+d),void(d=!0);var u,p;p={adViewId:o},(u=n)&&u.productType?t.getNotchService().onSetConfig(u)?(r.setSDKWebviewBGColor(r.backgroundColors.semiTransparent,p),r.setControllerBGColor(r.backgroundColors.semiTransparent)):u.settings.setContainerBGColorBlack?r.setControllerBGColor(r.backgroundColors.black):(r.setSDKWebviewBGColor(r.getSDKWebviewBGColorByProductType(u.productType),p),r.setControllerBGColor(r.getControllerBGColorByProductType(u.productType))):r.setControllerBGColor(r.backgroundColors.darkGrey),g(),m(n),t.ViewsManager.init(n,o);var v=t.DemandUtils.extendCallbackParamsWithParentProductConfig(n,t.ViewsManager.getDisplayWebViewParams(!0)),b=function(n){var r={};if(t.isAndroid()){var a=n.settings&&n.settings.immersive;(r=e.Utils.extend(r,{immersive:a})).activityThemeTranslucent=!!n.settings.translucentView,r.removeViewOnDestroy=!0,n.settings.sambsfix&&(h("ctrWVPauseResume=true"),r.ctrWVPauseResume=!0)}return t.isIOS()&&(r=e.Utils.extend(r,{appOrientation:t.AppOrientationManager.getOrientation(),ModalPresentationStyle:i.iOS_UIModalPresentationFullScreen})),r}(n);h("display platformParams: "+JSON.stringify(b)),h("display displayParams: "+JSON.stringify(v));var S=e.Utils.extend(b,v,{});t.callSDKFunction(i.nativeInterfaceMethod.displayWebView,S),s=!0,f()}},hide:function(){s&&function(){var n,r=new window.jQuery.Deferred;t.log("webview | hide | "+JSON.stringify(c),t.LogLevels.verbose);var a=t.DemandUtils.extendCallbackParamsWithParentProductConfig(c,t.ViewsManager.getDisplayWebViewParams(!1));return n=e.PubSub.subscribe(i.CB+"."+i.nativeCallBacks.hideSuccess,(function(){e.PubSub.unsubscribe(n),r.resolve()})),t.callSDKFunction(i.nativeInterfaceMethod.displayWebView,a,i.nativeCallBacks.hideSuccess,i.nativeCallBacks.hideFailed),window.timerService.stopTimer(window.lastWebviewClosedTimer),window.lastWebviewClosedTimer=window.timerService.startTimer(),r.promise()}().then((function(){s=!1,u.productConfig=c,u.on=!0,f(),d||p("close",c)}))},setVisibility:function(e){l=e,f()},shouldNotifyClose:v,loadProduct:m,unloadProduct:function(){d=!1,f(),u.on&&p("close",c)},disableForceClose:g,setWebviewBGColorTransparent:function(){r.setControllerBGColor(r.backgroundColors.transparent)},setControllerBGColor:function(e){r.setControllerBGColor(r.getControllerBGColorByProductType(e))},getState:function(){return{engaged:d,opened:s,productConfig:c,viewable:l,standalone:false}},redraw:function(){t.isAndroid()&&t.getConfigurationHelper().getDeviceApiLevel()>=20&&(r.setSDKWebviewBGColor(r.backgroundColors.black),r.setSDKWebviewBGColor(r.backgroundColors.transparent))}}}},{}],104:[function(e,t,n){var i=e("./ExternalContainer"),r=e("./ExternalAdViewService"),a=e("./ExternalAdViewConstants"),o=e("./AdViewsCollections"),s=(e("../../constants/SDKFeatureNames"),e("./BannerHandlerDelegate"));t.exports=function(t,n,l,d){var c="WebViewManager | ",u=e("./WPADUtils")(n),f=new o({controller:n});function p(e){if(e)return g("_getAdViewByAd "+e.adViewId),f.getAdViewById(e.adViewId)}function g(e){n.log(c+e)}return{loadAdUnitUrlToView:function(e,o,p,v){if(function(e){t.PubSub.subscribe(e.productType+".reset",(function(e){g("webViewManager | reset"),f.toArray().forEach((function(e){e.getContainerID()===u.getBannerAdViewId()&&(f.removeAdViewById(e.getContainerID()),e.clean())}))}))}(e),n.log(c+"_loadAdUnitUrlToView"),o&&e){var m=function(e){var o=new r(t,n,l,d);e.adViewId=u.generateAdViewId(e),n.isBannerNoneLWS(e.productType)?o.init(a.nativeFunction,e.adViewId):o.init(a.nativeFunctionAdViewAPI,e.adViewId);return new i(t,n,o,e.adViewId)}(e);e=function(e,n){return e=t.Utils.extend(e,{adViewId:n}),e}(e,m.getContainerID()),f.add(m);var h=function(e,n){return e=t.Utils.extend(e,{adViewId:n}),e}(v,m.getContainerID());h=function(e,n){n.adSize&&(e=t.Utils.extend(e,{adSize:n.adSize}));return e}(h,e);var b=function(e,t){return e+"&"+l.adViewIdString+"="+t}(o,m.getContainerID());!function({productType:e,demandSourceId:i,originalDemandSourceName:r,externalContainer:a}){if(g("assignAdInstanceHandlerToExternalContainer | id: "+a.getContainerID()),!a)return;if(n.isBannerMultipleInstances(e)){var o=new s({core:t,controller:n,constants:l,displayedAdManager:d,demandSourceId:i,originalDemandSourceName:r});a.setAdInstanceHandler(o)}}({productType:e.productType,demandSourceId:e.demandSourceId,originalDemandSourceName:e.originalDemandSourceName,externalContainer:m}),m.createAdUrlInAdView(b,e,p,h)}else g("_loadAdUnitUrlToView without ad/url")},updateAdUnitUrl:function(e,t,n,i){},displayAdView:function(e,t,n,i){g("_displayAdView"),d.set(e),window.jQuery.when(i(e)).then((function(){g("_displayView after adunitOpenCallback"),t(!1),n()})).fail((function(t){e.showAdCallbacks&&e.showAdCallbacks.onShowFailed(t)}))},handleScreenVisible:function(e,t){g("_handleScreenVisible");var n=p(t);n.sendMessageToExternalAdView({message:"handleScreenVisible",adViewId:n.getContainerID()})},unloadAdView:function(e){g("_unloadAdView "+e.adViewId);var n=p(e);if(n){n.removeContainer((function(e){if(e&&e.adViewId===n.getContainerID()){g("_unloadAdView | successCallback | removed id"+e.adViewId);var i=f.removeAdViewById(n.getContainerID());t.Utils.isEmptyObject(i)||i.clean()}}),(function(e){if(e&&e.adViewId===n.getContainerID()){t.PubSub.publish("SDKController.removeContainerError",[e]),g("_unloadAdView | failCallback | id"+e.adViewId);var i=f.removeAdViewById(n.getContainerID());t.Utils.isEmptyObject(i)||i.clean()}}))}else g("_unloadAdView | ad is not engaged / no external container")},displayLoader:function(e){g("_displayLoader");var t=p(e);t&&t.sendMessageToExternalAdView({message:"displayLoader",adViewId:t.getContainerID()})},hideLoader:function(e){g("_hideLoader");var t=p(e);t&&t.sendMessageToExternalAdView({message:"hideLoader",adViewId:t.getContainerID()})},hideView:function(e){g("_hideView ad: "+JSON.stringify(e));var t=p(e);t&&t.sendMessageToExternalAdView({message:"hideFrame",adViewId:t.getContainerID()})},displayView:function(e){g("_displayView ad: "+JSON.stringify(e));var t=p(e);t&&t.sendMessageToExternalAdView({message:"displayFrame",adViewId:t.getContainerID()})},isContainerLoaded:function(e){var t=p(e),n=!!t&&t.isContainerLoaded();return g("_isContainerLoaded: "+n),n},onAdUnitLoaded:function(e,t,n){g("_onAdUnitLoaded");var i=p(e);i&&(i.isAdInExternalViewLoaded()?g("already received the loaded event for container"):(i.onExternalViewLoaded(e,t,n),g("ad loaded:"+e.id)))},isAdViewExistForAd:function(e){return g("_isAdViewExistForAd"),!!e&&f.isExist(e.adViewId)},getAdViewByAd:p,sendMessageToDisplayedAdView:function(e){g("_sendMessageToDisplayedAdView");var t=p(d.get());t&&t.sendMessageToExternalAdView(e)},sendMessageToAllAdViews:function(e){g("_sendMessageToAllAdViews"),f.toArray().forEach((function(t){t.sendMessageToExternalAdView(e)}))},getDisplayedAdView:function(e){g("_getDisplayedAdView ad: "+JSON.stringify(e));var t=p(e);return t&&(g("external container visible="+t.isVisible()),t.isVisible())?t:null},isViewDisplayed:function(e){return e.isVisible()},getContainerCreationHandler:function(e){var t=p(e);return t?t.getContainerCreationHandler():null}}}},{"../../constants/SDKFeatureNames":118,"./AdViewsCollections":91,"./BannerHandlerDelegate":96,"./ExternalAdViewConstants":98,"./ExternalAdViewService":99,"./ExternalContainer":100,"./WPADUtils":102}],105:[function(e,t,n){const i=e("./ExternalAdViewConstants.js");t.exports=function(e,t){return{handleVisible:function(n){n.adViewId&&(t.log("ExternalAdViewService | bannerMultipleInstancesHandler| handleVisible: isVisible."+n.adViewId,t.LogLevels.error),e.PubSub.publish("isVisible."+n.adViewId,[n]))},handleRemoved:function(n){n.adViewId&&(t.log(" ExternalAdViewService | bannerMultipleInstancesHandler | "+i.handleContainerWasRemoved,t.LogLevels.error),e.PubSub.publish("removed."+n.adViewId,[n]))},handlePerformDestroy:function(n){n.adViewId&&(t.log(" ExternalAdViewService | bannerMultipleInstancesHandler | handlePerformDestroy params.adViewId="+n.adViewId),e.PubSub.publish("destroy."+n.adViewId,[n]))}}}},{"./ExternalAdViewConstants.js":98}],106:[function(e,t,n){t.exports=function(t,n,i){var r,a,o=e("../OrientationUtils.js")(),s=i.appInfo.orientation.none,l=!1,d={free:i.appInfo.orientation.none,portrait:i.appInfo.orientation.portrait,landscape:i.appInfo.orientation.landscape};function c(e,t,n){l=!1;var i=d[(e||"").toLowerCase()];if(i)return l=!0,i;if(!n)return t;var r=n.viewControllerToPresentFrom||n.topMostViewControllerOrientation,a=o.sharedOrientationBetweenOrientations(r,n.windowOrientation),s=function(e){if(o.isContainPortrait(e)&&o.isContainLandscape(e))return d.free;return o.isContainPortrait(e)?d.portrait:d.landscape}((a&&a.length>0?o.convertOrientationsArrayToNumber(a):r||n.windowOrientation).toString());return s!==t&&(l=!0),s}return{init:function(t,i){var o=new(e("../../patches/PublisherPatchEasybrain.js"))(n.getConfigurationHelper()).shouldSetAppOrientationPortrait;r=o(n.getConfig())?d.portrait:t,a=i.appOrientation,s=c(r,a,i.orientationRestriction)},getOrientation:function(){return s},isAppOrientation:function(e){return s===e},isChangedExternally:function(){return l},updateAppOrientationByNewRestriction:function(e){e&&function(e,n){e!==n&&t.PubSub.publish("AppOrientationManager.appOrientationChanged",[{appOrientation:n}])}(s,s=c(r,a,e))}}}},{"../../patches/PublisherPatchEasybrain.js":208,"../OrientationUtils.js":69}],107:[function(e,t,n){function i(e,t,n){var i=n||{},r,a,o=!1,s=t.Cache,l={campaignsOnly:"campaignsOnly",globalsOnly:"globalsOnly",globalsAndCampaigns:"globalsAndCampaigns"},d=!1,c=!1;function u(e){d=e}function f(e,t,n){return s.cacheAds(i,e,t,n)}function p(n,r,a){return setTimeout((function(){!0,t.log("Time out in update cache. Fallback to non-precache.",t.LogLevels.error),e.PubSub.publish("PrecacheManager.fallbackToNonPrecache",[{demandSourceName:i.demandSourceName,productType:i.productType}]),g(!1),e.PubSub.publish("Cache.StopCacheUpdate",[{demandSourceName:i.demandSourceName,productType:i.productType}]),u(!1),s.clearCacheByType(i,[]).then((function(){r()})).fail((function(){var e="Error deleting globals in fallback to NPC";t.log(e,t.LogLevels.error),a(e)}))}),i.nonPrecacheFallback)}function g(e){r=e}function v(n){a=p(o,n.cacheTimeoutSuccessCallback,n.cacheTimeoutFailCallback),u(!0),f(n.applicationKey,n.newAdsToEnterCache,n.adAssetsCacheConfig).then((function(){t.log("PM | success",t.LogLevels.verbose),clearTimeout(a),o||(t.log("cache update completed",t.LogLevels.verbose),u(!1),e.PubSub.publish("PrecacheManager.cacheAdsSuccessCallback",[i]))}),(function(t,r,s){if(clearTimeout(a),!o){u(!1),e.PubSub.publish("PrecacheManager.cacheAdsFailedCallback",[{productType:i.productType,demandSourceName:i.demandSourceName,deletedOffers:r,deletedAdsData:s,errorLog:"Error adding new ads from queue, some campaigns were deleted.",cacheParam:t,inventoryId:n.inventoryId}])}}))}function m(n){t.log("PrecacheManager | updateConfig"),i=e.Utils.extend(i,n)}function h(t){var n=t.numOfCampaigns||0,r=t.settings||{};return m({settings:r}),r.numOfBannersToInitSuccess>=0&&n>0&&r.numOfBannersToCache>0?(r.numOfBannersToCache<r.numOfBannersToInitSuccess&&(r.numOfBannersToInitSuccess=r.numOfBannersToCache),n<r.numOfBannersToInitSuccess&&(r.numOfBannersToInitSuccess=n),n<r.numOfBannersToCache&&(r.numOfBannersToCache=n),g(!0),r.maxCachedCampaigns=i.maxCachedCampaigns,s.setSettings(i,r)):(r.numOfBannersToInitSuccess=r.numOfBannersToCache=0,g(!1)),e.Utils.returnResolvedPromise()}function b(e){return e&&e.cacheBase===i.cacheBase}function S(){e.PubSub.subscribe("Cache.cacheUpdated",(function(t){b(t)&&(t=e.Utils.extend(t,i),e.PubSub.publish("PrecacheManager.cacheUpdatedCallback",[t]))})),e.PubSub.subscribe("Cache.campaignDeleted",(function(t){b(t)&&(t=e.Utils.extend(t,i),e.PubSub.publish("PrecacheManager.campaignDeletedCallback",[t]))})),e.PubSub.subscribe("Cache.campaignSaved",(function(t){if(b(t)){var n=e.Utils.extend(!0,{},t,i);e.PubSub.publish("PrecacheManager.campaignSavedCallback",[n])}})),e.PubSub.subscribe("Cache.campaignDownloadStarted",(function(t){b(t)&&(t=e.Utils.extend(t,i),e.PubSub.publish("PrecacheManager.campaignDownloadStartedCallback",[t]))})),e.PubSub.subscribe("Cache.preProcessingFailed",(function(t){b(t)&&(t=e.Utils.extend(t,i),e.PubSub.publish("PrecacheManager.preProcessingFailedCallback",[t]))}))}function y(){return r}function A(){var e,n,r=new window.jQuery.Deferred,a=y();function o(e){r.resolve(e)}return i.settings.purgeCacheOnInit?(n="purge cache on init (settings)",e=!0):a||(n="purge cache on non-precache",e=!0),e?(t.log("handleCacheClear purge reason: "+n,t.LogLevels.verbose),s.clearCacheByType(i,[]).then(o.bind(null,l.campaignsOnly),(function(){r.reject("Error in clearing cache")}))):o(),r.promise()}function C(n){y()&&(u(!0),s.cacheNext(i,n).always((function(){u(!1)})).fail((function(n,r,a){t.log("line[451]: failed updating cache on cache next with deletedAds: "+r,t.LogLevels.verbose),r&&r.length>0&&e.PubSub.publish("PrecacheManager.cacheNextFail",[{productType:i.productType,demandSourceName:i.demandSourceName,deletedAds:r,deletedAdsData:a,inventoryId:r[0].inventoryId}])})))}function I(){return l}function D(){return s.getNextAvailableAd(i)}function w(e){return s.clearCacheByType(i,e)}function P(t,n){return n=e.Utils.isDefined(n)?n:i.settings.numOfBannersToCache,s.mergeCampaigns(t,n,i.settings.maxCachedCampaigns,i)}function O(e,t){return s.areCampaignsAvailable(e,t,i)}function F(){return s.getCacheSizeByType(i)}function T(){return s.incrementNextCampaign(i)}function x(e){return s.getCurrentAd(i,e)}function U(e){return s.isNextAvailable(i,e)}function N(){return s.cacheNext(i)}function L(e,t){return s.setAdInventoryIndex(i,e,t)}function V(e){return s.isAdInCache(i,e)}function M(e){return s.setSettings(i,e)}function R(){c||(c=!0,S(),s.initCacheBase(i.cacheBase))}function k(e){return s.getAdStatusInQueue(i,e)}function K(e){return s.deleteCachedCampaign(i,e)}function B(e,t){return s.cacheSingleAd(i,e,t)}var E={updateConfig:m,init:R,decidePrecacheStatus:h,isPrecache:y,handleCacheClear:A,mergeCampaigns:P,handleCacheAds:v,updateCache:C,clearCacheByType:w,areCampaignsAvailable:O,getCacheSizeByType:F,setAdInventoryIndex:L,incrementNextCampaign:T,getCurrentAd:x,isAdInCache:V,getAdStatusInQueue:k,setCacheSettings:M,getNextAvailableAd:D,isNextAvailable:U,getCacheClearMessages:I,cachingStatus:s.cachingStatus,deleteCachedCampaign:K,cacheSingleAd:B,getConfig:function(){return i}};return E}t.exports=i},{}],108:[function(e,t,n){t.exports=function(t){var n=e("./SDKPluginTypeConstants.js");return{shouldShowInStandAloneView:function(e){var i=e.SupplyConfigurations.getNetworkConfigValueByKey(n.flags.showStandaloneViewInAdobe);return null!==i&&t.isDefined(i)||(i=!0),e.log("AdobeAirPluginHandler | shouldShowInStandAloneView | useStandAloneView: "+i),i}}}},{"./SDKPluginTypeConstants.js":109}],109:[function(e,t,n){t.exports={supportedPluginNames:{adobeAir:"AdobeAir"},flags:{showStandaloneViewInAdobe:"showStandaloneViewInAdobe"}}},{}],110:[function(e,t,n){t.exports=function(t,n){var i=e("./SDKPluginTypeConstants.js");function r(r){return(a=r).applicationSettings&&a.applicationSettings.SDKPluginType&&a.applicationSettings.SDKPluginType===i.supportedPluginNames.adobeAir?(t.log("SDKPluginTypeHandler | createPluginHandler | creating adobe handler"),new(e("./AdobeAirPluginHandler.js"))(n)):(t.log("SDKPluginTypeHandler | createPluginHandler | plugin handler is not required"),null);var a}return{shouldShowInStandAloneView:function(e){t.log("SDKPluginTypeHandler | shouldShowInStandAloneView");var n=r(e);return n&&"function"==typeof n.shouldShowInStandAloneView?n.shouldShowInStandAloneView(t):(t.log("SDKPluginTypeHandler | shouldShowInStandAloneView | "+(n?"function not supported in handler":"no plugin handler")),!1)}}}},{"./AdobeAirPluginHandler.js":108,"./SDKPluginTypeConstants.js":109}],111:[function(e,t,n){t.exports={versions:{SKAN1:1,SKAN2:2,SKAN4:4},applicationSettingsKeys:{skd:"skd",skanv:"skanv",atid:"atid",providers:"providers",skanIds:"skanIds"},controllerConfigKeys:{SKANData:"SKANData",version:"version",sourceAppTrackID:"sourceAppTrackID",adNetworkIDs:"adNetworkIDs"},nativeParamsKeys:{adNetworkId:"adNetworkId",adNetworkCampaignId:"adNetworkCampaignId",id:"id",adNetworkNonce:"adNetworkNonce",adNetworkImpressionTimestamp:"adNetworkImpressionTimestamp",adNetworkAttributionSignature:"adNetworkAttributionSignature",adNetworkPayloadVersion:"adNetworkPayloadVersion",adNetworkSourceAppStoreIdentifier:"adNetworkSourceAppStoreIdentifier",sourceIdentifier:"sourceIdentifier"},SKAdImpression:{minimalSupportedIOSVersion:14.5,jsInterface:"SKAdImpressionAPI",startImpression:"startImpression",startImpressionSuccess:"startImpressionSuccess",startImpressionFailed:"startImpressionFailed",endImpression:"endImpression",endImpressionSuccess:"endImpressionSuccess",endImpressionFailed:"endImpressionFailed"}}},{}],112:[function(e,t,n){t.exports=function(){var t=e("./SKANConstants");function n(e,t,n){var i={};return e&&(i.SKANVersion=e),t&&(i.SKANSourceAppTrackID=t),n&&Array.isArray(n)&&n.length>0&&(i.SKANAdNetworkIDs=n.toString()),i}function i(e){if(!e)return{};var n=parseFloat(e.version);return n?n<t.versions.SKAN2?a(e):n<t.versions.SKAN4?o(e):s(e):r(e)}function r(e){var n={};return n[t.nativeParamsKeys.id]=e.advertisedAppTrackID||e.appId,n}function a(e){var n=r(e);return n[t.nativeParamsKeys.adNetworkId]=e.adNetworkID,n[t.nativeParamsKeys.adNetworkImpressionTimestamp]=e.timestamp,n[t.nativeParamsKeys.adNetworkNonce]=e.nonce&&e.nonce.toLowerCase(),""===n[t.nativeParamsKeys.adNetworkNonce]&&(n[t.nativeParamsKeys.adNetworkNonce]="00000000-0000-0000-0000-000000000001"),n[t.nativeParamsKeys.adNetworkAttributionSignature]=e.signature,e.hasOwnProperty("SKANCampaignID")&&(n[t.nativeParamsKeys.adNetworkCampaignId]=e.SKANCampaignID),n}function o(e){var n=a(e);return n[t.nativeParamsKeys.adNetworkPayloadVersion]=e.version,n[t.nativeParamsKeys.adNetworkSourceAppStoreIdentifier]=e.sourceAppTrackID,n}function s(e){var n=o(e);return n[t.nativeParamsKeys.sourceIdentifier]=e.sourceID,n}function l(e,t){return window.SSA_CORE.Utils.extend({},e.settings&&e.settings.SKANData,e.ext&&e.ext.SKANData,e.ext&&e.ext.SKANData&&e.ext.SKANData[t])}return{extractDataForPayload:function(e,i){var r=function(e){var i=!!e&&e[t.applicationSettingsKeys.skd];if(!i)return{};var r=i[t.applicationSettingsKeys.skanv],a=i[t.applicationSettingsKeys.atid],o=i[t.applicationSettingsKeys.providers],s=[];if(o)for(var l of Object.keys(o))if(o[l]){var d=o[l][t.applicationSettingsKeys.skanIds];d&&Array.isArray(d)&&d.length>0&&(s=s.concat(d))}return n(r,a,s)}(i);return 0===Object.keys(r).length&&(r=function(e){if(!e)return{};var i=e[t.controllerConfigKeys.SKANData];if(!i)return{};var r=i[t.controllerConfigKeys.version],a=i[t.controllerConfigKeys.sourceAppTrackID],o=i[t.controllerConfigKeys.adNetworkIDs];return n(r,a,o)}(e)),r},extractDataForSKAdImpression:function(e){var n=l(e,"VTA");return parseFloat(n.version)<t.versions.SKAN4?o(n):s(n)},buildStoreKitLoadDataForSDK:function(e,t){if(!e)return{};var n={appId:e.appId,viewUniqueId:t,storeKitLoadParams:i(e)};return e.ppid&&(n.storeKitLoadParams.ppid=e.ppid),n},extractDataForSKOverlay:function(e){return e?i(l(e,"StoreKit")):{}}}}},{"./SKANConstants":111}],113:[function(e,t,n){t.exports=function(e,t,n,i){var r=parseInt(e),a=0,o=function(e){return!!r&&(-1!==n.storeKit.loadFailuresToPreventRetry.indexOf(e)?(i("StoreKitLoadingRetryExecutor | _shouldPerformRetry | stop executing retries for reason: "+e),!1):(a>=r&&i("StoreKitLoadingRetryExecutor | _shouldPerformRetry | All retries attempts exhausted"),a<r))};return{shouldPerformRetry:o,performRetry:function(){a++,"function"==typeof t&&(i("StoreKitLoadingRetryExecutor | _performRetry | Performing retry attempt #"+a),t())},getCurrentAttempt:function(){return a},cancelAdditionalRetryAttempts:function(){o=function(){return!1}}}}},{}],114:[function(e,t,n){t.exports=function(t,n,i){var r=e("../../patches/PatchStoreKitOsVersion"),a=e("./SKANModel")(),o=e("../../constants/SDKFeatureNames"),s=e("./StoreKitLoadingRetryExecutor"),l=e("./storeKitObject").DisplayStatus,d="NativeCallback",c={};function u(e){return e.viewIdentifier?e.viewIdentifier:e.viewUniqueId}function f(e,n){var i={message:"cool down time out is over "+e,productType:n.adProductType,demandSourceName:n.adDemandSourceName};t.PubSub.publish("StoreKit.storeKitCoolDown",[i])}function p(e,r){var f,S=u(e),y=function(e){var t=3e4;if(!e.productType)return t;return e.storeKitLoadingTimeout||t}(e),A=r||s(e.loadRetryAttempts,(function(){clearTimeout(f),h(S),p(e,A)}),i,n.log);if(b(e)){var C=a.buildStoreKitLoadDataForSDK(e,S);"00000000-0000-0000-0000-000000000001"===C.storeKitLoadParams.adNetworkNonce&&n.postAdUnitEvent({name:"appStoreInsideEmptyNonce"},!1),C=t.Utils.extend(C,{useCustomRootView:!0}),n.callSDKFunction("preLoadAppPage",C,"preloadAppInstallPageSuccess","preloadAppInstallPageFailure");var I=t.PubSub.subscribe(d+".appStoreInsideLoaded",(function(n){if(n&&"object"==typeof n&&n.viewUniqueId&&n.viewUniqueId===S){clearTimeout(f),t.PubSub.unsubscribe(I),e.callback&&(n.isLoaded||(n.currentLoadRetryAttempt=A.getCurrentAttempt()),e.callback.call(null,n));var i=n.errMsg&&decodeURIComponent(n.errMsg);!n.isLoaded&&A.shouldPerformRetry(i)&&A.performRetry()}})),D=t.PubSub.subscribe(d+".appStoreFailedToDisplayStoreKit",(function(e){n.log("appStoreFailedToDisplayStoreKit error",n.LogLevels.verbose);var i,r=decodeURIComponent(e.error);e.viewUniqueId=u(e),e.viewUniqueId!==S&&n.log("appStoreFailedToDisplayStoreKit params.viewUniqueId= "+e.viewUniqueId+" viewUniqueId= "+S,n.LogLevels.verbose),i=r,t.PubSub.publish("StoreKit.storeKitDisplayFailed",[i]),c[e.viewUniqueId]&&c[e.viewUniqueId].setShowingState(l.NON_VISIBLE,!1)})),w=t.PubSub.subscribe(d+".appStoreInsideDisplayStoreKit",(function(e){if(e.viewUniqueId=u(e),n.log("appStoreInsideDisplayStoreKit "+e.viewUniqueId,n.LogLevels.verbose),e.viewUniqueId===S){c[e.viewUniqueId]&&c[e.viewUniqueId].setShowingState(l.SHOW,!1);var i=t.Utils.extend({name:"appStoreInsideVisible",shouldPreloadStoreKitOnStoreKitClose:v()},e);n.postAdUnitEvent(i),g(!1,"storeKitOpen"),n.SKOverlayManager.onSKOpen()}})),P=t.PubSub.subscribe(d+".appStoreInsideClosed",(function(e){e.viewUniqueId===S&&(!1!==e.didStoreKitPresent&&!1!==e.isClosed?(T(e),n.SKOverlayManager.onSKClose()):F(e))})),O=t.PubSub.subscribe("SDKController.ClearAppPage",(function(e){e.viewUniqueId===S&&(n.checkRequiredCallbackParams(["viewUniqueId"],e,"ClearAppPage").didSucceed?(t.PubSub.unsubscribe(O),x()):n.log("error calling clear App install page with "+JSON.stringify(e),n.LogLevels.error))})),F=function(e){A.cancelAdditionalRetryAttempts(),n.CompatibilityService.isFeatureSupportedInNativeSDK(o.loadStoreKitOncePerAd)&&m()&&h(e.viewUniqueId),n.log("storeKit Failed to Load ",n.LogLevels.verbose),x()},T=function(e){c[e.viewUniqueId]&&c[e.viewUniqueId].setShowingState(l.NON_VISIBLE,!1);var i=t.Utils.extend({name:"appStoreInsideClosed",shouldPreloadStoreKitOnStoreKitClose:v()},e);n.postAdUnitEvent(i),g(!0,"storeKitClose"),v()&&(t.PubSub.unsubscribe(w),t.PubSub.unsubscribe(P),h(e.viewUniqueId))},x=function(){t.PubSub.unsubscribe(I),t.PubSub.unsubscribe(P),t.PubSub.unsubscribe(w),t.PubSub.unsubscribe(D)};f=setTimeout((function(){n.log("reach appstoreinside loading timeout",n.LogLevels.verbose),n.postAdUnitEvent({name:"appStoreLoadingTimeout",viewUniqueId:S,currentLoadRetryAttempt:A.getCurrentAttempt(),errMsg:i.storeKit.loadingTimeoutMessage},!0),A.shouldPerformRetry(i.storeKit.loadingTimeoutMessage)?A.performRetry():(x(),h(S))}),y)}}function g(e,n){var i={isViewable:e,changeReason:n};t.PubSub.publish(d+".viewableChange",[i])}function v(){return!n.CompatibilityService.isFeatureSupportedInNativeSDK(o.loadStoreKitOncePerAd)||!m()}function m(){return parseFloat(n.getConfigurationHelper().getDeviceOsVersion())<15.5}function h(e){if(b()){if(!e)return;n.callSDKFunction("clearAppPage",{viewUniqueId:e})}}function b(e){if(!n.isIOS())return!1;try{if(parseInt(n.getConfig().mobileSDKSettings.deviceApiLevel)<i.storeKit.minimalSupportedOSVersion)return!1}catch(e){n.log("StoreKitService | isStoreKitSupported | failed to parse deviceApiLevel as integer")}return!r(t.Utils,n.CompatibilityService).shouldBlock(n.getApiData({deviceOSVersion:1}).deviceOSVersion)&&(!e||!0!==e.standaloneView)}return t.PubSub.subscribe("SDKController.PreloadAppInstallPage",(function(e){n.log("SDKController.PreloadAppInstallPage"),n.checkRequiredCallbackParams(["appId"],e,"preloadAppInstallPage").didSucceed?p(e,null):n.log("error calling preload App install page with "+JSON.stringify(e),n.LogLevels.error)})),t.PubSub.subscribe("SDKController.ClearAppPage",(function(e){e.viewUniqueId=u(e),n.checkRequiredCallbackParams(["viewUniqueId"],e,"ClearAppPage").didSucceed?e&&e.viewUniqueId&&h(e.viewUniqueId):n.log("error calling clear App install page with "+JSON.stringify(e),n.LogLevels.error)})),{updateAdWithStoreAppId:function(e,t){if(e&&e.ext&&e.ext.clickTags&&e.ext.clickTags.storeAppId&&!b(t)&&delete e.ext.clickTags.storeAppId,t&&(void 0===(r=t.extractAppIdForStoreKit)||r)&&b(t)&&e&&e.ext&&e.ext.clickTags&&!e.ext.clickTags.storeAppId&&e.ext.clickTags.pixelURL){var i=n.AdUtils.getStoreAppId(e);i&&(e.ext.clickTags.storeAppId=i)}var r;return e},getViewUniqueId:u,isStoreKitVisible:function(){for(var e=Object.keys(c),t=0;t<e.length;t++)if(c[e[t]].getIsShowing())return!0;return!1},canPresentStoreKitObj:function(e){return e&&e.getIsNonVisible()},setStoreKitObjectPresentingProgress:function(e){e&&e.setShowingState(l.IN_PROGRESS,!0)},getStoreObject:function(t,n){return c[t]||(c[t]=new(e("./storeKitObject").StoreKitObject)(t,n,1500,f)),c[t]}}}},{"../../constants/SDKFeatureNames":118,"../../patches/PatchStoreKitOsVersion":206,"./SKANModel":112,"./StoreKitLoadingRetryExecutor":113,"./storeKitObject":115}],115:[function(e,t,n){"use strict";var i;Object.defineProperty(n,"__esModule",{value:!0}),function(e){e[e.NON_VISIBLE=0]="NON_VISIBLE",e[e.IN_PROGRESS=1]="IN_PROGRESS",e[e.SHOW=2]="SHOW"}(i||(i={}));t.exports={StoreKitObject:class{constructor(e,t,n,r){this.viewUniqueId=e,this.demandSourceData=t,this.coolDownTimeout=n,this.sendEventCoolDown=r,this.showState=i.NON_VISIBLE}getUniqueId(){return this.getUniqueId()}getIsNonVisible(){return this.showState===i.NON_VISIBLE}getIsShowing(){return this.showState===i.SHOW}setShowingState(e,t){this.showState=e,t&&setTimeout((()=>{this.showState===i.IN_PROGRESS&&(this.showState=i.NON_VISIBLE,this.sendEventCoolDown(this.viewUniqueId,this.demandSourceData))}),this.coolDownTimeout)}},DisplayStatus:i}},{}],116:[function(e,t,n){t.exports={NativeAPI:{failCallback:"updateTokenFail",successCallback:"updateTokenSuccess"},ControllerNativeAPI:{updateToken:"updateToken"},tokenAPI:"iabTokenAPI",payloadKeys:{common:{biddingRVImpressions:!0,biddingISImpressions:!0,totalRVSessionImpressions:!0,totalISSessionImpressions:!0,auid:!0,ici:!0},android:{gpi:!0,blacklistedCampaigns:!0},ios:{}}}},{}],117:[function(e,t,n){const i=e("../../modules/DemandSource/PayloadBuilderConstants");t.exports=function(t,n,r,a,o){var s=e("./TokenConstants");return t.PubSub.subscribe(r.CB+"."+s.NativeAPI.failCallback,(function(e){n.log("TokenService | updateTokenFail: "+JSON.stringify(e));var t=e.errMsg?e.errMsg:"unknown";a.report(o.updateTokenFail,{generalMessage:t})})),{updateToken:function(e){var i=function(e){if(!e)return{};var i={},r=s.payloadKeys.common;for(var a in r=t.Utils.extend(r,s.payloadKeys[n.getConfig().mobileSDKSettings.deviceOs]))r.hasOwnProperty(a)&&e.hasOwnProperty(a)&&(i[a]=e[a]);return i}(e);n.log("TokenService | _updateNativeToken | data: "+JSON.stringify(i)),0!==Object.keys(i).length&&n.callSDKFunction(s.tokenAPI,{functionName:s.ControllerNativeAPI.updateToken,functionParams:i},null,s.NativeAPI.failCallback)},getToken:function(){var e,r,a=window.jQuery.Deferred();return e=t.PubSub.subscribe(i.CB+"."+i.callbacks.getTokenSuccess,(function(n){var i;i=n,t.PubSub.clearHandlers([e,r]),a.resolve(i)})),r=t.PubSub.subscribe(i.CB+"."+i.callbacks.getTokenFailed,(function(o){let s=i.errorLog+":";var l;s+=o&&o.errMsg?o.errMsg:"",n.log(s,n.LogLevels.error),l=s,t.PubSub.clearHandlers([e,r]),a.reject(l)})),n.callSDKFunction(i.nativeFunction,{functionName:i.nativeAPI.getToken},i.callbacks.getTokenSuccess,i.callbacks.getTokenFailed),a.promise()}}}},{"../../modules/DemandSource/PayloadBuilderConstants":151,"./TokenConstants":116}],118:[function(e,t,n){t.exports={bannerMultipleInstances:"bannerMultipleInstances",storeKitDismissVCOnFinishCallback:"storeKitDismissVCOnFinishCallback",limitAppFiltering:"disableCheckInstalledAppsJSInterface",noPackagesInstallationPolling:"noPackagesInstallationPolling",webviewPerAdV1:"webviewperad-v1",loadStoreKitOncePerAd:"loadStoreKitOncePerAd",SKAdImpression:"SKAdImpression",SKOverlay:"SKOverlay",bannersOpenMeasurement:"bannersOpenMeasurement",initRecovery:"initRecovery"}},{}],119:[function(e,t,n){t.exports={pullingNativeDeviceData:{ios:"5.76",android:"5.81"},mutableAdvertingTrackingData:{ios:"5.79",android:"99"}}},{}],120:[function(e,t,n){var i={ext:{clickTags:{backgroundLandscape:"",backgroundPortrait:""},videoData:{videoPoster:"",videoSource:{videoformat_mp4:""}},appData:{appIcon:"",appImages:{both:[],portrait:[],landscape:[]}}}},r={ext:{videoData:{videoSource:{vast:""}}}},a={ext:{vastData:{xmlResponse:""}}},o={ext:{videoData:{videoPoster:"",videoSource:{videoformat_mp4:""}},appData:{appIcon:{url:""},appImages:[{url:""}]},imageData:{landscape:"",portrait:""}}},s={ext:{imageData:{landscape:"",portrait:""},layoutData:{portrait:{closeButtonUrl:"",frameUrl:""},landscape:{closeButtonUrl:"",frameUrl:""}}}},l={ext:{videoData:{videoPoster:"",videoSource:{videoformat_mp4:""}},layoutData:{html:""}}},d={ext:{videoData:{videoSource:{videoformat_mp4:""}},clickTags:{backgroundLandscape:""}}},c={ext:{videoData:{videoSource:{htmlURL:""}}}},u={ext:{videoData:{videoSource:{videoformat_mp4:""}},appData:{appIcon:""}}},f={ext:{videoData:{videoPoster:"",videoSource:{videoformat_mp4:""}},imageData:{landscape:"",portrait:""},layoutData:{portrait:{closeButtonUrl:"",frameUrl:""},landscape:{closeButtonUrl:"",frameUrl:""}}}};t.exports=function(){var t=new(e("../patches/PatchCacheFileEncoding")),n=function(e,n,i){var r=e.split("/").pop();return n+(r=t.getCachedFileName(r,i))},p=function(e,t){for(var n=[],i=Object.keys(t),r=0;r<i.length;r++)e[i[r]]&&a(t[i[r]],e[i[r]]);function a(e,t){var i,r;if("string"==typeof e)n.push(t);else if(e instanceof Array&&0===e.length)n=n.concat(t);else if(e instanceof Array&&e.length>0&&t instanceof Array&&t.length>0)for(i=0;i<t.length;i++)for(r=0;r<e.length;r++)a(e[r],t[i]);else{var o=Object.keys(e);for(i=0;i<o.length;i++)t[o[i]]&&a(e[o[i]],t[o[i]])}}return n};function g(e){return e.ext&&e.ext.ableToCache}function v(e){return e.ext.videoData&&e.ext.videoData.videoSource&&e.ext.videoData.videoSource.videoformat_mp4}function m(e){if(e.ext)return e.ext.layoutData?e.ext.layoutData.portrait&&e.ext.layoutData.landscape?v(e)?f:s:l:e.ext.appData&&e.ext.appData.appImages&&Array.isArray(e.ext.appData.appImages)?o:e.ext.clickTags&&e.ext.clickTags.backgroundLandscape&&e.ext.videoData.videoformat_mp4?d:function(e){return(t=e.ext)&&t.type&&"playableAd"===t.type&&e.ext.videoData&&e.ext.videoData.videoSource&&e.ext.videoData.videoSource.html;var t}(e)?c:function(e){return v(e)&&e.ext.appData&&e.ext.appData.appIcon&&!e.ext.appData.appImages}(e)?u:i}return{extractStaticFiles:function(e){return p(e,m(e))},extractVastSource:function(e){var t=e.ext&&e.ext.vastData&&e.ext.vastData.xmlResponse?a:r;return p(e,t)},updateAdunitPrecachePath:function(e,t,i){return function(e,t,i,r){for(var a=Object.keys(i),o=0;o<a.length;o++)e[a[o]]&&(e[a[o]]=s(i[a[o]],e[a[o]]));function s(e,i){var a,o;if("string"==typeof e||"string"==typeof i)i=n(i,t,r);else if(e instanceof Array&&0===e.length)for(a=0;a<i.length;a++)i[a]=n(i[a],t,r);else if(e instanceof Array&&e.length>0&&i instanceof Array&&i.length>0)for(a=0;a<i.length;a++)for(o=0;o<e.length;o++)i[a]=s(e[o],i[a]);else{var l=Object.keys(e);for(a=0;a<l.length;a++)i[l[a]]&&(i[l[a]]=s(e[l[a]],i[l[a]]))}return i}return e}(e,t,m(e),i)},getPlayableCacheFlag:function(){return"isPrecacheable"},isAdAbleToCache:g}}},{"../patches/PatchCacheFileEncoding":204}],121:[function(e,t,n){"use strict";var i=e("../../types");const r="adPlayerVersion",a="Failed to cache ad player files";var o;!function(e){e.AppJs="appJs",e.ChunkVendorsJs="chunkVendorsJs",e.Html="html"}(o||(o={}));const s={[o.AppJs]:"app.js",[o.ChunkVendorsJs]:"chunk-vendors.js",[o.Html]:"index.html"};class l{constructor(e,t,n,r,a,o,s,l){this.protocol=i.Protocol.Https;const{ext:d,debug:c,domain:u,scdn:f}=t;this.version=d.adPlayerVersion,this.assetsFolder=e,this.env=n,this.adPlayerUrl=r,this.cache=a,this.cacheRootFolder=o,this.debug=c,this.domain=u,this.securedCdnBaseUrl=f,this.core=s,this.jQuery=l}setProtocol(e){this.protocol=e}prepareAdPlayerAssetsWrapper(e){return new Promise(((t,n)=>{this.prepareAdPlayerAssets(e).then(t).fail(n)}))}prepareAdPlayerAssets(e){return this.adPlayerUrl.setRemoteUrl(`${this.buildAdPlayerAssetsBaseUrl()}${s[o.Html]}`),this.isAdPlayerAssetsPromisePendingOrResolved()?this.adPlayerAssetsPromise.promise():(this.adPlayerAssetsPromise=this.jQuery.Deferred(),this.shouldUpdateAdPlayerFiles().then((t=>t?this.updateAdPlayerFiles(e):(this.adPlayerUrl.setLocalUrl(`${this.getLocalAdPlayerFolder()}${s[o.Html]}`),this.adPlayerAssetsPromise.resolve(),this.adPlayerAssetsPromise.promise()))))}isAdplayerReadyToUseFromCache(){return!this.shouldUpdateAdPlayerFiles()}updateAdPlayerFiles(e){return this.clearAdPlayerCache().then((()=>this.precacheAdPlayerAssets(e)))}isAdPlayerAssetsPromisePendingOrResolved(){return!!this.adPlayerAssetsPromise&&-1!==["pending","resolved"].indexOf(this.adPlayerAssetsPromise.state())}getAdPlayerCache(){var e;const t=this.cache.getCacheByType({cacheBase:`${this.assetsFolder}`});return null!==(e=null==t?void 0:t.cache)&&void 0!==e?e:[]}getLocalAdPlayerFolder(){return`../${this.cacheRootFolder}/${this.assetsFolder}/`}clearAdPlayerCache(){return this.cache.clearCacheByType({cacheBase:this.assetsFolder},[])}static isAdPlayerDirContainAllAssets(e){for(const t in s)if(s.hasOwnProperty(t)){const n=t;if(-1===e.indexOf(s[n]))return!1}return!0}shouldUpdateAdPlayerFiles(){if(this.env===i.Environment.Develop)return this.core.Utils.returnResolvedPromise(!0);const e=this.getAdPlayerCache();return 0!==e.length&&l.isAdPlayerDirContainAllAssets(e)?this.shouldFetchNewAdPlayerVersion():this.core.Utils.returnResolvedPromise(!0)}buildAdPlayerAssetsBaseUrl(){if(this.env!==i.Environment.Production){const e=this.domain.split(".")[0];return`${this.protocol}//${this.domain}/users/staging/${e}/${this.assetsFolder}/${this.version}/dev/`}return`${this.protocol}//${this.securedCdnBaseUrl}/${this.assetsFolder}/${this.version}/`}precacheAdPlayerAssets(e){const t=this.assetsToCache(s,this.buildAdPlayerAssetsBaseUrl());return this.cache.cacheFilesByFolder(this.assetsFolder,t,e).then((()=>this.adPlayerUrl.setLocalUrl(`${this.getLocalAdPlayerFolder()}${s[o.Html]}`)),(()=>(this.adPlayerAssetsPromise.reject(a),a))).then((()=>this.updateAppDataWithVersion()))}assetsToCache(e,t){const n=[];return Object.keys(e).forEach((i=>{const r=e[i],a=/(\.\.\/)/g,o=r.match(a),s=(null==o?void 0:o.length)||0;let l=r.replace(a,"");if(s>0){const e=t.split("/");e.splice(e.length-1-s,s),n.push(e.join("/")+l)}else n.push(t+l)})),n}updateAppDataWithVersion(){return this.cache.getAppData().then((e=>this.setAppDataWithCurrentVersion(e))).always((()=>(this.adPlayerAssetsPromise.resolve(),this.adPlayerAssetsPromise.promise())))}setAppDataWithCurrentVersion(e){const t=e||{};return t[r]=this.version,this.cache.setAppData(t)}shouldFetchNewAdPlayerVersion(){return this.cache.getAppData().then((e=>this.shouldReplaceCachedAdPlayerBuild((null!=e?e:{})[r])),(()=>!0))}shouldReplaceCachedAdPlayerBuild(e){return e!==this.version}}t.exports=l},{"../../types":213}],122:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});t.exports=class{constructor(e){this.remoteUrl=null,this.localUrl=null,this.utils=e}setRemoteUrl(e){this.remoteUrl=e}setLocalUrl(e){this.localUrl=e}getAdPlayerUrl(e,t,n,i){var r;const a=e&&null!==(r=this.localUrl)&&void 0!==r?r:this.remoteUrl,{productType:o,demandSourceName:s}=n,l=i.shouldBuildAdUnitUrlForExternal?{mode:"native",viewType:"external"}:{},d=Object.assign({productType:o,demandSourceName:s,deviceOs:t},l);return`${a}?${this.utils.serialize(d)}`}}},{}],123:[function(e,t,n){"use strict";var i=e("../../types");const r=[i.AdType.ImageInterstitial,i.AdType.StaticBanner];t.exports=class{static shouldUseAdPlayer(e,t,n,a={},o,s){return!!e&&(!(t===i.DeviceOs.IOS&&s<=13)&&r.indexOf(n.ext.type)<0)}}},{"../../types":213}],124:[function(e,t,n){t.exports={adunitFilesMapping:{js:"main.min.js",css:"main.min.css",html:"adUnit.min.html"},owFilesMapping:{js:"main.min.js",css:"main.min.css",html:"adUnit.min.html"},environment:{develop:"dev",production:"prod",stage:"stage"},adunitAssetsJsonKeys:{html:"html",js:"js",css:"css",sprite:"sprite",libs:"libs",graphicAssets:"graphicAssets",adunitVersion:"adunitVersion"},adunitVersionKey:"adunitVersion",adunitLibsFileName:"adunitLibsFile",adunitGlobalsErrorMsgs:{failedDownloadingAssetsJson:"Failed downloading adunitStaticAssets.json",invalidAdunitAssetsJson:"Missing parameters in adunitStaticAssets.json",failedDownloaingGraphicAssets:"Failed to download adunit graphic assets",failedToRetrieveAdunitUrl:"Failed to retrieve Adunit url"},apiResponseTimeout:15e3}},{}],125:[function(e,t,n){t.exports=function(e,t,n,i){var r=e||{},a=t&&t.debug,o=t&&t.domain,s=t&&t.scdn,l=t&&t.protocol,d=t&&t.adunitConfig,c=n,u=i||{};function f(){return l+"//"+function(){if(a&&parseInt(a)>0&&"www.supersonicads.com"!==o){var e=o.split(".")[0];return o+"/users/staging/"+e}return s}()+"/adunit/dist/adunitAssets.json"}function p(){return window.jQuery.ajax({dataType:"json",url:f(),timeout:u.apiResponseTimeout}).then((function(e,t,n){if(e&&(e.libs&&e.libs.adunitVersion||e.adunitVersion))return e;var i=window.jQuery.Deferred();return i.reject(u.adunitGlobalsErrorMsgs.failedDownloadingAssetsJson),i.promise()}),(function(e,t,n){return u.adunitGlobalsErrorMsgs.failedDownloadingAssetsJson}))}function g(e){return e&&e.libs&&(e.adunitVersion||e.libs.adunitVersion)&&e.graphicAssets}return{getGlobalAssetsJSON:function(){return c===u.environment.develop?p():g(d)?r.Utils.returnResolvedPromise(d):p().then((function(e){return g(e)?r.Utils.returnResolvedPromise(e):r.Utils.returnRejectedPromise(u.adunitGlobalsErrorMsgs.invalidAdunitAssetsJson)}))},setProtocol:function(e){l=e}}}},{}],126:[function(e,t,n){function i(t){var n,i,r,a,o,s,l,d,c,u,f,p,g,v,m,h,b,S,y,A,C=e("./AdUnitConst.js");function I(){var e=r+"//",t="/adunit/dist",o=m?"/versions/"+m:"";if(n&&parseInt(n)>0&&"www.supersonicads.com"!==i){var s=i.split(".")[0],l="/stage/";("local"===s||parseInt(s)>1)&&(l="/dev/"),e=e+i+("/users/staging/"+s)+t+o+l}else e=e+a+t+o+"/prod/";return e}function D(){var e=l.getCacheByType({cacheBase:"globals"});return e&&e.cache||[]}function w(e,t){return l.cacheGlobalAssets(e,t)}function P(){return"../"+d+"/globals/"}function O(){return l.getAppData().then((function(e){return(e=e||{})[C.adunitVersionKey]=m,l.setAppData(e)})).always(s.Utils.returnResolvedPromise)}function F(){return l.clearCacheByType({cacheBase:"globals"},[])}function T(e){if(o===t.environment.develop)return s.Utils.returnResolvedPromise(!0);var n=D();return n.length<=0||function(e,t){for(var n=0;n<e.length;n++){var i=e[n].split("."),r=i[i.length-1];if(C.adunitFilesMapping.hasOwnProperty(r)&&e[n]!==C.adunitFilesMapping[r])return!0}return!1}(n)||SuperSonicGlobalConfig.controllerConfig.adunitVersionToDownload&&SuperSonicGlobalConfig.controllerConfig.adunitVersionToDownload!==m?s.Utils.returnResolvedPromise(!0):l.getAppData().then((function(e){var t=(e=e||{})[C.adunitVersionKey],n=s.VersionUtils.isEqual(m,t||"0");return s.Utils.returnResolvedPromise(n)})).then((function(e){var t=e&&function(){var e=D(),t=C.adunitFilesMapping;for(var n in t)if(-1===e.indexOf(t[n]))return!1;return!0}();return s.Utils.returnResolvedPromise(!t)})).fail((function(){return s.Utils.returnResolvedPromise(!0)}))}function x(e){if(!e)return[];var t=I();return Object.keys(e).map((function(n){var i=e[n],r=/(\.\.\/)/g,a=i.match(r),o=a&&a.length||0;if(i=i.replace(r,""),o>0){var s=t.split("/");return s.splice(s.length-1-o,o),s.join("/")+i}return t+i}))}function U(e){m=e.adunitVersion?e.adunitVersion:e.libs.adunitVersion}function N(e){var t=s.Utils.extend(!0,{},C.adunitFilesMapping,e);return t=function(e,t){var n="../../";return e.libs=function(e,t){for(var n in e)e.hasOwnProperty(n)&&"string"==typeof e[n]&&(e[n]=t+e[n]);return e}(t.libs,n),e}(t,e),t}function L(e,t){return w(x(e),t).then((function(){c.setLocalAdunitUrl(P()+c.getRemoteAdunitFileName())}),(function(){return c.setLocalAdunitUrl(c.getRemoteAdunitUrl()),C.adunitGlobalsErrorMsgs.failedToRetrieveAdunitUrl})).then(O)}function V(e){return A.prefetchGlobalAssetsToBrowser(e,I())}return{init:function(t,p,g,v,m,h,b,S,I){t,n=p.debug,i=p.domain,r=p.protocol,a=p.scdn,l=g,d=v,c=m,u=h,o=b,s=S,I,f=new(e("./AdUnitDataJsonFetcher.js"))(s,p,o,C),A=new(e("./AdUnitUtils.js"))(s,C),y=new(e("./AdUnitGraphicAssetsManager.js"))(s,A,l)},setProtocol:function(e){r=e,f.setProtocol(e)},getStaticGlobalsUrl:I,getGlobalAssetsJSON:function(){return f.getGlobalAssetsJSON()},prefetchGlobalAssetsToBrowser:V,getGlobalsCache:D,isAdunitVersionChanged:function(e){var t=D(),n=!0;return s.Utils.each(t,(function(t,i){return i.indexOf(e)>-1&&(n=!1),n})),n},clearGlobalsCache:F,getLocalGlobalsFolder:P,cacheGlobalAssets:w,assetsToCache:x,updateAdUnitGlobals:function(e,t,n,i){if(e){if(b&&"rejected"!==b.state())return b.promise();b=window.jQuery.Deferred()}else{if(h&&"rejected"!==h.state())return h.promise();h=window.jQuery.Deferred()}return S&&"rejected"!==S.state()||(S=f.getGlobalAssetsJSON().then((function(e){var t;U(p=e),p=N(p),g=C.adunitFilesMapping,y.setAdunitAssetsPaths(p.graphicAssets,I()),v=p.libs,u.setLibsFilesPaths(v,I()),t=I()+C.adunitFilesMapping.html,c.setRemoteAdunitUrl(t),c.setLocalAdunitUrlFromCache(P(),D())})).then((function(){return e?u.manageDownloadLibsFileByFiletype(C.adunitLibsFileName,t):V({adunitLibsFile:v.adunitLibsFile})})).fail((function(t){e?b.reject(t):h.reject(t)}))),S.then((function(){var t;return t=e?function(e){if(y.shouldUpdateAdunitAssets())return y.precacheAdunitGraphicAssets(e);return s.Utils.returnResolvedPromise()}(n).then(null,(function(){b.reject(C.adunitGlobalsErrorMsgs.failedDownloaingGraphicAssets)})).then(T.bind(null,i)).then((function(e){return e?F().then(L.bind(null,g,n)).then((function(){b.resolve()}),(function(e){b.reject(e)})).always((function(){return b.promise()})):(b.resolve(),b.promise())})):V(g).then(y.prefetchAdunitGraphicAssets).then((function(){h.resolve()}),(function(e){h.reject(e)})).always((function(){return h.promise()})),t}))},setAdunitVersion:U,getAdunitGlobalsHTML:function(){return C.adunitFilesMapping.html},updateGlobalAssetsStructure:N,getOWGlobalsHTML:function(){return C.owFilesMapping.html},getOWStaticGlobalsUrl:function(e){var t=r+"//",o="/ow-adunit/dist",s="/versions/"+e;if(n&&parseInt(n)>0&&"www.supersonicads.com"!==i){var l=i.split(".")[0],d="/stage/";("local"===l||parseInt(l)>1)&&(d="/dev/"),t=t+i+("/users/staging/"+l)+o+s+d}else t=t+a+o+s+"/prod/";return t}}}var r;t.exports=function(e,t){return t?new i(e):(r||(r=new i(e)),r)}},{"./AdUnitConst.js":124,"./AdUnitDataJsonFetcher.js":125,"./AdUnitGraphicAssetsManager.js":127,"./AdUnitUtils.js":128}],127:[function(e,t,n){t.exports=function(e,t,n){var i,r=n||{},a=t||{},o={},s={},l="graphicAssets";function d(){var e=r.getCacheByType({cacheBase:l});return e&&e.cache||[]}return{setAdunitAssetsPaths:function(e,t){o=e,i=t,s.sprite=o.sprite},shouldUpdateAdunitAssets:function(){if(0===d().length)return!0;for(var e in o)if(!r.isFileInCache(a.extractFileNameFromPath(o[e]),l))return!0;return!1},precacheAdunitGraphicAssets:function(e){return(t=function(){for(var e=d(),t=[],n=function(e){for(var t in o)if(a.extractFileNameFromPath(o[t])===e)return!1;return!0},i=0;i<e.length;i++)n(e[i])&&t.push(e[i]);return t}(),r.deleteCachedListOfAssets(l,t)).then(r.cacheGraphicAssets.bind(null,function(){var e=[];for(var t in o){var n=a.extractFileNameFromPath(o[t]);if(!r.isFileInCache(n,l)){var s=a.formatAssetsUrlForCache(o[t],i);e.push(s)}}return e}(),e));var t},prefetchAdunitGraphicAssets:function(){return a.prefetchGlobalAssetsToBrowser(s,i)}}}},{}],128:[function(e,t,n){t.exports=function(e,t){var n=e,i=t||{};return{formatAssetsUrlForCache:function(e,t){var n=t,i=function(e,t){var n=/(\.\.\/)/g,i=t.match(n),r=i&&i.length||0;if(t=t.replace(n,""),r>0){var a=e.split("/");return a.splice(a.length-1-r,r),a.join("/")+t}return e+t};return"string"==typeof e?i(n,e):e?Object.keys(e).map((function(t){return i(n,e[t])})):[]},prefetchGlobalAssetsToBrowser:function(e,t,r,a){var o,s,l=new window.jQuery.Deferred,d=[],c=0,u=0,f=n.Utils.extend(!0,{},e);f.hasOwnProperty(i.adunitAssetsJsonKeys.html)&&delete f.html;var p=function(e){return d.indexOf(e)>-1};n.Utils.each(f,(function(e,t){"string"==typeof t?p(t)||u++:delete f[e]})),0===u&&l.resolve();var g=function(e){if(function(e){p(e)||d.push(e)}(e),++c===u){if("function"==typeof r&&r(d),o)return;clearTimeout(s),l.resolve()}},v=t;return n.Utils.each(f,(function(e,t){if(!p(t)){var n=v+t;window.jQuery.get(n,{},null,{dataType:"text"}).done((function(){g(t)})).fail((function(e,n,i){"parsererror"===n&&g(t)}))}})),s=setTimeout((function(){c<u&&("function"==typeof a&&a(),l.reject("Failed to preload all global assets ("+c+" out of "+u+" succeeded)")),o=!0}),15e3),l.promise()},extractFileVersionFromUrl:function(e){var t=e.split("/");return t.length>0?t[t.length-2]:"0"},extractFileNameFromPath:function(e){return e.replace(/^.*[\\\/]/,"")}}}},{}],129:[function(e,t,n){function i(t){var n=t.Utils||{},i=t.VersionUtils,r={dapi:"dapi",externalObfuscation:"externalObfuscation",adunitLibsFile:"adunitLibsFile",omid:"omid"},a={dapi:{filename:"dapi.js",type:r.dapi,cacheKeyName:"dapiVersion"},externalObfuscation:{filename:"obfuscateV2.html",type:r.externalObfuscation,cacheKeyName:"externalObfuscation"},adunitLibsFile:{filename:"adunitLibs.min.js",type:r.adunitLibsFile,cacheKeyName:"adunitLibsFile"},omid:{filename:"omid.js",type:r.omid,cacheKeyName:"omid"}},o="libs",s,l,d,c;function u(e,t,n){return!!a[e]&&(a[e].url=t,a[e].newVersion=n,!0)}function f(e,t,i){return u(e,t,i),n.returnResolvedPromise()}function p(e,t){return u(e,d.formatAssetsUrlForCache(t,c),d.extractFileVersionFromUrl(t))}function g(e){return s.isFileInCache(e,o)?s.deleteCachedAsset(o,e):n.returnResolvedPromise()}function v(e,t){return i.isEqual(e,t)}function m(e,t){var n=a[e],i={};return!!n&&(i[n.cacheKeyName]=t,i)}function h(t,n){l=t,s=n||{},d=new(e("./AdUnitUtils.js"))(s)}function b(e,t){if(c=t,e)for(var n in e)p(n,e[n])}function S(e,t){var i=a[e]||{},r=function(){return g(i.filename).then((function(){return l.log("LibsManager | updateFileInCache | going to download",l.LogLevels.verbose),s.cacheLibsAsset(i.url).then(null,(function(){return n.returnResolvedPromise()}))})).fail((function(){return n.returnResolvedPromise()}))},d=function(e){return l.log("LibsManager | updateFileVersion | appData "+JSON.stringify(e),l.LogLevels.verbose),e=window.SSA_CORE.Utils.extend(e,m(i.type,i.newVersion)),l.log("LibsManager | updateFileVersion | updatedData "+JSON.stringify(e),l.LogLevels.verbose),s.setAppData(e).fail((function(){return n.returnResolvedPromise()}))};return s.getAppData().then((function(e){e=e||{},i.savedVersion=e&&e[i.cacheKeyName]?e[i.cacheKeyName]:"0";var a=!v(i.newVersion,i.savedVersion);return t||a?r().then(d.bind(null,e)):s.isFileInCache(i.filename,o)?(l.log("LibsManager | manageDownloadLibsFileByFiletype | file version is updated and file is already in cache",l.LogLevels.verbose),n.returnResolvedPromise()):(l.log("LibsManager | manageDownloadLibsFileByFiletype  | file version updated but file is not in cache - download it again",l.LogLevels.verbose),s.cacheLibsAsset(i.url))}),r).then((function(){return l.log("LibsManager | manageDownloadLibsFileByFiletype  | success to download file "+i.url,l.LogLevels.verbose),n.returnResolvedPromise("success")}),(function(){return l.log("LibsManager | manageDownloadLibsFileByFiletype  | failed to download file "+i.url,l.LogLevels.verbose),y(i)}))}function y(e){return e.filename===a.adunitLibsFile.filename?n.returnRejectedPromise("Failed to download file "+e.filename):n.returnResolvedPromise()}var A={init:h,setLibsFilesPaths:b,manageDownloadLibsFileByFiletype:S,updateFileVersionByFilePathForThirdPartyLibraries:f};return A}t.exports=i},{"./AdUnitUtils.js":128}],130:[function(e,t,n){function i(e,t){var n,i,r=function(){return n},a=function(e){n=e},o=function(){var e=null;return n&&(e=n.replace(/^.*[\\\/]/,"")),e},s=function(){return i},l=function(e){i=e},d=function(e,t,n,i){var a=e?s():r();return a+=t&&t.productType?"#?productType="+t.productType:"",a+=t&&t.demandSourceName?"&demandSourceName="+t.demandSourceName:"",a+=n&&n.shouldBuildAdUnitUrlForExternal?"&"+c(i):""};function c(e){var n={mode:"native",viewType:"external"};return e&&(n.deviceOs=e),t.serialize(n)}var u=function(e,n){t.each(n,(function(t,n){if("string"==typeof n&&n.match(/.*\.html/))return l(e+n.replace(/^.*[\\\/]/,"")),!1}))},f={getAdunitUrl:d,getRemoteAdunitUrl:r,setRemoteAdunitUrl:a,getRemoteAdunitFileName:o,getLocalAdunitUrl:s,setLocalAdunitUrl:l,setLocalAdunitUrlFromCache:u};return f}t.exports=i},{}],131:[function(e,t,n){t.exports={NativeAPI:{adClicked:"adClicked",init:".initInterstitial",load:".loadInterstitial",show:".showInterstitial"},ControllerCallbacks:{cacheReady:".CacheReady",noMoreOffers:".NoMoreOffers",failedToShow:".failedToShow",failedToLoad:".failedToLoad",fallbackToNonPrecache:".fallbackToNonPrecache",actionClick:".ActionClick",exhaustedDemandSource:".exhaustedDemandSource",onAdWindowsClosed:".onAdWindowsClosed",resetStateManager:".resetStateManager"},AdUnitCallbacks:{adClicked:"SDKController.AdClicked",adVisible:"SDKController.AdVisible",engageEnd:"SDKController.engageEnd"},retriesLogic:{maxNumOfAttemptsToCallAPI:2,initAttemptsDelay:500,serverResponseTimeoutInMilis:1e4},Features:{allowMultiInitCalls:!0,reportOnAdunitReady:!0,preFetchAllVasts:!0,allowConsecutiveGatewayRequestsDuringLoad:!0},amountOfInventories:1}},{}],132:[function(e,t,n){t.exports=function(e,t,n,i,r){return{retriesLogic:t.retriesLogic,NativeAPI:t.NativeAPI,ControllerCallbacks:{reset:".reset",isVisible:".isVisible",isInitiated:".isInitiated",cacheReady:".CacheReady",failedToShow:".failedToShow",failedToLoad:".failedToLoad",actionClick:".ActionClick",exhaustedDemandSource:".exhaustedDemandSource",onAdWindowsClosed:".onAdWindowsClosed",noMoreOffers:".NoMoreOffers"},AdUnitCallbacks:t.AdUnitCallbacks,ControllerNativeAPI:t.NativeAPI,ProductName:n.BN,Features:{allowMultiInitCalls:!0,allowReloadDuringShow:!0,displayOnAdReady:!0,allowConsecutiveGatewayRequestsDuringLoad:!1},gatewayDestinationMap:{prod:n.gatewayDestinationMap.BN.production},amountOfInventories:2,shouldResetOnEngageEnd:!0,shouldAvoidHandleFrameClose:!0,forcePreload:r,width:i?i.width:0,height:i?i.height:0,label:i?i.label:null}}},{}],133:[function(e,t,n){t.exports=function(t,n){var i=e("../components/Constants");return{create:function(r){var a=e("./ProductAdapter"),o=e("./AdapterSharedConfig"),s=e("./Banner/BannerConfiguration")(t,o,i,r,n.isBannerMultipleInstances(i.BN));return new a(t,n,s,i)}}}},{"../components/Constants":33,"./AdapterSharedConfig":131,"./Banner/BannerConfiguration":132,"./ProductAdapter":168}],134:[function(e,t,n){function i(t,n){var i="NativeCallback",r="globals",a="graphicAssets",o="ad-player",s=!1,l=e("./Cache/CacheConstants"),d={},c={mraid:{cache:[]},globals:{cache:[],cacheQueue:[]},"ad-player":{cache:[],cacheQueue:[]},Interstitial:{cache:[],currentAd:0,cacheQueue:[],evaluatedCache:[]},assets:{cache:[],cacheQueue:[]},libs:{cache:[],cacheQueue:[]},graphicAssets:{cache:[],cacheQueue:[]}},u={Interstitial:{numOfBannersToCache:1}},f,p=function(e){return 0!==c[e.cacheBase].cache.length?(c[e.cacheBase].currentAd+1)%c[e.cacheBase].cache.length:0},g=function(e){e=e||{},t.Utils.each(c,(function(n,i){var r=n;c[r].cache&&0!==c[r].cache.length&&t.Utils.isDefined(e)&&e.hasOwnProperty(r)&&c[r].cache.sort((function(t,n){return e[r].indexOf(t.id)<e[r].indexOf(n.id)?-1:1}))}))},v=function(e){var n,i=e.length;for(n=0;n<i;n++)t.Utils.isDefined(e[n])&&e[n]&&t.PubSub.unsubscribe(e[n])},m=function(e){n.log("cache: "+JSON.stringify(c[e].cache)+" currentAd: "+c[e].currentAd,n.LogLevels.info),n.log("queue: "+JSON.stringify(c[e].cacheQueue),n.LogLevels.info)},h=function(e,t){var n,i=null,r=c[e.cacheBase].cacheQueue.length;for(n=0;n<r;n++)if(c[e.cacheBase].cacheQueue[n].cachingStatus===t){i=c[e.cacheBase].cacheQueue[n];break}return i},b=function(e,t){return e.cacheBase+"/"+t},S=function(e,t){var i=c[e.cacheBase].evaluatedCache.map((function(e){return n.AdUtils.getAdId(e)}));if(i.length>0){var r=i.indexOf(t.toString());r>=0&&(n.log("Removing ad from evaluatedCache! "+t,n.LogLevels.verbose),c[e.cacheBase].evaluatedCache.splice(r,1))}},y=function(e,t){var i=n.AdUtils.getAdId(t);if(t&&i){var r,a=c[e.cacheBase].cacheQueue.length;for(r=0;r<a;r++)c[e.cacheBase].cacheQueue[r].id==i&&(c[e.cacheBase].cacheQueue[r]=t)}},A=function(e,n){var i=-1;t.Utils.each(c[n.cacheBase].cache,(function(n,r){return!(t.Utils.isDefined(r.inventoryIndex)&&r.inventoryIndex>e.inventoryIndex||!t.Utils.isDefined(r.inventoryIndex))||(i=n,!1)})),-1===i?c[n.cacheBase].cache.push(e):c[n.cacheBase].cache.splice(i,0,e);var r={};r.cacheBase=n.cacheBase,r.id=e.id,r.inventoryId=e.inventoryId,r.demandSourceName=e.demandSourceName,t.PubSub.publish("Cache.campaignSaved",[r])},C=function(e){t.Utils.each(c[e.cacheBase].cacheQueue,(function(t,i){if(i.cachingStatus===f.cachingStatus.none&&0===c[e.cacheBase].cache.filter((function(e){return n.AdUtils.getAdId(e)===n.AdUtils.getAdId(i)})).length&&0===c[e.cacheBase].evaluatedCache.filter((function(e){return n.AdUtils.getAdId(e)===n.AdUtils.getAdId(i)})).length)return c[e.cacheBase].evaluatedCache.push(i),!1}))},I=function(e,t){var i=c[e.cacheBase].cache.map((function(e){return n.AdUtils.getAdId(e)}));if(i.length>0){var r=i.indexOf(t.toString());r>=0&&(n.log("Removing ad from cache array! "+t,n.LogLevels.verbose),c[e.cacheBase].cache.splice(r,1))}},D=function(e,t){return n.getGlobalAppData().then((function(i){i.cachePriorityArray=i.cachePriorityArray||{};var r=i.cachePriorityArray[e.cacheBase];if(r){var a=r.indexOf(t.toString());a>=0&&(n.log("Removing ad from cache array! "+t,n.LogLevels.verbose),r.splice(a,1),i.cachePriorityArray=r)}return n.setGlobalAppData(i)}))};function w(e,r){c[e.cacheBase].evaluatedCache.length;var a,o,s,l,p=c[e.cacheBase].cacheQueue.length,g=(u[e.cacheBase].numOfBannersToCache,null),m=null,I=null,D=null,w=null,P=[],O=[],F=[],T=0,U={};for(s=jQuery.Deferred(),o=0;o<p;o++)c[e.cacheBase].cacheQueue[o].cachingStatus!==f.cachingStatus.pending&&c[e.cacheBase].cacheQueue[o].cachingStatus!==f.cachingStatus.queued||0;var N=function(){c[e.cacheBase].evaluatedCache.length>0?(n.log("line[182]: evaluatedCache is: "+JSON.stringify(c[e.cacheBase].evaluatedCache),n.LogLevels.verbose),(a=h(e,f.cachingStatus.none))?(a.cachingStatus=f.cachingStatus.pending,S(e,n.AdUtils.getAdId(a)),a.numOfAssetsCached=0,d[e.cacheBase][a.id]=[],F.push(n.AdUtils.getAdId(a)),a.preProcessing().then((function(n){if(!t.Utils.isDefined(n))return t.Utils.returnResolvedPromise();a=Y(n),y(e,a)}),(function(){var i={};i.cacheBase=e.cacheBase,i.id=n.AdUtils.getAdId(a),i.inventoryId=a.inventoryId,i.demandSourceName=a.demandSourceName,t.PubSub.publish("Cache.preProcessingFailed",[i]),P.push(i.id),s.reject(c[e.cacheBase].cache,P)})).then((function(){var i={};i.cacheBase=e.cacheBase,i.id=a.id,i.demandSourceName=a.demandSourceName,t.PubSub.publish("Cache.campaignDownloadStarted",[i]),U={},0===a.assets.length?M(e,n.AdUtils.getAdId(a)):(n.log("campaign "+a.id+" download started",n.LogLevels.info),n.cacheAdUnitAssets(b(e,a.id),a))}))):(v([g,m,w,I,D]),0===P.length?s.resolve(c[e.cacheBase].cache):s.reject(c[e.cacheBase].cache,P,O))):(h(e,f.cachingStatus.pending)&&n.log("cache is full but we're waiting for a campaign to finish downloading (probably the last)",n.LogLevels.verbose),v([g,m,w,I,D]),0===P.length?s.resolve(c[e.cacheBase].cache):s.reject(c[e.cacheBase].cache,P,O))},V=function(e){v([I,D]),e&&(N())},M=function(e,a,o,s){var u,p,g=s&&s.hasOwnProperty("file")?s.file:null,v=!(!s||!s.hasOwnProperty("status"))&&s.status,m=[];if((u=R(e,a))&&ne(v,U,g,u.assets,r)){if(r.cacheBase=e.cacheBase,U[g]={isSuccessfullyCached:v},!ie(o,g,U,u.assets,T,r))return void T++;T=0}if(d[e.cacheBase][a].push(s),u&&u.id&&d[e.cacheBase][u.id].length===u.assets.length)if(n.log("campaign "+u.id+" download finished!",n.LogLevels.info),l=k(d[e.cacheBase][u.id],(function(e){return e.status})),p=K(d[e.cacheBase][u.id],u,(function(e){return e.status})),0===u.assets.length&&(l=!0),delete d[e.cacheBase][u.id],l){if(u.cachingStatus=f.cachingStatus.queued,c[e.cacheBase].evaluatedCache.length>=0){L(e,u.id,!1),u.numOfAssetsCached=u.assets.length,A(u,e),m=c[e.cacheBase].cache.map((function(e){return n.AdUtils.getAdId(e)})),e.inventoryId=u.inventoryId,e.demandSourceName=u.demandSourceName;var h=t.Utils.extend(!0,{},e,{inventoryId:u.inventoryId,demandSourceName:u.demandSourceName});t.PubSub.publish("Cache.cacheUpdated",[h])}else n.log("Cache full, could not enter new ad",n.LogLevels.error);m.length>0?(n.log("mappedAds after 'handleCachedAd/pushNewCachedAd' "+m,n.LogLevels.verbose),n.setCachePriorityArrayKey(e,m).always((function(){N()}))):N()}else L(e,a,!1),C(e),I=t.PubSub.subscribe(i+".deleteFolderFailed",(function(e){n.log("in delete failure from cache next",n.LogLevels.verbose),n.checkRequiredCallbackParams(["path"],e,"deleteFolderFailed").didSucceed&&(n.log("deleting folder failed: "+JSON.stringify(e),n.LogLevels.error),t.Utils.isDefined(e.errCode)&&1==e.errCode?V(!0):V(!1))})),D=t.PubSub.subscribe(i+".deleteFolderSuccess",(function(e){n.log("in delete success from cache next",n.LogLevels.verbose),n.checkRequiredCallbackParams(["path"],e,"deleteFolderSuccess").didSucceed&&(n.log("deleting folder success: "+JSON.stringify(e),n.LogLevels.info),V(!0))})),P.push(u.id),p&&O.push({id:u.id,failedAssetsUrlsArray:p.failedAssetsUrlsArray}),n.deleteFolder(o)};return g=t.PubSub.subscribe(i+".assetCached",(function(i,r,a){if(n.checkRequiredCallbackParams(["path","file"],i,"assetCached",a).didSucceed){var o,s=x(i.path),l=decodeURIComponent(i.path),c={file:i.file,status:!0};-1!==F.indexOf(s.id)?t.Utils.isDefined(d[s.type][s.id])&&s.type===e.cacheBase?(n.log("asset cached success: "+s.id+"/"+i.file,n.LogLevels.verbose),o={cacheBase:s.type},R(o,s.id).numOfAssetsCached++,M(o,s.id,l,c)):n.log("Exiting asset cached. folder:"+s.id+" responses array:"+JSON.stringify(d),n.LogLevels.error):n.log("ad is not recognised in this scope: "+s.id+" adForCaching:"+F,n.LogLevels.info)}})),m=t.PubSub.subscribe(i+".assetCachedFailed",(function(i,r,a){if(n.checkRequiredCallbackParams(["path","file"],i,"assetCachedFailed",a).didSucceed){var o,s=x(i.path),l=decodeURIComponent(i.path),c={file:i.file,status:!1};-1!==F.indexOf(s.id)&&(t.Utils.isDefined(d[s.type][s.id])&&s.type===e.cacheBase?(n.log("asset cached failed: "+s.id+"/"+i.file+" with error: "+i.errMsg,n.LogLevels.error),o={cacheBase:s.type},M(o,s.id,l,c)):n.log("Exiting asset cached failed. folder:"+s.id+" responses array:"+JSON.stringify(d),n.LogLevels.error))}})),w=t.PubSub.subscribe(i+".preCacheFileFail",(function(i,r,a){if(n.checkRequiredCallbackParams(["path","file"],i,"preCacheFileFail",a).didSucceed){var o,s=x(i.path),l=decodeURIComponent(i.path),c={file:i.file,status:!1};-1!==F.indexOf(s.id)&&(t.Utils.isDefined(d[s.type][s.id])&&s.type===e.cacheBase?(n.log("pre cache file fail: "+i.file+" with error: "+i.errMsg,n.LogLevels.error),o={cacheBase:s.type},M(o,s.id,l,c)):n.log("Exiting preCache file fail. folder:"+s.id+" responses array:"+JSON.stringify(d),n.LogLevels.error))}})),N(),s.promise()}var P=function(e,t){return e&&e.files&&Array.isArray(e.files)&&"ads"===t},O=function(e){var t;try{t=parseInt(e)}catch(e){t=0}return t},F=function(e,i,r){var a,o;for(a in i)if(i.hasOwnProperty(a)){if("userUniqueId"===a||"applicationUserId"===a||"applicationKey"===a)continue;if("files"===a){e.cache=i[a];continue}if(P(i[a],r)){e.cache.push({id:a,numOfAssetsCached:t.Utils.isDefined(i[a].files)?i[a].files.length:0,lastUpdateTime:t.Utils.isDefined(i[a].lastUpdateTime)?O(i[a].lastUpdateTime):0,assets:t.Utils.isDefined(i[a].files)?i[a].files:[]});continue}if("lastUpdateTime"===a)return;n.isRootFolder(a)?o=e:(f.initCacheBase(a),o=e[a]),F(o,i[a],a)}},T=function(e){t.Utils.isDefined(e)&&e&&e!=={}?F(c,e):c={mraid:{cache:[]},globals:{cache:[],cacheQueue:[]},RewardedVideo_Premium:{cache:[],currentAd:0,cacheQueue:[]},RewardedVideo_Direct:{cache:[],currentAd:0,cacheQueue:[]},Interstitial:{cache:[],currentAd:0,cacheQueue:[]},assets:{cache:[],cacheQueue:[]},libs:{cache:[],cacheQueue:[]}}},x=function(e){var n=decodeURIComponent(e).split("/");return{type:n[0],id:t.Utils.isDefined(n[1])?n[1]:null}},U=function(e){var t=e.split("#");return t.length>1?t[t.length-1]:(t=e.split("/"))[t.length-1]},N=function(e,t){var n=-1;if(!e)return n;var i,r=U(t),a=e.length;for(i=0;i<a;i++)if(U(e[i])===r){n=i;break}return n},L=function(e,t,n){var i,r=c[e.cacheBase].cacheQueue,a=[],o=!1;for(i=0;i<c[e.cacheBase].cacheQueue.length;i++)r[i].id!=t?a.push(r[i]):(o&&!n&&a.push(r[i]),o=!0);c[e.cacheBase].cacheQueue=a},V=function(e,a){var s,l,d,u,p=0,g=c[e.cacheBase].cache.length,m=[],h=[],b=jQuery.Deferred(),S=function(e,n){-1!==m.indexOf(decodeURIComponent(e.path))&&(e.success=n,h.push(e),h.length>=m.length&&(v([d,u]),k(h,(function(e){return t.Utils.isDefined(e.success)&&e.success}))?b.resolve():b.reject()))};if(u=t.PubSub.subscribe(i+".deleteFolderFailed",(function(i){n.checkRequiredCallbackParams(["path"],i,"deleteFolderFailed").didSucceed&&-1!==i.path.indexOf(e.cacheBase)&&(n.log("deleting folder failed: "+JSON.stringify(i),n.LogLevels.error),t.Utils.isDefined(i.errCode)&&1==i.errCode?S(i,!0):S(i,!1))})),d=t.PubSub.subscribe(i+".deleteFolderSuccess",(function(i){if(n.checkRequiredCallbackParams(["path"],i,"deleteFolderSuccess").didSucceed&&-1!==i.path.indexOf(e.cacheBase)){n.log("deleting folder success: "+JSON.stringify(i),n.LogLevels.info),S(i,!0);var r=x(i.path);if(null!==r.id){var a={};a.cacheBase=r.type,a.id=r.id,a.inventoryId=r.inventoryId,t.PubSub.publish("Cache.campaignDeleted",[a])}}})),-1!==[r,o].indexOf(e.cacheBase))c[e.cacheBase].cache=[],c[e.cacheBase].cacheQueue=[],m.push(e.cacheBase);else{for(p=0;p<g;p++)t.Utils.isDefined(c[e.cacheBase].cache[0].id)||n.log("something went wrong. len="+g+" cache size= "+c[e.cacheBase].cache.length+" first element="+JSON.stringify(c[e.cacheBase].cache[0]),1),s=c[e.cacheBase].cache[0].id.toString(),t.Utils.isDefined(s)&&-1===a.indexOf(s)&&(l=e.cacheBase+"/"+s,-1===m.indexOf(l)&&m.push(l)),c[e.cacheBase].cache.shift();for(g=c[e.cacheBase].cacheQueue.length,p=0;p<g;p++)s=c[e.cacheBase].cacheQueue[0].id,t.Utils.isDefined(s)&&c[e.cacheBase].cacheQueue[0].cachingStatus!==f.cachingStatus.none&&(l=e.cacheBase+"/"+s,-1===m.indexOf(l)&&m.push(l)),c[e.cacheBase].cacheQueue.shift()}if(0===m.length)v([d,u]),b.resolve();else for(n.log("Removing irrelevant campaigns: "+JSON.stringify(m)),p=0;p<m.length;p++)n.deleteFolder(m[p]);return b.promise()},M=function(e,t){var n,i=null,r=c[e.cacheBase].cache,a=c[e.cacheBase].cache.length;for(n=0;n<a;n++)if(r[n].id==t){i=r[n];break}return i},R=function(e,t){var n,i=null,r=c[e.cacheBase].cacheQueue,a=c[e.cacheBase].cacheQueue.length;for(n=0;n<a;n++)if(r[n].id==t){i=r[n];break}return i},k=function(e,t){var n,i=e.length,r=!0;for(n=0;n<i;n++)r=r&&t(e[n]);return r};function K(e,t,n){var i,r=e.length,a={failedAssetsUrlsArray:[]},o=function(e,t){if(!e||!e.assets)return null;var n=e.assets,i=t.split("?");t=i[0];for(var r=0;r<n.length;r++){if(t&&-1!==n[r].indexOf(t))return n[r].split("?")[0]}return null};for(i=0;i<r;i++)if(!n(e[i])){var s=o(t,e[i].file);s&&a.failedAssetsUrlsArray.push(s)}return a}var B=function(){t.PubSub.subscribe(i+".printCache",(function(e){t.Utils.isDefined(e.type)&&m(e.type)}))},E=function(e,i,r){var a=0,o=!1;return t.Utils.each(c[r.cacheBase].cache,(function(t,r){if(e.filter((function(e){return n.AdUtils.getAdId(e)===n.AdUtils.getAdId(r)})).length>0&&++a>=i)return o=!0,!1})),o},j=function(e,t,i,r){var a,o=e.slice(0,t),s=[];for(c[r.cacheBase].evaluatedCache=[],a=0;a<o.length;a++)0===c[r.cacheBase].cache.filter((function(e){return n.AdUtils.getAdId(e)===n.AdUtils.getAdId(o[a])&&_(e,o[a])})).length&&c[r.cacheBase].evaluatedCache.push(o[a]);for(a=0;a<o.length;a++)0===c[r.cacheBase].cache.filter((function(e){return n.AdUtils.getAdId(e)===n.AdUtils.getAdId(o[a])&&!_(e,o[a])})).length&&s.push(o[a]);for(a=t;a<e.length;a++)c[r.cacheBase].cache.filter((function(t){return n.AdUtils.getAdId(t)===n.AdUtils.getAdId(e[a])&&_(t,e[a])})).length>0&&s.push(e[a]);var l,d=e.length;for(a=0;a<c[r.cacheBase].cache.length;a++)0===e.filter((function(e){return n.AdUtils.getAdId(e)===n.AdUtils.getAdId(c[r.cacheBase].cache[a])})).length&&(c[r.cacheBase].cache[a].inventoryIndex=++d,s.push(((l=c[r.cacheBase].cache[a]).adId=l.id,l.staticContent=l.assets,l)));return c[r.cacheBase].mergedAds=s.slice(0,i),c[r.cacheBase].mergedAds},_=function(e,t){if(!e||!t)return n.log("line[750]: entering isCachedAdStillUpdated with no ad",n.LogLevels.verbose),!1;var i=X(e.assets),r=X(t.staticContent);return n.log("cachedAdNumOfUniqueAssets: "+i+", newAdNumOfUniqueAssets:"+r,n.LogLevels.verbose),i===r&&(W(t)||e.lastUpdateTime==t.lastUpdateTime)},W=function(e){return e&&"0"!==e.creativeId},G=function(e,t){return c[t]&&c[t].cache.indexOf(e)>-1};function H(e){if(!e)return null;var t=c[l.adsAssetsCacheDir]&&c[l.adsAssetsCacheDir].cache;if(!t)return null;for(var n=0;n<t.length;n++){var i=t[n];if(i&&i.id===e)return i}return null}function q(e){return e&&e.assets?e.assets.length:0}function J(){var e=c[l.adsAssetsCacheDir]&&c[l.adsAssetsCacheDir].cache;if(!e)return[];for(var t=[],n=0;n<e.length;n++)t.push(e[n].id);return t}function Q(e){var t=H(n.AdUtils.getAdId(e));return!!(t&&e.adAssets&&q(t)>=e.adAssets.length)}function $(e,i){if(e&&i&&Array.isArray(i)&&0!==i.length){var r=n.AdUtils.getAdId(e);c[l.adsAssetsCacheDir]||(c[l.adsAssetsCacheDir]={}),c[l.adsAssetsCacheDir].cache||(c[l.adsAssetsCacheDir].cache=[]);for(var a=c[l.adsAssetsCacheDir].cache,o=[],s=0;s<a.length;s++){var d=a[s];d.id===r&&(o=d.assets,a.splice(s,1))}var u={id:r,assets:o.concat(i.filter((e=>o.indexOf(e)<0))),lastUpdateTime:e.lastUpdateTime?e.lastUpdateTime:0,inventoryIndex:t.Utils.isDefined(e.inventoryIndex)?e.inventoryIndex:-1};a.push(u)}}var z=function(e,t,n){var i=M(e,t);i&&(i.inventoryIndex=n)},X=function(e){var i,r=[];return e?(t.Utils.each(e,(function(e,t){i=U(t),-1===N(r,i)&&r.push(i)})),r.length):(n.log("cannot extract unique assets count",n.LogLevels.error),-1)},Y=function(e){var i={id:n.AdUtils.getAdId(e),demandSourceName:e.demandSourceName,assets:e.staticContent||[],lastUpdateTime:t.Utils.isDefined(e.lastUpdateTime)?e.lastUpdateTime:0,numOfAssetsCached:0,cachingStatus:f.cachingStatus.none,preProcessing:e.preProcessing||t.Utils.returnResolvedPromise};return t.Utils.isDefined(e.credits)&&(i.credits=e.credits),t.Utils.isDefined(e.inventoryIndex)&&(i.inventoryIndex=e.inventoryIndex),i},Z=function(e,t){var n={};n.failedCachedFile=e,n.listOfFilesUrls=t;var i=e.split("?");e=i[0];for(var r=0;r<t.length;r++)if(-1!==t[r].indexOf(e))return t[r];return!1},ee=function(e,t,n,i,r,a,o){return{cacheBase:e,productType:t,demandSourceName:n,file:i,currentRetryAttempt:r,totalRetryAttempts:a,assetType:o}},te=function(e){return e&&e.hasOwnProperty("retryAttempts")&&e.hasOwnProperty("retryInterval")},ne=function(e,t,n,i,r){return n&&i&&i.length>0&&(!e||t[n])&&te(r)},ie=function(e,i,r,a,o,s){var l,d=!0,c=Z(i,a),u=s.retryAttempts,f=s.retryInterval,p={cacheBase:e,failedCachedFile:i,listOfFilesUrls:a};if(c)return r[i].isSuccessfullyCached?o>0&&r[i].isSuccessfullyCached&&(l=ee(e,s.productType,s.demandSourceName,c,o,u,s.assetType),t.PubSub.publish("Cache.assetRetrySuccess",[l])):o<u?(d=!1,setTimeout((function(){n.cacheAsset(e,c)}),1e3*f)):(l=ee(e,s.productType,s.demandSourceName,c,o,u,s.assetType),t.PubSub.publish("Cache.assetRetryFailed",[l])),d;t.PubSub.publish("Cache.executeRetryFileUrlEmpty",[p])},re={init:function(e,t){return f=this,s||(T(e),B(),s=!0),g(t),s},initCacheBase:function(e){c[e]||(c[e]={cache:[],currentAd:0,cacheQueue:[]}),d[e]||(d[e]={})},setAdInventoryIndex:z,cacheNext:function(e,t){return n.log("line[707]: recalling cache next",n.LogLevels.verbose),C(e),w(e,t)},incrementNextCampaign:function(e){c[e.cacheBase].currentAd=p(e)},isNextAvailable:function(e,t){return f.getCurrentAd(e,t)},setSettings:function(e,t){u[e.cacheBase]=t},getCacheSizeByType:function(e){var t=c[e.cacheBase];return t&&t.hasOwnProperty("cache")?t.cache.length:0},cacheGlobalAssets:function(e,t){return f.cacheFilesByFolder("globals",e,t)},cacheGraphicAssets:function(e,t){return f.cacheFilesByFolder("graphicAssets",e,t)},cacheFilesByFolder:function(e,s,l){var d,u,f,p,g,m=s.length,h=[],b=0,S={};if(!c.hasOwnProperty(e))return t.Utils.returnResolvedPromise();u=jQuery.Deferred();var y=c[e].cache,A=c[e].cacheQueue,C=function(t,n){if(ne(n,S,t,s,l)){if(S[t]={isSuccessfullyCached:n},l.cacheBase=e,!ie(e,t,S,s,b,l))return void b++;b=0}h.push({file:t,status:n}),I(t),h.length>=m&&(v([f,p,g]),k(h,(function(e){return e.status}))?(y=s.map((function(e){return e.replace(/^.*[\\\/]/,"")})),u.resolve(y)):u.reject())},I=function(e){var t=A.indexOf(e);t>-1&&A.splice(t,1)};for(f=t.PubSub.subscribe(i+".assetCached",(function(e,t,i){n.checkRequiredCallbackParams(["path","file"],e,"assetCached",i).didSucceed&&-1!==[r,a,o].indexOf(e.path)&&(n.log("asset cached success: "+e.file,n.LogLevels.verbose),C(e.file,!0))})),p=t.PubSub.subscribe(i+".assetCachedFailed",(function(e,t,i){n.checkRequiredCallbackParams(["path","file"],e,"assetCachedFailed",i).didSucceed&&-1!==[r,a,o].indexOf(e.path)&&(n.log("asset cached failed: "+e.file+" with error: "+e.errMsg,n.LogLevels.error),C(e.file,!1))})),g=t.PubSub.subscribe(i+".preCacheFileFailed",(function(e,t,i){n.checkRequiredCallbackParams(["path","file"],e,"preCacheFileFail",i).didSucceed&&-1!==[r,a,o].indexOf(e.path)&&(n.log("failed to request to save file:"+e.file+" with error "+e.errMsg,n.LogLevels.error),C(e.file,!1))})),d=0;d<m;d++)-1===N(y,s[d])?(-1===N(A,s[d])?A.push(s[d]):I(s[d]),n.cacheAsset(e,s[d])):-1!==N(y,s[d])&&C(s[d],!0);return 0===m&&v([f,p,g]),u.promise()},cacheLibsAsset:function(e){var t=jQuery.Deferred(),i=e.replace(/^.*[\\\/]/,"");return c.libs.cacheQueue.push(i),n.cacheAsset("libs",e).then((function(){!function(e){c.libs.cache.push(i);var t=c.libs.cacheQueue.indexOf(e);-1!==e&&c.libs.cacheQueue.splice(t,1)}(e),t.resolve(c.libs.cache)}),(function(){t.reject("Libs asset cache failed: "+e)})),t.promise()},cacheAds:function(e,t,n,i){var r,a=n.length;for(r=0;r<a;r++){var o=Y(n[r]);c[e.cacheBase].cacheQueue.push(o)}return w(e,i)},cacheSingleAd:function(e,t,n){c[e.cacheBase].cacheQueue.splice(0,0,Y(t)),f.cacheNext(e,n)},clearCacheByType:function(e,i){var r,a,o=i.length,s=[],l=null,d=[],u=jQuery.Deferred();if(0===c[e.cacheBase].cache.length&&0===c[e.cacheBase].cacheQueue.length)return u.resolve(c[e.cacheBase].cache),u.promise();for(r=0;r<o;r++)a=n.AdUtils.getAdId(i[r]),l=M(e,a),_(l,i[r])&&(d.push(a),t.Utils.isDefined(i[r].credits)&&!t.Utils.isDefined(l.credits)&&(l.credits=i[r].credits),s.push(l));return jQuery.when(V(e,d)).then((function(){c[e.cacheBase].cache=s,u.resolve(c[e.cacheBase].cache)}),(function(){n.log("error in clear cache by type",n.LogLevels.error),u.reject()})),u.promise()},getCurrentAd:function(e,i){var r=null;return e&&e.cacheBase&&i?(t.Utils.each(i,(function(i,a){return t.Utils.each(c[e.cacheBase].cache,(function(e,t){return!(r=n.AdUtils.getAdId(t)===n.AdUtils.getAdId(a)?t:r)})),!r})),r):null},getNextAvailableAd:function(){return{}},getCacheByType:function(e){return c[e.cacheBase]},getRootCacheStructure:function(){return c},isAdInCache:function(e,t){var n,i=!1,r=c[e.cacheBase],a=r&&r.cache?r.cache.length:0;for(n=0;n<a;n++)if(r.cache[n].id===t){i=!0;break}return i},getAdStatusInQueue:function(e,t){var n=R(e,t);return n?n.cachingStatus:null},setAppData:function(e){return n.setGlobalAppData(e)},getAppData:function(){return n.getGlobalAppData()},deleteCachedAsset:function(e,t){return n.deleteAsset(e,t)},deleteCachedListOfAssets:function(e,t){var i,r=new jQuery.Deferred,a=[],o=0;if(0===t.length)return r.resolve(0),r.promise();for(i=0;i<t.length;i++)a.push(n.deleteAsset(e,t[i]));return jQuery.when.apply(null,a).always((function(){var e=arguments;for(i in e)e[i]&&o++;r.resolve(o)})),r.promise()},deleteCachedCampaign:function(e,t){var i=e.cacheBase+"/"+t;return n.deleteFolder(i),I(e,t),D(e,t)},isFileInCache:G,getCachedAdFolder:H,getAmountOfAssetsInAdFolder:q,isAdExistInCacheAndContainsAssets:Q,setAdInAdsFolder:$,mergeCampaigns:j,areCampaignsAvailable:E,getFileIndexInCache:N,removeAdFromCacheArray:I,cachingStatus:{none:0,pending:1,queued:2}};return re}t.exports=i},{"./Cache/CacheConstants":141}],135:[function(e,t,n){"use strict";var i;Object.defineProperty(n,"__esModule",{value:!0}),function(e){e[e.Unknown=-1]="Unknown",e[e.FolderAndAssetsDoNotExist=0]="FolderAndAssetsDoNotExist",e[e.FolderAndAssetsExist=1]="FolderAndAssetsExist",e[e.FolderExistsAssetsDoNotExist=2]="FolderExistsAssetsDoNotExist"}(i||(i={}));t.exports=class{constructor(e,t){this.controller=e,this.cacheUtils=t}isAdExistInCache(e){return this.getCacheStatusOfAd(e)===i.FolderAndAssetsExist}getCacheStatusOfAd(e){const t=this.controller.AdUtils.getAdId(e);if(!(null==e?void 0:e.adAssets)||!t)return i.Unknown;const n=this.controller.Cache.getCachedAdFolder(t);if(!n)return i.FolderAndAssetsDoNotExist;return e.adAssets.some((e=>!this.isAssetInAdsCacheFolder(e.URL,t,n)))?i.FolderExistsAssetsDoNotExist:i.FolderAndAssetsExist}isAssetInAdsCacheFolder(e,t,n=this.controller.Cache.getCachedAdFolder(t)){const i=this.cacheUtils.extractFileNameFromURL(e);if(!i||!n)return!1;return n.assets.some((e=>this.controller.getCacheFileEncodingPatch().isFileNameMatches(e,i)))}}},{}],136:[function(e,t,n){t.exports=function(e,t,n,i){function r(e,t,n,i,r){var o=e+n-i,s=t.length;return s<o?(a(r,i,e),t):s===o?t:s>o?t.splice(0,o):void 0}function a(t,n,i){e.PubSub.publish("AdsAssetsClearanceService.cacheReachedMaximumCapacity",[{demandSourceName:t.demandSourceName,productType:t.productType,maxAdsToSaveInCache:n,amountOfAdsCached:i}])}return{enactClearanceLogic:function(e,o,s,l,d){var c=function(e){for(var n=[],i=[],r=e.length,a=0;a<r;a++)t.isAdExistInCacheAndContainsAssets(e[a])?i.push(e[a]):n.push(e[a]);return{adsFromFeedThatAreNotInCache:n,adsThatWereAlreadyInTheCache:i}}(e),u=c.adsFromFeedThatAreNotInCache,f=t.getCacheSizeByType(s);if(o=function(e,t,n){for(var r=e,a=i.getAdIdsOfAds(n),o=0;o<r&&o<t.length;o++){var s=t[o].isCacheable,l=i.getAdId(t[o]),d=-1!==a.indexOf(l);s&&!d||e--}return e}(o,e,c.adsThatWereAlreadyInTheCache),function(e,t){return t<=0||0===e.length}(u,o)||function(e,t,n){return e+t<=n}(f,o,l))return{adsToCache:u,adsToRemoveFromCache:[],adsThatWereAlreadyCached:c.adsThatWereAlreadyInTheCache};var p=function(e){for(var i=t.getCacheByType(e).cache,r=[],a=i.length,o=0;o<a;o++){var s=i[o];0===n.getReferenceCountOfAd(s.id)&&r.push(s)}return r}(s);return 0===p.length?(a(d,l,f),{adsToCache:u,adsToRemoveFromCache:[],adsThatWereAlreadyCached:c.adsThatWereAlreadyInTheCache}):{adsToCache:u,adsToRemoveFromCache:r(f,p,o,l,d),adsThatWereAlreadyCached:c.adsThatWereAlreadyInTheCache}}}}},{}],137:[function(e,t,n){t.exports=function(t,n,i){var r,a,o,s,l=e("./CacheConstants"),d=new(e("./CacheUtils"))(t),c=new(e("./AdsReferencesManager")),u={},f={},p={};function g(e,r,a,o){var c=n.AdUtils.getAdId(r);if(!d.isAssetValid(e))return t.Utils.returnRejectedPromise(l.errors.cacheAssetInvalidParams);var u=e[l.assetKeys.URL],f=d.extractFileNameFromURL(u);if(!f)return I("urlNotMatched",{demandSourceName:a.demandSourceName,productType:a.productType,asset:e,ad:r}),t.Utils.returnRejectedPromise(l.errors.cacheAssetInvalidParams);if(s.isAssetInAdsCacheFolder(f,c))return e[l.assetKeys.file]=f,t.Utils.returnResolvedPromise(e);var p=new jQuery.Deferred,g=d.buildAdFolderPath(c);return function(e,i,r){var a=[],o=t.PubSub.subscribe("AdsAssetsNativeCommunicator.adsAssetCachedSuccess",c),s=t.PubSub.subscribe("AdsAssetsNativeCommunicator.adsAssetCachedFailure",u);function c(o){o[l.assetKeys.path]===i&&n.getCacheFileEncodingPatch().isFileNameMatches(d.extractFileNameFromURL(o[l.assetKeys.file]),d.extractFileNameFromURL(e[l.assetKeys.URL]))&&(t.PubSub.clearHandlers(a),e[l.assetKeys.path]=d.buildAdAssetsPath(o[l.assetKeys.path],o[l.assetKeys.file]),e[l.assetKeys.file]=o[l.assetKeys.file],r.resolve(e))}function u(i){n.getCacheFileEncodingPatch().isFileNameMatches(d.extractFileNameFromURL(i[l.assetKeys.file]),d.extractFileNameFromURL(e[l.assetKeys.URL]))&&(t.PubSub.clearHandlers(a),r.reject("failed caching file "+i[l.assetKeys.file]))}a.push(o,s)}(e,g,p),i.saveFileWithRetry(u,g,a,o),p.promise()}function v(e,r,o){var c=n.AdUtils.getAdId(e);if(!c)return t.Utils.returnRejectedPromise("Failed to cache ad "+c||n.AdUtils.getBannerId(e));if(!e.isCacheable)return t.Utils.returnResolvedPromise();if(I("adAssetsCacheStatus",{demandSourceName:r.demandSourceName,productType:r.productType,ad:e,adAssetsCacheStatus:s.getCacheStatusOfAd(e)}),s.isAdExistInCache(e))return t.Utils.returnResolvedPromise();if(function(e){return u.hasOwnProperty(e)}(c))return function(e){if(u.hasOwnProperty(e))return u[e];return t.Utils.returnResolvedPromise()}(c);var f=new jQuery.Deferred;!function(e,t){u.hasOwnProperty(e)||(u[e]=t)}(c,f.promise());for(var p=[],v=0;v<e.adAssets.length;v++)p.push(g(e.adAssets[v],e,r,o));return jQuery.when.apply(null,p).then((function(){var n=t.Utils.convertArrayLikeObjectToArray(arguments);!function(e,t){if(!t||!Array.isArray(t))return;for(var n=[],i=0;i<t.length;i++){var r=t[i];r&&r.hasOwnProperty(l.assetKeys.file)&&n.push(r[l.assetKeys.file])}a.setAdInAdsFolder(e,n)}(e,n),b(c),I("saveAdInCacheSuccess",{demandSourceName:r.demandSourceName,productType:r.productType,ad:e}),f.resolve()}),(function(a){A(n.AdUtils.getAdId(e),r.instanceUniqueId),I("saveAdInCacheFailure",{demandSourceName:r.demandSourceName,productType:r.productType,ad:e});var o=d.buildAdFolderPath(c);!function(e,i,r,a,o){var s=[],l=n.AdUtils.getAdId(e),d=t.PubSub.subscribe("AdsAssetsNativeCommunicator.deleteAdFolderSuccess",u),c=t.PubSub.subscribe("AdsAssetsNativeCommunicator.deleteAdFolderFailure",u);function u(n){n.path===i&&(t.PubSub.clearHandlers(s),I("deleteAdFromCacheSuccess",{demandSourceName:o.demandSourceName,productType:o.productType,ad:e}),b(l),a.reject("ad "+l+" failed to cached with reason: "+r))}s.push(d,c)}(e,o,a,f,r),i.deleteFolder(o)})),f.promise()}function m(e,t,n,i,r){t<=0?r.resolve():0===e.length&&t>0?r.reject(l.errors.cacheMandatoryAdsFailed):v(e.shift(),n,i).then((function(){t--,m(e,t,n,i,r)})).fail((function(){m(e,t,n,i,r)}))}function h(e,t,n,i){t<=0||0===e.length||v(e.shift(),n,i).then((function(){t--,h(e,t,n,i)})).fail((function(){h(e,t,n,i)}))}function b(e){u.hasOwnProperty(e)&&delete u[e]}function S(e){f.hasOwnProperty(e)&&delete f[e]}function y(e,t){c.setReferenceForAd(e,t)}function A(e,t){c.unsetReferenceForAd(e,t)}function C(e,r){var o=n.AdUtils.getAdId(e);return function(e){return null===a.getCachedAdFolder(e)}(o)?t.Utils.returnResolvedPromise():function(e){return f.hasOwnProperty(e)}(o)?function(e){return f.hasOwnProperty(e)?f[e]:t.Utils.returnResolvedPromise()}(o):function(e,r){var o=n.AdUtils.getAdId(e),s=new jQuery.Deferred;!function(e,t){f.hasOwnProperty(e)||(f[e]=t)}(o,s.promise());var l=d.buildAdFolderPath(o);return function(e,i,r,o){var s=[],l=n.AdUtils.getAdId(e),c=t.PubSub.subscribe("AdsAssetsNativeCommunicator.deleteAdFolderSuccess",p),u=t.PubSub.subscribe("AdsAssetsNativeCommunicator.deleteAdFolderFailure",f);function f(n){n.path===i&&(t.PubSub.clearHandlers(s),S(l),I("deleteAdFromCacheFailure",{demandSourceName:o.demandSourceName,productType:o.productType,ad:e}),r.reject(n.errorMsg))}function p(n){n.path===i&&(t.PubSub.clearHandlers(s),S(l),a.removeAdFromCacheArray(d.getAdLevelCacheConfiguration(),l),I("deleteAdFromCacheSuccess",{demandSourceName:o.demandSourceName,productType:o.productType,ad:e}),r.resolve())}s.push(c,u)}(e,l,s,r),i.deleteFolder(l),s.promise()}(e,r)}function I(e,n){t.PubSub.publish("AdsAssetsManager."+e,[n])}return{init:function(i,u){a=i,function(e){if(0===Object.keys(e).length)return;n.getSegmentationAllocator().addAdLevelCacheSegment(e.adLevelCacheGroup)}(p=u||{}),o=p[l.maxAdsToSaveInCache]||l.defaultMaxAdsToSaveInCache,r=new(e("./AdsAssetsClearanceService"))(t,a,c,n.AdUtils),s=new(e("./AdCacheStatus"))(n,d)},setAdAssetsForAds:function(e){if(e)for(var t=0;t<e.length;t++)e[t].adAssets=d.extractAssetsFromAd(e[t])},cacheAssetsOfAd:v,cacheAdsWithClearanceLogic:function(e,n,i,a,c){if(0===e.length||!n||!r)return t.Utils.returnResolvedPromise(l.errors.cacheAdsWithClearanceLogicConfigurationProblem);var u=JSON.parse(JSON.stringify(e));return function(e,n){if(0===e.length)return t.Utils.returnResolvedPromise();for(var i=[],r=new jQuery.Deferred,a=0;a<e.length;a++)i.push(C(e[a],n));jQuery.when.apply(null,i).then(r.resolve,r.reject),r.promise()}(r.enactClearanceLogic(u,n,d.getAdLevelCacheConfiguration(),o,a).adsToRemoveFromCache,a),function(e,n,i,r,a){function o(){return h(e,n,r,a),t.Utils.returnResolvedPromise()}if(!function(e){return e>0}(i)||function(e,t){for(var n=0;n<t;n++){var i=e[n];if(i&&i.isCacheable)return!1}return!0}(e,i))return o();if(function(e,t){for(var n=0;n<t;n++){var i=e[n];if(i&&i.isCacheable&&!s.isAdExistInCache(i))return!1}return!0}(e,i))return I("adsAlreadyCached",{demandSourceName:r.demandSourceName,productType:r.productType}),o();var l=JSON.parse(JSON.stringify(e));return function(e,t,n,i){var r=new jQuery.Deferred;return m(e,t,n,i,r),r.promise()}(l,i,r,a).then(o)}(u,n,i,a,c)},areNonMandatoryAdsToCacheConfigured:function(e,n){return!(!t.Utils.isDefined(e)||!t.Utils.isDefined(n))&&e<n},setReferencesForAds:function(e,t){var i;if(Array.isArray(e))for(var r=0;r<e.length;r++)(i=e[r])&&i.isCacheable&&y(n.AdUtils.getAdId(e[r]),t)},unsetReferencesForAds:function(e,t){if(Array.isArray(e))for(var i=0;i<e.length;i++)A(n.AdUtils.getAdId(e[i]),t)},unsetReferencesForInstance:function(e){c.unsetAllReferencesForReferrer(e)}}}},{"./AdCacheStatus":135,"./AdsAssetsClearanceService":136,"./AdsReferencesManager":139,"./CacheConstants":141,"./CacheUtils":142}],138:[function(e,t,n){t.exports=function(t,n){var i=e("./CacheConstants"),r=new(e("./CacheUtils"))(t);return{saveFileWithRetry:function(a,o,s,l){var d=[],c=new(e("./CacheAssetRetry"))(l,p),u=t.PubSub.subscribe("NativeCallback.assetCached",(function(e){if(e.path=decodeURIComponent(e.path),e[i.assetKeys.path]!==o||!n.getCacheFileEncodingPatch().isFileNameMatches(r.extractFileNameFromURL(e[i.assetKeys.file]),r.extractFileNameFromURL(a)))return;c.areRetryAttemptsPerformed()&&t.PubSub.publish("AdsAssetsNativeCommunicator.adAssetRetrySuccess",[{demandSourceName:s.demandSourceName,productType:s.productType,file:a,currentRetryAttempt:c.getAttemptsSoFar(),totalRetryAttempts:l.adAssetRetryAttempts}]);t.PubSub.publish("AdsAssetsNativeCommunicator.adsAssetCachedSuccess",[e]),t.PubSub.clearHandlers(d)})),f=t.PubSub.subscribe("NativeCallback.assetCachedFailed",(function(e){if(e.path=decodeURIComponent(e.path),e[i.assetKeys.path]!==o||!n.getCacheFileEncodingPatch().isFileNameMatches(r.extractFileNameFromURL(e[i.assetKeys.file]),r.extractFileNameFromURL(a)))return;if(c.shouldExecuteRetry())return void c.performRetryWithDelay();c.areRetryAttemptsPerformed()&&t.PubSub.publish("AdsAssetsNativeCommunicator.adAssetRetryFailed",[{demandSourceName:s.demandSourceName,productType:s.productType,file:a,currentRetryAttempt:c.getAttemptsSoFar(),totalRetryAttempts:l.adAssetRetryAttempts,errMsg:e.errMsg}]);t.PubSub.publish("AdsAssetsNativeCommunicator.adsAssetCachedFailure",[e]),t.PubSub.clearHandlers(d)}));function p(){n.callSDKFunction("saveFile",{file:a,path:o,overrideExistingFile:!1})}d.push(u,f),p()},deleteFolder:function(e){if(e){var i=[],r=t.PubSub.subscribe("NativeCallback.deleteFolderSuccess",(function(r){n.isIOS()&&(r.path=decodeURIComponent(r.path));if(r.path!==e)return;t.PubSub.publish("AdsAssetsNativeCommunicator.deleteAdFolderSuccess",[r]),t.PubSub.clearHandlers(i)})),a=t.PubSub.subscribe("NativeCallback.deleteFolderFailed",(function(r){n.isIOS()&&(r.path=decodeURIComponent(r.path));if(r.path!==e)return;t.PubSub.publish("AdsAssetsNativeCommunicator.deleteAdFolderFailure",[r]),t.PubSub.clearHandlers(i)}));i.push(r,a),n.callSDKFunction("deleteFolder",{path:e},"deleteFolderSuccess","deleteFolderFailed")}}}}},{"./CacheAssetRetry":140,"./CacheConstants":141,"./CacheUtils":142}],139:[function(e,t,n){t.exports=function(){var e={};function t(t,n){if(t&&n&&e.hasOwnProperty(t)){var i=e[t].indexOf(n);-1!==i&&e[t].splice(i,1)}}return{setReferenceForAd:function(t,n){t&&n&&(e.hasOwnProperty(t)||(e[t]=[]),-1===e[t].indexOf(n)&&e[t].push(n))},unsetReferenceForAd:t,unsetAllReferencesForReferrer:function(n){for(var i=Object.keys(e),r=0;r<i.length;r++)t(i[r],n)},getReferenceCountOfAd:function(t){return function(t){return t&&e.hasOwnProperty(t)?e[t]:[]}(t).length}}}},{}],140:[function(e,t,n){t.exports=function(e,t){var n=e&&e.adAssetRetryAttempts,i=e&&e.adAssetRetryInterval,r=0;return{shouldExecuteRetry:function(){return r<n&&"function"==typeof t},areRetryAttemptsPerformed:function(){return r>0},getAttemptsSoFar:function(){return r},performRetryWithDelay:function(){setTimeout((function(){r++,t()}),1e3*i)}}}},{}],141:[function(e,t,n){t.exports={assetKeys:{URL:"URL",size:"size",label:"label",path:"path",file:"file"},errors:{cacheAssetInvalidParams:"Unable to cache asset due to invalid cacheModule/adId/asset",cacheAdsWithClearanceLogicConfigurationProblem:"Unable to cacheAds due to not being in new flow/no ads/no need to cache ads/no clearance service",cacheMandatoryAdsFailed:"Failed to cache mandatory ads"},adsAssetsCacheDir:"ads",supportNewCacheStructureConfigurationKey:"supportNewCacheStructure",fileNameFromURLPattern:/[^/]+$/,adLevelCache:"adLevelCache",maxAdsToSaveInCache:"maxAdsToSaveInCache",defaultMaxAdsToSaveInCache:30}},{}],142:[function(e,t,n){t.exports=function(t){var n=e("./CacheConstants");return{isAssetValid:function(e){return e&&"string"==typeof e[n.assetKeys.URL]},extractAssetsFromAd:function(e){e.ext&&e.ext.appData&&e.ext.appData.adAssets&&(e.ext.appData.appImages=e.ext.appData.adAssets,delete e.ext.appData.adAssets);for(var n=[],i=t.AdAssets.extractStaticFiles(e).filter((function(e,t,n){return n.indexOf(e)===t})),r=0;r<i.length;r++)n.push({URL:i[r]});return n},buildAdFolderPath:function(e){return n.adsAssetsCacheDir+"/"+e},buildAdAssetsPath:function(e,t){return"../"+e+"/"+t},extractFileNameFromURL:function(e){if(!e)return null;var i=e.match(n.fileNameFromURLPattern);return i&&0!==i.length?t.SDKController&&"function"==typeof t.SDKController.isAndroid?t.SDKController.isAndroid()?i[0].split("?")[0]:i[0]:i[0].split("?")[0]:null},getAdLevelCacheConfiguration:function(){return{cacheBase:n.adsAssetsCacheDir}}}}},{"./CacheConstants":141}],143:[function(e,t,n){t.exports=class{constructor(){this.store={}}setData(e,t){this.store[e]=t}getData(e){return this.store[e]}clear(){this.store={}}}},{}],144:[function(e,t,n){t.exports=function(t,n,i,r,a,o,s,l){"use strict";var d,c,u=!1,f=r.demandSourceName,p=n.adUnitUrl,g=n.adPlayerUrl,v=!1,m=new(e("./../../components/MultipleInventories")),h=new(e("./PreloadAdManager"))(t,n),b=e("../../components/OMIDConstants"),S=new(e("./../../components/sdkPluginType/SDKPluginTypeHandler"))(n,t.Utils),y=new(e("./../../components/AdFeaturesParser"))(t,n,i,a,!0),A=new(e("../IOSAudioSessionHandler"))(t,n),C=a.analyticsCategories,I={},D=a.displayMode,w=!1,P=null,O={},F=i.closeButtonStates,T=[],x=i.CB,U=null,N=0,L={},V={},M=n[a.productType],R=new(e("./DemandEntityBuilder.js"))(a,r),k=e("../../patches/PatchIOSLoadAfterLoad.js")(t,n,R),K=e("./FetchDemand/FetcherPatch.js")(t,n,a,o,i),B=n.DemandUtils,E=new(e("./../RewardedVideo/dsTaskManager.js"))(t,n,R,i),j=e("../../components/VastService.js")(t,n),_=new(e("./../RewardedVideo/availabilityReporter.js"))(t,n,a,R,E),W=new(e("./../RewardedVideo/availabilityManager.js"))(t,n,_,a),G=e("../../components/containers/WPADUtils")(n),H=e("../AdPlayer/AdPlayerUtils");const q=new(e("../../components/AndroidSandbox/AndroidSandboxService"))({core:t,controller:n,analytics:o,shouldReceiveMessage:e=>B.shouldReceiveMessage(R,e)});var J=n.InstancesTimers,Q={load:{fail:"",success:""},init:{fail:"",success:""}},$=function(){T.push(t.PubSub.subscribe("StoreKit.storeKitDisplayFailed",(function(e){o.report(C.storeKitDisplayFailed,{generalMessage:e})}))),T.push(t.PubSub.subscribe("StoreKit.storeKitCoolDown",(function(e){B.shouldReceiveMessage(R,e)&&o.report(C.storeKitCoolDown,{generalMessage:e.message})}))),T.push(t.PubSub.subscribe("PrecacheManager.cacheUpdatedCallback",(function(e){if(B.shouldReceiveMessage(R,e)){var t,i,r;if(n.log("globals ready: "+w+" initSuccess in settings: "+I.numOfBannersToInitSuccess+" adUnits: "+m.size(e.inventoryId),n.LogLevels.verbose),0===I.numOfBannersToInitSuccess)i=1,t=s.areCampaignsAvailable(se(e.inventoryId).slice(0,i),i);else{var a=le(e.inventoryId);i=a.length;var o=ee(m.getOffers(e.inventoryId),I.numOfBannersToInitSuccess);r=o<=i?o:i,t=s.areCampaignsAvailable(a,r)}n.log("PM | cacheUpdatedCallback cache updated areCampaignsAvailable: "+t,n.LogLevels.verbose),w&&t&&ne(e.inventoryId)}}))),T.push(t.PubSub.subscribe("PrecacheManager.campaignDeletedCallback",(function(e){if(B.shouldReceiveMessage(R,e)){var i,r={};t.Utils.isDefined(e.id)&&(i=oe(e.id,e.inventoryId),(r=n.AdUtils.updateEventWithAdParams(I,i,r)).inventoryIndex=i&&t.Utils.isDefined(i.inventoryIndex)?i.inventoryIndex:-1),o.report(C.campaignDeletedCache,r)}}))),T.push(t.PubSub.subscribe("PrecacheManager.campaignSavedCallback",(function(e){if(B.shouldReceiveMessage(R,e)){var i,r=-1,a=null,s={};t.Utils.isDefined(e.id)&&(i=oe(e.id,e.inventoryId),a=e.id,r=i&&t.Utils.isDefined(i.inventoryIndex)?i.inventoryIndex:-1,s=n.AdUtils.updateEventWithAdParams(I,i,s)),s=t.Utils.extend(s,{eNameStart:{name:C.campaignSavedCache.name+(a||"")},inventoryIndex:r}),o.trackTimingStop(C.campaignSavedCache,s)}}))),T.push(t.PubSub.subscribe("PrecacheManager.campaignDownloadStartedCallback",(function(e){if(B.shouldReceiveMessage(R,e)){var n=t.Utils.extend(!0,{},C.campaignSavedCache);n.name=n.name+(e.id||""),o.trackTimingStart(n)}}))),T.push(t.PubSub.subscribe("PrecacheManager.cacheAdsSuccessCallback",(function(e){B.shouldReceiveMessage(R,e)&&n.log("RV cacheAdsSuccessCallback "+JSON.stringify(e),n.LogLevels.verbose)}))),T.push(t.PubSub.subscribe("PrecacheManager.cacheNextFail",(function(e){B.shouldReceiveMessage(R,e)&&e.deletedAds&&e.deletedAds.length>0&&t.Utils.each(e.deletedAds,(function(t,i){var r=oe(i,e.inventoryId),a=n.AdUtils.updateEventWithAdParams(I,r,{}),s=e.deletedAdsData;if(s&&s[t].id==i){var l=s[t].failedAssetsUrlsArray.toString();a.rvnomoreoffersreason=l.substring(0,999)}o.report(C.campaignFailedToCache,a),re(i,e.inventoryId)}))}))),T.push(t.PubSub.subscribe("PrecacheManager.fallbackToNonPrecache",(function(e){B.shouldReceiveMessage(R,e)&&(t.PubSub.publish(a.productType+".fallbackToNonPrecache",[e]),o.report(C.fallbackToNonPrecache))}))),T.push(t.PubSub.subscribe("PrecacheManager.cacheAdsFailedCallback",(function(e){if(B.shouldReceiveMessage(R,e)){n.log("RV cacheAdsFailedCallback "+JSON.stringify(e),n.LogLevels.verbose);for(var t,i,r,a,d=e.deletedOffers.length,c=e.deletedOffers,u=e.deletedAdsData,f=0;f<d;f++){var p=c[f],g=oe(p,e.inventoryId),v=n.AdUtils.updateEventWithAdParams(I,g,{});if(u&&u[f].id==p){var h=u[f].failedAssetsUrlsArray.toString();v.rvnomoreoffersreason=h.substring(0,999)}o.report(C.campaignFailedToCache,v),ie(p,e.inventoryId)}if(0===I.numOfBannersToInitSuccess)i=1,t=s.areCampaignsAvailable(se(e.inventoryId).slice(0,i),i);else{var b=le(e.inventoryId);i=b.length;var S=ee(m.getOffers(e.inventoryId),I.numOfBannersToInitSuccess);r=S<=i?S:i,t=s.areCampaignsAvailable(b,r)}w&&t?ne(e.inventoryId):(l.noMoreOffers((a?Q[a]:Q).load.fail,e.errorMsg),_.publishAvailabilityFalse("NoMoreOffers",e.errorLog))}}))),T.push(t.PubSub.subscribe("PrecacheManager.preProcessingFailedCallback",(function(e){B.shouldReceiveMessage(R,e)&&n.log("PM | preProcessingFailedCallback "+e,n.LogLevels.verbose)}))),T.push(t.PubSub.subscribe("Cache.assetRetrySuccess",(function(e){if(B.shouldReceiveMessage(R,e)&&e.file&&e.currentRetryAttempt&&e.totalRetryAttempts){var t=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",n=J.extendEventElapsedTime(R.productType,R.demandSourceName,{generalMessage:t.substring(0,250)});e.assetType===i.assetType.adunitAsset?o.report(C.adUnitRetrySuccess,n):e.assetType===i.assetType.adAsset&&o.report(C.adAssetRetrySuccess,n)}}))),T.push(t.PubSub.subscribe("Cache.assetRetryFailed",(function(e){if(B.shouldReceiveMessage(R,e)&&e.file&&e.currentRetryAttempt&&e.totalRetryAttempts){var t=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",n=J.extendEventElapsedTime(R.productType,R.demandSourceName,{generalMessage:t.substring(0,250)});e.assetType===i.assetType.adunitAsset?o.report(C.adUnitRetryFail,n):e.assetType===i.assetType.adAsset&&o.report(C.adAssetRetryFail,n)}}))),T.push(t.PubSub.subscribe("Cache.executeRetryFileUrlEmpty",(function(e){var t={},n=e.listOfFilesUrls.toString();t.callfailreason=e.failedCachedFile.substring(0,255),t.rvnomoreoffersreason=n.substring(0,999),o.report(C.executeRetryFileUrlEmpty,t)}))),T.push(t.PubSub.subscribe("SDKController.AdTracked",(function(e){B.shouldReceiveMessage(R,e)&&(e=n.AdUtils.formatParamsToAdId(e),n.log("AdTracked with params: "+JSON.stringify(e),n.LogLevels.verbose),o.report(C.adTracked),n.callSDKFunction("adCredited",B.extendCallbackParamsWithParentProductConfig(R,{credits:oe(n.AdUtils.getAdId(e),e.inventoryId).credits}),"adCreditedSuccess","adCreditedFailed"))}))),T.push(t.PubSub.subscribe("SDKController.MrailImpression",(function(e){B.shouldReceiveMessage(R,e)&&(n.log("MrailImpression with params: "+JSON.stringify(e),n.LogLevels.verbose),e=e.hasOwnProperty("callback")?delete e.callback:e,o.report(C.mrailImpression,e))}))),T.push(t.PubSub.subscribe("SDKController.AdStarted",(function(e){if(B.shouldReceiveMessage(R,e)&&n.RingerSwitchService.isInitiated()){var t={},i=ye();i&&i.ext&&(t=Fe(P.ext)),n.RingerSwitchService.startListener(t),n.log("Ringer | startListener ringer status from AdStarted.",n.LogLevels.info)}}))),T.push(t.PubSub.subscribe("SDKController.Analytics",(function(e){if(B.shouldReceiveMessage(R,e)&&e&&e.action){var i=e.action,r=e.eventParam;"fireEvent"===i?(r.label&&Object.keys(r.label).length>0&&t.Utils.extend(r.data,r.label),o.report(r.eName,r.data)):"startTiming"===i?o.trackTimingStart(r.eName,r.data):"stopTiming"===i?o.trackTimingStop(r.eName,r.data):"setCustomData"===i&&(n.log("Controller - setCustomData received",n.LogLevels.verbose),o.updateBaseData(r.data))}}))),T.push(t.PubSub.subscribe("SDKController.AdLoaded",(function(e){if(B.shouldReceiveMessage(R,e)){var r=n.AdUtils.getAdId(e),s=oe(r,e.inventoryId),l=e.inventoryId;if(clearTimeout(d),n.log("ad loaded with params: "+JSON.stringify(e),n.LogLevels.verbose),s&&o.updateBaseData({rvPlayMethod:s.displayMode}),t.Utils.isDefined(e.errMsg)){E.publish("AdErrorState",[B.extendCallbackParamsWithDemandConfig(R,{error:!0})]),n.log("Error in loading ad: "+e.errMsg,n.LogLevels.error);var u={generalMessage:e.errMsg,vastViewCount:0};return u=J.extendEventElapsedTime(R.productType,R.demandSourceName,u),u=n.AdUtils.updateEventWithAdParams(I,s,u),o.report(C.adLoadedError,u),he(s),void function(e){var t=n.AdUtils.getAdId(e),r=E.getStatus().duringEngage;function s(){n.log(a.productType+" adLoaded with error | no offers for user - show dialog",n.LogLevels.verbose),n.setCloseButtonState({productType:a.productType,demandSourceName:f,state:F.close});var t={productType:a.productType,message:c&&c.noOffers?c.noOffers:i.labels.noOffers,yes:"close",alwaysClose:!0};n.postAdUnitEvent({name:"alertUserOnError",options:t}),o.report(C.userAlert,{inventoryIndex:e.inventoryIndex||-1})}re(t,e.inventoryId),r&&!v?s():(n.log("DemandSource | adLoaded with error - removing and moving to next offer",n.LogLevels.verbose),Se(null),n.removeAdUnit(oe(t,e.inventoryId)))}(s)}o.report(C.adLoaded,{vastViewCount:0}),t.Utils.isDefined(e.enableBackButton)&&n.setBackButtonState(e.enableBackButton),e=n.AdUtils.formatParamsToAdId(e),n.onAdLoaded(oe(n.AdUtils.getAdId(e),e.inventoryId));var p={totalNumberCredits:ae(l),numOfAdUnits:m.size(l),adViewId:e.adViewId};W.adLoadedSuccessfully(p,a.forcePreload)}}))),T.push(t.PubSub.subscribe("SDKController.AdVisible",(function(e){B.shouldReceiveMessage(R,e)&&function(e){l.adVisible(),v=!0;var t=n.AdUtils.getAdId(e),i=oe(t,e.inventoryId);n.log("Bidder ProductInstance | adVisible | id="+t),E.publish("Engaged",[B.extendCallbackParamsWithParentProductConfig(R,{duringEngage:!0})]);var r=n.getRecoveryInfo(),a=function(e){if(e&&e.ext&&e.ext.type){if("customEndCard"===e.ext.type&&void 0!==e.ext.UII)return!0}return!1}(i)?1:0;o.trackTimingStop(C.adVisible,{eNameStart:C.showAdCalled,custom_a:r,custom_c:a}),n.log("Bidder ProductInstance | send event adVisible"),n.SKAdImpressionService.startImpression(i,Ue,Ne),re(t,e.inventoryId),o.trackTimingStart(C.adVisibleToClose)}(e)}))),T.push(t.PubSub.subscribe("SDKController.AdError",(function(e){B.shouldReceiveMessage(R,e)&&n.log("SDKController.AdError:"+JSON.stringify(e),n.LogLevels.verbose)}))),T.push(t.PubSub.subscribe("SDKController.dialogBoxResume",(function(e){B.shouldReceiveMessage(R,e)&&o.report(C.dialogBoxResume)}))),T.push(t.PubSub.subscribe("SDKController.dialogBoxExit",(function(e){B.shouldReceiveMessage(R,e)&&o.report(C.dialogBoxExit)}))),T.push(t.PubSub.subscribe("SDKController.adClosed",(function(e){B.shouldReceiveMessage(R,e)&&(Oe()&&(n.log("audioSession | handleAudioSessionEnd",n.LogLevels.info),A.disableControlOverAudioSession()),n.SKAdImpressionService.endImpression(e.ad,Le,Ve))}))),T.push(t.PubSub.subscribe(a.productType+".GetConfig",(function(e){if(B.shouldReceiveMessage(R,e)){n.log("Bidder ProductInstance | getConfig received");var r=ye();if(!r)return void n.log("Bidder ProductInstance | getConfig with no loaded ad");!function(e,r){var a=oe(n.AdUtils.getAdId(e),e.inventoryId);if(a){!function(e){I.requestID&&(e.requestID=I.requestID);var r=function(e){var t=n.decideUrlProtocolAccordingToHTTPSCompliance()+"//"+e;"prod"!==n.getEnv()&&(t=n.api()+"/users/staging/"+SuperSonicGlobalConfig.mobileSDKSettings.env);return t}(n.getApiData({scdn:1,protocol:0,defaultProtocol:1}).scdn);e=t.Utils.extend(!0,e,n.getFormattedDeviceData(),function(e){return{settings:{protocol:n.decideUrlProtocolAccordingToHTTPSCompliance(),urltocdn:e,appKey:n.getSDKDataByKey(i.requiredSDKDataKeys.applicationKey),appOrientation:n.getSDKDataByKey(i.requiredSDKDataKeys.appOrientation),deviceLanguage:n.getSDKDataByKey(i.requiredSDKDataKeys.deviceLanguage),bundleId:n.getSDKDataByKey(i.requiredSDKDataKeys.bundleId),sdkAbName:n.getSDKDataByKey(i.requiredSDKDataKeys.sdkAbName),deviceId:n.getDeviceId(),skOverlaySupported:n.SKOverlayManager.isSKOverlaySupported()}}}(r))}(a),function(e){var i=(!e||e.displayMode!=D.softprecache)&&s.isPrecache();e.settings.omidUrl=function(e){var t=n.OMIDService.getVersionData().omidVersion;if(n.OMIDService.isAdOmidSupported(e)&&b.omidVersionRequiresWebviewPerAd[t])return n.OMIDService.getOmidBundleUrl();return""}(e),void 0===e.productType&&(e.productType=R.productType);void 0===e.demandSourceName&&(e.demandSourceName=R.demandSourceName);void 0!==e.settings.cw&&(e.settings.cw=function(e){var t=n.getDeviceOs();if(e.settings.cw&&e.settings.cw.hasOwnProperty(t))return e.settings.cw[t];return e.settings.cw}(e));e.displayOnAdReady=I.displayOnAdReady,e.settings.precache=i,e.settings.sessionDepth=function(){return n.ImpressionsCounterService.getPayloadCounters(R).instanceImpressions+1}(),e.settings.viewType=I.viewType,e.settings.isGpi=n.isGpi(),t.AdAssets.isAdAbleToCache(e)&&(e.settings.ableToCache=e.ext.ableToCache,delete e.ext.ableToCache)}(a);var o=n.Utils.flattenAd(a);n.ExternalAdProtocols.prepareAd(o),r&&r.callback&&r.callback.call(null,o)}else n.log("line[456]: no current available ad",n.LogLevels.verbose)}(r,e)}}))),T.push(t.PubSub.subscribe(a.productType+"isVisible",(function(e){if(n.log("Bidder ProductInstance | isVisible"),B.shouldReceiveMessage(R,e)){var t=ye();if(n.isAdDisplayed(t))return void n.log("Bidder ProductInstance | isVisible | isAdDisplayed=true");if(!t)return void n.log("Bidder ProductInstance | isVisible | ad is null");n.getCurrentDisplayedAdType()!==a.productType&&n.getCurrentDisplayedAd()||n.setCurrentDisplayedAd(t)}})))};function z(e){var i={};if(t.Utils.isDefined(e.ad)){var r=e.ad&&t.Utils.isDefined(e.ad.inventoryIndex)?e.ad.inventoryIndex:-1;i=n.AdUtils.updateEventWithAdParams(I,e.ad,i),i=t.Utils.extend(i,{inventoryIndex:r})}return i}T.push(t.PubSub.subscribe("ExternalContainer.duringCreation",(function(e){B.shouldReceiveMessage(R,e)&&o.report(C.duringCreation)})));var X=function(t){var r;if(((r=a.productType)===i.RV||r===i.IS)&&(t&&t.customComponents)){var s=n.environmentConfiguration(),l=new(e("../DynamicUI/CustomComponentsEvents"))(o);new(e("../DynamicUI/CustomComponentsLoader"))(n,l,s.getDynamicUIHost()).downloadCustomComponents(t.customComponents)}};function Y(e){for(var t=0;t<e.length;t++)e[t].isCacheable=e[t].adAssets.length>0||n.AdUtils.isPlayablePrecachedAd(e[t])}function Z(e){t.Utils.each(e,(function(e,t){t.inventoryIndex=e}))}var ee=function(e,t){for(var n=e.length<t?e.length:t,i=t,r=0;r<n;r++)e[r].isCacheable||i--;return i},te=function(){E.publish("InitiatedAPICall",[B.extendCallbackParamsWithProductConfig(R,{duringInit:!1})])},ne=function(e){if(n.log("Bidder ProductInstance | handlePossibleAdUnitsReady",n.LogLevels.verbose),de(e)){var r=m.size(e),o=ae(e);te(),a.forcePreload||W.canReportAvailable(r,o),function(e,r){var a=de(r),o=s.isPrecache();h.canPreloadCandidateAd(!1,!1,a,!1,o,I.displayOnAdReady)&&function(e){var r=new window.jQuery.Deferred;if(!E.canPreload())return n.log("Cannot preload at this time, "+E.getStatusMsg(),n.LogLevels.error),t.Utils.returnRejectedPromise(i.errors.showAdFailedReasons.taskManagerPreload);var a=ye()||de(e);if(!a)return n.log("Cannot preload with no offer",n.LogLevels.error),t.Utils.returnRejectedPromise(i.errors.showAdFailedReasons.preloadNoAd);a=t.Utils.extend(!0,a,R),xe(a,!1,r),r.promise()}(r)}(0,e)}},ie=function(e,t){m.removeOfferById(e,t)&&!m.isEmpty(t)&&s.incrementNextCampaign()},re=function(e,t){var i=m.getOfferById(e,t);i?i.toRemove=!0:n.log("Error in mark current ad to be removed:"+e,n.LogLevels.error)},ae=function(e){for(var t=0,n=m.getOffers(e),i=m.size(e),r=0;r<i;r++)t+=n[r].credits;return t},oe=function(e,t){var i=m.getOfferById(e,t);return i||n.log("Error in getAdUnitById, id "+e+" not found in "+JSON.stringify(m.getOffers(t)),1),i},se=function(e){return m.getOffers(e).filter((function(e){return!(t.Utils.isDefined(e.toRemove)&&e.toRemove)}))},le=function(e){return se(e).filter((function(e){return e.isCacheable}))},de=function(e){var t,i=oe(n.AdUtils.getAdId(fe(e)),e);return s.isPrecache()&&i&&i.isCacheable?(i=oe(n.AdUtils.getAdId(ue(e)),e),t=D.precache):t=D.nonprecache,i&&!i.displayMode&&ce(i,t),i},ce=function(e,t){e&&(e.displayMode=t)},ue=function(e){return 0===I.numOfBannersToInitSuccess?s.getCurrentAd(se(e).slice(0,1)):s.getCurrentAd(se(e))},fe=function(e){return m.getCurrentOffer(e)},pe=function(e){v=!1;var i=n.AdUtils.getAdId(e);E.publish("Engaged",[B.extendCallbackParamsWithProductConfig(R,{duringEngage:!1})]);var r=oe(i,e.inventoryId);clearTimeout(d),r?(n.log("onEngageEnd with params: "+JSON.stringify(r),n.LogLevels.verbose),t.Utils.isDefined(r)&&r.toRemove&&(n.AdsAssetsManager.unsetReferencesForAds([e],R.instanceUniqueId),n.log("removing ad id: "+i,n.LogLevels.verbose),ie(i,r.inventoryId))):n.log("Tried to end engage with no ad",n.LogLevels.error)},ge=function(e){var n=new window.jQuery.Deferred;if(t.Utils.isDefined(e.response)&&t.Utils.isDefined(e.response.errorCode)){te();var i=t.Utils.isDefined(e.response.errorMessage)&&e.response.errorMessage?e.response.errorMessage:a.errors.init[1003];n.reject(i)}else t.Utils.isDefined(e.seatbid)&&t.Utils.isDefined(e.seatbid.bid)&&t.Utils.isDefined(e.seatbid.ext)&&t.Utils.isDefined(e.seatbid.ext.labels)?n.resolve(e):(te(),n.reject(a.errors.init[1004]));return n.promise()},ve=function(e){var r=function(e){return I.disableTokenFiltering||void 0===e||0===e.length||(e.forEach(be),function(e){if(e){var t={blacklistedCampaigns:e.join(",")};n.getTokenService().updateToken(t)}}(M.filteredListService.getFilteredListCampaigns())),t.Utils.returnResolvedPromise()},l=function(e){for(var i=e&&e.length||0,r="",a=0;a<i;a++)r+=n.AdUtils.getAdType(e[a],I),a<i-1&&(r+=", ");return o.updateBaseData({feedSize:i,feedCampaignOrder:r}),t.Utils.returnResolvedPromise()},d=function(e){return function(e){for(var n=0;n<e.length;n++){var i=e[n].ext.layoutData;if(t.Utils.isDefined(i)&&t.Utils.isDefined(i.html)&&i.html.length>0)return!0}return!1}(e)?n.libsManager.manageDownloadLibsFileByFiletype(a.libsCacheFiles.dapi):t.Utils.returnResolvedPromise()},u=function(e){var i=s.isPrecache()&&function(e){for(var t=!1,i=0;i<e.length;i++)if(n.AdUtils.isPlayablePrecachedAd(e[i])){t=!0;break}return t}(e);return i?n.libsManager.manageDownloadLibsFileByFiletype(a.libsCacheFiles.externalObfuscation).then((function(t){!function(e,t){for(var i=0;i<e.length;i++)n.AdUtils.isPlayablePrecachedAd(e[i])&&(e[i].ext.ableToCache="success"===t)}(e,t)})):t.Utils.returnResolvedPromise()},f=function(e){return e.some((function(e){return n.OMIDService.isAdOmidSupported(e,a.productType)}))&&n.OMIDService.downloadOmidJsBundle(),t.Utils.returnResolvedPromise()},p=function(e,t,i){var r,s=new window.jQuery.Deferred,l=n.AdsAssetsManager.cacheAdsWithClearanceLogic(e,t.numOfBannersToCache,t.numOfBannersToInitSuccess,i,Ie(t)).then((function(){clearTimeout(r),s.resolve()})).fail((function(e){clearTimeout(r),s.reject(e)}));return r=setTimeout((function(){var e=l.state();"pending"!==e&&"rejected"!==e||(o.report(C.adLevelCachingTimeout,{callfailreason:"ad level timeout expired when caching ads"}),s.reject("cacheAdsAssets timeout expired")),"resolved"===e&&s.resolve()}),a.precacheConfig.timeoutForCachingAdsInAdLevelCacheFlow),s.promise()};return function(e){E.setConnection(!0);var g,v=e.seatbid.bid,h=e.seatbid.ext,b=m.getAvailableInventoryId(),S=v.length>0&&v[0].ext.adSource||h.adSource;return o.updateBaseData({landingId:h.landingId,strategyId:h.strategyId,adSource:S,dspname:h.dspName}),h.deliveryPlumbus,window.jQuery.when(function(e){I=y.parse(e)}(e),function(e){e.labels,c=e.labels}(h)).then(X.bind(null,I)).then(we.bind(null,I)).then(De.bind(null,I)).then(n.CampaignsFilter.filterByAppInstalled.bind(null,v,I,a.filterDisableTypes)).then(r).then(l.bind(null,v)).then(f.bind(null,v)).then(s.decidePrecacheStatus.bind(null,{numOfCampaigns:v.length,settings:I})).then((function(){return g=v.length>0&&H.shouldUseAdPlayer(!!n.getConfig().mobileSDKSettings.ext.adPlayerVersion,n.getDeviceOs(),v[0],I,a.productType,parseInt(n.getConfigurationHelper().getDeviceApiLevel())),n.log("should use ad-player? "+g),W.setAMSettings({preFetchAllVasts:I.preFetchAllVasts,isPreCache:s.isPrecache(),numOfBannersToInitSuccess:I.numOfBannersToInitSuccess,reportOnAdunitReady:I.reportOnAdunitReady}),v&&v.length>0?(w=!1,L={productType:a.productType,demandSourceName:R.demandSourceName,retryAttempts:I.adunitRetryAttempts||15,retryInterval:I.adunitRetryInterval||1,assetType:i.assetType.adunitAsset},g?t.Utils.returnResolvedPromise():n.adUnitGlobals.updateAdUnitGlobals(!0,I.purgeAdunitLibsFile,L,o)):t.Utils.returnRejectedPromise(i.errors.noFill)})).then((function(){return g?t.Utils.returnResolvedPromise():window.jQuery.when(d(v),u(v))})).then((function(){return function(e){return e?n.getAdPlayerAssets().prepareAdPlayerAssets(L):t.Utils.returnResolvedPromise()}(g)})).then(n.AdsAssetsManager.setAdAssetsForAds.bind(null,v)).then(Y.bind(null,v)).then(n.AdsAssetsManager.setReferencesForAds.bind(null,v,R.instanceUniqueId)).then(Z.bind(null,v)).then(p.bind(null,v,I,R)).then(Pe.bind(null,v)).then((function(){w=!0;var e=m.setOffers(v.slice(0),b);0!==I.numOfBannersToInitSuccess||a.forcePreload||W.reportAdAvailable({numOfAdUnits:m.size(e),totalNumberCredits:ae(e)}),ne(e)})).fail((function(e){var t=e||"Fail parse adUnit info from api response";n.AdsAssetsManager.unsetReferencesForAds(v,R.instanceUniqueId),m.removeInventory(b),Ae(),Se(null),e&&n.log(e,n.LogLevels.error),_.publishAvailabilityFalse("NoMoreOffers",e||t)})),(new window.jQuery.Deferred).resolve(t.Utils.extend(!0,{},e.seatbid.ext,{numOfAdUnits:e.seatbid.bid.length}))}(e)},me=function(e,r,a){var l,d=n.AdUtils.getAdId(e);n.log("Error in loading ad - timeout in "+d,n.LogLevels.error),l=a?C.showAdFail:C.adLoadedError;var c,u,f={isprecache:s.isPrecache(),callfailreason:"Error in loading ad - timeout"};f=n.AdUtils.updateEventWithAdParams(I,e,f),o.report(l,f),B.extendCallbackParamsWithProductConfig(R,e),re(d,e.inventoryId),Se(null),j.removeIframe((c=d,u="",t.Utils.isDefined(R.demandSourceName)&&(u=R.demandSourceName),u+(R.productType+c))),I.viewType===i.viewTypes.externalView?n.removeAdUnitFromExternal(e):n.removeAdUnit(e)},he=function(e){e&&e.cid?n.blacklistService.addToBlacklistedCampaigns(R.productType,R.demandGroupName,e.cid):n.log("DemandSource | cannot add to blacklist with no ad",n.LogLevels.error)},be=function(e){e&&e.cid&&M.filteredListService.addToFilteredListCampaigns(e.cid)},Se=function(e){P=e};function ye(){return P}var Ae=function(){W.reset(),h.reset(),V={}},Ce=function(){for(var e=Object.keys(m.getInventories()),t=0;t<e.length;t++)n.AdsAssetsManager.unsetReferencesForAds(m.getOffers(e[t]),R.instanceUniqueId)};function Ie(e){return{adAssetRetryAttempts:e.adAssetRetryAttempts||5,adAssetRetryInterval:e.adAssetRetryInterval||1}}function De(e){e&&e.hasOwnProperty(i.numOfBannersToInitSuccess)&&e.hasOwnProperty(i.numOfBannersToCache)&&o.updateBaseData({cacheConfig:e[i.numOfBannersToInitSuccess]+"/"+e[i.numOfBannersToCache]})}function we(e){e&&n.DeviceDataService.setPullDataOnLoadAd(e.enablePullDataOnLoadAd)}function Pe(e){e.forEach((function(e){var t=n.AdUtils.getAdId(e);V.hasOwnProperty(t)&&(e.adAssetsCacheStatus=V[t])}))}function Oe(){return n.isIOS()&&I.manageIOSAudioSession}function Fe(e){return e?{ringerUpdateDelay:I.ringerUpdateDelay,shouldSetRingerUpdateDelay:n.AdUtils.isPlayableCampaign(e)||n.AdUtils.isMRAIDCampaign(e)||n.AdUtils.isExternalCampaign(e)}:{}}function Te(e,r){n.log(r,n.LogLevels.error);var s=B.extendCallbackParamsWithDemandConfig(R,{errMsg:r});t.PubSub.publish(a.productType+".failedToShow",[s]);var l=r;l!==i.errors.showAdFailedReasons.preloadNoAd&&l!==i.errors.showAdFailedReasons.showNoAd&&(l+=E.getStatusMsg()),o.report(C.showAdFail,{callFailReason:l}),n.callSDKFunction(e,B.extendCallbackParamsWithDemandConfig(R,{errMsg:r})),r!==i.errors.showAdFailedReasons.onAdVisibleFailed&&r!==i.errors.showAdFailedReasons.screenVisibleTimeout||t.PubSub.publish(i.taskManager+".Engaged",[B.extendCallbackParamsWithProductConfig(R,{duringEngage:!1})])}function xe(e,r,l){n.log("Bidder ProductInstance | preloadFlow"),h.preloadAdFinished();var c,u=!1,f=s.isPrecache();e&&e.displayMode===D.softprecache&&(u=!0),f&&!u&&function(e){var i=n.AdUtils.getAdId(e),r=s.getConfig().precachePath+i+"/";t.AdAssets.updateAdunitPrecachePath(e,r,n.isAndroid())}(e),e.isWPAD=G.shouldDisplayAdOnExternalWebView(e,I),e.isWPAD?(n.AdUtils.setViewType(I,e,i.viewTypes.externalView),O.shouldBuildAdUnitUrlForExternal=!0,c=2):(n.log("Bidder ProductInstance | ad is not WPAD"),n.AdUtils.removeViewTypeFromSetting(I),O.shouldBuildAdUnitUrlForExternal=!1,c=1),e.displayStrategy=c;var v=n.AdUtils.updateEventWithAdParams(I,e,{});v=t.Utils.extend(v,{displaystrategy:c}),o.updateBaseData(v),Se(e);var m,b=f||n.getAdPlayerAssets().isAdplayerReadyToUseFromCache(),y=!!n.getConfig().mobileSDKSettings.ext.adPlayerVersion,A=n.getDeviceOs(),C=parseInt(n.getConfigurationHelper().getDeviceApiLevel());(function(e,t,n){var i=a.timerLengths.loadAdTimeout;clearTimeout(d),d=setTimeout((function(){me(e,t,n)}),i)})(e,m=H.shouldUseAdPlayer(y,A,e,I,a.productType,C)?g.getAdPlayerUrl(b,A,R,O):p.getAdunitUrl(b,R,O,A),r),I=t.Utils.extend(I,{preload:!0}),n.AdUtils.setViewType(I,e),S.shouldShowInStandAloneView(n.getConfig())&&n.AdUtils.extendSettingsWithStandaloneViewSupport(I),e=n.StoreKitService.updateAdWithStoreAppId(e,I),n.loadAdUnitUrl(e,m,R,I),e.isWPAD?function(e,t){var i=n.getContainerCreationHandler(e),r=i.getState();r===i.getCreationStates().createdSuccessfully?(n.log("product instance | containerState | createdSuccessfully ",n.LogLevels.info),t.resolve(e)):r===i.getCreationStates().duringCreation?window.jQuery.when(i.getCreationResultPromise()).then((function(){n.log("product instance | during creation result: success",n.LogLevels.info),t.resolve(e)})).fail((function(e){t.reject("product instance | "+e)})):t.reject("product instance | did not start to create native webview")}(e,l):l.resolve(e)}function Ue(){o.report(C.startImpressionSuccess)}function Ne(e){o.report(C.startImpressionFailed,{callfailreason:e.errMsg,generalmessage:e.hasOwnProperty("errCode")?e.errCode:-1})}function Le(){o.report(C.endImpressionSuccess)}function Ve(e){o.report(C.endImpressionFailed,{callfailreason:e.errMsg,generalmessage:e.hasOwnProperty("errCode")?e.errCode:-1})}return{name:f,init:function(){u||(Ae(),$(),T.push(t.PubSub.subscribe("AdsAssetsClearanceService.cacheReachedMaximumCapacity",(function(e){if(B.shouldReceiveMessage(R,e)){var t={custom_b:e.maxAdsToSaveInCache};t=J.extendEventElapsedTime(R.productType,R.demandSourceName,t),o.report(C.adLevelCacheReachedMaxCapacity,t)}}))),T.push(t.PubSub.subscribe("AdsAssetsManager.saveAdInCacheSuccess",(function(e){if(B.shouldReceiveMessage(R,e)){var t=z(e);t=J.extendEventElapsedTime(R.productType,R.demandSourceName,t),o.report(C.saveAdInCacheSuccess,t);var i=n.AdsAssetsManager.areNonMandatoryAdsToCacheConfigured(I.numOfBannersToInitSuccess,I.numOfBannersToCache);w&&i&&ne(m.getActiveInventoryId())}}))),T.push(t.PubSub.subscribe("AdsAssetsManager.saveAdInCacheFailure",(function(e){if(B.shouldReceiveMessage(R,e)){var t=z(e);t=J.extendEventElapsedTime(R.productType,R.demandSourceName,t),o.report(C.saveAdInCacheFailure,t),re(n.AdUtils.getAdId(e.ad))}}))),T.push(t.PubSub.subscribe("AdsAssetsManager.deleteAdFromCacheSuccess",(function(e){if(B.shouldReceiveMessage(R,e)){var t=z(e);t=J.extendEventElapsedTime(R.productType,R.demandSourceName,t),o.report(C.deleteAdFromCacheSuccess,t)}}))),T.push(t.PubSub.subscribe("AdsAssetsManager.deleteAdFromCacheFailure",(function(e){if(B.shouldReceiveMessage(R,e)){var t=z(e);t=J.extendEventElapsedTime(R.productType,R.demandSourceName,t),o.report(C.deleteAdFromCacheFailure,t)}}))),T.push(t.PubSub.subscribe("AdsAssetsManager.adsAlreadyCached",(function(e){if(B.shouldReceiveMessage(R,e)){var n=J.extendEventElapsedTime(R.productType,R.demandSourceName,{});n=t.Utils.extend(n,e),o.report(C.adsAlreadyCached,n)}}))),T.push(t.PubSub.subscribe("AdsAssetsNativeCommunicator.adAssetRetrySuccess",(function(e){if(B.shouldReceiveMessage(R,e)){var t=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",n=J.extendEventElapsedTime(R.productType,R.demandSourceName,{generalMessage:t.substring(0,250)});o.report(C.adAssetRetrySuccess,n)}}))),T.push(t.PubSub.subscribe("AdsAssetsNativeCommunicator.adAssetRetryFailed",(function(e){if(B.shouldReceiveMessage(R,e)){var n=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",i=J.extendEventElapsedTime(R.productType,R.demandSourceName,{});i=t.Utils.extend(i,{callfailreason:e.errMsg,generalMessage:n.substring(0,250)}),o.report(C.adAssetRetryFail,i)}}))),T.push(t.PubSub.subscribe("AdsAssetsManager.urlNotMatched",(function(e){if(B.shouldReceiveMessage(R,e)){var n=z(e);n=t.Utils.extend(n,{generalMessage:JSON.stringify(e.asset)}),o.report(C.urlNotMatched,n)}}))),T.push(t.PubSub.subscribe("AdsAssetsManager.adAssetsCacheStatus",(function(e){if(B.shouldReceiveMessage(R,e)){var i=n.AdUtils.getAdId(e.ad);i&&t.Utils.isDefined(e.adAssetsCacheStatus)&&!t.Utils.isDefined(V[i])&&(V[i]=e.adAssetsCacheStatus)}}))),s.init(),E.init(),n.initAnalytics(B.extendCallbackParamsWithParentProductConfig(R,{})),q.init(),u=!0)},loadAdWithAdm:function(e,i,r){!function(e,t,n){Q[e].success=t||Q[e].success,Q[e].fail=n||Q[e].fail}("load",i,r),l.loadWithADM(),n.log("loadAdWithAdm | bidder | resetting last response to none",n.LogLevels.verbose),n.DeviceDataService.shouldPullDataOnLoadAd()&&n.DeviceDataService.pullData(),Ae(),Se(null),K.applyCommunicationSolution(window.timerService.timeElapsed(window.lastWebviewClosedTimer),!E.canEngage()),(E.publish("InitiatedAPICall",[B.extendCallbackParamsWithProductConfig(R,{duringInit:!0})]),t.Utils.returnResolvedPromise(e.adm)).then(ge).then(ve,(function(e){var n;switch(n=a.errors.init[1005],typeof e){case"object":e.responseText&&""!==e.responseText?n=e.responseText:e.errorMessage&&""!==e.errorMessage&&(n=e.errorMessage);break;case"string":""!==e&&(n=e)}return te(),t.Utils.returnRejectedPromise(n)})).then((function(){}),(function(e){try{if("string"==typeof e){var i=parseInt(e);i>1001&&i<1006&&(e=a.errors.load.invalid)}}catch(e){}var o=B.extendCallbackParamsWithDemandConfig(R,{errMsg:e});n.callSDKFunction(r,o),t.PubSub.publish(a.productType+".failedToLoad",[o])}))},showAd:function(e,r,a){var s=ye()||de(m.getActiveInventoryId());function l(e){return function(e){var r=new window.jQuery.Deferred;if(!e)return r.reject(i.errors.showAdFailedReasons.showNoAd);if(!E.canEngage())return r.reject(i.errors.showAdFailedReasons.taskManagerEngage);return function(e){t.PubSub.publish(i.taskManager+".Engaged",[B.extendCallbackParamsWithProductConfig(R,{duringEngage:e})])}(!0),e=t.Utils.extend(e,{showAdCallbacks:{onShowSuccess:r.resolve,onShowFailed:r.reject}}),n.displayAdView(e),r.promise()}(e).then((function(){!function(e){o.trackTimingStop(C.showAdSuccess,{eNameStart:C.showAdCalled}),n.callSDKFunction(e,B.extendCallbackParamsWithDemandConfig(R)),k.onShowSuccess(R)}(r)}),(function(e){Te(a,e)}))}s?(n.RingerSwitchService.isInitiated()&&s&&(n.RingerSwitchService.startListener(Fe(s.ext)),n.log("Ringer | startListener from DS.",n.LogLevels.info)),function(){U=new window.jQuery.Deferred;var e=t.PubSub.subscribe(x+".getDemandSourceStateSuccess",(function(n){B.shouldReceiveMessage(R,n)&&(t.PubSub.unsubscribe(e),t.PubSub.unsubscribe(i),"resolved"!==U.state()&&(N=n&&n.state||N,U.resolve(n)))})),i=t.PubSub.subscribe(x+".getDemandSourceStateFail",(function(n){B.shouldReceiveMessage(R,n)&&(t.PubSub.unsubscribe(i),t.PubSub.unsubscribe(e),"resolved"!==U.state()&&U.resolve())})),r=B.extendCallbackParamsWithParentProductConfig(R);n.callSDKFunction("getDemandSourceState",r,"getDemandSourceStateSuccess","getDemandSourceStateFail")}(),function(){if(Oe())return n.log("audioSession | handleAudioSessionStart",n.LogLevels.info),A.enableControlOverAudioSession();var e=new jQuery.Deferred;return e.resolve(),e.promise()}().always((function(){n.isContainerLoaded(s)?l(s):function(e){var t=new window.jQuery.Deferred;return xe(e,!0,t),t.promise()}(s).then(l).fail((function(e){Te(a,e)}))}))):Te(a,"ShowAd | Bidding | there is no ad to show.")},showAdBanner:function(){var e=ye();if(e){n.setCurrentDisplayedAd(e);var t=n.getAdViewContainer(e);t&&t.shouldReportAdVisible()&&n.onAdVisible()}},reset:function(){Ce(),m.reset(),E.publish("InitiatedTimeoutAttempt",[B.extendCallbackParamsWithProductConfig(R,{duringAPITimeoutAttempts:!1})]),Ae(),Se(null)},getStatus:E.getStatus,statesManager:l,instConfig:r,clearListeners:function(){t.Utils.each(T,(function(e,n){t.PubSub.unsubscribe(n)}))},engageEnd:function(e,r){if(n.log("engageEnd",n.LogLevels.verbose),B.shouldReceiveMessage(R,e)){!function(e){n.log("_resetPreloadedAd",n.LogLevels.verbose),pe(e),o.resetBaseData(i.baseDataKeys),h.setCanPreloadFlag(!0)}(e);var l={handlePrefetchFailedOnBackground:function(e){n.log("_backgroundPrefetchFailed | ManualLoad",n.LogLevels.verbose),this.publishNoMoreOffers(i.noMoreOffersReason.noMoreOffersToShowInFeed)},handlePrefetchFailedOnVisible:function(e){var t;n.log("handlePrefetchFailedOnVisible | manuel load",n.LogLevels.verbose),t=e,s.isPrecache()&&n.AdsAssetsManager.cacheAssetsOfAd(m.getActiveInventory().getCurrentOffer(),R,Ie(I)).then(ne.bind(null,t.inventoryId))},handleAdClosed:function(e){n.log("handleAdClosed | manuel load",n.LogLevels.verbose),n.AdsAssetsManager.unsetReferencesForAds(m.getOffers(e.inventoryId),R.instanceUniqueId),m.removeInventory(e.inventoryId)},publishNoMoreOffers:function(e){n.log("publishNoMoreOffers | ManualLoad",n.LogLevels.verbose);var r=B.extendCallbackParamsWithDemandConfig(R,{errorMsg:e||i.noMoreOffersReason.noMoreOffersToShowInFeed});t.PubSub.publish(a.productType+".NoMoreOffers",[r])}};!function(e){n.log("getAndResetErrorStateFromTaskManager",n.LogLevels.verbose);var t=e.getStatus().adErrorState;return e.publish("AdErrorState",[B.extendCallbackParamsWithProductConfig(R,{error:!1})]),t}(E)?e.engaged?l.handleAdClosed(e):l.handlePrefetchFailedOnBackground(e):e.engaged?l.handlePrefetchFailedOnVisible(e):l.handlePrefetchFailedOnBackground(e),(t.Utils.isFunction(r)?r:function(){})()}},getDSAnalytics:function(){return o},getPreLoadedAd:ye,initProduct:function(){},shouldAvoidHandleFrameClose:function(){return!1}}}},{"../../components/AndroidSandbox/AndroidSandboxService":28,"../../components/OMIDConstants":61,"../../components/VastService.js":83,"../../components/containers/WPADUtils":102,"../../patches/PatchIOSLoadAfterLoad.js":205,"../AdPlayer/AdPlayerUtils":123,"../DynamicUI/CustomComponentsEvents":155,"../DynamicUI/CustomComponentsLoader":156,"../IOSAudioSessionHandler":162,"./../../components/AdFeaturesParser":20,"./../../components/MultipleInventories":55,"./../../components/sdkPluginType/SDKPluginTypeHandler":110,"./../RewardedVideo/availabilityManager.js":174,"./../RewardedVideo/availabilityReporter.js":175,"./../RewardedVideo/dsTaskManager.js":176,"./DemandEntityBuilder.js":145,"./FetchDemand/FetcherPatch.js":149,"./PreloadAdManager":152}],145:[function(e,t,n){t.exports=function(t,n){var i=e("../../components/Constants.js");return{productType:t.productType,demandGroupName:n.demandGroupName||n.demandSourceName,demandSourceName:n.demandSourceName,demandType:n.demandType||i.demandSourceType.demandSource,isInAppBidding:n.isInAppBidding,isOneFlow:n.isOneFlow,isLoadWithAdmFlow:n.isLoadWithAdmFlow,isMultipleAdObjects:!!n.isMultipleAdObjects,demandSourceId:n.demandSourceId,waterfallPosition:n.waterfallPosition,originalDemandSourceName:n.originalDemandSourceName||n.demandSourceName,instanceUniqueId:t.productType+"."+n.demandSourceName,adSize:n.adSize}}},{"../../components/Constants.js":33}],146:[function(e,t,n){t.exports=function(){return{initAd:{name:"initAd",id:1},initAdFail:{name:"initAdFail",id:2},showAd:{name:"showAd",id:4},showAdFail:{name:"showAdFail",id:5},showAdSuccess:{name:"showAdSuccess",id:26},showAdCalled:{name:"showAdCalled",id:-3},adVisible:{name:"adVisible",id:8},videoStarted:{name:"videoStarted",id:9},videoCompleted:{name:"videoCompleted",id:10},endCardDisplayed:{name:"endCardDisplayed",id:11},clickDownloadNow:{name:"clickDownloadNow",id:12},adTracked:{name:"adTracked",id:34},apsAttribution:{name:"apsAttribution",id:41},apsAttributionSuccess:{name:"apsAttributionSuccess",id:42},apsAttributionFailed:{name:"apsAttributionFailed",id:43},endCardDisplayedToClickDownload:{name:"endCardDisplayedToClickDownload",id:-4},campaignSavedCache:{name:"campaignSavedCache",id:106},campaignsAvailableFromCache:{name:"campaignsAvailableFromCache",id:107},noMoreOffers:{name:"noMoreOffers",id:105},clickReplay:{name:"clickReplay",id:111},clickVideoSound:{name:"clickVideoSound",id:112},adVisibleToClose:{name:"adVisibleToClose",id:-5},adUnitRetrySuccess:{name:"adUnitRetrySuccess",id:170},adUnitRetryFail:{name:"adUnitRetryFail",id:171},adLoaded:{name:"adLoaded",id:6},adLoadedError:{name:"adLoadedError",id:7},userAlert:{name:"userAlert",id:113},campaignFailedToCache:{name:"campaignFailedToCache",id:109},campaignDeletedCache:{name:"campaignDeletedCache",id:108},loadAd:{name:"loadAd",id:21},loadAdFailed:{name:"loadAdFailed",id:22},loadAdFailedForExhaustedInstance:{name:"loadAdFailedExhaustedInstance",id:32},loadAdIgnored:{name:"loadAdIgnored",id:24},loadAdSuccess:{name:"loadAdSuccess",id:23},bannerLoaded:{name:"bannerLoaded",id:27},getInventory:{name:"getInventory",id:158},getInventoryFailed:{name:"getInventoryFailed",id:159},getExtraOffersInventoryFailed:{name:"getExtraOffersInventoryFailed",id:160},bannerDestroyed:{name:"bannerDestroyed",id:30},bannerLoadSuccessToVisible:{name:"bannerLoadSuccessToVisible",id:-7},bannerVisibleToClick:{name:"bannerVisibleToClick",id:-8},bannerReloadDuringLoad:{name:"bannerReloadDuringLoad",id:251},bannerLoadedDuringShow:{name:"bannerLoadedDuringShow",id:232},fallbackToNonPrecache:{name:"fallbackToNonPrecache",id:154},parseVastSuccess:{name:"parseVastSuccess",id:240},parseVast:{name:"parseVast",id:-11},parseVastFail:{name:"parseVastFail",id:241},dialogBoxExit:{name:"dialogBoxExit",id:155},dialogBoxResume:{name:"dialogBoxResume",id:156},parseVastInfo:{name:"parseVastInfo",id:157},refreshInterval:{name:"refreshInterval",id:164},attemptToBringNewFeed:{name:"attemptToBringNewFeed",id:163},adAssetRetrySuccess:{name:"adAssetRetrySuccess",id:320},adAssetRetryFail:{name:"adAssetRetryFail",id:321},executeRetryFileUrlEmpty:{name:"executeRetryFileUrlEmpty",id:323},saveAdInCacheSuccess:{name:"saveAdInCacheSuccess",id:279},saveAdInCacheFailure:{name:"saveAdInCacheFailure",id:280},deleteAdFromCacheSuccess:{name:"deleteAdFromCacheSuccess",id:281},deleteAdFromCacheFailure:{name:"deleteAdFromCacheFailure",id:282},adLevelCacheReachedMaxCapacity:{name:"adLevelCacheReachedMaxCapacity",id:283},adsAlreadyCached:{name:"adsAlreadyCached",id:284},adLevelCachingTimeout:{name:"adLevelCachingTimeout",id:285},duringCreation:{name:"duringCreation",id:287},startImpressionSuccess:{name:"startImpressionSuccess",id:304},startImpressionFailed:{name:"startImpressionFailed",id:305},endImpressionSuccess:{name:"endImpressionSuccess",id:306},endImpressionFailed:{name:"endImpressionFailed",id:307},overlayDismissed:{name:"overlayDismissed",id:299},overlayDismissFailure:{name:"overlayDismissFailure",id:337},overlayRemovalFailure:{name:"overlayRemovalFailure",id:338},overlayMissing:{name:"overlayMissing",id:339},presentOverlay_c:{name:"presentOverlay_c",id:352},overlayDidFinishPresentation_c:{name:"overlayDidFinishPresentation_c",id:353},presentOverlayFailed_c:{name:"presentOverlayFailed_c",id:354},dismissOverlay_c:{name:"dismissOverlay_c",id:355},overlayWillStartDismissal_c:{name:"overlayWillStartDismissal_c",id:356},overlayDidFinishDismissal_c:{name:"overlayDidFinishDismissal_c",id:357},overlayWillStartPresentation_c:{name:"overlayWillStartPresentation_c",id:358},presentOverlayDuringPendingPresent:{name:"podpp",id:359},noFill:{name:"noFill",id:20},urlNotMatched:{name:"urlNotMatched",id:349},storeKitCoolDown:{name:"storeKitCoolDown",id:374},storeKitDisplayFailed:{name:"storeKitDisplayFailed",id:375},customComponentDownloadSuccess:{name:"customComponentDownloadSuccess",id:361},customComponentDownloadError:{name:"customComponentDownloadError",id:362},mrailImpression:{name:"mrailImpression",id:414},destroyMultipleAdInstance:{name:"destroyMultipleAdInstance",id:290},getTokenFromNativeFailed:{name:"getTokenFromNativeFailed",id:423},getTokenFromNativeSuccess:{name:"getTokenFromNativeSuccess",id:424}}}},{}],147:[function(e,t,n){t.exports={direct:{http:{method:"GET",dataType:"jsonp"}}}},{}],148:[function(e,t,n){t.exports=function(t){var n=e("./FetchDemandConst.js");return{fetchFeed:function(e,i,r){return t({url:e,data:i,type:n.direct.http.method,dataType:n.direct.http.dataType,timeout:r||1e4})},get:function(e,i,r){return t({url:e,data:i,type:n.direct.http.method,timeout:r||1e4})}}}},{"./FetchDemandConst.js":147}],149:[function(e,t,n){t.exports=function(e,t,n,i,r){var a=295e3,o=t.getConfig().mobileSDKSettings.deviceOs,s=t.getConfig().controllerConfig||{},l={applyPatchLogic:{name:"applyPatchLogic",id:841},applyPatchLogicEnd:{name:"applyPatchLogicEnd",id:842}};function d(){setTimeout((function(){t.callSDKFunction("displayWebView",{display:!1}),window.timerService.stopTimer(window.lastWebviewClosedTimer),window.lastWebviewClosedTimer=window.timerService.startTimer()}))}function c(t){var n=e.PubSub.subscribe(r.CB+".viewableChange",(function(t){t.isViewable&&(e.PubSub.unsubscribe(n),d())})),a=e.PubSub.subscribe(r.CB+".webviewPatch",(function(){e.PubSub.unsubscribe(a),function(e){var t=window.timerService.timeElapsed(window.lastWebviewClosedTimer)-e;i.report(l.applyPatchLogicEnd,{generalMessage:t>0?t:-9})}(t),d()}))}function u(e){if(o!==r.deviceOs.android)return!1;if("number"!=typeof e||e<a)return!1;var n=t.SupplyConfigurations.getNetworkConfigValueByKey("shouldApplyNetworkSolution"),i=s.shouldApplyNetworkSolution;return!1!==n&&!1!==i}return{applyCommunicationSolution:function(e,n){var o;u(e)&&(n||(t.log("applyCommunicationSolution five minutes communication issue | timeElapsed window.lastWebviewClosedTimer > 5 minutes: "+e),o=e,i.report(l.applyPatchLogic,{generalMessage:a>0?o:-8}),c(e),t.callSDKFunction(r.nativeInterfaceMethod.displayWebView,{display:!0,productType:r.IS,activityThemeTranslucent:!0,success:"webviewPatch"})))},shouldApplyCommunicationSolution:u}}},{}],150:[function(e,t,n){t.exports=function(t,n,i,r){var a,o,s=e("./PayloadBuilderConstants.js"),l="PayloadBuilder | ",d=e("../../components/storeKit/SKANModel")(),c=i.productType,u=i.demandSourceName,f=i.demandGroupName,p=0,g=!1,v=0,m=t.getConfig().controllerConfig;function h(e){var i=t.getSDKDataByKey(r.abTests.abt);return i&&i.hasOwnProperty(r.abtParamByProductType[c])&&i[r.abtParamByProductType[c]].length>0&&(e.abt=i[r.abtParamByProductType[c]]),n.Utils.returnResolvedPromise(e)}function b(e){var i=d.extractDataForPayload(m,t.getConfig().applicationSettings);return e=n.Utils.extend(e,i),n.Utils.returnResolvedPromise(e)}function S(e){return e=n.Utils.extend(e,{demandSource:u,impressionsCount:p,auid:t.AppUserIdService.getAUID()}),n.Utils.returnResolvedPromise(e)}function y(e){var r=t.ImpressionsCounterService.getPayloadCounters(i);return e=n.Utils.extend(e,r),n.Utils.returnResolvedPromise(e)}function A(e){var r={},s=t.getApiData({fpf:0});g&&s&&(r.fpf=s.fpf);var l=i.waterfallPosition;return n.Utils.isDefined(l)&&(r.wp=l),r.retryCounter=v,r.delpl=a,o&&(r.sesp=o),e=n.Utils.extend(e,r),n.Utils.returnResolvedPromise(e)}function C(e){var i=t.getApiData({segmentId:0}),r=t.getApiData({segmentName:0});return i&&r&&(e=n.Utils.extend(e,{segmentId:i.segmentId,segmentName:r.segmentName})),n.Utils.returnResolvedPromise(e)}function I(e){var i=t.getApiData({coppa:0});return e.cscd=i&&i.coppa,n.Utils.returnResolvedPromise(e)}function D(e){var i=t.getApiData({med_ver:0});return i&&i.med_ver&&(e.medv=i.med_ver),n.Utils.returnResolvedPromise(e)}function w(e){var i=new window.jQuery.Deferred;return t.shouldExtendApiDataWithDebugData()?t.getSDKDebugParams().then((function(t){return e=n.Utils.extend(e,t),n.Utils.returnResolvedPromise(e)})).always((function(){i.resolve(e)})):i.resolve(e),i.promise()}function P(e){if(!t.blacklistService.isEmpty(c,f)){var i=t.blacklistService.getBlacklistedCampaigns(c,f);e=n.Utils.extend(e,{blacklistedCampaigns:i.join(",")})}return n.Utils.returnResolvedPromise(e)}function O(e){return t.LastSeenCampaignService.shouldAddLastDisplayedAdCampaignIdToPayload(c)&&(e=n.Utils.extend(e,{lastSeenCampaignId:t.LastSeenCampaignService.getLastDisplayedAdCampaignId()})),n.Utils.returnResolvedPromise(e)}function F(e){if(t.OMIDService.isNativeServiceActivated()){var i=t.OMIDService.getVersionData();e=n.Utils.extend(e,{omidEnabled:!0,omidVersion:i.omidVersion,omidPartnerVersion:i.omidPartnerVersion})}else e=n.Utils.extend(e,{omidEnabled:!1,moatSupported:!1});return n.Utils.returnResolvedPromise(e)}function T(e){return t.getTokenService().getToken().then((function(i){if("object"!=typeof i)return n.Utils.returnResolvedPromise(e);var a,o=(a=t.SupplyConfigurations.getNetworkConfigValueByKey(s.addTokenKeysToPayload),Array.isArray(a)||(a=[]),a);return n.Utils.each(i,(function(t,n){var i;i=t,(o.indexOf(i)>-1||function(e){return e.indexOf(s.metaDataPrefix)>-1}(t))&&(e[t]=n)})),i.hasOwnProperty(s.metaDataOneTokenKey)&&function(e,t){"object"==typeof t&&n.Utils.each(t,(function(t,n){e[s.metaDataPrefix+t]=n}))}(e,i[s.metaDataOneTokenKey]),t.isIOS()&&!t.isLegacy(t.featureMap.mutableAdvertingTrackingData)&&function(e,i){var a=function(e){for(var t,n={},i=r.advertiserIdParamsToUpdate,a=0;a<i.length;a++)void 0!==e[t=i[a]]&&(n[t]=e[t]);return n}(i);if(!a)return;t.getConfigurationHelper().parseConfiguration(a,{},t.getConfig().mobileSDKSettings),t.AdvertisingIdService.decideOnAdvertisingId(t.getConfig().mobileSDKSettings,m),n.Utils.each(a,(function(n,i){var r=t.getSDKDataByKey(n);void 0!==r&&(e[n]=r)}))}(e,i),n.Utils.returnResolvedPromise(e)})).fail((function(){return n.Utils.returnResolvedPromise(e)}))}function x(e){return e=N(e,r.xCodeData.xCodeVersion),e=N(e,r.xCodeData.xCodeBuildVersion),e=N(e,r.xCodeData.xCodeSdkName),e=N(e,r.xCodeData.xCodeSdkBuild),n.Utils.returnResolvedPromise(e)}function U(e){return e.mediationABGroup=t.SupplyConfigurations.getValueByKey("abInternal"),n.Utils.returnResolvedPromise(e)}function N(e,i){var r=t.getSDKDataByKey(i);return r&&(e=n.Utils.extend(e,{[i]:r})),e}function L(e){return t.log(l+"returnPayload | built payload for "+c),n.Utils.returnResolvedPromise(e)}return{createPayload:function(e){return p=e.impressionsCount,g=e.firstAttemptToGetFeed,v=e.retryCounter,a=e.deliveryPlumbus,o=e.sesp,t.getApplicationInfo(t.DemandUtils.extendCallbackParamsWithParentProductConfig(i,{})).then(t.getAPIRequiredData).then(S).then(y).then(A).then(I).then(D).then(C).then(h).then(b).then(w).then(P).then(O).then(F).then(T).then(x).then(U).then(L)}}}},{"../../components/storeKit/SKANModel":112,"./PayloadBuilderConstants.js":151}],151:[function(e,t,n){t.exports={CB:"NativeCallback",metaDataPrefix:"metadata_",metaDataOneTokenKey:"md",addTokenKeysToPayload:"addTokenKeysToPayload",nativeFunction:"iabTokenAPI",nativeAPI:{getToken:"getToken"},callbacks:{getTokenSuccess:"getTokenSuccess",getTokenFailed:"getTokenFailed"},errorLog:"payloadBuilder | getToken Failed"}},{}],152:[function(e,t,n){t.exports=function(e,t){var n=!0;function i(e){n=!!e}return{canPreloadCandidateAd:function(i,r,a,o,s,l){if(!n)return t.log("PreloadAdManager | Can not preload next ad right now"),!1;if(i&&!r)return t.log("PreloadAdManager | Skipping preload on capped demand"),!1;if(l)return t.log("PreloadAdManager | can preload true | Display when ad ready true"),!0;var d=e.VastUtils.isVastCampaign(a);return r||s&&!d||o?(t.log("PreloadAdManager | preload ad "+t.AdUtils.getAdId(a)),!0):(t.log("PreloadAdManager | skip preload ad "+t.AdUtils.getAdId(a)),!1)},preloadAdFinished:function(){i(!1)},setCanPreloadFlag:i,reset:function(){i(!0)}}}},{}],153:[function(e,t,n){function i(t,n,i,r,a,o,s,l){"use strict";var d,c,u=!1,f=r.demandSourceName,p=n.adUnitUrl,g=n.adPlayerUrl,v=new(e("./../../components/MultipleInventories.js")),m=new(e("./PreloadAdManager"))(t,n),h=e("../../components/OMIDConstants"),b=new(e("./../../components/AdFeaturesParser"))(t,n,i,a,!1),S=new(e("../../patches/PublisherPatchEasybrain.js"))(n.getConfigurationHelper()),y=new(e("./../../components/sdkPluginType/SDKPluginTypeHandler.js"))(n,t.Utils),A=a.analyticsCategories,C={},I=t.Utils.extend(!0,{},a.precacheConfig),D=a.displayMode,w=!1,P=0,O=null,F=null,T=null,x=!1,U,N=[],L,V={},M,R=i.closeButtonStates,k=!1,K=[],B=null,E=null,j=null,_=i.CB,W=null,G=0,H={},q={},J={},Q,$=n[a.productType],z=new(e("./DemandEntityBuilder.js"))(a,r),X=e("../../patches/PatchIOSLoadAfterLoad.js")(t,n,z),Y=o,Z=e("./FetchDemand/FetcherPatch.js")(t,n,a,Y,i),ee=n.DemandUtils,te=new(e("./../RewardedVideo/dsTaskManager.js"))(t,n,z,i),ne=e("../../components/VastService.js")(t,n),ie=new(e("./../RewardedVideo/availabilityReporter.js"))(t,n,a,z,te),re=new(e("./../RewardedVideo/availabilityManager.js"))(t,n,ie,a),ae=new(e("./PayloadBuilder.js"))(n,t,z,i),oe=e("../../components/containers/WPADUtils")(n),se=e("../AdPlayer/AdPlayerUtils"),le=new(e("../IOSAudioSessionHandler"))(t,n),de,ce=!0,ue=!1,fe=n.getExternalContainer(),pe=n.InstancesTimers,ge=function(){K.push(t.PubSub.subscribe("StoreKit.storeKitDisplayFailed",(function(e){Y.report(A.storeKitDisplayFailed,{generalMessage:e})}))),K.push(t.PubSub.subscribe("StoreKit.storeKitCoolDown",(function(e){ee.shouldReceiveMessage(z,e)&&Y.report(A.storeKitCoolDown,{generalMessage:e.message})}))),K.push(t.PubSub.subscribe("PrecacheManager.cacheUpdatedCallback",(function(e){if(ee.shouldReceiveMessage(z,e)){var t,i,r;if(n.log("globals ready: "+w+" initSuccess in settings: "+C.numOfBannersToInitSuccess+" adUnits: "+v.size(e.inventoryId),n.LogLevels.verbose),0===C.numOfBannersToInitSuccess)i=1,t=de.areCampaignsAvailable(rt(e.inventoryId).slice(0,i),i);else{var a=at(e.inventoryId);i=a.length;var o=$e(v.getOffers(e.inventoryId),C.numOfBannersToInitSuccess);r=o<=i?o:i,t=de.areCampaignsAvailable(a,r)}n.log("PM | cacheUpdatedCallback cache updated areCampaignsAvailable: "+t,n.LogLevels.verbose),w&&t&&Ye(e.inventoryId)}}))),K.push(t.PubSub.subscribe("PrecacheManager.campaignDeletedCallback",(function(e){if(ee.shouldReceiveMessage(z,e)){var i,r={};t.Utils.isDefined(e.id)&&(i=nt(e.id,e.inventoryId),(r=n.AdUtils.updateEventWithAdParams(C,i,r)).inventoryIndex=i&&t.Utils.isDefined(i.inventoryIndex)?i.inventoryIndex:-1),Y.report(A.campaignDeletedCache,r)}}))),K.push(t.PubSub.subscribe("PrecacheManager.campaignSavedCallback",(function(e){if(ee.shouldReceiveMessage(z,e)){var i,r=-1,a=null,o={};t.Utils.isDefined(e.id)&&(i=nt(e.id,e.inventoryId),a=e.id,r=i&&t.Utils.isDefined(i.inventoryIndex)?i.inventoryIndex:-1,o=n.AdUtils.updateEventWithAdParams(C,i,o)),o=t.Utils.extend(o,{eNameStart:{name:A.campaignSavedCache.name+(a||"")},inventoryIndex:r}),Y.trackTimingStop(A.campaignSavedCache,o)}}))),K.push(t.PubSub.subscribe("PrecacheManager.campaignDownloadStartedCallback",(function(e){if(ee.shouldReceiveMessage(z,e)){var n=t.Utils.extend(!0,{},A.campaignSavedCache);n.name=n.name+(e.id||""),Y.trackTimingStart(n)}}))),K.push(t.PubSub.subscribe("PrecacheManager.cacheAdsSuccessCallback",(function(e){ee.shouldReceiveMessage(z,e)&&n.log("RV cacheAdsSuccessCallback "+JSON.stringify(e),n.LogLevels.verbose)}))),K.push(t.PubSub.subscribe("PrecacheManager.cacheNextFail",(function(e){ee.shouldReceiveMessage(z,e)&&e.deletedAds&&e.deletedAds.length>0&&t.Utils.each(e.deletedAds,(function(t,i){var r=nt(i,e.inventoryId),a=n.AdUtils.updateEventWithAdParams(C,r,{}),o=e.deletedAdsData;if(o&&o[t].id==i){var s=o[t].failedAssetsUrlsArray.toString();a.rvnomoreoffersreason=s.substring(0,999)}Y.report(A.campaignFailedToCache,a),et(i,e.inventoryId)}))}))),K.push(t.PubSub.subscribe("PrecacheManager.fallbackToNonPrecache",(function(e){ee.shouldReceiveMessage(z,e)&&(t.PubSub.publish(a.productType+".fallbackToNonPrecache",[e]),Y.report(A.fallbackToNonPrecache))}))),K.push(t.PubSub.subscribe("PrecacheManager.cacheAdsFailedCallback",(function(e){if(ee.shouldReceiveMessage(z,e)){n.log("RV cacheAdsFailedCallback "+JSON.stringify(e),n.LogLevels.verbose);for(var t,i,r,a=e.deletedOffers.length,o=e.deletedOffers,s=e.deletedAdsData,l=0;l<a;l++){var d=o[l],c=nt(d,e.inventoryId),u=n.AdUtils.updateEventWithAdParams(C,c,{});if(s&&s[l].id==d){var f=s[l].failedAssetsUrlsArray.toString();u.rvnomoreoffersreason=f.substring(0,999)}Y.report(A.campaignFailedToCache,u),Ze(d,e.inventoryId)}if(0===C.numOfBannersToInitSuccess)i=1,t=de.areCampaignsAvailable(rt(e.inventoryId).slice(0,i),i);else{var p=at(e.inventoryId);i=p.length;var g=$e(v.getOffers(e.inventoryId),C.numOfBannersToInitSuccess);r=g<=i?g:i,t=de.areCampaignsAvailable(p,r)}re.cacheAdsFailed(w,t,e.errorLog,Ye.bind(null,e.inventoryId))}}))),K.push(t.PubSub.subscribe("PrecacheManager.preProcessingFailedCallback",(function(e){if(ee.shouldReceiveMessage(z,e)){n.log("PM | preProcessingFailedCallback "+e,n.LogLevels.verbose);var t=e.id,i=nt(t,e.inventoryId);Ge(i)&&(ee.extendCallbackParamsWithProductConfig(z,i),n.addAdToLoadedCreatives(i),Xe(),Ie(i))}}))),K.push(t.PubSub.subscribe("Cache.assetRetrySuccess",(function(e){if(ee.shouldReceiveMessage(z,e)&&e.file&&e.currentRetryAttempt&&e.totalRetryAttempts){var t=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",n=pe.extendEventElapsedTime(z.productType,z.demandSourceName,{generalMessage:t.substring(0,250)});e.assetType===i.assetType.adunitAsset?Y.report(A.adUnitRetrySuccess,n):e.assetType===i.assetType.adAsset&&Y.report(A.adAssetRetrySuccess,n)}}))),K.push(t.PubSub.subscribe("Cache.assetRetryFailed",(function(e){if(ee.shouldReceiveMessage(z,e)&&e.file&&e.currentRetryAttempt&&e.totalRetryAttempts){var t=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",n=pe.extendEventElapsedTime(z.productType,z.demandSourceName,{generalMessage:t.substring(0,250)});e.assetType===i.assetType.adunitAsset?Y.report(A.adUnitRetryFail,n):e.assetType===i.assetType.adAsset&&Y.report(A.adAssetRetryFail,n)}}))),K.push(t.PubSub.subscribe("Cache.executeRetryFileUrlEmpty",(function(e){var t={},n=e.listOfFilesUrls.toString();t.callfailreason=e.failedCachedFile.substring(0,255),t.rvnomoreoffersreason=n.substring(0,999),Y.report(A.executeRetryFileUrlEmpty,t)}))),K.push(t.PubSub.subscribe("SDKController.AdTracked",(function(e){ee.shouldReceiveMessage(z,e)&&(e=n.AdUtils.formatParamsToAdId(e),n.log("AdTracked with params: "+JSON.stringify(e),n.LogLevels.verbose),Y.report(A.adTracked),n.callSDKFunction("adCredited",ee.extendCallbackParamsWithParentProductConfig(z,{credits:nt(n.AdUtils.getAdId(e),e.inventoryId).credits}),"adCreditedSuccess","adCreditedFailed"))}))),K.push(t.PubSub.subscribe("SDKController.MrailImpression",(function(e){ee.shouldReceiveMessage(z,e)&&(n.log("MrailImpression with params: "+JSON.stringify(e),n.LogLevels.verbose),e=e.hasOwnProperty("callback")?delete e.callback:e,Y.report(A.mrailImpression,e))}))),K.push(t.PubSub.subscribe("SDKController.AdStarted",(function(e){if(ee.shouldReceiveMessage(z,e)&&n.RingerSwitchService.isInitiated()){var t={},i=kt();i&&i.ext&&(t=Dn(T.ext)),n.RingerSwitchService.startListener(t),n.log("Ringer | startListener ringer status from AdStarted.",n.LogLevels.info)}}))),K.push(t.PubSub.subscribe("SDKController.Analytics",(function(e){if(ee.shouldReceiveMessage(z,e)&&e&&e.action){var i=e.action,r=e.eventParam;"fireEvent"===i?(r.label&&Object.keys(r.label).length>0&&t.Utils.extend(r.data,r.label),Y.report(r.eName,r.data)):"startTiming"===i?Y.trackTimingStart(r.eName,r.data):"stopTiming"===i?Y.trackTimingStop(r.eName,r.data):"setCustomData"===i&&(n.log("Controller - setCustomData received",n.LogLevels.verbose),Y.updateBaseData(r.data))}}))),K.push(t.PubSub.subscribe("SDKController.AdLoaded",(function(e){if(ee.shouldReceiveMessage(z,e)){var i=n.AdUtils.getAdId(e),r=nt(i,e.inventoryId),a=e.inventoryId;clearTimeout(U),n.log("ad loaded with params: "+JSON.stringify(e),n.LogLevels.verbose),r&&Y.updateBaseData({rvPlayMethod:r.displayMode});var o=0;if(t.VastUtils.isVastCampaign(r)&&(o=t.VastUtils.getVastViewCount(r)),t.Utils.isDefined(e.errMsg)){te.publish("AdErrorState",[ee.extendCallbackParamsWithDemandConfig(z,{error:!0})]),n.log("Error in loading ad: "+e.errMsg,n.LogLevels.error);var s={generalMessage:e.errMsg,vastViewCount:t.VastUtils.getVastViewCountForEvent(o)};return s=n.AdUtils.updateEventWithAdParams(C,r,s),s=pe.extendEventElapsedTime(z.productType,z.demandSourceName,s),Y.report(A.adLoadedError,s),t.VastUtils.setMaxVastCount(r),Nt(r),void Ie(r)}var l=pe.extendEventElapsedTime(z.productType,z.demandSourceName,{vastViewCount:t.VastUtils.getVastViewCountForEvent(o)});Y.report(A.adLoaded,l),t.Utils.isDefined(e.enableBackButton)&&n.setBackButtonState(e.enableBackButton),e=n.AdUtils.formatParamsToAdId(e),n.onAdLoaded(nt(n.AdUtils.getAdId(e),e.inventoryId)),re.adLoadedSuccessfully({numOfAdUnits:v.size(a),totalNumberCredits:tt(a)},!1)}}))),K.push(t.PubSub.subscribe("SDKController.AdLoadError",(function(e){ee.shouldReceiveMessage(z,e)&&(re.adLoadError(),n.unloadAdViewsByProduct(z),Fn()||Gt())}))),K.push(t.PubSub.subscribe("SDKController.AdError",(function(e){ee.shouldReceiveMessage(z,e)&&n.log("SDKController.AdError:"+JSON.stringify(e),n.LogLevels.verbose)}))),K.push(t.PubSub.subscribe("SDKController.dialogBoxResume",(function(e){ee.shouldReceiveMessage(z,e)&&Y.report(A.dialogBoxResume)}))),K.push(t.PubSub.subscribe("SDKController.dialogBoxExit",(function(e){ee.shouldReceiveMessage(z,e)&&Y.report(A.dialogBoxExit)}))),K.push(t.PubSub.subscribe("SDKController.adClosed",(function(e){ee.shouldReceiveMessage(z,e)&&(yn(),n.SKAdImpressionService.endImpression(e.ad,jn,_n))}))),K.push(t.PubSub.subscribe(a.productType+".GetConfig",(function(e){if(ee.shouldReceiveMessage(z,e)){n.log("ProductInstance | getConfig received");var i=kt();if(!i)return void n.log("ProductInstance | getConfig with no loaded ad");t.VastUtils.isVastCampaign(i)&&E?E.then((function(t,n){be(n||t,e)})):be(i,e)}}))),K.push(t.PubSub.subscribe(a.productType+".isVisible",(function(e){if(n.log("ProductInstance | isVisible"),ee.shouldReceiveMessage(z,e)){var t=kt(),r=n.getCurrentDisplayedAd();if(n.isAdDisplayed(t))return void n.log("ProductInstance | isVisible | isAdDisplayed=true");t?r&&n.getCurrentDisplayedAdType()!==a.productType?Y.report(A.bannerLoadedDuringShow):(n.setCurrentDisplayedAd(t),n.getCurrentDisplayedAdType()===i.BN&&fe.shouldReportAdVisibleForBanners()&&(n.log("ProductInstance | isVisible | shouldReportAdVisible"),n.onAdVisible())):n.log("ProductInstance | isVisible | ad is null")}})))};K.push(t.PubSub.subscribe("ExternalContainer.duringCreation",(function(e){ee.shouldReceiveMessage(z,e)&&Y.report(A.duringCreation)})));var ve=function(){K.push(t.PubSub.subscribe("AdsAssetsClearanceService.cacheReachedMaximumCapacity",(function(e){if(ee.shouldReceiveMessage(z,e)){var t={custom_b:e.maxAdsToSaveInCache};t=pe.extendEventElapsedTime(z.productType,z.demandSourceName,t),Y.report(A.adLevelCacheReachedMaxCapacity,t)}}))),K.push(t.PubSub.subscribe("AdsAssetsManager.saveAdInCacheSuccess",(function(e){if(ee.shouldReceiveMessage(z,e)){var t=me(e);t=pe.extendEventElapsedTime(z.productType,z.demandSourceName,t),Y.report(A.saveAdInCacheSuccess,t);var i=n.AdsAssetsManager.areNonMandatoryAdsToCacheConfigured(C.numOfBannersToInitSuccess,C.numOfBannersToCache);w&&i&&Ye(v.getActiveInventoryId())}}))),K.push(t.PubSub.subscribe("AdsAssetsManager.saveAdInCacheFailure",(function(e){if(ee.shouldReceiveMessage(z,e)){var t=me(e);t=pe.extendEventElapsedTime(z.productType,z.demandSourceName,t),Y.report(A.saveAdInCacheFailure,t),et(n.AdUtils.getAdId(e.ad))}}))),K.push(t.PubSub.subscribe("AdsAssetsManager.deleteAdFromCacheSuccess",(function(e){if(ee.shouldReceiveMessage(z,e)){var t=me(e);t=pe.extendEventElapsedTime(z.productType,z.demandSourceName,t),Y.report(A.deleteAdFromCacheSuccess,t)}}))),K.push(t.PubSub.subscribe("AdsAssetsManager.deleteAdFromCacheFailure",(function(e){if(ee.shouldReceiveMessage(z,e)){var t=me(e);t=pe.extendEventElapsedTime(z.productType,z.demandSourceName,t),Y.report(A.deleteAdFromCacheFailure,t)}}))),K.push(t.PubSub.subscribe("AdsAssetsManager.adsAlreadyCached",(function(e){ee.shouldReceiveMessage(z,e)&&(e=pe.extendEventElapsedTime(z.productType,z.demandSourceName,e),Y.report(A.adsAlreadyCached,e))}))),K.push(t.PubSub.subscribe("AdsAssetsNativeCommunicator.adAssetRetrySuccess",(function(e){if(ee.shouldReceiveMessage(z,e)){var t=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",n=pe.extendEventElapsedTime(z.productType,z.demandSourceName,{generalMessage:t.substring(0,250)});Y.report(A.adAssetRetrySuccess,n)}}))),K.push(t.PubSub.subscribe("AdsAssetsNativeCommunicator.adAssetRetryFailed",(function(e){if(ee.shouldReceiveMessage(z,e)){var n=e.file+"["+e.currentRetryAttempt+" of "+e.totalRetryAttempts+"]",i=pe.extendEventElapsedTime(z.productType,z.demandSourceName,{});i=t.Utils.extend(i,{callfailreason:e.errMsg,generalMessage:n.substring(0,250)}),Y.report(A.adAssetRetryFail,i)}}))),K.push(t.PubSub.subscribe("AdsAssetsManager.urlNotMatched",(function(e){if(ee.shouldReceiveMessage(z,e)){var n=me(e);n=t.Utils.extend(n,{generalMessage:JSON.stringify(e.asset)}),Y.report(A.urlNotMatched,n)}}))),K.push(t.PubSub.subscribe("AdsAssetsManager.adAssetsCacheStatus",(function(e){if(ee.shouldReceiveMessage(z,e)){var i=n.AdUtils.getAdId(e.ad);i&&t.Utils.isDefined(e.adAssetsCacheStatus)&&!t.Utils.isDefined(J[i])&&(J[i]=e.adAssetsCacheStatus)}})))};function me(e){var i={};if(t.Utils.isDefined(e.ad)){var r=e.ad&&t.Utils.isDefined(e.ad.inventoryIndex)?e.ad.inventoryIndex:-1;i=n.AdUtils.updateEventWithAdParams(C,e.ad,i),i=t.Utils.extend(i,{inventoryIndex:r})}return i}function he(){return Y}function be(e,i){var r=nt(n.AdUtils.getAdId(e),e.inventoryId);if(r){t.VastUtils.isVastCampaign(e)||Se(r),Pe(r);var a=n.Utils.flattenAd(r);n.ExternalAdProtocols.prepareAd(a),i&&i.callback&&i.callback.call(null,a)}else n.log("line[456]: no current available ad",n.LogLevels.verbose);return r}function Se(e){C.requestID&&(e.requestID=C.requestID);var i=ye(n.getApiData({scdn:1,protocol:0,defaultProtocol:1}).scdn);return e=t.Utils.extend(!0,e,n.getFormattedDeviceData(),Ae(i))}function ye(e){var t=n.decideUrlProtocolAccordingToHTTPSCompliance()+"//"+e;return"prod"!==n.getEnv()&&(t=n.api()+"/users/staging/"+SuperSonicGlobalConfig.mobileSDKSettings.env),t}function Ae(e){return{settings:{protocol:n.decideUrlProtocolAccordingToHTTPSCompliance(),urltocdn:e,appKey:n.getSDKDataByKey(i.requiredSDKDataKeys.applicationKey),appOrientation:n.getSDKDataByKey(i.requiredSDKDataKeys.appOrientation),deviceLanguage:n.getSDKDataByKey(i.requiredSDKDataKeys.deviceLanguage),bundleId:n.getSDKDataByKey(i.requiredSDKDataKeys.bundleId),sdkAbName:n.getSDKDataByKey(i.requiredSDKDataKeys.sdkAbName),deviceId:n.getDeviceId(),skOverlaySupported:n.SKOverlayManager.isSKOverlaySupported()}}}function Ce(){E=null,B=null}function Ie(e){var t=n.AdUtils.getAdId(e);et(t,e.inventoryId);var r=te.getStatus().duringEngage;Ce();var o=d.getNextAd(r,e.inventoryId);function s(){n.log("RV adLoaded with error | no offers for user - show dialog",n.LogLevels.verbose),n.setCloseButtonState({productType:a.productType,demandSourceName:f,state:R.close});var t={productType:a.productType,message:L&&L.noOffers?L.noOffers:i.labels.noOffers,yes:"close",alwaysClose:!0};n.postAdUnitEvent({name:"alertUserOnError",options:t}),Y.report(A.userAlert,{inventoryIndex:e.inventoryIndex||-1})}r&&e.isWPAD||r&&!o?s():(n.log("DemandSource | adLoaded with error - removing and moving to next offer",n.LogLevels.verbose),Rt(null),n.removeAdUnit(nt(t,e.inventoryId)))}function De(e){var t=n.OMIDService.getVersionData().omidVersion;return n.OMIDService.isAdOmidSupported(e)&&h.omidVersionRequiresWebviewPerAd[t]?n.OMIDService.getOmidBundleUrl():""}function we(e){var t=n.getDeviceOs();return e.settings.cw&&e.settings.cw.hasOwnProperty(t)?e.settings.cw[t]:e.settings.cw}function Pe(e){var i=(!e||e.displayMode!=D.softprecache)&&de.isPrecache();e.settings.omidUrl=De(e),void 0===e.productType&&(e.productType=z.productType),void 0===e.demandSourceName&&(e.demandSourceName=z.demandSourceName),void 0!==e.settings.cw&&(e.settings.cw=we(e)),e.settings.precache=i,e.settings.sessionDepth=n.ImpressionsCounterService.getPayloadCounters(z).instanceImpressions+1,e.settings.viewType=C.viewType,e.settings.isGpi=n.isGpi(),t.AdAssets.isAdAbleToCache(e)&&(e.settings.ableToCache=e.ext.ableToCache,delete e.ext.ableToCache)}var Oe=function(e){var t="AttemptToBringNewAds | ";if(n.log(t),Y.report(A.attemptToBringNewFeed,{generalMessage:te.getStatusMsg()}),k)n.log(t+"Cannot bring feed attemptToBringNewAdsInProcess="+k);else{if(k=!0,!te.allowExternalCallToApi())return n.log(t+"Cannot bring feed: "+te.getStatusMsg()),void(F=setTimeout((function(){k=!1,n.log(t+"2 minutes delay finished"),Oe(e)}),a.timerLengths.riDelay));re.inventoryEmpty(e),setTimeout((function(){n.log(t+"Can bring feed"),Fe(C.refreshInterval),n.unloadAdViewsByProduct(z),k=!1,Gt()}),0)}},Fe=function(e){n.log("setting refresh interval to: "+e,n.LogLevels.info),O&&clearInterval(O),e&&0!==e&&!Fn()?O=setInterval((function(){Y.report(A.refreshInterval),te.canEngage()?(clearInterval(O),te.canInitCallToApi().then(Oe)):(n.log("setDuringRefreshInterval(true)",n.LogLevels.info),Ln(!0))}),e*a.timeUnit):n.log("No Refresh interval is needed")},Te=function(t){if(xe(a.productType)&&t&&t.customComponents){var i=n.environmentConfiguration(),r=new(e("../DynamicUI/CustomComponentsEvents"))(Y);new(e("../DynamicUI/CustomComponentsLoader"))(n,r,i.getDynamicUIHost()).downloadCustomComponents(t.customComponents)}};function xe(e){return e===i.RV||e===i.IS}function Ue(e){M=e.labels,L=e.labels}var Ne=function(e){C=b.parse(e)};function Le(e){O&&clearInterval(O),$t()&&Fe(e.refreshInterval)}function Ve(e){n.DeviceDataService.setPullDataOnLoadAd(e.enablePullDataOnLoadAd)}var Me=function(e){t.Utils.each(e,(function(e,t){t.inventoryIndex=e,de.isPrecache()&&de.setAdInventoryIndex(n.AdUtils.getAdId(t),e)}))};function Re(e){return e?n.getAdPlayerAssets().prepareAdPlayerAssets(H):t.Utils.returnResolvedPromise()}function ke(e){for(var t=0;t<e.length;t++)e[t].isCacheable=e[t].adAssets.length>0||n.AdUtils.isPlayablePrecachedAd(e[t])}function Ke(e){t.Utils.each(e,(function(e,t){t.inventoryIndex=e}))}function Be(){t.Utils.each(K,(function(e,n){t.PubSub.unsubscribe(n)}))}function Ee(){F&&clearTimeout(F),O&&clearInterval(O)}function je(e){n.AdsAssetsManager.unsetReferencesForInstance(z.instanceUniqueId);var i=!!e&&e.engaged;Be(),Ee();var r=t.Utils.extend(!0,{},z,{engaged:i});t.PubSub.publish(a.productType+".exhaustedDemandSource",[r])}function _e(e){var t,i=[];for(t=0;t<e.length;t++)de.isAdInCache(n.AdUtils.getAdId(e[t]))||i.push(e[t]);return i}var We=function(e){var n=[];return t.Utils.each(e,(function(e,t){t.ext&&t.ext.appData&&t.ext.appData.adAssets&&(t.ext.appData.appImages=t.ext.appData.adAssets,delete t.ext.appData.adAssets),n.push(t)})),n},Ge=function(e){return de.isPrecache()&&t.VastUtils.isVastCampaign(e)&&e.ext.precacheVasts},He=function(e){return 1===e.length&&Ge(e[0])&&(x=!0),t.Utils.returnResolvedPromise()},qe=function(e){return ht(t.VastUtils.isVastCampaign(e)),e.inventoryId&&It(),mt(e).then((function(e,t){return n.AdUtils.formatVastAdForPrecache(t,qe.bind(null,e))}))},Je=function(e){var t=[];return x?t.push(n.AdUtils.formatVastAdForPrecache(e[0],qe.bind(null,e[0]))):t=n.AdUtils.formatAdsForPrecache(e),t},Qe=function(e,r){var a,o,s,l=de.isPrecache();e=We(e),Me(e);var d=v.setOffers(e.slice(0),r);a=Je(e),o=$e(e,C.numOfBannersToCache);var c=function(){if(t.VastUtils.isThereVastCampaign(rt(d))&&re.setAMSettings({reportOnAdunitReady:!1},!0),l){var s=$e(e,C.numOfBannersToInitSuccess),c=de.areCampaignsAvailable(a.slice(0,s),s);c&&Y.report(A.campaignsAvailableFromCache),n.log("DemandSource | updateCurrentAds areCampaignsAvailable "+c,n.LogLevels.verbose),0===C.numOfBannersToInitSuccess&&re.reportAdAvailable({numOfAdUnits:v.size(d),totalNumberCredits:tt(d)}),(c||0===o||0===C.numOfBannersToInitSuccess)&&Ye(d);var u=_e(a),f={cacheTimeoutSuccessCallback:function(){Qe(e,r)},cacheTimeoutFailCallback:ze,applicationUserId:n.getSDKDataByKey(i.requiredSDKDataKeys.applicationUserId),applicationKey:n.getSDKDataByKey(i.requiredSDKDataKeys.applicationKey),newAdsToEnterCache:u,inventoryId:d,adAssetsCacheConfig:q};de.handleCacheAds(f)}else Ye(d)};l&&(s=de.mergeCampaigns(a,o),n.log("DemandSource | updateCurrentAds after merge "+JSON.stringify(s),n.LogLevels.verbose)),!l||C.purgeCacheOnInit?(n.log("DemandSource | already purged cache so go strait to adding the new ads",n.LogLevels.verbose),c()):de.clearCacheByType(s).always(c)},$e=function(e,t){for(var n=e.length<t?e.length:t,i=t,r=0;r<n;r++)e[r].isCacheable||i--;return i},ze=function(e){re.cacheTimeoutFail(e)},Xe=function(){te.publish("InitiatedAPICall",[ee.extendCallbackParamsWithProductConfig(z,{duringInit:!1})])},Ye=function(e){n.log("ProductInstance | handlePossibleAdUnitsReady",n.LogLevels.verbose);var r=ot(e);if(r){var a=t.VastUtils.isVastCampaign(r);if(x&&ht(a,e))Ct(e);else{var o=v.size(e),s=tt(e);t.VastUtils.areAllCampaignTypesAreVast(rt(e));Xe(),re.canReportAvailable(o,s)}fe&&z.productType===i.BN?kn(C,z,V):d.attemptToPreloadAd(!1,e)}},Ze=function(e,t){v.removeOfferById(e,t)&&!v.isEmpty(t)&&de.incrementNextCampaign()},et=function(e,t){var i=v.getOfferById(e,t);i?i.toRemove=!0:n.log("Error in mark current ad to be removed:"+e,n.LogLevels.error),j=null},tt=function(e){for(var t=0,n=v.getOffers(e),i=v.size(e),r=0;r<i;r++)t+=n[r].credits;return t},nt=function(e,t){var i=v.getOfferById(e,t);return i||n.log("Error in getAdUnitById, id "+e+" not found in "+JSON.stringify(v.getOffers(t)),1),i},it=function(e,t,n){return v.replaceOfferById(e,t,n)},rt=function(e){return v.getOffers(e).filter((function(e){return!(t.Utils.isDefined(e.toRemove)&&e.toRemove)}))},at=function(e){return rt(e).filter((function(e){return e.isCacheable}))},ot=function(e){var t,i=nt(n.AdUtils.getAdId(ut(e)),e);return de.isPrecache()&&i&&i.isCacheable?(i=nt(n.AdUtils.getAdId(ct(e)),e),t=D.precache):t=D.nonprecache,i&&!i.displayMode&&lt(i,t),i},st=function(e,t){if(!e)return null;var i=dt(t);return i?nt(n.AdUtils.getAdId(i),t):null},lt=function(e,t){e&&(e.displayMode=t)},dt=function(e){return rt(e).length>0?rt(e)[0]:null},ct=function(e){return 0===C.numOfBannersToInitSuccess?de.getCurrentAd(rt(e).slice(0,1)):de.getCurrentAd(rt(e))},ut=function(e){return v.getCurrentOffer(e)},ft=function(e){var i=n.AdUtils.getAdId(e);te.publish("Engaged",[ee.extendCallbackParamsWithProductConfig(z,{duringEngage:!1})]),Rt(null),Ce();var r=nt(i,e.inventoryId);clearTimeout(U),r?(n.log("onEngageEnd with params: "+JSON.stringify(r),n.LogLevels.verbose),t.Utils.isDefined(r)&&r.toRemove&&(n.AdsAssetsManager.unsetReferencesForAds([e],z.instanceUniqueId),n.log("removing ad id: "+i,n.LogLevels.verbose),Ze(i,r.inventoryId))):n.log("Tried to end engage with no ad",n.LogLevels.error)},pt=function(e){var i=n.AdUtils.getAdId(e),r=nt(i,e.inventoryId);t.Utils.isDefined(r)&&r.toRemove&&(n.log("removing ad id: "+i,n.LogLevels.verbose),Ze(i,r.inventoryId))};function gt(e){B&&"pending"===B.state()&&(t.Utils.isDefined(e)?(n.log("handleVastAvailability - VAST failed to load with reason: "+e),B.reject()):(n.log("handleVastAvailability - VAST verified - resolve"),B.resolve()))}function vt(e){var n="";return t.Utils.isDefined(z.demandSourceName)&&(n=z.demandSourceName),n+=z.productType+e}function mt(e){var i=n.AdUtils.getAdId(e),r=St(e),a=e.inventoryId;if(e.ext.videoData.isVast&&j){var o=t.VastUtils.getVastViewCount(e),s=e.settings.preload,l=e.displayMode;j=t.VastUtils.setVastViewCount(j,o),(e=j).settings.preload=s,e.displayMode=l}else(e=t.VastUtils.setVastViewCount(e,0)).ext.vastExhaustIndex&&e.ext.vastExhaustIndex>1&&(j=e);return Se(e),E=new window.jQuery.Deferred,e.vastIframeId=vt(i),Y.trackTimingStart(A.parseVast),ne.parseVast(e,de.isPrecache(),C).then((function(o){if(null!==E){if(Y.trackTimingStop(A.parseVastSuccess,{generalMessage:r,eNameStart:A.parseVast}),!t.Utils.isDefined(e.toRemove)||!e.toRemove){o.ext.videoData.isVast=!0,e&&e.displayMode&&(o.displayMode=e.displayMode),t.VastUtils.incrementVastViewCount(o),gt(o.errMsg);var s=e;return t.VastUtils.incrementVastViewCount(s),it(e=o,n.AdUtils.getAdId(e),a),E.resolve(s,o)}ne.removeIframe(vt(i))}}),(function(o){if(null!==E){var s={generalMessage:r,eNameStart:A.parseVast};if(s=n.AdUtils.updateEventWithAdParams(C,e,s),o.isTimeLimitReached&&(s.callFailReason="timeout"),Y.trackTimingStop(A.parseVastFail,s),!t.Utils.isDefined(e.toRemove)||!e.toRemove){var l=t.VastUtils.incrementVastViewCount(e);gt(o.errMsg),te.publish("AdErrorState",[ee.extendCallbackParamsWithProductConfig(z,{error:!0})]),n.log("Error in loading ad: "+o.errMsg,n.LogLevels.error);var d={generalMessage:o.errMsg,vastViewCount:t.VastUtils.getVastViewCountForEvent(l)};return d=n.AdUtils.updateEventWithAdParams(C,e,d),Y.report(A.adLoadedError,d),t.VastUtils.setMaxVastCount(e),Nt(nt(i,a)),E.reject()}ne.removeIframe(vt(i))}}))}function ht(e,t){return bt(e)||yt(t)}function bt(e){return C.preFetchAllVasts&&e}function St(e){var n;return bt(t.VastUtils.isVastCampaign(e))?n="preFetchAllVasts":yt(e.inventoryId)&&(n="vastAvailabilityValidation"),n}function yt(e){return de.isPrecache()&&t.VastUtils.areAllCampaignTypesAreVast(rt(e))}function At(e){n.log("handleVastAvailability",n.LogLevels.verbose),It(),Ct(e),Xe()}function Ct(e){window.jQuery.when(B).then((function(){Xe(),re.canReportAvailable(v.size(e),tt(e))}))}function It(){B&&"pending"===B.state()||(B=new window.jQuery.Deferred)}var Dt=function(){return te.canInitCallToApi().then((function(){}),(function(){return n.log(a.errors.init[1001]+te.getStatusMsg(),n.LogLevels.error),a.errors.init[1001]})).then((function(){return te.publish("InitiatedAPICall",[ee.extendCallbackParamsWithProductConfig(z,{duringInit:!0})]),P++,t.Utils.decodeValues(c),i.BN===a.productType&&Y.report(A.getInventory),Z.applyCommunicationSolution(window.timerService.timeElapsed(window.lastWebviewClosedTimer)),n.FetchDirectService.fetchFeed($.getDestination(f),c,a.timerLengths.serverResponseTimeoutInMilis)})).then(wt).then(Ot,(function(e,t){var n,i=new window.jQuery.Deferred;switch(n=a.errors.init[1005],typeof e){case"object":e.responseText&&""!==e.responseText?n=e.responseText:e.errorMessage&&""!==e.errorMessage&&(n=e.errorMessage);break;case"string":""!==e&&(n=e)}return Xe(),"timeout"===t?i.reject(a.errors.load.timeout):i.reject(n),i.promise()}))},wt=function(e){var n=new window.jQuery.Deferred;if(t.Utils.isDefined(e.response)&&t.Utils.isDefined(e.response.errorCode)){Xe();var i=t.Utils.isDefined(e.response.errorMessage)&&e.response.errorMessage?e.response.errorMessage:a.errors.init[1003];n.reject(i)}else t.Utils.isDefined(e.seatbid)&&t.Utils.isDefined(e.seatbid.bid)&&t.Utils.isDefined(e.seatbid.ext)&&t.Utils.isDefined(e.seatbid.ext.labels)?n.resolve(e):(Xe(),n.reject(a.errors.init[1004]));return n.promise()};function Pt(e){if(e){var t={blacklistedCampaigns:e.join(",")};n.getTokenService().updateToken(t)}}var Ot=function(e){var r=function(e){return Fn()?(C.disableTokenFiltering||void 0===e||0===e.length||(e.forEach(Lt),Pt($.filteredListService.getFilteredListCampaigns())),t.Utils.returnResolvedPromise()):t.Utils.returnResolvedPromise()},o=function(e){for(var i=e&&e.length||0,r="",a=0;a<i;a++)r+=n.AdUtils.getAdType(e[a],C),a<i-1&&(r+=", ");return Y.updateBaseData({feedSize:i,feedCampaignOrder:r}),t.Utils.returnResolvedPromise()},l=function(e){return e.some((function(e){return n.OMIDService.isAdOmidSupported(e,a.productType)}))&&n.OMIDService.downloadOmidJsBundle(),t.Utils.returnResolvedPromise()},d=function(e,i,r){if(hn())return t.Utils.returnResolvedPromise();var o,s=new window.jQuery.Deferred,l=n.AdsAssetsManager.cacheAdsWithClearanceLogic(e,i.numOfBannersToCache,i.numOfBannersToInitSuccess,r,Jt(i)).then((function(){clearTimeout(o),s.resolve()})).fail((function(e){clearTimeout(o),s.reject(e)}));return o=setTimeout((function(){var e=l.state();if("pending"===e||"rejected"===e){var t={callfailreason:"ad level timeout expired when caching ads"};t=pe.extendEventElapsedTime(r.productType,r.demandSourceName,t),Y.report(A.adLevelCachingTimeout,t),s.reject("cacheAdsAssets timeout expired")}"resolved"===e&&s.resolve()}),a.precacheConfig.timeoutForCachingAdsInAdLevelCacheFlow),s.promise()};return function(e){te.setConnection(!0);var c=e.seatbid.bid,u=e.seatbid.ext,f=c.length>0&&c[0].ext.adSource||u.adSource;$.getAmountOfSupportedInventories()===i.DEFAULT_AMOUNT_OF_INVENTORIES&&(Et(),v.reset());var p,g=v.getAvailableInventoryId(),m=c.length>0&&c[0].ext?c[0].ext.mpTestId:null;return Y.updateBaseData({landingId:u.landingId,strategyId:u.strategyId,adSource:f,integrationType:m}),Q=u.deliveryPlumbus,u.sessionPlumbus&&s.setData(a.productType+"sesp",u.sessionPlumbus),window.jQuery.when(Ne(e),Ue(u)).then((function(){if(!(c&&c.length>0))return t.Utils.returnRejectedPromise(i.errors.noFill)})).then(Te.bind(null,C)).then(Le.bind(null,C)).then(Ve.bind(null,C)).then(Qt.bind(null,C)).then(n.CampaignsFilter.filterByAppInstalled.bind(null,c,C,a.filterDisableTypes)).then(r).then(o.bind(null,c)).then(l.bind(null,c)).then(de.decidePrecacheStatus.bind(null,{numOfCampaigns:c.length,settings:C})).then((function(){return Y.updateBaseData(n.AdUtils.extractEventData(c[0])),p=c.length>0&&se.shouldUseAdPlayer(!!n.getConfig().mobileSDKSettings.ext.adPlayerVersion,n.getDeviceOs(),c[0],C,a.productType,parseInt(n.getConfigurationHelper().getDeviceApiLevel())),n.log("should use ad-player? "+p),re.setAMSettings({preFetchAllVasts:C.preFetchAllVasts,isPreCache:de.isPrecache(),numOfBannersToInitSuccess:C.numOfBannersToInitSuccess,reportOnAdunitReady:C.reportOnAdunitReady}),c&&c.length>0?(w=!1,Ht(),p?t.Utils.returnResolvedPromise():n.adUnitGlobals.updateAdUnitGlobals(!0,zt(),H,Y)):t.Utils.returnRejectedPromise(i.errors.noFill)})).then((function(){return p?t.Utils.returnResolvedPromise():window.jQuery.when(function(e){return Xt(e)?n.libsManager.manageDownloadLibsFileByFiletype(a.libsCacheFiles.dapi):t.Utils.returnResolvedPromise()}(c),function(e){return de.isPrecache()&&Yt(e)?n.libsManager.manageDownloadLibsFileByFiletype(a.libsCacheFiles.externalObfuscation).then((function(t){Zt(e,t)})):t.Utils.returnResolvedPromise()}(c))})).then((function(){return hn()?de.handleCacheClear():t.Utils.returnResolvedPromise()})).then(He(c)).then((function(){return Re(p)})).then(n.AdsAssetsManager.setAdAssetsForAds.bind(null,c)).then(ke.bind(null,c)).then(n.AdsAssetsManager.setReferencesForAds.bind(null,c,z.instanceUniqueId)).then(Ke.bind(null,c)).then(d.bind(null,c,C,z)).then(nn.bind(null,c)).then((function(){if(Y.updateBaseData(n.AdUtils.extractEventData(c[0])),w=!0,hn())return qt(),Qe(c,g);var e=v.setOffers(c.slice(0),g);0===C.numOfBannersToInitSuccess&&re.reportAdAvailable({numOfAdUnits:v.size(e),totalNumberCredits:tt(e)}),Ye(e)})).fail((function(e){var t=e||"Fail parse adUnit info from api response";n.AdsAssetsManager.unsetReferencesForAds(c,z.instanceUniqueId),v.removeInventory(g),i.BN===a.productType&&Y.report(A.getInventoryFailed,{generalMessage:t}),Kt(),e&&n.log(e,n.LogLevels.error),re.inventoryEmpty(e||t)})),(new window.jQuery.Deferred).resolve(t.Utils.extend(!0,{},e.seatbid.ext,{numOfAdUnits:e.seatbid.bid.length}))}(e)},Ft=function(){t.Utils.each(N,(function(e,t){clearTimeout(t)})),N=[]};function Tt(e){te.publish("Engaged",[ee.extendCallbackParamsWithProductConfig(z,{duringEngage:e})])}function xt(){var e;e={productType:a.productType,message:L&&L.noInternet?L.noInternet:i.labels.noInternet,yes:"close",alwaysClose:!0},n.alert(e)}var Ut=function(e,r,a){var o,s=n.AdUtils.getAdId(e);n.log("Error in loading ad - timeout in "+s,n.LogLevels.error),o=a?A.showAdFail:A.adLoadedError;var l={isprecache:de.isPrecache(),callfailreason:"Error in loading ad - timeout"};l=n.AdUtils.updateEventWithAdParams(C,e,l),Y.report(o,l),ee.extendCallbackParamsWithProductConfig(z,e),t.VastUtils.isVastCampaign(e)&&Nt(e),et(s,e.inventoryId),Rt(null),Ce(),ne.removeIframe(vt(s)),C.viewType===i.viewTypes.externalView?n.removeAdUnitFromExternal(e):n.removeAdUnit(e)},Nt=function(e){e&&e.cid?n.blacklistService.addToBlacklistedCampaigns(z.productType,z.demandGroupName,e.cid):n.log("DemandSource | cannot add to blacklist with no ad",n.LogLevels.error)},Lt=function(e){e&&e.cid&&$.filteredListService.addToFilteredListCampaigns(e.cid)},Vt=function(){var e={errMsg:void 0,didSucceed:!0};return t.Utils.isDefined(C.allowMultiInitCalls)&&!C.allowMultiInitCalls?(e.errMsg=a.errors.init.multi,e.didSucceed=!1):te.allowExternalCallToApi()?S.shouldFail(n.getConfig())&&(e.errMsg=a.errors.init.deviceOsIsNotSupported,e.didSucceed=!1):(e.errMsg="Already attempting to initiate",e.didSucceed=!1),e},Mt=function(){F&&clearTimeout(F)},Rt=function(e){T=e};function kt(){return T}var Kt=function(){Rt(null),Ce(),re.reset(),m.reset(),J={}},Bt=function(){Et(),v.reset(),te.publish("InitiatedTimeoutAttempt",[ee.extendCallbackParamsWithProductConfig(z,{duringAPITimeoutAttempts:!1})]),Kt()},Et=function(){for(var e=Object.keys(v.getInventories()),t=0;t<e.length;t++)n.AdsAssetsManager.unsetReferencesForAds(v.getOffers(e[t]),z.instanceUniqueId)},jt=function(){var e=!1;if(z.productType===i.BN&&v){var t=v.getActiveInventoryId();t&&(e=v.isNextOfferAvailable(t))}return e},_t=function(){var e=v.getActiveInventoryId();if(e){var t=ot(e);v.removeOfferById(t.id,e),Ye(e)}};function Wt(){n.DeviceDataService.shouldPullDataOnLoadAd()&&n.DeviceDataService.pullData()}function Gt(e,r){var o=function(e){if(!s){P=0,te.publish("InitiatedTimeoutAttempt",[ee.extendCallbackParamsWithProductConfig(z,{duringAPITimeoutAttempts:!1})]),e=e||a.errors.init[1002],i.BN===a.productType&&(Y.report(A.getInventoryFailed,{generalMessage:e}),fe.resetExternalAdViewsIdentifiers());try{if("string"==typeof e){var o=parseInt(e);o>1001&&o<1006&&(e=a.errors.load.invalid)}}catch(e){}var l=ee.extendCallbackParamsWithDemandConfig(z,{errMsg:e});n.callSDKFunction(r,l),t.PubSub.publish(a.productType+".failedToLoad",[l])}};if(Wt(),Kt(),jt())_t();else{var s=!1;(N.push(setTimeout((function(){o(a.errors.load.timeout),s=!0}),7*a.timeUnit)),(new window.jQuery.Deferred).resolve()).then(Mt).then(On).then(Dt).always(Ft).then((function(){s||(P=0,te.publish("InitiatedTimeoutAttempt",[ee.extendCallbackParamsWithProductConfig(z,{duringAPITimeoutAttempts:!1})]),ce=!1)}),(function(t){var n=new window.jQuery.Deferred,i=$.doesAllowConsecutiveGatewayRequestsDuringLoad();return s||(t===a.errors.load.timeout&&i&&P<a.maxNumOfAttemptsToCallAPI?(te.publish("InitiatedTimeoutAttempt",[ee.extendCallbackParamsWithProductConfig(z,{duringAPITimeoutAttempts:!0})]),setTimeout((function(){Gt(e,r)}),a.timerLengths.initAttemptsDelay),n.resolve()):n.reject(t)),n.promise()})).then(null,o)}}function Ht(){H={productType:a.productType,demandSourceName:z.demandSourceName,retryAttempts:C.adunitRetryAttempts||15,retryInterval:C.adunitRetryInterval||1,assetType:i.assetType.adunitAsset}}function qt(){q={productType:a.productType,demandSourceName:z.demandSourceName,retryAttempts:C.adAssetRetryAttempts,retryInterval:C.adAssetRetryInterval,assetType:i.assetType.adAsset}}function Jt(e){return{adAssetRetryAttempts:e.adAssetRetryAttempts||5,adAssetRetryInterval:e.adAssetRetryInterval||1}}function Qt(e){e&&e.hasOwnProperty(i.numOfBannersToInitSuccess)&&e.hasOwnProperty(i.numOfBannersToCache)&&Y.updateBaseData({cacheConfig:e[i.numOfBannersToInitSuccess]+"/"+e[i.numOfBannersToCache]})}function $t(){return!Fn()}function zt(){return C.purgeAdunitLibsFile}function Xt(e){for(var n=0;n<e.length;n++){var i=e[n].ext.layoutData;if(t.Utils.isDefined(i)&&t.Utils.isDefined(i.html)&&i.html.length>0)return!0}return!1}function Yt(e){for(var t=!1,i=0;i<e.length;i++)if(n.AdUtils.isPlayablePrecachedAd(e[i])){t=!0;break}return t}function Zt(e,t){for(var i=0;i<e.length;i++)n.AdUtils.isPlayablePrecachedAd(e[i])&&(e[i].ext.ableToCache="success"===t)}function en(e){var i=C.numOfBannersToCache,r=rt(e).slice(0,i),a=!0;return t.Utils.each(r,(function(e,t){return!n.AdUtils.isCacheableAd(t)||Ge(t)||de.isAdInCache(n.AdUtils.getAdId(t))||de.getAdStatusInQueue(n.AdUtils.getAdId(t))===de.cachingStatus.pending||(a=!1),a})),a}function tn(e){var i=de.isPrecache();i&&!hn()?n.AdsAssetsManager.cacheAssetsOfAd(v.getActiveInventory().getCurrentOffer(),z,Jt(C)).then(Ye.bind(null,e.inventoryId)):i&&!en(e.inventoryId)?de.updateCache(q):x&&t.VastUtils.isVastCanPlayAgain(e)&&de.cacheSingleAd(n.AdUtils.formatVastAdForPrecache(e,qe.bind(null,e)),q)}function nn(e){e.forEach((function(e){var t=n.AdUtils.getAdId(e);J.hasOwnProperty(t)&&(e.adAssetsCacheStatus=J[t])}))}function rn(e,r){if(n.log("engageEnd",n.LogLevels.verbose),ee.shouldReceiveMessage(z,e))if(e.productType!==i.BN){on(e);var a=sn;an(te)?e.engaged?a.handlePrefetchFailedOnVisible(e):a.handlePrefetchFailedOnBackground(e):e.engaged?a.handleAdClosed(e):a.handlePrefetchFailedOnBackground(e),(t.Utils.isFunction(r)?r:function(){})()}else pt(e)}function an(e){n.log("getAndResetErrorStateFromTaskManager",n.LogLevels.verbose);var t=e.getStatus().adErrorState;return e.publish("AdErrorState",[ee.extendCallbackParamsWithProductConfig(z,{error:!1})]),t}function on(e){n.log("_resetPreloadedAd",n.LogLevels.verbose),ft(e),Y.resetBaseData(i.baseDataKeys),m.setCanPreloadFlag(!0)}var sn={handlePrefetchFailedOnBackground:function(e){n.log("_backgroundPrefetchFailed | ManualLoad",n.LogLevels.verbose),d.getNextAd(!1,e.inventoryId,!0)?tn(e):this.publishNoMoreOffers(i.noMoreOffersReason.noMoreOffersToShowInFeed)},handlePrefetchFailedOnVisible:function(e){n.log("handlePrefetchFailedOnVisible | manuel load",n.LogLevels.verbose),tn(e)},handleAdClosed:function(e){if(n.log("handleAdClosed | manuel load",n.LogLevels.verbose),Fn())return n.log("handleAdClosed | manuel load | isInAppBiddingInstance=true"),n.AdsAssetsManager.unsetReferencesForAds(v.getOffers(e.inventoryId),z.instanceUniqueId),void v.removeInventory(e.inventoryId);n.log("handleAdClosed | manuel load | Do not perform internal load."),Kt(),Et(),v.reset(),t.PubSub.publish(a.productType+".resetStateManager",[z])},publishNoMoreOffers:function(e){n.log("publishNoMoreOffers | ManualLoad",n.LogLevels.verbose);var r=ee.extendCallbackParamsWithDemandConfig(z,{errorMsg:e||i.noMoreOffersReason.noMoreOffersToShowInFeed});t.PubSub.publish(a.productType+".NoMoreOffers",[r])}};function ln(e){if(ee.shouldReceiveMessage(z,e)){var i=n.AdUtils.getAdId(e),r=nt(i,e.inventoryId);if(n.log("ProductInstance | adVisible | id="+i),te.publish("Engaged",[ee.extendCallbackParamsWithParentProductConfig({duringEngage:!0})]),n.SKAdImpressionService.startImpression(r,Bn,En),t.VastUtils.isVastCampaign(r)){var a=t.VastUtils.getVastViewCount(r);Y.trackTimingStop(A.adVisible,{vastViewCount:t.VastUtils.getVastViewCountForEvent(a),eNameStart:A.showAdCalled}),n.log("ProductInstance | send event adVisible"),t.VastUtils.isVastCanPlayAgain(r)||et(i,e.inventoryId)}else{var o=n.getRecoveryInfo(),s=dn(r)?1:0;Y.trackTimingStop(A.adVisible,{eNameStart:A.showAdCalled,custom_a:o,custom_c:s}),n.log("ProductInstance | send event adVisible"),et(i,e.inventoryId)}Y.trackTimingStart(A.adVisibleToClose),C.extraOffersInEndCard&&n.ExtraOffers.isSupported(n.getConfig().mobileSDKSettings.deviceOs,n.getConfig().mobileSDKSettings.deviceApiLevel,r,C)&&cn()}}function dn(e){if(e&&e.ext&&e.ext.type&&("customEndCard"===e.ext.type&&void 0!==e.ext.UII))return!0;return!1}function cn(){window.jQuery.when(On()).then((function(e){var t=n.getCurrentDisplayedAd();return n.ExtraOffers.fetchExtraOffersInventory(e,t.productType,t.cid,t.settings.requestID,t.ext.opportunityID)})).then((function(e){n.postAdUnitEvent(JSON.stringify({name:"extraOffersEndCardData",data:{inventory:e}}))})).fail((function(e){n.postAdUnitEvent(JSON.stringify({name:"cancelExtraOffersEndCard"}));var t=e&&"string"==typeof e?e:"Extra offers flow failed";n.log("onExtraOffersFetchFail | Reason: "+t),Y.report(A.getExtraOffersInventoryFailed,{callfailreason:t})}))}function un(t,n){return new(e("../../components/precacheManager.js"))(t,n,fn())}function fn(){var e=hn()?z.productType+"_"+z.demandSourceName:i.cacheAdsDirectory;return I.cacheBase=e,I.precachePath="../"+I.cacheBase+"/",I=t.Utils.extend(I,z)}function pn(){var e=n.getSDKDataByKey(i.cacheConfiguration);if(e){var t=e.adLevelCacheTimeout?1e3*e.adLevelCacheTimeout:i.defaultTimeoutForCachingAds;a.precacheConfig.timeoutForCachingAdsInAdLevelCacheFlow=t}}function gn(e){return z[e]}function vn(e){e&&e.demandSourceName===f&&On()}function mn(e,t){var i;if(n.log("in load ad with params: "+JSON.stringify(e),n.LogLevels.verbose),!e||e.demandSourceName!==f)return i=pe.extendEventElapsedTime(a.productType,f,{callFailReason:a.errors.general.dsNameNotValid}),Y.report(A.loadAdIgnored,i),void pe.clearStartTime(a.productType,f);var r=Vt();if(r.errMsg){var o=A.loadAdFailed;return(i=pe.extendEventElapsedTime(a.productType,f,{})).demandSourceName=f,i.callFailReason=r.errMsg,Y.report(o,i),pe.clearStartTime(a.productType,f),void n.callSDKFunction(t,ee.extendCallbackParamsWithDemandConfig(z,{errMsg:r.errMsg}))}n.unloadAdViewsByProduct(z),n.log("resetting last response to none",n.LogLevels.verbose),Gt(e,t)}function hn(){for(var e=$.getDestination(f),t=[i.gatewayDestinationMap.IS.production,i.gatewayDestinationMap.BN.production,i.gatewayDestinationMap.RV.production],n=0;n<t.length;n++)if(-1!==e.indexOf(t[n]))return!1;return!0}function bn(){if(Sn())return n.log("audioSession | handleAudioSessionStart",n.LogLevels.info),le.enableControlOverAudioSession();var e=new jQuery.Deferred;return e.resolve(),e.promise()}function Sn(){return n.isIOS()&&C.manageIOSAudioSession}function yn(){Sn()&&(n.log("audioSession | handleAudioSessionEnd",n.LogLevels.info),le.disableControlOverAudioSession())}function An(e,t,i){var r=ot(v.getActiveInventoryId());n.RingerSwitchService.isInitiated()&&r&&(n.RingerSwitchService.startListener(Dn(r.ext)),n.log("Ringer | startListener from DS.",n.LogLevels.info)),Tn(),bn().always((function(){d.preload(!0,v.getActiveInventoryId()).then((function(){return d.show(kt())})).then((function(){wn(t)})).fail((function(e){n.log("Cannot engage at this time "+te.getStatusMsg(),n.LogLevels.error),Pn(i,e)}))}))}function Cn(){var e=kt();if(e){n.setCurrentDisplayedAd(e);var t=n.getAdViewContainer(e);t&&t.shouldReportAdVisible()&&n.onAdVisible()}}function In(e){var r=new window.jQuery.Deferred;return e?te.canEngage()?(Tt(!0),e=t.Utils.extend(e,{showAdCallbacks:{onShowSuccess:r.resolve,onShowFailed:r.reject}}),n.displayAdView(e),r.promise()):r.reject(i.errors.showAdFailedReasons.taskManagerEngage):r.reject(i.errors.showAdFailedReasons.showNoAd)}function Dn(e){return e?{ringerUpdateDelay:C.ringerUpdateDelay,shouldSetRingerUpdateDelay:n.AdUtils.isPlayableCampaign(e)||n.AdUtils.isMRAIDCampaign(e)||n.AdUtils.isExternalCampaign(e)}:{}}function wn(e){Y.trackTimingStop(A.showAdSuccess,{eNameStart:A.showAdCalled}),n.callSDKFunction(e,ee.extendCallbackParamsWithDemandConfig(z)),X.onShowSuccess(z)}function Pn(e,r){var o=ee.extendCallbackParamsWithDemandConfig(z,{errMsg:r});t.PubSub.publish(a.productType+".failedToShow",[o]);var s=r;s!==i.errors.showAdFailedReasons.preloadNoAd&&s!==i.errors.showAdFailedReasons.showNoAd&&(s=s+". "+te.getStatusMsg()),Y.report(A.showAdFail,{callFailReason:s}),n.callSDKFunction(e,ee.extendCallbackParamsWithDemandConfig(z,{errMsg:r})),r!==i.errors.showAdFailedReasons.onAdVisibleFailed&&r!==i.errors.showAdFailedReasons.screenVisibleTimeout||Tt(!1)}function On(){var e={impressionsCount:n.ImpressionsCounterService.getPayloadCounters(z).instanceImpressions,firstAttemptToGetFeed:ce,retryCounter:P,deliveryPlumbus:Q,sesp:s.getData(a.productType+"sesp")};return ae.createPayload(e).then((function(e){return c=e}))}function Fn(){return r&&r.isInAppBidding}function Tn(){W=new window.jQuery.Deferred;var e=t.PubSub.subscribe(_+".getDemandSourceStateSuccess",(function(n){ee.shouldReceiveMessage(z,n)&&(t.PubSub.unsubscribe(e),t.PubSub.unsubscribe(i),"resolved"!==W.state()&&(G=n&&n.state||G,W.resolve(n)))})),i=t.PubSub.subscribe(_+".getDemandSourceStateFail",(function(n){ee.shouldReceiveMessage(z,n)&&(t.PubSub.unsubscribe(i),t.PubSub.unsubscribe(e),"resolved"!==W.state()&&W.resolve())})),r=ee.extendCallbackParamsWithParentProductConfig(z);n.callSDKFunction("getDemandSourceState",r,"getDemandSourceStateSuccess","getDemandSourceStateFail")}function xn(e,t){var i=n.getContainerCreationHandler(e),r=i.getState();r===i.getCreationStates().createdSuccessfully?(n.log("product instance | containerState | createdSuccessfully ",n.LogLevels.info),t.resolve(e)):r===i.getCreationStates().duringCreation?window.jQuery.when(i.getCreationResultPromise()).then((function(){n.log("product instance | during creation result: success",n.LogLevels.info),t.resolve(e)})).fail((function(e){t.reject("product instance | "+e)})):t.reject("product instance | did not start to create native webview")}function Un(e){var i=n.AdUtils.getAdId(e),r=I.precachePath+i+"/";t.AdAssets.updateAdunitPrecachePath(e,r,n.isAndroid())}function Nn(e,n,i){var r=!1;return e&&!n&&(t.VastUtils.isVastCampaign(i)&&!Ge(i)||(r=!0)),r}function Ln(e){ue=e}function Vn(){return ue}function Mn(e,t,n){var i=a.timerLengths.loadAdTimeout;clearTimeout(U),U=setTimeout((function(){Ut(e,t,n)}),i)}function Rn(e){!x&&t.VastUtils.isVastCampaign(e)&&(null!==E||t.Utils.isDefined(e.toRemove)&&e.toRemove||mt(e).then(null,Ie.bind(null,e)))}function kn(e,r,a,o){fe.checkStatusOfAdView().then((function(s){var l=ot(o);n.AdUtils.setViewType(e,l,i.viewTypes.externalView);var d=n.AdUtils.updateEventWithAdParams(e,l,{});Y.updateBaseData(d),Rt(l),a.shouldBuildAdUnitUrlForExternal=!0;var c=p.getAdunitUrl(!1,r,a,n.getDeviceOs());s.isExternalAdViewInitiated?(be(l),fe.updateAdInAdView(c,l,r,e)):(Mn(l,c,!1),e=t.Utils.extend(e,{adViewId:fe.getContainerID()}),fe.createAdUrlInAdView(c,l,r,e)),n.addAdToLoadedCreatives(l)}))}function Kn(){return r.shouldAvoidHandleFrameClose}function Bn(){Y.report(A.startImpressionSuccess)}function En(e){Y.report(A.startImpressionFailed,{callfailreason:e.errMsg,generalmessage:e.hasOwnProperty("errCode")?e.errCode:-1})}function jn(){Y.report(A.endImpressionSuccess)}function _n(e){Y.report(A.endImpressionFailed,{callfailreason:e.errMsg,generalmessage:e.hasOwnProperty("errCode")?e.errCode:-1})}function Wn(){var e=G===i.demandSourceStates.cappedPerSession;return e&&t.Utils.isDefined(z)&&n.log("isDemandCapped | demandSource "+z.demandSourceName+" is capped"),e}function Gn(){Fn()&&a&&(a.isExhaustInstanceAllowed=!1)}var Hn={name:f,init:function(){d=this,u||(Kt(),de=un(t,n),ge(),ve(),pn(),de.init(),te.init(),n.initAnalytics(ee.extendCallbackParamsWithParentProductConfig(z,{})),Gn(),u=!0)},isNextAvailable:function(e){if(de.isPrecache()){var n=rt(e);return de.isNextAvailable(n)||n&&n[0]&&!n[0].isCacheable}return v.isNextOfferAvailable(e)||t.VastUtils.isVastCanPlayAgain(ot(e))},prepareAdToEngageEnd:function(e){return Ge(e)?de.deleteCachedCampaign(n.AdUtils.getAdId(e)):t.Utils.returnResolvedPromise()},getNextAd:function(e,t,n){var i=d.isNextAvailable(t);return de.isPrecache()&&!i&&(i=st(n||e,t)),i},attemptToPreloadAd:function(e,i){var r=Wn();if(!r||e){var a=rt(i),o=ot(i),s=bt(t.VastUtils.isVastCampaign(o))||t.VastUtils.areAllCampaignTypesAreVast(a),l=de.isPrecache();ht(t.VastUtils.isVastCampaign(o),i)&&At(i),m.canPreloadCandidateAd(r,e,o,s,l,C.displayOnAdReady)&&d.preloadAd(e,i)}else n.log("Skipping preload on capped demand",n.LogLevels.verbose)},preloadAd:function(e,t){d.preload(e,t).then((function(){e&&d.show(kt())}))},preload:function(e,r){var a,o=new window.jQuery.Deferred;return te.canPreload()?(a=kt()||ot(r))||(a=st(e,r),lt(a,D.softprecache),a)?(a=t.Utils.extend(!0,a,z),n.isContainerLoaded(a)?o.resolve(a):d.preloadFlow(a,e,o),o.promise()):(n.log("Cannot preload with no offer",n.LogLevels.error),t.Utils.returnRejectedPromise(i.errors.showAdFailedReasons.preloadNoAd)):(n.log("Cannot preload at this time, "+te.getStatusMsg(),n.LogLevels.error),t.Utils.returnRejectedPromise(i.errors.showAdFailedReasons.taskManagerPreload))},preloadFlow:function(e,r,o){n.log("ProductInstance | preloadFlow"),m.preloadAdFinished();var s,l=!1,d=de.isPrecache(),c={preload:!r};e&&e.displayMode==D.softprecache&&(l=!0),Nn(d,l,e)&&Un(e),e.isWPAD=oe.shouldDisplayAdOnExternalWebView(e,C),e.isWPAD?(n.AdUtils.setViewType(C,e,i.viewTypes.externalView),V.shouldBuildAdUnitUrlForExternal=!0,s=2):(n.log("ProductInstance | ad is not WPAD"),n.AdUtils.removeViewTypeFromSetting(C),V.shouldBuildAdUnitUrlForExternal=!1,s=1),e.displayStrategy=s;var u=n.AdUtils.updateEventWithAdParams(C,e,{});u=t.Utils.extend(u,{displaystrategy:s}),Y.updateBaseData(u),Rt(e);var f,v=d||n.getAdPlayerAssets().isAdplayerReadyToUseFromCache(),h=!!n.getConfig().mobileSDKSettings.ext.adPlayerVersion,b=n.getDeviceOs(),S=parseInt(n.getConfigurationHelper().getDeviceApiLevel());Mn(e,f=se.shouldUseAdPlayer(h,b,e,C,a.productType,S)?g.getAdPlayerUrl(v,b,z,V):p.getAdunitUrl(v,z,V,b),r),C=t.Utils.extend(C,c),n.AdUtils.setViewType(C,e),y.shouldShowInStandAloneView(n.getConfig())&&n.AdUtils.extendSettingsWithStandaloneViewSupport(C),e=n.StoreKitService.updateAdWithStoreAppId(e,C),n.loadAdUnitUrl(e,f,z,C),Rn(e),e.isWPAD?xn(e,o):o.resolve()},show:In,getDSAnalytics:he,adVisible:ln,engageEnd:rn,initProduct:vn,loadAd:mn,showAd:An,showAdBanner:Cn,getProperty:gn,getPreLoadedAd:kt,isInAppBiddingInstance:Fn,isDemandCapped:Wn,shouldAvoidHandleFrameClose:Kn,reset:Bt,getStatus:te.getStatus,instConfig:r,statesManager:l};return d=Hn,Hn}t.exports=i},{"../../components/OMIDConstants":61,"../../components/VastService.js":83,"../../components/containers/WPADUtils":102,"../../components/precacheManager.js":107,"../../patches/PatchIOSLoadAfterLoad.js":205,"../../patches/PublisherPatchEasybrain.js":208,"../AdPlayer/AdPlayerUtils":123,"../DynamicUI/CustomComponentsEvents":155,"../DynamicUI/CustomComponentsLoader":156,"../IOSAudioSessionHandler":162,"./../../components/AdFeaturesParser":20,"./../../components/MultipleInventories.js":55,"./../../components/sdkPluginType/SDKPluginTypeHandler.js":110,"./../RewardedVideo/availabilityManager.js":174,"./../RewardedVideo/availabilityReporter.js":175,"./../RewardedVideo/dsTaskManager.js":176,"./DemandEntityBuilder.js":145,"./FetchDemand/FetcherPatch.js":149,"./PayloadBuilder.js":150,"./PreloadAdManager":152}],154:[function(e,t,n){t.exports=function(e,t){var n=6e4,i=(e=e||{}).retriesLogic||{},r=e.Features||{},a=e.ProductName;return{initiated:!1,overrideFeedSettings:r,productType:a,errors:{init:{missingData:"Failed to get required parameters",multi:"Multiple Init calls not allowed",1001:"Trying to call API while during an un-finished process",1002:"1002",1003:"1003",1004:"Invalid API response",1005:"1005",deviceOsIsNotSupported:"Device OS is not Supported"},load:{noMoreOffers:"Failed to load "+a+" ad",duringLoad:"Load "+a+" is already in progress",duringShow:"Can not Load "+a+" when showing ad",timeout:"API request timeout",invalid:"Invalid API response",instanceExhausted:"Instance already exhausted",inStateVisibleOrInShowingProcess:"in state visible or inShowingProcess",inLoadingStateOrWaitingToLoad:"in state waitingToLoad or internalLoadingProcess",instanceOnHold:"Instance on Hold"},show:{isConnected:"no internet connection",duringEngage:"already engaged with an offer",notLoaded:"ad was not loaded, try to load before calling to show",duringLoad:a+" load is in progress",visible:a+" is already showing",tryingToEngage:a+" is in showing process",instanceExhausted:"Can not show - Instance already exhausted"},vast:{noOffers:"empty"},general:{dsNotSet:"trying to call demandSource function, but demandSource object is not set",dsNameNotValid:"demand source name is not valid"}},displayMode:{nonprecache:"nonprecache",precache:"precache",softprecache:"softprecache"},libsCacheFiles:{dapi:"dapi",externalObfuscation:"externalObfuscation"},responseTypesWithReason:{none:0,ready:1,notReady:2},precacheConfig:{maxCachedCampaigns:10,nonPrecacheFallback:3e5,cacheBase:null,precachePath:null,timeoutForCachingAdsInAdLevelCacheFlow:3e4},timeUnit:n,timerLengths:{initAttemptsDelay:i.initAttemptsDelay||500,serverResponseTimeoutInMilis:i.serverResponseTimeoutInMilis,riDelay:12e4,loadAdTimeout:16e3},customDialog:4,filterDisableTypes:[],maxNumOfAttemptsToCallAPI:i.maxNumOfAttemptsToCallAPI||2,analyticsCategories:t,shouldDisplayOnAdReady:!!r.displayOnAdReady,forcePreload:e.forcePreload}}},{}],155:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const i=new(e("../../modules/DemandSource/EventCategories"));t.exports=class{constructor(e){this.analytics=e}trackDownloadSuccess(e){this.analytics.report(i.customComponentDownloadSuccess,e)}trackDownloadFailed(e){this.analytics.report(i.customComponentDownloadError,e)}}},{"../../modules/DemandSource/EventCategories":146}],156:[function(e,t,n){"use strict";var i=e("tslib");t.exports=class{constructor(e,t,n){this.controller=e,this.analytics=t,this.dynamicUIHost=n}downloadCustomComponents(e){return(0,i.__awaiter)(this,void 0,void 0,(function*(){for(let t in e)if(e.hasOwnProperty(t)){const n=e[t];for(let e=0;e<n.length;e++)yield this.downloadCustomComponentAndFireEvent(n[e],t)}}))}getComponentUrl(e,t){const{id:n}=e;return`${this.dynamicUIHost}templates/${t}/${n}.html`}downloadCustomComponentAndFireEvent(e,t){return(0,i.__awaiter)(this,void 0,void 0,(function*(){const n=this.getComponentUrl(e,t);try{const t=yield this.controller.FetchDirectService.get(n);e.htmlContent=t,this.analytics.trackDownloadSuccess({generalMessage:n})}catch(t){e.errorReason=t?t.statusText:"unknown",this.analytics.trackDownloadFailed({callFailReason:t.statusText,generalMessage:n})}}))}}},{tslib:18}],157:[function(e,t,n){t.exports=function(t){var n={prod:e("./EnvironmentProduction"),staging:e("./EnvironmentStaging")};return n[t.environment]?new n[t.environment](t,e("./constants")):new n.staging(t,e("./constants"))}},{"./EnvironmentProduction":158,"./EnvironmentStaging":159,"./constants":160}],158:[function(e,t,n){t.exports=function(e,t){var n,i,r=t.fileExtension,a=t.controllerFolder,o=t.cacheRootFolder,s=t.jQueryFileName,l=e.controllerVersion,d=e.schema,c=e.cdnDomain,u=e.scdnDomain,f=e.environment,p=o[e.deviceOs],g=e.cdnService,v=e.domain;function m(){return d+"//"+c+"/mobileSDKController"}function h(){return p}return{getControllerHost:m,getControllerJsUrl:function(){return m()+"/versions/"+l+"/sdk_controller"+r+".js"},getJQueryUrls:function(){return[d+"//code.jquery.com/"+s,d+"//"+c+"/libs/"+s]},getConfig:function(){return{controllerVersion:l,schema:d,cdnDomain:c,environment:f,cacheRootFolder:p,serviceCdn:g,domain:v}},getCacheControllerJsUrl:function(){return h()+"/"+a+l+"/sdk_controller"+r+".js"},getCacheJQueryPath:function(){return h()+"/assets/"+s},getAppConfigDomain:function(){return d+"//"+g},getUrlToCdnAdUnit:function(){return n.decideUrlProtocolAccordingToHTTPSCompliance()+"//"+u},setController:function(e){n=e},getStaticGlobalsUrl:function(e){return d+"//"+u+"/adunit/dist/versions/"+e+"/prod/"},getAssetsJsonUrl:function(){return d+"//"+u+"/adunit/dist/adunitAssets.json"},getAppConfigUrl:function(){return d+"//"+g+"/delivery/mobile/adUnit/getAppConfig.php"},setBaseServerUrlForOfferwall:function(e){i=e},getBaseServerUrlForOfferwall:function(){return i?d+"//"+i:""},getCacheRootFolder:h,getExternalLibrariesUrl:function(){return m()+"/libs/"},getCacheLibsPath:function(){return h()+"/libs/"},getDynamicUIHost:function(){return d+"//"+c+"/ad-player/dist/dynamic-ui/"}}}},{}],159:[function(e,t,n){t.exports=function(e,t){t.fileExtension;var n=t.controllerFolder,i=t.cacheRootFolder,r=t.jQueryFileName,a=e.controllerVersion,o=e.schema,s=e.cdnDomain,l=(e.scdnDomain,e.environment),d=e.stagingCdnDomain,c=i[e.deviceOs],u=e.cdnService,f=e.domain;function p(){var e=d.split(".")[0];return o+"//"+d+"/users/staging/"+e}function g(){return c}return{getControllerHost:p,getControllerJsUrl:function(){return p()+"/controller/"+a+"/sdk_controller.js"},getJQueryUrls:function(){return[o+"//code.jquery.com/"+r,o+"//"+s+"/libs/"+r]},getConfig:function(){return{controllerVersion:a,schema:o,cdnDomain:s,environment:l,cacheRootFolder:c,stagingCdnDomain:d,domain:f}},getCacheControllerJsUrl:function(){return e=a,g()+"/"+n+e+"/sdk_controller.js";var e},getCacheJQueryPath:function(){return g()+"/assets/"+r},getAppConfigDomain:function(){return o+"//"+u},getUrlToCdnAdUnit:function(){var e=d.split(".")[0];return o+"//"+d+"/users/staging/"+e},setController:function(e){e},getStaticGlobalsUrl:function(e){var t=d.split(".")[0];return o+"//"+d+"/users/staging/"+t+"/adunit/dist/versions/"+e+"/stage/"},getAssetsJsonUrl:function(){var e=d.split(".")[0];return o+"//"+d+"/users/staging/"+e+"/adunit/dist/adunitAssets.json"},getAppConfigUrl:function(){return o+"//"+u+"/delivery/mobile/adUnit/getAppConfig.php"},setBaseServerUrlForOfferwall:function(e){},getBaseServerUrlForOfferwall:function(){return""},getCacheRootFolder:g,getExternalLibrariesUrl:function(){return p()+"/common/libs/"},getCacheLibsPath:function(){return g()+"/libs/"},getDynamicUIHost:function(){return p()+"/ad-player/dist/dynamic-ui/"}}}},{}],160:[function(e,t,n){t.exports={fileExtension:".min.gz",controllerFolder:"controller_",cacheRootFolder:{ios:"../SSAPublisher",android:"../supersonicads"},jQueryFileName:"jquery-1.9.1.min.js"}},{}],161:[function(e,t,n){t.exports={serviceAPIKey:"audioSessionAPI",cbNative:"NativeCallback.",API:{getAudioSessionData:{name:"getAudioSessionData",success:"getAudioSessionDataSuccess",failure:"getAudioSessionDataFailure"},setAudioSessionData:{name:"setAudioSessionData",success:"setAudioSessionDataSuccess",failure:"setAudioSessionDataFailure"},activateAudioSession:{name:"activateAudioSession",success:"activateAudioSessionSuccess",failure:"activateAudioSessionFailure"},deactivateAudioSession:{name:"deactivateAudioSession",success:"deactivateAudioSessionSuccess",failure:"deactivateAudioSessionFailure"},isOtherAppPlayingAudio:{name:"isOtherAppPlayingAudio",success:"isOtherAppPlayingAudioSuccess",failure:"isOtherAppPlayingAudioFailure"},getAvailableCategories:{name:"getAvailableCategories",success:"getAvailableCategoriesSuccess",failure:"getAvailableCategoriesFailure"},getAvailableModes:{name:"getAvailableModes",success:"getAvailableModesSuccess",failure:"getAvailableModesFailure"}},knownCategories:{AVAudioSessionCategoryAmbient:"AVAudioSessionCategoryAmbient",AVAudioSessionCategorySoloAmbient:"AVAudioSessionCategorySoloAmbient",AVAudioSessionCategoryPlayback:"AVAudioSessionCategoryPlayback",AVAudioSessionCategoryRecord:"AVAudioSessionCategoryRecord",AVAudioSessionCategoryPlayAndRecord:"AVAudioSessionCategoryPlayAndRecord",AVAudioSessionCategoryMultiRoute:"AVAudioSessionCategoryMultiRoute"},knownCategoryOptions:{AVAudioSessionCategoryOptionMixWithOthers:1,AVAudioSessionCategoryOptionDuckOthers:2,AVAudioSessionCategoryOptionAllowBluetooth:4,AVAudioSessionCategoryOptionDefaultToSpeaker:8,AVAudioSessionCategoryOptionInterruptSpokenAudioAndMixWithOthers:17,AVAudioSessionCategoryOptionAllowBluetoothA2DP:32,AVAudioSessionCategoryOptionAllowAirPlay:64},knownModes:{AVAudioSessionModeDefault:"AVAudioSessionModeDefault",AVAudioSessionModeVoiceChat:"AVAudioSessionModeVoiceChat",AVAudioSessionModeVideoRecording:"AVAudioSessionModeVideoRecording",AVAudioSessionModeMeasurement:"AVAudioSessionModeMeasurement",AVAudioSessionModeMoviePlayback:"AVAudioSessionModeMoviePlayback",AVAudioSessionModeVideoChat:"AVAudioSessionModeVideoChat",AVAudioSessionModeSpokenAudio:"AVAudioSessionModeSpokenAudio"}}},{}],162:[function(e,t,n){t.exports=function(t,n){var i=e("./IOSAudioSessionConstants.js"),r=e("./IOSAudioSessionService.js")(t,n,i),a=!1,o={};function s(){n.log("IOSAudioSessionHandler | setNewAudioSessionData");var e={functionParams:{category:i.knownCategories.AVAudioSessionCategorySoloAmbient}};return r.setAudioSessionData(e)}function l(e){return n.log("IOSAudioSessionHandler | saveCurrentAudioSessionData: "+JSON.stringify(e)),o=e,t.Utils.returnResolvedPromise()}function d(e){n.log("IOSAudioSessionHandler | _setCurrentlyEnabled: isEnabled="+e),a=e}return n.log("IOSAudioSessionHandler | constructor",n.LogLevels.error),{enableControlOverAudioSession:function(){return n.log("IOSAudioSessionHandler | enableControlOverAudioSession"),(n.log("IOSAudioSessionHandler | handleOtherAppPlayingState"),r.getAudioSessionData()).then(l).then(s).then((function(){d(!0)})).fail((function(e){n.log("IOSAudioSessionHandler | enableControlOverAudioSession | failed  with error: "+e)}))},disableControlOverAudioSession:function(){if(n.log("IOSAudioSessionHandler | disableControlOverAudioSession"),a)return r.setAudioSessionData({functionParams:{restoredAudioSessionData:o}}).then((function(){d(!1)})).fail((function(e){n.log("IOSAudioSessionHandler | disableControlOverAudioSession | failed  with error: "+e)}));n.log("IOSAudioSessionHandler | disableControlOverAudioSession | avoid - currently not enabled")}}}},{"./IOSAudioSessionConstants.js":161,"./IOSAudioSessionService.js":163}],163:[function(e,t,n){t.exports=function(e,t,n){var i=t.jQuery();return{getAudioSessionData:function(){t.log("IOSAudioSessionService | getAudioSessionData",t.LogLevels.info);var r,a,o=new i.Deferred;return r=e.PubSub.subscribe(n.cbNative+n.API.getAudioSessionData.success,(function(i){var s,l;t.log(n.API.getAudioSessionData.success+JSON.stringify(i)),e.PubSub.unsubscribe(r),e.PubSub.unsubscribe(a),o.resolve((l={},(s=i).category&&(l.category=s.category),s.mode&&(l.mode=s.mode),s.categoryOptions&&(l.categoryOptions=s.categoryOptions),l))})),a=e.PubSub.subscribe(n.cbNative+n.API.getAudioSessionData.failure,(function(i){t.log(n.cbNative+JSON.stringify(i)),e.PubSub.unsubscribe(a),e.PubSub.unsubscribe(r),o.reject({errMsg:"failed in native"})})),t.callSDKService(n.serviceAPIKey,n.API.getAudioSessionData.name,{},n.API.getAudioSessionData.success,n.API.getAudioSessionData.failure),o.promise()},setAudioSessionData:function(r){t.log("IOSAudioSessionService | setAudioSessionData");var a,o,s=new i.Deferred,l=r||{};return a=e.PubSub.subscribe(n.cbNative+n.API.setAudioSessionData.success,(function(i){t.log(n.API.setAudioSessionData.success+" | params "+JSON.stringify(i)),e.PubSub.unsubscribe(a),e.PubSub.unsubscribe(o),s.resolve()})),o=e.PubSub.subscribe(n.cbNative+n.API.setAudioSessionData.failure,(function(i){t.log(n.API.setAudioSessionData.failure+JSON.stringify(i)),e.PubSub.unsubscribe(o),e.PubSub.unsubscribe(a),s.reject()})),t.callSDKService(n.serviceAPIKey,n.API.setAudioSessionData.name,l,n.API.setAudioSessionData.success,n.API.setAudioSessionData.failure),s.promise()},isOtherAppPlayingAudio:function(){t.log("IOSAudioSessionService | isOtherAppPlayingAudio");var r,a,o=new i.Deferred;return r=e.PubSub.subscribe(n.cbNative+n.API.isOtherAppPlayingAudio.success,(function(i){t.log(n.API.isOtherAppPlayingAudio.success+JSON.stringify(i)),e.PubSub.unsubscribe(r),e.PubSub.unsubscribe(a),o.resolve(i.otherAppPlaying)})),a=e.PubSub.subscribe(n.cbNative+n.API.isOtherAppPlayingAudio.failure,(function(i){t.log(n.API.isOtherAppPlayingAudio.failure+JSON.stringify(i)),e.PubSub.unsubscribe(a),e.PubSub.unsubscribe(r),o.reject()})),t.callSDKService(n.serviceAPIKey,n.API.isOtherAppPlayingAudio.name,{},n.API.isOtherAppPlayingAudio.success,n.API.isOtherAppPlayingAudio.failure),o.promise()},getAvailableCategories:function(){t.log("IOSAudioSessionService | getAvailableCategories");var r,a,o=new i.Deferred;return r=e.PubSub.subscribe(n.cbNative+n.API.getAvailableCategories.success,(function(i){t.log(n.API.getAvailableCategories.success+JSON.stringify(i)),e.PubSub.unsubscribe(r),e.PubSub.unsubscribe(a),o.resolve(i.availableCategories)})),a=e.PubSub.subscribe(n.cbNative+n.API.getAvailableCategories.failure,(function(i){t.log(n.API.getAvailableCategories.failure+JSON.stringify(i)),e.PubSub.unsubscribe(a),e.PubSub.unsubscribe(r),o.reject()})),t.callSDKService(n.serviceAPIKey,n.API.getAvailableCategories.name,{},n.API.getAvailableCategories.success,n.API.getAvailableCategories.failure),o.promise()},getAvailableModes:function(){t.log("IOSAudioSessionService | getAvailableModes");var r,a,o=new i.Deferred;return r=e.PubSub.subscribe(n.cbNative+n.API.getAvailableModes.success,(function(i){t.log(n.API.getAvailableModes.success+JSON.stringify(i)),e.PubSub.unsubscribe(r),e.PubSub.unsubscribe(a),o.resolve(i.availableModes)})),a=e.PubSub.subscribe(n.cbNative+n.API.getAvailableModes.failure,(function(i){t.log(n.API.getAvailableModes.failure+JSON.stringify(i)),e.PubSub.unsubscribe(a),e.PubSub.unsubscribe(r),o.reject()})),t.callSDKService(n.serviceAPIKey,n.API.getAvailableModes.name,{},n.API.getAvailableModes.success,n.API.getAvailableModes.failure),o.promise()}}}},{}],164:[function(e,t,n){t.exports=class{constructor(e,t){this.instancesMap={},this.logTag="InstancesMemoryHandler | ",this.controller=e,this.productAdapter=t}clear(e){if(!this.instancesMap.hasOwnProperty(e))return void this.log("clear | can not clear demandSourceName "+e+" | it does not exist | instancesMap "+this.instancesMap);let t=this.instancesMap[e],n=this.productAdapter[t];if(n){n.clearListeners(),delete this.productAdapter[t];let e=n.getPreLoadedAd();e&&this.controller.unloadAdViewByAdViewId(e.adViewId)}this.remove(e)}isExist(e,t){return this.instancesMap[e]===t}log(e){this.controller.log(this.logTag+e)}add(e,t){this.isExist(e,t)||(this.clear(e),this.instancesMap[e]=t)}remove(e){delete this.instancesMap[e]}}},{}],165:[function(e,t,n){t.exports=function(e,t,n,i){var r=e.Utils.extend(!0,{barSettings:{isUpper:!0,color:"#FF0000"}},t.Features);return{NativeAPI:t.NativeAPI,ControllerCallbacks:t.ControllerCallbacks,AdUnitCallbacks:t.AdUnitCallbacks,ControllerNativeAPI:t.NativeAPI,retriesLogic:t.retriesLogic,DemandName:"InterstitialDS",ProductName:i.IS,Features:r,gatewayDestinationMap:{prod:i.gatewayDestinationMap.IS.production},amountOfInventories:t.amountOfInventories}}},{}],166:[function(e,t,n){t.exports=function(){return{showOWCalled:{name:"showOWCalled",id:16},showOWFail:{name:"showOWFail",id:17},owVisible:{name:"owVisible",id:18},inventoryGetToReceived:{name:"inventoryGetToReceived",id:-12},initControllerToShowOWCalled:{name:"initControllerToShowOWCalled",id:-13},showOWCalledToOwVisible:{name:"showOWCalledToOwVisible",id:-14},adVisibleToClose:{name:"adVisibleToClose",id:-5},initOW:{name:"initOW",id:13},initOWFail:{name:"initOWFail",id:14},initOWSuccess:{name:"initOWSuccess",id:127},staticAssetsLoaded:{name:"staticAssetsLoaded",id:126},dialogBoxExit:{name:"dialogBoxExit",id:155},dialogBoxResume:{name:"dialogBoxResume",id:156},getInventory:{name:"getInventory",id:158},getInventoryFailed:{name:"getInventoryFailed",id:159}}}},{}],167:[function(e,t,n){function i(t,n){"use strict";var i=e("../../components/Constants.js"),r,a=!1,o=6e4,s="https://guc-api.sonic-us.supersonicads.com/api/v1/guc.php?format=json",l="https://guc-api.sonic-us.supersonicads.com/api/v1/myOffers",d="openRTB",c=i.OW,u="TaskManager",f=i.CB,p=window.jQuery,g,v={},m,h={},b={},S={productType:c},y=i.confirmCloseMsgMap,A={missingData:"Failed to get required parameters",invalid:"Invalid API response",emptySdkToggles:"Empty .sdkToggles",appInfo:"Failed to retrieve application info",timeout:"API request timeout",server:"Server error",engaged:"Already engaged with OfferWall product",adunitAssetsTimeout:"Timeout in loading ad unit static assets",closeBeforeVisible:"User closed before ad loaded",missingDeviceIds:"Missing deviceIds",preconditions:"Failed to initiated OW, preconditions did not pass"},C={adunit:"adunit",inventory:"inventory",inventoryInBackground:"inventoryInBackground",preConditions:"preConditions",close:"close"},I={v:1,controllerId:1,applicationKey:0,applicationUserId:0,debug:0,language:0,maxVideoLength:0,itemName:0,itemCount:0,timestamp:0,localTime:1,timezoneOffset:1,itemSignature:0,disableCache:0,showDeliveryLimitationsLog:0,disableSession:0,minimumOfferCommission:0,minimumOfferCommissionSignature:0,applicationUserGender:0,applicationUserAgeGroup:0,applicationUserCreationDate:0,applicationUserCreationDateSignature:0,demoCampaigns:0,appOrientation:1,mobileCarrier:0,connectionType:1,iphoneAppOnIpadDevice:0,deviceOs:1,SDKVersion:1,deviceOSVersion:1,deviceOEM:0,deviceVolume:0,immersiveMode:0,att:0,"deviceIds[OpenUDID]":0,"deviceIds[IFA]":0,"deviceIds[IDFV]":0,"deviceIds[SERIAL]":0,"deviceIds[AndroidID]":0,"deviceIds[IMEI]":0,"deviceIds[AID]":0,displaySizeWidth:0,displaySizeHeight:0,deviceWidthDP:0,deviceHeightDP:0,deviceScreenScale:0,deviceLanguage:0,deviceModel:0,diskFreeSize:1,country:0,pageSize:0,page:0,landingId:0,customParams:0,admin:0,useClientSideCallbacks:0,isLimitAdTrackingEnabled:0,SDKPluginType:0,bundleId:0,jb:0,gpi:0,allowArbitraryLoads:0,allowArbitraryLoadsInWebContent:0,mcc:0,mnc:0,appVersion:0,batteryLevel:0,cdnCn:0,sdkAbName:0,segmentId:0,segmentName:0,consent:0,moatSupported:0,mediationType:0},D={settings:{},textData:{},offers:[]},w={SDKVersion:1},P={id:0,url:""},O={openAppStoreSheet:!0,preload:!1},F={osNotSupported:"Sorry, your operating system version is not supported.",dialogErrorMessage:"Sorry, we were unable to display the wall at the moment. Please try again later.",noOffers:"Sorry, we currently have no offers to display. Please try again later.",noInternet:"No internet connection. Please connect and try again."},T={initOWSuccess:null,initOWFailure:null},x=0,U,N={},L,V,M,R,k,K=!1,B=!1,E=null,j=null,_=n.adUnitGlobals,W="#/?productType="+c+"&mode=msdkctrl",G=null,H=null,q=null,J=null,Q=null,$=!1,z=null,X,Y={adUnitAssetsTimeout:6e4,pollAPITimeout:1e4},Z={offers:[],settings:{},textData:{noOffers:F.noOffers},ext:{emptyOWReason:"default empty OW reason"}},ee={},te=e("./OWEventCategories.js")(),ne,ie,re,ae,oe=function(){var e=!1,r=!1,a=!1,o=!0,s=!1;return{init:function(){e||(t.PubSub.subscribe(u+".Engaged",(function(e){t.Utils.isDefined(e.duringEngage)&&(r=e.duringEngage)})),t.PubSub.subscribe(f+".enterBackground",(function(){a=!0})),t.PubSub.subscribe(f+".enterForeground",(function(e){a=!1,!ce()||e&&t.Utils.isDefined(e.active)&&!e.active||(n.log("poll on CPI offer closed/external browser offer closed (iOS flow)"),B=!1,he())})),t.PubSub.subscribe(f+".viewableChange",(function(e){e&&t.Utils.isDefined(e.isViewable)&&(!s||!e.isViewable||t.Utils.isDefined(e.webview)&&"main"!==e.webview||(s=!1,n.postAdUnitEvent({name:"OfferClosed"})),ce()&&e.isViewable&&t.Utils.isDefined(e.webview)&&"main"===e.webview&&(n.log("poll on CPI offer closed/external browser offer closed (Android flow)"),B=!1,he()))})),t.PubSub.subscribe(f+".deviceStatusChanged",(function(e){t.Utils.isDefined(e.connectionType)&&(o="none"!==e.connectionType&&"notReachable"!==e.connectionType)})),e=!0)},canEngage:function(){if(r||!o)return!1;var e=n.getCurrentDisplayedAd();return!e||e.productType===i.BN},isConnected:function(){return o},setConnection:function(e){o=e},setAdOpened:function(e){s=e},getStatusMsg:function(){return" duringEngage:"+r+" appInBackground:"+a+" isConnected:"+o},getStatus:function(){return{duringEngage:r,appInBackground:a,isConnected:o,isAdOpened:s}},duringEngage:function(){return r},publish:function(e,n){t.PubSub.publish(u+"."+e,n)},waitUntilAppInForeground:function(){var e=p.Deferred();return a?(n.log("OfferWall | Waiting for app to be in foreground"),t.PubSub.subscribeOnce(f+".enterForeground",(function(){e.resolve()}))):e.resolve(),e.promise()},waitUntilConnected:function(){var e=p.Deferred();if(o)e.resolve();else{n.log("OfferWall | waiting for internet connection");var i=t.PubSub.subscribe(f+".deviceStatusChanged",(function(n){t.Utils.isDefined(n.connectionType)&&(o="none"!==n.connectionType&&"notReachable"!==n.connectionType)&&(t.PubSub.unsubscribe(i),e.resolve())}))}return e.promise()}}}(),se=function(){t.PubSub.subscribe(c+".ActionClick",(function(e){n.OpenURLService.openForOW(e)||n.log(c+" failed to perform ActionClick")})),t.PubSub.subscribe("SDKController.AdClosed",(function(e){e.productType===c&&oe.getStatus().isAdOpened&&n.isIOS()&&(n.postAdUnitEvent({name:"OfferClosed"}),oe.setAdOpened(!1),ce()&&(n.log("OfferWall | poll on ad closed"),he()))})),t.PubSub.subscribe("SDKController.AdOpened",(function(e){e.productType===c&&(oe.setAdOpened(!0),K&&pe(e.bannerId,!0))})),t.PubSub.subscribe("SDKController.engageEnd",(function(e,i){e.productType===c&&(n.callSDKFunction("removeCloseEventHandler"),K&&(n.log("OfferWall | poll on engageEnd(ad closed)"),he()),oe.publish("Engaged",[{duringEngage:!1,productType:c}]),ie.unsetParamFromBaseData("landingId"),t.Utils.isFunction(i)&&i.call(),$&&"pending"===H.state()&&xe("User closed before visible"),G&&G.always((function(){G=null;Oe(!0)})))})),t.PubSub.subscribe("SDKController.adLoaded",(function(e){e.adType===c&&(n.log("OfferWall | received ad loaded event"),n.onAdLoaded(P))})),t.PubSub.subscribe("SDKController.AdVisible",(function(e){e.productType===c&&(n.log("OfferWall | ad visible"),ie.trackTimingStop(te.owVisible,{eNameStart:te.showOWCalledToOwVisible}),ie.trackTimingStart(te.adVisibleToClose))})),t.PubSub.subscribe("SDKController.Analytics",(function(e){if(e.productType===c&&e&&e.action){var n=e.action,r=e.eventParam;"fireEvent"===n?(r.label&&Object.keys(r.label).length>0&&t.Utils.extend(r.data,r.label),ie.report(r.eName,r.data)):"startTiming"===n?ie.trackTimingStart(r.eName,r.data):"stopTiming"===n?ie.trackTimingStop(r.eName,r.data):"setCustomData"===n?ie.updateBaseData(r.data):"unsetCustomData"===n&&(r&&r.data&&"bannerId"===r.data?ie.resetBaseData(i.baseDataKeys):ie.unsetParamFromBaseData(r.data))}})),t.PubSub.subscribe(f+".initOfferWall",(function(e,i,r){n.log("OfferWall | CB.init called"),ve(),ie.report(te.initOW),n.getApplicationInfo(S).then(gt,(function(e){n.callSDKFunction(r,{errMsg:e||A.appInfo})})).then((function(){return ie.report(te.initOWSuccess),n.callSDKFunction(i),t.Utils.returnResolvedPromise()}),(function(e){return ie.report(te.initOWFail,{callFailReason:e}),n.callSDKFunction(r,{errMsg:e}),t.Utils.returnResolvedPromise()})).then(De).then((function(){K&&he()}))})),t.PubSub.subscribe(f+".showOfferWall",(function(e,t,i){e&&n.AppOrientationManager.updateAppOrientationByNewRestriction(e.orientationRestriction),r.showOfferWall().then((function(){n.callSDKFunction(t,{placementId:Ye()})}),(function(e){n.callSDKFunction(i,{errMsg:e})})).always((function(){St(bt())&&(G=null)}))})),t.PubSub.subscribe(f+".getUserCredits",(function(e,i,r){if(n.checkRequiredCallbackParams(["applicationKey","applicationUserId","productType"],e,"getOfferWallCredits",r).didSucceed&&e.productType===c){if(t.Utils.decodeValues(e),It(e)&&oe.duringEngage()){var a="Could not provide credits, user provided is different from current user";return n.callSDKFunction(r,{errMsg:a}),void n.log(a,n.LogLevels.error)}De(!0,e).then((function(){he(e,r)}),(function(e){n.log(e,n.LogLevels.error),n.callSDKFunction(r,{errMsg:"Failed to initiate client side callbacks"})}))}})),t.PubSub.subscribe("SDKController.OWOfferClicked",(function(e){n.getCurrentDisplayedAdType()===c&&ue(e)})),t.PubSub.subscribe("SDKController.videoOfferClosed",(function(){n.RingerSwitchService.isInitiated()&&(n.RingerSwitchService.stopListener(),n.log("OfferWall | Ringer | stop detecting ringer status changes from OW videoOfferClosed event")),ce()&&(B=!1,he())})),t.PubSub.subscribe("SDKController.dialogBoxResume",(function(e){de(e)&&ie.report(te.dialogBoxResume)})),t.PubSub.subscribe("SDKController.dialogBoxExit",(function(e){de(e)&&ie.report(te.dialogBoxExit)})),t.PubSub.subscribe(c+".GetCompletionOffers",(function(e){if(t.Utils.isDefined(e.productType)){var n=ke();ae.getInventory(n.data,l,"json").then(le.bind(null,e),le.bind(null,e))}})),t.PubSub.subscribe("SDKController.OWPopupOfferOpened",(function(e){ne||(ne=window.timerService.startTimer())}))};function le(e,t){ae.isValidResponseStructure(t)&&(t=nt(t)),e&&e.callback&&e.callback.call(null,t)}function de(e){return e&&e.productType===S.productType}function ce(){return K&&B}function ue(e){n.log("OfferWall | marked offer clicked for CSC with type "+e.type),B=!0}function fe(e){return U=e&&e.placementId||x,n.log("OfferWall | Updated placement to "+U),U}var pe=function(e,t){k&&"pending"===k.state()&&p.when(k).always((function(){pe(e,t)})),N[e]=t,t?L++:L--,p.when(R).always((function(){n.log("poll counter set to: "+L),k=n.setUserData(h.applicationKey,h.applicationUserId,{counter:L}),p.when(k).always((function(){k=null}))}))},ge=function(){var e=new p.Deferred,i={counter:0,timestamp:0};return p.when(R,k).always((function(){p.when(n.getUserData(j,E)).then((function(e){L=i.counter=t.Utils.isDefined(e.counter)?e.counter:0,V=i.timestamp=t.Utils.isDefined(e.timestamp)?e.timestamp:0})).always((function(){p.when(n.setUserData(j,E,i)).then((function(){n.log("initiation done with resolve"),e.resolve()}),(function(){n.log("initiation done with reject",n.LogLevels.error),e.reject()}))}))})),e.promise()};function ve(){if(!re){re=!0,n.initAnalytics(S);var e={owPageNumber:0,isPrecache:ee.precache};ie.updateBaseData(e)}}var me=function(e){var i,r;if(R){if("pending"===R.state())return R.promise()}else R=new p.Deferred;return i=t.PubSub.subscribe(f+".adCreditedSuccess",(function(){V=e.timestamp,R.resolve(),t.PubSub.clearHandlers([i,r])})),r=t.PubSub.subscribe(f+".adCreditedFailed",(function(e){R.reject(e.errMsg),t.PubSub.clearHandlers([i,r])})),p.when(k).always((function(){n.callSDKFunction("adCredited",e,"adCreditedSuccess","adCreditedFailed")})),R.promise()},he=function(e,i){var r={},a=[];if(n.log("In poll with counter "+L),!t.Utils.isDefined(e)&&L<=0||M&&"pending"===M.state())n.log("Exit poll, p:"+(M?M.state():null)+" a:"+(R?R.state():null));else{var o=n.getApiData(w),l=0;if(t.Utils.isDefined(o.errMsg)||!t.Utils.isDefined(j)||!t.Utils.isDefined(E))return n.log(o.errMsg,n.LogLevels.error),void(t.Utils.isDefined(e)&&t.Utils.isDefined(i)&&n.callSDKFunction(i,{errMsg:"Failed to make polling request, missing data"}));t.Utils.decodeValues(o);var d={deviceId:n.getDeviceId(),aid:j,auid:E,SDKVersion:o.SDKVersion,timestamp:V};Ee(d),M=p.ajax({url:s,data:d,timeout:Y.pollAPITimeout,type:"GET",dataType:"jsonp"}),p.when(M).then((function(o){if(n.log("Received poll data"),!(t.Utils.isDefined(o.rewardsData)&&t.Utils.isDefined(o.sig)&&t.Utils.isDefined(o.rewardsSummary)))return n.log("Poll data error",n.LogLevels.error),void(t.Utils.isDefined(e)&&t.Utils.isDefined(i)&&n.callSDKFunction(i,{errMsg:"Failed to retrieve user completion data, data error"}));!t.Utils.isEmptyObject(o.rewardsData)||t.Utils.isDefined(e)?(n.log(l),r={productType:c,credits:o.rewardsFromTime,total:o.rewardsSummary,signature:o.sig,timestamp:o.latestCompletionTime,externalPoll:t.Utils.isDefined(e),totalCreditsFlag:0===V},p.when(R).always((function(){R=null,p.when(me(r)).then((function(){t.Utils.each(o.rewardsData,(function(){this.b&&N[this.b]&&pe(this.b,!1),a.push(this.id),l+=this.r?this.r:0})),a.length>0&&p.ajax({url:o.callbackURL,type:"GET",dataType:"jsonp",data:{vt:a.join(","),applicationKey:j,applicationUserId:E},success:function(){n.log("successfully updated server on csc")},error:function(e){n.log("failed to update server on csc",n.LogLevels.error)}})})).always((function(){R=null}))}))):n.log("no new completions")}),(function(r){n.log("Error retrieve user completion data"),t.Utils.isDefined(e)&&t.Utils.isDefined(i)&&n.callSDKFunction(i,{errMsg:"Failed to retrieve user completion data"})}))}};function be(){return oe.canEngage()?t.Utils.returnResolvedPromise():oe.isConnected()?t.Utils.returnRejectedPromise(A.engaged):t.Utils.returnRejectedPromise(F.noInternet)}function Se(e){e&&(v=e)}function ye(e){return e in v?v[e]:null}function Ae(e,i){var r;return r=e?i:h=n.getApiData(I),t.Utils.returnResolvedPromise(r)}function Ce(e){return K=e&&("true"===e.useClientSideCallbacks||"boolean"==typeof e.useClientSideCallbacks&&e.useClientSideCallbacks),t.Utils.returnResolvedPromise(e)}function Ie(e){var n=It(e);return t.Utils.returnResolvedPromise(n,e)}function De(e,i){return Ae(e,i).then(Ce).then(Ie).then((function(i,r){return i&&(K||e)?(n.log("OfferWall | init client side callbacks"),Dt(r),ge()):t.Utils.returnResolvedPromise()}))}function we(){return be().then(n.getApplicationInfo.bind(n,S)).then((function(){return fe(n.getApiData({placementId:1})),De()}))}function Pe(){n.log("OfferWall | In Refresh Interval"),oe.duringEngage()?n.log("OfferWall | Refresh Interval Popped, but during engage - ignore"):oe.waitUntilAppInForeground().then(oe.waitUntilConnected).then((function(){n.log("OfferWall | Refresh Interval Popped, calling refreshOfferWall"),n.unloadAdViewsByProduct(S),Oe()}))}function Oe(e){Ne(),oe.isConnected()&&(Je(),ee.precache?ct():e&&!ee.getInventoryOnInit||Ue())}function Fe(){z=setTimeout((function(){n.log("OfferWall | Adunit static assets timer popped"),xe(A.adunitAssetsTimeout)}),Y.adUnitAssetsTimeout)}function Te(e){clearTimeout(z),n.log("OfferWall | Resolve adunit static assets promise"),H.resolve(e)}function xe(e){clearTimeout(z),n.log("OfferWall | Reject adunit static assets promise - "+JSON.stringify(e)),H.reject.apply(H.reject,arguments)}function Ue(){var e=ke();e.errMsg||lt(e).always(vt)}function Ne(){q=null,Q=null,J=null}function Le(){var e=t.PubSub.subscribe(c+".GetConfig",(function(e){n.log("OfferWall | Received getConfig event from adunit"),Te(e)}));return function(){t.PubSub.unsubscribe(e)}}function Ve(){var e=t.PubSub.subscribe(u+".Engaged",(function(e){e.productType===c&&($=!0)}));return function(){t.PubSub.unsubscribe(e)}}function Me(){n.log("OfferWall | Load Adunit"),H=new p.Deferred,ie.trackTimingStart(te.staticAssetsLoaded);var e=Le();return p.when(m?(n.log("Using cached adunit url: "+m),t.Utils.returnResolvedPromise({html:m})):_.getGlobalAssetsJSON()).then((function(e){if(m||(_.setAdunitVersion(e),m=_.getAdunitGlobalsHTML()),$)xe("User closed before visible");else if("rejected"===q.state())xe("Finished when flow already failed");else{var t=_.getStaticGlobalsUrl()+m+W;setTimeout((function(){n.updateAdUnitUrl(P,t,S,{preload:!0,forceCreation:!0})}),0),Fe()}}),xe),H.promise().then((function(e){return ie.trackTimingStop(te.staticAssetsLoaded),e})).always((function(){e()}))}function Re(){var e={pass:!0,reason:"ok"};return oe.isConnected()?n.isSupportedOsVersion(c)?n.isLimitedDeviceModel()&&(e.reason="Device is not supported",e.pass=!1):(e.pass=!1,e.reason="Operating system version "+n.getConfigurationHelper().getDeviceOsVersion()+" is not supported"):(e.pass=!1,e.reason=F.noInternet),e}function ke(){var e={data:null,errMsg:null},i=n.getApiData(I);return t.Utils.isDefined(i.errMsg)?e.errMsg=i.errMsg:i==={}?e.errMsg=A.missingData:(i.format=d,Ee(i),Be(i),Ke(i),t.Utils.decodeValues(i),i.auid=n.AppUserIdService.getAUID(),e.data=i,h=i),e}function Ke(e){var t=n.getApiData({coppa:0});e.cscd=t&&t.coppa}function Be(e){var t=n.getSDKDataByKey(i.xCodeVersion);t&&(e.xCodeVersion=t)}function Ee(e){var t=n.getSDKDataByKey(i.abTests.abt);t&&t.hasOwnProperty(i.abtParamByProductType[c])&&t[i.abtParamByProductType[c]].length>0&&(e.abt=t[i.abtParamByProductType[c]])}function je(e){q&&"pending"===q.state()&&(n.log("OfferWall | Rejecting Get Inventory | "+e.errMsg),e.errCode&&(eventObj.errorCode=e.errCode),e.failFlow!=C.preConditions&&ie.report(te.getInventoryFailed,{callFailReason:e.errMsg}),q.reject(e))}function _e(e,t){return{failFlow:e,errMsg:t}}function We(){return _e(C.close,"User closed before visible",!0)}function Ge(e,t,n){var i=_e(e,t);return i.errCode=n||0,i}function He(){return G&&"pending"===G.state()}function qe(){return q&&"pending"===q.state()}function Je(){X&&(clearTimeout(X),X=null)}function Qe(){var e=n.getApiData({scdn:1,protocol:0,defaultProtocol:1}),t=n.decideUrlProtocolAccordingToHTTPSCompliance(),i=e.scdn;return{protocol:t,urltocdn:"prod"!==n.getEnv()?n.api()+"/users/staging/"+SuperSonicGlobalConfig.mobileSDKSettings.env:t+"//"+i,preload:ee.precache,hasNotch:n.getNotchService().hasNotch()}}function $e(e,i){var r=He(),a=e.offers&&e.offers.length>0;if(!r&&!a){var o=_e(C.inventoryInBackground,"Empty Inventory");return n.log("No inventory available while preloading in background - Remove iframe"),n.unloadAdViewsByProduct(S),je(o),t.Utils.returnRejectedPromise(o)}return F.confirmCloseMsg=e.textData.confirmCloseMsg,t.Utils.extend(e.settings,Qe(),n.getFormattedDeviceData()),Xe(e),Ze(e).then((function(e){ze(e),i.callback.call(null,e)}))}function ze(e){var r={settings:{deviceId:n.getDeviceId(),appKey:n.getSDKDataByKey(i.requiredSDKDataKeys.applicationKey),userApplicationId:n.getSDKDataByKey(i.requiredSDKDataKeys.applicationUserId),shouldShowOWPopup:Tt()}};return t.Utils.extend(!0,e,r)}function Xe(e){n.getConfig().mobileSDKSettings.deviceOs!==i.deviceOs.ios&&e.settings.forceOWOrientation&&(P.ext={forceOrientation:e.settings.forceOWOrientation})}function Ye(){return U||x}function Ze(e){var i=new p.Deferred;if(!e.settings.placementsFlow)return i.resolve(nt(e));if(He())i.resolve(it(e));else{n.log("Waiting for show before resolving getConfig");var r=t.PubSub.subscribe(f+".showOfferWall",(function(){t.PubSub.unsubscribe(r),n.getApplicationInfo(S).then((function(){fe(n.getApiData({placementId:1})),i.resolve(it(e))}))}))}return i.promise()}function et(e,t){if(!e)return!1;if(e.offers&&e.offers.length>0){var n=e.offers[0];return n.rewards&&n.rewards[t]}return!!e.settings.currency&&e.settings.currency[t]}function tt(e,n){if(!e.intermediateData||!e.intermediateData.text)return e;var i=e.currency||n,r=e.intermediateData.text.actionButton,a=e.intermediateData.text.instructionDescription,o=e.intermediateData.text.instructions,s={"{{rewardCount}}":e.rewards,"{{currencyName}}":i};if(r.length>0&&(e.intermediateData.text.actionButton=t.Utils.replacePlaceHolder(r,s)),a.length>0&&(e.intermediateData.text.instructionDescription=t.Utils.replacePlaceHolder(a,s)),o.length>0)for(var l=0;l<o.length;l++)o[l]=t.Utils.replacePlaceHolder(o[l],s);return e}function nt(e){for(var t=e.offers,n=0;n<t.length;n++)t[n]=tt(t[n],e.settings.currency);return e}function it(e){var t=e.offers,i=Ye();et(e,i)||(i=fe({placementId:x})),n.log("Offerwall | currentPlacement: "+i),e.settings.placementId=i;for(var r=0;r<t.length;r++)t[r].textData=t[r].textData[i],t[r].rewards=t[r].rewards[i],t[r].multiCompletionsRewards&&t[r].multiCompletionsRewards[i]&&(t[r].multiCompletionsRewards=t[r].multiCompletionsRewards[i]),t[r]=tt(t[r],e.settings.currency[i]);try{e.settings.vip&&(e.settings.vip=e.settings.vip[i]),e.settings.currency=e.settings.currency[i],e.settings.doublePromotionData&&(e.settings.doublePromotionData=e.settings.doublePromotionData[i]),e.settings.multiCreditPromotionData&&(e.settings.multiCreditPromotionData=e.settings.multiCreditPromotionData[i]),e.settings.linksData.contactSupport.label=e.settings.linksData.contactSupport.label[i],e.textData.header=e.textData.header[i]}catch(e){n.log("OfferWall | Failed to interpolate inventory response",n.LogLevels.error)}return e}function rt(e,i){i.failFlow!==C.close?(He()?i.failFlow===C.inventory&&(e&&"rejected"!==e.state()||(e=ot()),e.then((function(e){var n=t.Utils.extend(!0,{},Z);n.ext.emptyOWReason=i.errMsg,ze(n),e.callback.call(null,n)}))):(i.failFlow===C.inventory&&(i=_e(C.inventoryInBackground,"Failed to get Inventory"),n.log("OfferWall | Inventory failed while preloading in background - Remove iframe")),n.unloadAdViewsByProduct(S)),je(i)):je(i)}function at(e){n.log("Offerwall | Get Inventory"),ie.report(te.getInventory);var r=n.getProtocol()+i.gatewayDestinationMap.OW.production;return ae.getInventory(e.data,r).then((function(e){return e.settings&&e.settings.sdkToggles&&Object.keys(e.settings.sdkToggles).length?e:(n.log("Offerwall | Get Inventory invalid .sdkToggles"),t.Utils.returnRejectedPromise(_e({errorMessage:A.emptySdkToggles})))})).then((function(e){if($){var n=We();return t.Utils.returnRejectedPromise(n)}return e}),(function(e){return $?We():Ge(C.inventory,e.errorMessage,e.errorCode)})).then((function(e){return n.CampaignsFilter.filterByAppInstalledOW(e.offers,e.settings).then((function(){return t.Utils.returnResolvedPromise(e)}))}))}function ot(){var e=ye(i.offerWallSetting.OWVersion)||i.offerWallSetting.defaultOWVersion;return Ut.bind(null,e)().then(null,(function(e){return $?We():_e(C.adunit,e)}))}function st(){if(n.log("OfferWall | _handlePreConditions"),J&&"pending"===J.state())return n.log("OfferWall | _handlePreConditions already has deferred "+J.state()),J;var e;J=new p.Deferred,$=!1,Je();var t=!0,i=Re();i.pass||(je(e=_e(C.preConditions,i.reason)),t=!1);var r=ke();return r.errMsg&&(je(e=_e(C.preConditions,r.errMsg)),t=!1),t?J.resolve(r):J.reject(e),J.promise()}function lt(e){return n.log("OfferWall | _getInventoryWithPromise"),Q&&"rejected"!==Q.state()?(n.log("OfferWall | _getInventoryWithPromise already has deferred "+Q.state()),Q):Q=at(e).then((function(e){var r=e.settings;return r.shouldStartMuted=n.AdUtils.isCampaignShouldStartMuted(n.getConfig().controllerConfig,i.OW),t.Utils.extend(r,r.sdkToggles),delete r.sdkToggles,Se(r),dt({feedSize:e.offers.length,landingId:e.settings.templateId||e.settings.landingId,strategyId:e.settings.strategyId,requestId:e.settings.requestID}),t.Utils.returnResolvedPromise(e)}))}function dt(e){ie.updateBaseData(e)}function ct(){return n.log("OfferWall | _initOfferWall"),q&&"rejected"!==q.state()?(n.log("OfferWall | _initOfferWall using cached promise in Init OW flow"),q.promise()):(q=new p.Deferred,ft().then((function(){q.resolve()})),q.promise())}function ut(e){var t=new p.Deferred;return n.shouldExtendApiDataWithDebugData()?n.extendApiDataWithDebugParams(e.data).then((function(n){e.data=n,t.resolve(e)})):t.resolve(e),t.promise()}function ft(){var e=null;return st().then((function(e){return ut(e)})).then((function(e){return lt(e)})).then((function(t){return e=ot(),p.when(t,e)})).then((function(e,t){return $e(e,t)}),(function(t){return rt(e,t)})).always(vt)}function pt(){return st().then(lt,(function(e){return e&&e.errMsg||(e={errMsg:A.preconditions}),n.log("OfferWall.js | CB.init preConditionsFailed "+JSON.stringify(e),n.LogLevels.verbose),t.Utils.returnRejectedPromise(e.errMsg)})).then(null,(function(e){return n.log("OfferWall.js | CB.init getInventoryPromise fail",n.LogLevels.verbose),e=e||A.server,t.Utils.returnRejectedPromise(e)})).always(vt)}function gt(){return ee.precache?(ct(),t.Utils.returnResolvedPromise()):ee.getInventoryOnInit?pt():t.Utils.returnResolvedPromise()}function vt(){if(!X&&(ee.precache||ee.getInventoryOnInit)&&!St(bt())){var e=ee.refreshInterval;n.log("Setting OW refresh interval - "+e+" minutes",n.LogLevels.verbose),X=setTimeout(Pe,e*o)}}function mt(){$&&t.Utils.returnRejectedPromise(We().errMsg)}function ht(e){"object"!=typeof e&&(e={errMsg:e});var i=e.errMsg||"Generic error on ShowOfferWall";return $?i:e.failFlow===C.adunit?(ie.report(te.showOWFail,{callFailReason:"l1651: "+i}),Pt(i),i):e.failFlow===C.preConditions?(ie.report(te.showOWFail,{callFailReason:"l1655: "+i}),Pt(i),i):(n.log("Empty OfferWall error",n.LogLevels.verbose),Ct(),t.Utils.returnResolvedPromise())}function bt(){var e,n=ye("standaloneOfferWallData");if(n&&n.url){var i=n.url,r=Ye();t.Utils.isDefined(r)&&(i=t.Utils.replacePlaceHolder(i,{"{{PlacementId}}":r})),-1===i.indexOf("openOWInStandalone")&&(i+="&openOWInStandalone=true"),e=t.Utils.extend({},n,{url:i})}return e}function St(e){return e&&e.openInStandaloneOfferWall&&e.url}function yt(){return G&&"rejected"!==G.state()?(n.log("line[354]: Recalling showOW before resolving previous flow",n.LogLevels.error),ie.report(te.showOWFail,{callFailReason:"Recalling showOW before resolving previous flow"}),G):(G=new p.Deferred,ve(),ie.incrementSessionNumber(),ie.trackTimingStart(te.initControllerToShowOWCalled,n.getApiData({controllerTimeLoaded:1}).controllerTimeLoaded),ie.trackTimingStop(te.showOWCalled,{eNameStart:te.initControllerToShowOWCalled}),ie.trackTimingStart(te.showOWCalledToOwVisible),we().then((function(){if(!St(i=bt())){var n=ct();return e=Ve(),At(n),n.then(mt,ht)}return t.Utils.returnResolvedPromise()}),(function(e){return ie.report(te.showOWFail,{callFailReason:"l1735: "+e}),Pt(e),e})).always((function(){e&&e()})).then((function(){if(St(i)){var e={url:i.url,method:"external_browser"};n.openUrl(e)}else Ct();n.log("Resolving ShowOfferWall"),G.resolve.apply(this,arguments)}),(function(e){n.log("Rejecting ShowOfferWall"),G.reject(e)})),G.promise());var e,i}function At(e){if(P.url=null,P.isWPAD=!1,"resolved"!==e.state()||!ee.precache){var t={preload:!1,immersive:!!ye(i.offerWallSetting.immersive)&&ye(i.offerWallSetting.immersive),OLXD:ye(i.offerWallSetting.OLXD)};n.loadAdUnitUrl(P,P.url,S,t),n.displayAdView(P)}}function Ct(){P.isWPAD=!1,n.loadAdUnitUrl(P,P.url,S,{preload:!1}),n.displayAdView(P)}var It=function(e){var t=e.applicationUserId,n=e.applicationKey;return t!==E||n!==j},Dt=function(e){E=e.applicationUserId,j=e.applicationKey};function wt(e){return F.dialogErrorMessage}function Pt(e){n.log("No OfferWall dialog error");var t={productType:c,message:wt(e),alwaysClose:!0,yes:"close",no:"OK"};n.alert(t)}function Ot(){var e=n.getProtocol();b={dev:e+i.gatewayDestinationMap.OW.production,stage:e+i.gatewayDestinationMap.OW.production,prod:e+i.gatewayDestinationMap.OW.production}}function Ft(e){return b[e]||b.prod}function Tt(){var e=n.getApplicationExternalConfig().getABTestConfiguration("Offerwall",h.landingId),t=e.OWPopupInterval?e.OWPopupInterval:0;if(!t||!ne)return!0;var r=window.timerService.timeElapsed(ne);return t*i.timeunit-r<=0&&(window.timerService.stopTimer(ne),ne=void 0,!0)}var xt={init:function(i){r=this,p=n.jQuery(),Ot();var o=Ft(n.getEnv());if(!a){var s={baseData:{productType:c}};"android"===n.getConfig().mobileSDKSettings.deviceOs&&(I.deviceApiLevel=0),ie=t.Analytics.createAnalytic(s),ae=new(e("../../components/FetcherService.js"))(t.Utils,o,D),oe.init(),se(),ee=i.supplyConfig,a=!0}},getNextBtnText:function(){return t.Utils.isDefined(F.next)?F.next:"Next"},getConfirmCloseMsg:function(){return F.confirmCloseMsg&&F.confirmCloseMsg[y[0]]},showOfferWall:yt,isNextAvailable:function(){return!1},getBack:function(){return P.url}};function Ut(e){n.log("OfferWall | Load external version: "+e),H=new p.Deferred,ie.trackTimingStart(te.staticAssetsLoaded);var t=Le();if($)xe("User closed before visible");else{var i=_.getOWStaticGlobalsUrl(e)+_.getOWGlobalsHTML()+W;n.log("composedUrl: "+i),setTimeout((function(){n.updateAdUnitUrl(P,i,S,{preload:!0,forceCreation:!0})}),0),Fe()}return H.promise().then((function(t){return ie.trackTimingStop(te.staticAssetsLoaded,{custom_a:e}),t})).always((function(){t()}))}return t.Utils.extend(xt,{_promisedCanEngage:be,_initiateClientSideCallbacks:De,_preShowOfferWall:we,_refreshInterval:Pe,_refreshOfferWall:Oe,_setAdunitAssetsTimer:Fe,_resolveAdunitAssetsPromise:Te,_rejectAdunitAssetsPromise:xe,_subscribeGetConfig:Le,_subscribeCloseDuringShow:Ve,_loadAdunitToIframe:Me,_verifyRestrictions:Re,_getAPIRequiredData:ke,_rejectInitWithReason:je,_generateErrorObject:_e,_generateCloseBeforeVisibleErrorObject:We,_isDuringShow:He,_isDuringInit:qe,_clearRefreshInterval:Je,_handleDependenciesResolve:$e,_handleDependenciesReject:rt,_getInventory:at,_loadAdunit:ot,_handleInitOfferWallError:ht,_showLoaderIfNeeded:At,_initOfferWallByConfig:gt,_displayOfferWall:Ct,_getInventoryAndPreload:ft,_initOfferWall:ct,_setOfferWallSettings:Se,_getOfferWallSetting:ye,shouldAvoidHandleFrameClose:function(){return!1}}),xt}t.exports=i},{"../../components/Constants.js":33,"../../components/FetcherService.js":41,"./OWEventCategories.js":166}],168:[function(e,t,n){t.exports=function(t,n,i,r){"use strict";var a,o,s,l=e("./InstancesMemoryHandler"),d=new(e("./SDKController/ManualLoadInstancesBuilder.js"))(n.getConfig().controllerConfig,r),c=new(e("./DemandSource/EventCategories"))(i.ProductName),u=new(e("./DataStore")),f=new(e("./DemandSource/dsConfig"))(i,c),p=new(e("./prdTaskManager"))(t,n,i.ProductName,r),g=new(e("../components/FilteredListService")),v={},m={},h=!1,b=n.DemandUtils,S=[],y=null,A=null,C=n.InstancesTimers,I={loadSuccess:null,loadFailure:null};function D(e){C.clear(i.ProductName,e),delete a[e]}function w(e){return t.Utils.extend(!0,{},{originalDemandSourceName:G(e)},e)}function P(o){var l=G(o);return a[l]?a[l]:function(o){var l=G(o),c={productType:i.ProductName,demandSourceName:l,isInAppBidding:E(o),isOneFlow:j(o),isLoadWithAdmFlow:W(o),demandSourceId:o.demandSourceId,originalDemandSourceName:o.originalDemandSourceName||G(o),adSize:{width:o.width,height:o.height,label:o.label},isMultipleAdObjects:_(o)},p=d.createDemandEntityConfigObj(c);return n.log("initiating "+i.ProductName+" demand source with configuration "+JSON.stringify(p),n.LogLevels.verbose),p.shouldAvoidHandleFrameClose=i.shouldAvoidHandleFrameClose,a[l]=p.isLoadWithAdmFlow?function(a){var o=B(a);s=function(a){if(s)return s;var o={productType:i.ProductName,isInAppBidding:!0,originalDemandSourceName:a.originalDemandSourceName||G(a)},l=t.Utils.extend(!0,{},f.precacheConfig);return l.cacheBase=r.cacheAdsDirectory,l.precachePath="../"+l.cacheBase+"/",l=t.Utils.extend(l,o),new(e("../components/precacheManager"))(t,n,l)}(a);var l=new(e("./ProductAdapter/BidderProductStatesManager"))(t,n,a,f,r,o);return new(e("./DemandSource/BidderProductInstance"))(t,n,r,a,f,o,s,l)}(p):function(a){var o=B(a),s=new(e("./ProductAdapter/ProductStatesManager"))(t,n,a,f,r,o,i.NativeAPI);return new(e("./DemandSource/ProductInstance"))(t,n,r,a,f,o,u,s)}(p),a[l].init(),a[l]}(o)}function O(e){return!!function(e,t){if(t===r.deviceOs.ios)return!!e.isViewControllerSet;return!0}(e,n.getConfig().mobileSDKSettings.deviceOs)}function F(e,t,a){var o=G(e),s=q(e);if(V(s),s.resetBaseData(r.baseDataKeys),N(s,o),k(o))!function(e,t,r){var a=f.errors.load.instanceExhausted;e.productType=i.ProductName;var o=b.extendCallbackParamsWithDemandConfig(e,{errMsg:a});o=C.extendEventElapsedTime(e.productType,e.demandSourceName,o),t.report(c.loadAdFailedForExhaustedInstance,o),C.clearStartTime(e.productType,e.demandSourceName),n.callSDKFunction(r,o)}(e,s,a);else{var l=P(e);if(T(l)){if(e&&e.productType===r.BN){if(!O(e))return void function(e,t,i){t.report(c.loadAdFailed,{callfailreason:"Missing Parameter : View Controller",timingvalue:C.stop(e.productType,e.demandSourceName)}),n.callSDKFunction(i,b.extendCallbackParamsWithDemandConfig(e,{errMsg:"Missing Parameter : View Controller"}))}(e,s);n.addExternalAdViewIdAndSetStatus(e)}p.canEngage()?l.statesManager.load(l.loadAd,t,a,l.readyStateParams):H(e,s,a,"LWS is not allowed for nonBidding instance")}else x(e,s,a)}}function T(e){return e&&e.statesManager}function x(e,t,n){H(e,t,n,f.errors.general.dsNotSet)}function U(e,i,a){var o=P(e),s=J(o);V(s),s.resetBaseData(r.baseDataKeys);var l=function(e){return e&&e.dynamicDemandSource?e.dynamicDemandSource:null}(e),d=function(e){if(!e)return null;try{var n=t.Utils.parseJSON(decodeURIComponent(e));return t.Utils.isEmptyObject(n)&&(n=null),n}catch(e){}return null}(e.adm),c={dynamicDemandSource:l,auctionId:L(d,"-1")};c=t.Utils.extend(c,function(e){var t={};e.label&&(t.adsizelabel=e.label);e.height&&e.width&&(t.adsizeheight=e.height,t.adsizewidth=e.width);return t}(e),function(e){if(!e||!e.seatbid||!e.seatbid.ext)return{};var t={landingId:e.seatbid.ext.landingId,strategyId:e.seatbid.ext.strategyId,adSource:e.seatbid.ext.adSource,dspname:e.seatbid.ext.dspName};return n.AdUtils.updateEventWithAdParams(e.seatbid.ext,e.seatbid.bid[0],t)}(d)),s.updateBaseData(c),N(s,e.originalDemandSourceName),T(o)?d?(e.adm=d,o.loadAdWithAdm(e,i,a)):function(e,t,n){H(e,t,n,"unable to parse adm from native SDK")}(e,s,a):x(e,s,a)}function N(e,t){n.log("productAdapter - load",n.LogLevels.verbose);var r=C.extendEventElapsedTime(i.ProductName,t,{demandSourceName:t});e.report(c.loadAd,r),f.shouldDisplayOnAdReady&&e.trackTimingStart(c.showAdCalled)}function L(e,t){return e&&e.seatbid.ext.hasOwnProperty("auction")?e.seatbid.ext.auction.id:t}function V(e){n.getTokenService().getToken().then((function(t){const{mt:n}=t;n&&(e.report(c.getTokenFromNativeSuccess,{generalMessage:n}),e.updateBaseData({mediationType:n}))})).fail((function(t){e.report(c.getTokenFromNativeFailed,{callFailReason:t})}))}function M(e,t){if(n.log("productAdapter - destroy",n.LogLevels.verbose),e&&_(e.instConfig)){e.clearListeners(),delete a[e.name];var i=e.getPreLoadedAd();i&&n.unloadAdViewByAdViewId(i.adViewId);var r=b.extendCallbackParamsWithDemandConfig(e.instConfig,{custom_a:t});q(e.instConfig).report(c.destroyMultipleAdInstance,r)}}function R(e){return e&&e.productType===i.ProductName}function k(e){return-1!==S.indexOf(e)}function K(e){return e?a[e]:null}function B(e){return t.Analytics.createAnalytic({baseData:{productType:i.ProductName,demandSourceName:e.originalDemandSourceName,demandSourceId:e.demandSourceId,isBiddingInstance:e.isInAppBidding,isOneFlow:e.isOneFlow}})}function E(e){return!(!e||!e.inAppBidding||"true"!==e.inAppBidding.toLowerCase())}function j(e){return!(!e||!e.isOneFlow||"true"!==e.isOneFlow.toLowerCase())}function _(e){if(!e||!e.isMultipleAdObjects)return!1;var t=e.isMultipleAdObjects;return!0===t||t.toLowerCase&&"true"===t.toLowerCase()}function W(e){return E(e)||j(e)}function G(e){return e&&e.demandSourceName?e.demandSourceName:i.DemandName}function H(e,t,r,a){e.productType=i.ProductName;var o=b.extendCallbackParamsWithDemandConfig(e,{errMsg:a});o.callfailreason=a,o.timingvalue=C.stop(e.productType,e.demandSourceName),o=C.extendEventElapsedTime(e.productType,e.demandSourceName,o),t.report(c.loadAdFailed,o),C.clearStartTime(e.productType,e.demandSourceName),n.callSDKFunction(r,o)}function q(e){return J(a[G(e)])}function J(e){return e&&e.getDSAnalytics&&e.getDSAnalytics()?e.getDSAnalytics():o}return{init:function(){if(a=this,!h){var e={baseData:{productType:i.ProductName}};o=t.Analytics.createAnalytic(e),y=new l(n,a),A=new l(n,a),function(){var e=n.getProtocol();v={dev:e+i.gatewayDestinationMap.prod,stage:e+i.gatewayDestinationMap.prod,prod:e+i.gatewayDestinationMap.prod};var t,r,a=n.getApiData({destinationMap:0});if(a&&a.destinationMap)for(t in m=a.destinationMap)r=m[t],m[t]&&m[t].length>0&&-1===m[t].indexOf(e)&&(m[t]=e+r)}(),t.PubSub.subscribe(i.AdUnitCallbacks.engageEnd,(function(e,n){if(R(e)){var r=K(e.demandSourceName);_(e)&&M(r,"engageEnd"),r&&r.statesManager&&((e&&e.engaged||i.shouldResetOnEngageEnd)&&r.statesManager.engageEnd(),r.engageEnd(e,(function(){p.publish("Engaged",[{duringEngage:!1,productType:i.ProductName}]),t.Utils.isFunction(n)&&n()})))}})),t.PubSub.subscribe(i.AdUnitCallbacks.adClicked,(function(e){if(R(e)){var t=n.getCurrentDisplayedAd();t&&n.callSDKFunction(i.ControllerNativeAPI.adClicked,b.extendCallbackParamsWithProductConfig(t,{}))}})),t.PubSub.subscribe(i.AdUnitCallbacks.adVisible,(function(e){if(R(e)){var t=K(e.demandSourceName);t&&t.instConfig.isLoadWithAdmFlow||(t?(n.log("ProductAdapter | "+i.AdUnitCallbacks.adVisible+" demandSourceName="+e.demandSourceName),t.adVisible(e),t.statesManager&&t.statesManager.adVisible()):n.log(i.AdUnitCallbacks.adVisible+" called without an active demand source name"))}})),t.PubSub.subscribe(i.ProductName+i.ControllerCallbacks.cacheReady,(function(e){var t=K(e.demandSourceName);t&&t.statesManager&&(t.readyStateParams=e,t.statesManager.cacheReady(I.loadSuccess,e))})),t.PubSub.subscribe(i.ProductName+i.ControllerCallbacks.noMoreOffers,(function(e){var t=K(e.demandSourceName);t&&t.statesManager&&t.statesManager.noMoreOffers(I.loadFailure,e.errorMsg)})),t.PubSub.subscribe(i.ProductName+i.ControllerCallbacks.failedToShow,(function(e){var t=K(e.demandSourceName);t&&t.statesManager&&(n.log(i.ProductName+" failed to show - can not engage ad",n.LogLevels.error),t.statesManager.failedToShow())})),t.PubSub.subscribe(i.ProductName+i.ControllerCallbacks.failedToLoad,(function(e){var t=K(e.demandSourceName);if(t&&t.statesManager){n.log(i.ProductName+" failed to load",n.LogLevels.error);var r={callFailReason:e.errMsg,timingvalue:C.stop(i.ProductName,e.demandSourceName)};r=C.extendEventElapsedTime(i.ProductName,e.demandSourceName,r),q(e).report(c.loadAdFailed,r),C.clearStartTime(i.ProductName,e.demandSourceName),t.statesManager.failedToLoad()}})),t.PubSub.subscribe(i.ProductName+i.ControllerCallbacks.actionClick,(function(e){n.OpenURLService.open(e)||n.log(i.ProductName+" failed to perform ActionClick",n.LogLevels.info)})),t.PubSub.subscribe(i.ProductName+i.ControllerCallbacks.exhaustedDemandSource,(function(e){var t=G(e),i=K(t);n.log("exhaustedDemandSource: "+t,n.LogLevels.verbose),i&&(i.exhausted=!0),S.push(t),e&&e.engaged||(n.log("Demand source deleted in BG: "+t,n.LogLevels.verbose),D(t))})),t.PubSub.subscribe(i.ProductName+i.ControllerCallbacks.fallbackToNonPrecache,(function(e){var t=K(e.demandSourceName);t&&t.statesManager&&t.statesManager.noMoreOffers(I.loadFailure,"failed due to fallbackToNonPrecache flow on manual load")})),t.PubSub.subscribe(i.ProductName+i.ControllerCallbacks.resetStateManager,(function(e){var t=K(G(e));t&&t.statesManager&&t.statesManager.resetAdState()})),t.PubSub.subscribe("SDKController"+i.ControllerCallbacks.onAdWindowsClosed,(function(e){if(R(e)){var t=K(e.demandSourceName);if(t)return t.exhausted?(n.log("Demand source deleted: "+e.demandSourceName,n.LogLevels.verbose),void D(e.demandSourceName)):void 0}})),i.ControllerCallbacks.reset&&t.PubSub.subscribe(i.ProductName+i.ControllerCallbacks.reset,(function(e){var t=K(e.demandSourceName);if(t)return n.getExternalContainer().resetReportAdVisibilityFlags(),q(e).report(c.bannerDestroyed),t.statesManager.resetAdState(),void t.reset();n.log("Reset called without an active demand source name",n.LogLevels.verbose)})),t.PubSub.subscribe(r.BN+".isVisible",(function(e){if(e&&e.demandSourceName){var t=e.demandSourceName,i=e.originalDemandSourceName,a=K(t);a&&a.getPreLoadedAd()&&(n.isBannerMultipleInstances(r.BN)&&(y.remove(i),A.add(i,t)),a.showAdBanner())}})),p.init(),h=!0}},getProductType:function(){return i.ProductName},getDestination:function(e){return m&&m[e]?m[e]:v[n.getEnv()]},getAmountOfSupportedInventories:function(){return i.amountOfInventories},shouldAvoidHandleFrameClose:function(){return i.shouldAvoidHandleFrameClose},doesAllowConsecutiveGatewayRequestsDuringLoad:function(){return i.Features.allowConsecutiveGatewayRequestsDuringLoad},getProductTM:function(){return p},initProduct:function(e,t,a){W(e=w(e))&&(e.demandSourceName=e.demandSourceId),C.setStartTime(i.ProductName,e.demandSourceName,e.loadStartTime);var o={isBiddingInstance:E(e),isOneFlow:j(e),demandSourceName:e.originalDemandSourceName};o=C.extendEventElapsedTime(i.ProductName,e.demandSourceName,o);var s=q(e);s.resetBaseData(r.baseDataKeys),s.report(c.initAd,o);var l=n.getSDKLimitationData(i.ProductName);if(!l.didSucceed)return o={callFailReason:l.errMsg,demandSourceName:e.originalDemandSourceName},o=C.extendEventElapsedTime(i.ProductName,e.demandSourceName,o),q(e).report(c.initAdFail,o),C.clearStartTime(i.ProductName,e.demandSourceName),void n.callSDKFunction(a,{errMsg:l.errMsg,demandSourceName:demandSourceName});var d=P(e);d.initProduct(e),n.callSDKFunction(t,b.extendCallbackParamsWithDemandConfig(d.instConfig))},loadProduct:function(e,t,a){n.log("productAdapter - loadProduct",n.LogLevels.verbose),e=w(e),C.start(i.ProductName,e.demandSourceName),C.setStartTime(i.ProductName,e.demandSourceName,e.loadStartTime),I.loadSuccess=t,I.loadFailure=a,W(e)?((e.productType!==r.BN||n.isBannerMultipleInstances(e.productType))&&(_(e)||y.add(e.demandSourceName,e.demandSourceId),e.demandSourceName=e.demandSourceId),U(e,t,a)):F(e,t,a)},showProduct:function(e,i,a){W(e=w(e))&&(_(e)||(y.remove(e.demandSourceName),A.add(e.demandSourceName,e.demandSourceId)),e.demandSourceName=e.demandSourceId);var o=G(e),s=K(o),l=e&&e.orientationRestriction;if(q(e).updateBaseData({sessionDepth:n.ImpressionsCounterService.getTotalImpressionsByProduct(f.productType)+1}),q(e).report(c.showAd),n.AppOrientationManager.updateAppOrientationByNewRestriction(l),function(e,t,i,r){if(k(i)){var a={errMsg:f.errors.show.instanceExhausted,demandSourceName:i};return q(e).report(c.showAdFail,{callfailreason:f.errors.show.instanceExhausted}),n.callSDKFunction(t,a),!1}return!!r||(q(e).report(c.showAdFail,{callfailreason:f.errors.general.dsNotSet}),n.callSDKFunction(t,{errMsg:f.errors.general.dsNotSet}),!1)}(e,a,o,s)){if(!p.canEngage()){var d="Cannot engage offer at this time",u=s.instConfig,g=b.extendCallbackParamsWithDemandConfig(u,{errMsg:d});t.PubSub.publish(f.productType+".failedToShow",[g]);var v=d;return v!==r.errors.showAdFailedReasons.preloadNoAd&&v!==r.errors.showAdFailedReasons.showNoAd&&(v+=JSON.stringify(s.getStatus())),q(e).report(c.showAdFail,{callFailReason:v}),n.callSDKFunction(a,b.extendCallbackParamsWithDemandConfig(u,{errMsg:d})),void(d!==r.errors.showAdFailedReasons.onAdVisibleFailed&&d!==r.errors.showAdFailedReasons.screenVisibleTimeout||t.PubSub.publish(r.taskManager+".Engaged",[b.extendCallbackParamsWithProductConfig(u,{duringEngage:!1})]))}q(e).trackTimingStart(c.showAdCalled),s.statesManager.show(s.showAd,i,a)}},destroyProduct:function e(n){_(n)?M(K(n.demandSourceId),"nativeSDK"+e.name):t.PubSub.publish("destroy."+n.demandSourceId)},initProductFail:function(e,t,i){var r=b.extendCallbackParamsWithDemandConfig(e,{errMsg:i});r.callfailreason=i,r.timingvalue=C.stop(e.productType,e.demandSourceName),r=C.extendEventElapsedTime(e.productType,e.demandSourceName,r),q(e).report(c.initAdFail,r),C.clearStartTime(e.productType,e.demandSourceName),n.callSDKFunction(t,r)},className:"ProductAdapter",filteredListService:g}}},{"../components/FilteredListService":43,"../components/precacheManager":107,"./DataStore":143,"./DemandSource/BidderProductInstance":144,"./DemandSource/EventCategories":146,"./DemandSource/ProductInstance":153,"./DemandSource/dsConfig":154,"./InstancesMemoryHandler":164,"./ProductAdapter/BidderProductStatesManager":169,"./ProductAdapter/ProductStatesManager":171,"./SDKController/ManualLoadInstancesBuilder.js":181,"./prdTaskManager":202}],169:[function(e,t,n){function i(e,t,n,i,r,a){var o={readyToLoad:0,inLoadingProcess:1,loaded:2,readyToShow:3,inShowingProcess:4,visible:5},s=o.readyToLoad,l=o.readyToShow,d=i.analyticsCategories,c=t.DemandUtils,u=c.extendCallbackParamsWithDemandConfig(n),f=t.InstancesTimers;function p(e){return s===e}function g(e){return l===e}function v(e){s=parseInt(e,10)}function m(e){l=parseInt(e,10)}function h(){return v(o.readyToLoad)}function b(){return m(o.readyToShow)}function S(){return p(o.readyToLoad)?i.errors.show.notLoaded:p(o.inLoadingProcess)?i.errors.show.duringLoad:g(o.inShowingProcess)?i.errors.show.tryingToEngage:g(o.visible)?i.errors.show.visible:"fail reason is unknown."}function y(e){if(g(o.visible)||g(o.inShowingProcess))t.log(S(),t.LogLevels.error);else if(!p(o.loaded)){var i=c.extendCallbackParamsWithDemandConfig(n,{errMsg:S()});t.callSDKFunction(e,i)}}function A(){t.log("BidderStateManager _loadWithADM"),v(o.inLoadingProcess)}function C(t,i,r){if(!I()){var s=e.Utils.extend(!0,{demandSourceName:n.originalDemandSourceName,callfailreason:S()},u);return a.report(d.showAdFail,s),void y(r)}m(o.inShowingProcess),t(u,i,r)}function I(){return p(o.loaded)&&g(o.readyToShow)}function D(i,r){v(o.loaded);var s=e.Utils.extend(!0,{},u,{demandSourceName:n.originalDemandSourceName,timingvalue:f.stop(n.productType,n.originalDemandSourceName)});s=f.extendEventElapsedTime(n.productType,n.originalDemandSourceName,s),a.report(d.loadAdSuccess,s),f.clearStartTime(n.productType,n.originalDemandSourceName),t.callSDKFunction(i,c.extendCallbackParamsWithDemandConfig(n,r)),e.PubSub.publish("ProductStatesManager.stateResolved",[c.extendCallbackParamsWithProductConfig(n,{response:!0})])}function w(o,s){var l=s===r.errors.noFill?d.noFill:d.loadAdFailed,p=e.Utils.extend(!0,{},u,{demandSourceName:n.originalDemandSourceName,callFailReason:s,timingvalue:f.stop(n.productType,n.originalDemandSourceName)});p=f.extendEventElapsedTime(n.productType,n.originalDemandSourceName,p),a.report(l,p),f.clearStartTime(n.productType,n.originalDemandSourceName);var g=c.extendCallbackParamsWithDemandConfig(n,{errMsg:i.errors.load.noMoreOffers});t.callSDKFunction(o,g),e.PubSub.publish("ProductStatesManager.stateResolved",[c.extendCallbackParamsWithProductConfig(n,{response:!1})]),h()}function P(){b()}function O(){h()}function F(){m(o.readyToShow)}function T(){v(o.readyToLoad),m(o.visible)}var x={show:C,cacheReady:D,noMoreOffers:w,failedToShow:P,failedToLoad:O,engageEnd:F,adVisible:T,loadWithADM:A,resetAdState:b};return x}t.exports=i},{}],170:[function(e,t,n){t.exports={NativePrefix:"NativeCallback",className:"ProductAdapter",adStates:{notSet:0,inLoadingProcess:1,loaded:2,inShowingProcess:3,visible:4}}},{}],171:[function(e,t,n){function i(t,n,i,r,a,o,s){var l=e("./ProductAdapterConstants.js"),d=l.adStates,c=d.notSet,u=r.analyticsCategories,f=!1,p=n.DemandUtils,g=p.extendCallbackParamsWithDemandConfig(i),v=n.InstancesTimers;function m(e){return c===e}function h(e){c=parseInt(e,10)}function b(){return c}function S(){return h(d.notSet)}function y(){return m(d.loaded)}function A(e,s,l){if(f)f=!1;else{if(m(d.inLoadingProcess)||i.productType===a.BN&&m(d.loaded)){l.name===u.loadAdFailed.name&&s===a.errors.noFill&&(l=u.noFill);var c=t.Utils.extend(!0,{callFailReason:s},g);c=v.extendEventElapsedTime(i.productType,i.demandSourceName,c),o.report(l,c),v.clearStartTime(i.productType,i.demandSourceName);var h=p.extendCallbackParamsWithDemandConfig(i,{errMsg:r.errors.load.noMoreOffers});n.callSDKFunction(e,h),t.PubSub.publish("ProductStatesManager.stateResolved",[p.extendCallbackParamsWithProductConfig(i,{response:!1})])}S()}}function C(e){if(s)if(e===s.load){if(m(d.inLoadingProcess))return r.errors.load.duringLoad;if(m(d.visible)||m(d.inShowingProcess))return r.errors.load.duringShow}else if(e===s.show){if(m(d.notSet))return r.errors.show.notLoaded;if(m(d.inLoadingProcess))return r.errors.show.duringLoad;if(m(d.visible)||m(d.inShowingProcess))return r.errors.show.visible}}function I(e,t){if(s)if(e===s.load)m(d.inLoadingProcess)&&n.log(C(s.load),n.LogLevels.error);else if(e===s.show)if(m(d.notSet)||m(d.inLoadingProcess)){var r=p.extendCallbackParamsWithDemandConfig(i,{errMsg:C(s.show)});n.callSDKFunction(t,r)}else(m(d.visible)||m(d.inShowingProcess))&&n.log(C(s.show),n.LogLevels.error)}function D(e,t,n,r){i.productType!==a.BN?w(e,t,n,r):P(e,n)}function w(e,a,l,c){var p;if(m(d.notSet)||m(d.loaded))h(d.inLoadingProcess),e(g,l);else if(f){var b=f?r.errors.load.inStateVisibleOrInShowingProcess:r.errors.load.inLoadingStateOrWaitingToLoad;p=t.Utils.extend(!0,{callfailreason:b},g),p=v.extendEventElapsedTime(i.productType,i.demandSourceName,p),o.report(u.loadAdIgnored,p),v.clearStartTime(i.productType,i.demandSourceName)}else m(d.visible)||m(d.inShowingProcess)?f=!0:(o.report(u.loadAdFailed,t.Utils.extend(!0,{},g,{callfailreason:C(s.load),timingvalue:n.InstancesTimers.stop(i.productType,i.demandSourceName)})),I(s.load))}function P(e,r){var a=function(){};if(m(d.notSet))h(d.inLoadingProcess),e(g,a,r);else if(m(d.loaded))h(d.notSet),e(g,void 0,r);else if(m(d.visible)||m(d.inShowingProcess))h(d.inLoadingProcess),e(g,a,r);else if(m(d.inLoadingProcess))o.report(u.bannerReloadDuringLoad,p.extendCallbackParamsWithDemandConfig(i));else{var l=t.Utils.extend(!0,{},g,{callfailreason:C(s.load),timingvalue:n.InstancesTimers.stop(i.productType,i.demandSourceName)});o.report(u.loadAdFailed,l),I(s.load)}}function O(e,n,r){if(y())h(d.inShowingProcess),e(g,n,r);else{var a=t.Utils.extend(!0,{callFailReason:C(s.show)},g);a=v.extendEventElapsedTime(i.productType,i.demandSourceName,a),o.report(u.showAdFail,a),I(s.show,r)}}function F(e,t){i.productType!==a.BN?T(e,t):x(e,t)}function T(e,r){var a=!!m(d.inLoadingProcess);if(h(d.loaded),a){var s=t.Utils.extend(!0,{},g,{timingvalue:n.InstancesTimers.stop(i.productType,i.demandSourceName)});s=v.extendEventElapsedTime(i.productType,i.demandSourceName,s),o.report(u.loadAdSuccess,s),v.clearStartTime(i.productType,i.demandSourceName),n.callSDKFunction(e,p.extendCallbackParamsWithDemandConfig(i,r)),t.PubSub.publish("ProductStatesManager.stateResolved",[p.extendCallbackParamsWithProductConfig(i,{response:!0})])}}function x(e,r){(m(d.inLoadingProcess)||m(d.visible))&&(o.report(u.loadAdSuccess,{timingvalue:n.InstancesTimers.stop(i.productType,i.demandSourceName)}),o.trackTimingStart(u.bannerLoadSuccessToVisible),n.callSDKFunction(e,p.extendCallbackParamsWithDemandConfig(i,r)),t.PubSub.publish("ProductStatesManager.stateResolved",[p.extendCallbackParamsWithProductConfig(i,{response:!0})])),h(d.loaded)}function U(e,t){A(e,t,u.loadAdFailed)}function N(){S()}function L(){S()}function V(){h(f?d.inLoadingProcess:d.notSet)}function M(){h(d.visible)}var R={getAdState:b,load:D,show:O,cacheReady:F,noMoreOffers:U,failedToShow:N,failedToLoad:L,engageEnd:V,adVisible:M,resetAdState:S};return R}t.exports=i},{"./ProductAdapterConstants.js":170}],172:[function(e,t,n){t.exports=function(t,n,i){"use strict";var r,a=e("./AdapterSharedConfig"),o=e("./ProductAdapter"),s=[],l=!1;function d(e){return e&&"true"===e.rewarded?n.RewardedVideo:n.Interstitial}function c(){if(!n.RewardedVideo){var r=e("./AdapterSharedConfig"),a=e("./RewardedVideo/RewardedAdConfiguration")(t,r,n.SupplyConfigurations,i);n.RewardedVideo=new o(t,n,a,i),n.RewardedVideo.init()}return n.RewardedVideo}function u(){if(!n.NativeAd){var i=e("native-ads").apiFactory;n.NativeAd=i.createNativeAdApi({controller:n,core:t})}return n.NativeAd}function f(r){return r&&"true"===r.rewarded?c():function(){if(!n.Interstitial){var r=e("./InterstitialDemandSource/AdConfiguration")(t,a,n.SupplyConfigurations,i);n.Interstitial=new o(t,n,r,i),n.Interstitial.init()}return n.Interstitial}()}return{initModule:function(){!function(){if(r)return;s.push(t.PubSub.subscribe(i.CB+a.NativeAPI.init,(function(e,t,i){n.log("productRouter | NativeAPI.init"),t=i=function(){},f(e).initProduct(e,t,i)}))),s.push(t.PubSub.subscribe(i.CB+a.NativeAPI.load,(function(e,t,i){n.log("productRouter | NativeAPI.load"),f(e).loadProduct(e,t,i)}))),s.push(t.PubSub.subscribe(i.CB+a.NativeAPI.show,(function(e,t,n){d(e).showProduct(e,t,n)}))),s.push(t.PubSub.subscribe(i.CB+".destroyInterstitial",(function(e,t,n){d(e).destroyProduct(e)}))),s.push(t.PubSub.subscribe(i.CB+".initRewardedVideo",(function(e,t,n){c().initProductFail(e,n,"Unsupported API function, use Manual RV instead.")}))),s.push(t.PubSub.subscribe(i.CB+".showRewardedVideo",(function(e,t,n){c().initProductFail(e,n,"Unsupported API function, use Manual RV instead.")}))),s.push(t.PubSub.subscribe(i.CB+".initBanner",(function(e,t,i){!e||e.inAppBidding||l||(l=!0,n.initBannerExternalService()),function(e){n.Banner||(n.Banner=n.BannerFactory.create(e),n.Banner.init());return n.Banner}(e).initProduct(e,t,i)}))),s.push(t.PubSub.subscribe(i.CB+".loadBanner",(function(e,t,r){e.productType=i.BN,n.Banner.loadProduct(e,t,r)}))),s.push(t.PubSub.subscribe(i.CB+".bannerViewVisible",(function(e,t,i){n.Banner.showProduct(e,t,i)}))),s.push(t.PubSub.subscribe(i.CB+".destroyBanner",(function(e){n.Banner.destroyProduct(e)}))),s.push(t.PubSub.subscribe(i.CB+".nativeAd.load",(function(e,t){u().load(e,t)}))),s.push(t.PubSub.subscribe(i.CB+".nativeAd.register",(function(e){u().register(e)}))),s.push(t.PubSub.subscribe(i.CB+".nativeAd.visibilityChanged",(function(e,t){u().visibilityChanged(e,t)}))),s.push(t.PubSub.subscribe(i.CB+".nativeAd.click",(function(e,t){u().click(e,t)}))),s.push(t.PubSub.subscribe(i.CB+".nativeAd.privacyClick",(function(e,t){u().privacyClick(e)}))),s.push(t.PubSub.subscribe(i.CB+".nativeAd.destroy",(function(e,t){u().destroy(e)}))),r=!0}()},destroyListeners:function(){t.Utils.each(s,(function(e,n){t.PubSub.unsubscribe(n)})),r=!1},className:"ProductRouter"}}},{"./AdapterSharedConfig":131,"./InterstitialDemandSource/AdConfiguration":165,"./ProductAdapter":168,"./RewardedVideo/RewardedAdConfiguration":173,"native-ads":15}],173:[function(e,t,n){t.exports=function(e,t,n,i){var r=e.Utils.extend(!0,{},t.Features);return{NativeAPI:t.NativeAPI,ControllerCallbacks:t.ControllerCallbacks,AdUnitCallbacks:t.AdUnitCallbacks,ControllerNativeAPI:t.NativeAPI,retriesLogic:t.retriesLogic,DemandName:"SupersonicAds",ProductName:i.RV,Features:r,gatewayDestinationMap:{prod:i.gatewayDestinationMap.RV.production},amountOfInventories:t.amountOfInventories}}},{}],174:[function(e,t,n){t.exports=function(e,t,n,i){var r=i.responseTypesWithReason,a={};function o(e){n.publishAvailabilityFalse("NoMoreOffers",e)}function s(e){t.log("Availability Manager | reportAdAvailable",t.LogLevels.verbose),n.isCurrentState(r.ready)||n.publishAvailabilityTrue(e)}return{setAMSettings:function(t,n){t&&"object"==typeof t&&(a=n?e.Utils.extend(a,t):t)},cacheAdsFailed:function(e,t,n,i){e&&t?i():o(n)},cacheTimeoutFail:function(e){o(e)},canReportAvailable:function(e,t){a.reportOnAdunitReady&&a.isPreCache&&0!==a.numOfBannersToInitSuccess||s({numOfAdUnits:e,totalNumberCredits:t})},adLoadError:function(){o("Ad loaded with error")},inventoryEmpty:function(e){o(e)},reportAdAvailable:s,reset:function(){n.setLastResponse(r.none),a={}},adLoadedSuccessfully:function(e,t){(t||(a.reportOnAdunitReady||a.preFetchAllVasts)&&a.isPreCache)&&s(e)}}}},{}],175:[function(e,t,n){t.exports=function(e,t,n,i,r){var a=n.responseTypesWithReason,o=a.none,s=t.DemandUtils;function l(e){return o===e}function d(t,r){e.PubSub.publish(n.productType+"."+t,[s.extendCallbackParamsWithParentProductConfig(i,r)])}function c(){r.publish("InitiatedAPICall",[s.extendCallbackParamsWithProductConfig(i,{duringInit:!1})])}return{setLastResponse:function(e){o=e},getLastResponse:function(){return o},publishAvailabilityTrue:function(t){c(),d("CacheReady",t=e.Utils.extend(t,{firstCampaignCredits:1})),o=a.ready},publishAvailabilityFalse:function(e,t){c(),l(a.notReady)||"NoMoreOffers"===e&&(d(e,{numOfAdUnits:0,firstCampaignCredits:0,totalNumberCredits:0,errorMsg:t}),o=a.notReady)},isCurrentState:l}}},{}],176:[function(e,t,n){t.exports=function(e,t,n,i){var r,a=!1,o=!1,s=!1,l=!1,d=!1,c=!1;function u(e){return e&&e.productType===n.productType&&(!n.demandSourceName||e.demandSourceName===n.demandSourceName)}return{init:function(){a||(e.PubSub.subscribe(i.taskManager+".InitiatedAPICall",(function(t){u(t)&&e.Utils.isDefined(t.duringInit)&&(o=t.duringInit)})),e.PubSub.subscribe(i.taskManager+".AdErrorState",(function(t){u(t)&&e.Utils.isDefined(t.error)&&(d=t.error)})),e.PubSub.subscribe(i.taskManager+".Engaged",(function(i){u(i)&&e.Utils.isDefined(i.duringEngage)&&(s=i.duringEngage,t.log("duringEngage "+s+" on demand "+n.demandSourceName,t.LogLevels.verbose))})),e.PubSub.subscribe(i.taskManager+".CacheUpdateStatus",(function(t){u(t)&&e.Utils.isDefined(t.duringCacheUpdate)&&(l=t.duringCacheUpdate)})),e.PubSub.subscribe(i.taskManager+".InitiatedTimeoutAttempt",(function(t){u(t)&&e.Utils.isDefined(t.duringAPITimeoutAttempts)&&(c=t.duringAPITimeoutAttempts)})),a=!0,r=t[n.productType].getProductTM())},canEngage:function(){return!o&&!s&&r.canEngage()},canPreload:function(){var e=!d&&!o&&r.isConnected();return n&&n.isInAppBidding||(e=e&&!s),e},canInitCallToApi:function(){return!s&&!o&&!l&&r.isConnected()?r.canInitCallToApi():e.Utils.returnRejectedPromise()},allowExternalCallToApi:function(){return!c},setConnection:function(e){return r.setConnection(e)},getStatusMsg:function(){return" duringInit:"+o+" duringEngage:"+s+" duringCacheUpdate:"+l+" error state:"+d+" during timeout attempts:"+c+r.getStatusMsg()},getStatus:function(){return{duringInit:o,duringEngage:s,duringCacheUpdate:l,adErrorState:d,timeoutAttempts:c,isConnected:r.isConnected()}},publish:function(t,n){e.PubSub.publish(i.taskManager+"."+t,n)}}}},{}],177:[function(e,t,n){t.exports=function(t,n,i){var r=e("./configurationValidator.js")(n,i.DebugLevels,i.errors),a=function(){var e=!0;return n.each(t.mobileSDKSettings,(function(t,i){return t.match(/^deviceIds/)&&n.isDefined(i)&&i&&(e=!1),e})),e};return{parseConfiguration:function(e,t,o){var s,l=[],d=t.length;for(s=0;s<d;s++)n.isDefined(e[t[s]])||("applicationUserId"!==t[s]||a())&&l.push(t[s]);return l.length>0?{didSucceed:!1,errMsg:{errMsg:i.errors.missing+JSON.stringify(l)}}:r(e,o)},getDeviceApiLevel:function(){var e=t.mobileSDKSettings.deviceApiLevel;return"android"!==t.mobileSDKSettings.deviceOs||e?"ios"!==t.mobileSDKSettings.deviceOs||e||(e=t.mobileSDKSettings.deviceOSVersion.split(".")[0]):e=t.mobileSDKSettings.deviceOSVersion,e},getDeviceOsVersion:function(){var e=t.mobileSDKSettings.deviceOSVersion;return"android"===t.mobileSDKSettings.deviceOs&&(e=t.mobileSDKSettings.deviceApiLevel?t.mobileSDKSettings.deviceOSVersion:""),e}}}},{"./configurationValidator.js":185}],178:[function(e,t,n){t.exports=function(){return{adVisibleToClose:{name:"adVisibleToClose",id:-5},adClosed:{name:"adClosed",id:100},OWClosed:{name:"OWClosed",id:104},getExternalApplicationConfigurationError:{name:"getExternalApplicationConfigurationError",id:136},openUrlError:{name:"openUrlError",id:114},failedToStartStoreActivity:{name:"failedToStartStoreActivity",id:209},cdnABTestSuccess:{name:"cdnABTestSuccess",id:223},cdnABTestFail:{name:"cdnABTestFail",id:224},cdnABTestException:{name:"cdnABTestException",id:225},userClosedBeforeAdVisible:{name:"userClosedBeforeAdVisible",id:151},controllerException:{name:"controllerException",id:153},mismatchAdLoadError:{name:"mismatchAdLoadError",id:206},dialogBoxExit:{name:"dialogBoxExit",id:155},dialogBoxResume:{name:"dialogBoxResume",id:156},updateTokenFail:{name:"updateTokenFail",id:184},globalsInOldFormat:{name:"globalsInOldFormat",id:274},unauthorizedMessage:{name:"unauthorizedMessage",id:268},omidServiceFailure:{name:"omidServiceFailure",id:270},omidStartSessionRequired:{name:"omidStartSessionRequired",id:364},omidStartSessionSuccess:{name:"omidStartSessionSuccess",id:365},omidFinishSessionRequired:{name:"omidFinishSessionRequired",id:366},omidFinishSessionSuccess:{name:"omidFinishSessionSuccess",id:367},removeContainerError:{name:"removeContainerError",id:190},linkActivationOnAd:{name:"linkActivationOnAd",id:324},auidFail:{name:"auidFail",id:197},patchOrientation:{name:"patchOrientation",id:343},initFailed:{name:"initFailed",id:344},setAdDisplayAlreadyAdShown:{name:"setAdDisplayAlreadyAdShown",id:350},adChangedOnClose:{name:"adChangedOnClose",id:345},controllerInitiated:{name:"controllerInitiated",id:103}}}},{}],179:[function(e,t,n){t.exports=function(){var e={},t="loadTimer",n={};function i(e,t){return e&&t?e+"."+t:null}function r(e,t){var r=i(e,t);return n.hasOwnProperty(r)?{timeElapsed:Date.now()-n[r],columnName:"custom_c"}:{timeElapsed:Date.now(),columnName:"custom_d"}}return{start:function(n,r){var a=i(n,r);a&&(e.hasOwnProperty(a)?e[a][t]&&window.timerService.stopTimer(e[a][t]):e[a]={},e[a][t]=window.timerService.startTimer())},stop:function(n,r){var a=i(n,r);if(!(a&&e[a]&&e[a][t]))return-1;var o=e[a][t],s=window.timerService.stopTimer(o);return delete e[a][t],s},clear:function(t,n){var r=i(t,n);if(r&&e[r]){var a=e[r];for(var o in a)a.hasOwnProperty(o)&&window.timerService.stopTimer(a[o]);delete e[r]}},setStartTime:function(e,t,r){var a=i(e,t);!n.hasOwnProperty(a)&&r&&(n[a]=r)},getTimeElapsed:r,clearStartTime:function(e,t){var r=i(e,t);n.hasOwnProperty(r)&&delete n[r]},extendEventElapsedTime:function(e,t,n){var i=r(e,t);return n[i.columnName]=i.timeElapsed,n}}}},{}],180:[function(e,t,n){t.exports=function(e){var t="LoadedCreatives | ",n=e.AdUtils,i=[];function r(e){if(!e)return d("in _isExistAd without ad"),!1;var t=void 0!==l(n.getAdId(e),e);return d("_isExistAd | adId "+e.id+" | isExist "+t),t}function a(){return d("_size | size "+i.length),i.length}function o(e,t){return e.productType===t.productType&&(!t.demandSourceName||e.demandSourceName===t.demandSourceName)}function s(e,t){return function(i){return o(i,t)&&n.getAdId(i)==e}}function l(e,t){var n=s(e,t),r=i.filter(n);return r.length>0?r[0]:void 0}function d(n){e.log(t+n)}function c(){d("_printAll"),i.forEach((function(e){d("_printAll | adViewId "+e.adViewId)}))}return{isExistAd:r,addAd:function(e){return d("_addAd"),e?r(e)?(d("_addAd | ad already exist | adViewId "+e.adViewId),!1):(i.push(e),d("_addAd | added successfully | adViewId "+e.adViewId),!0):(d("_addAd | ad is undefined"),!1)},removeAdById:function(e,t){d("_isExistAd adId = "+e);var n=s(e,t),r=a();return c(),i=i.filter((function(e){return!n(e)})),c(),r!==a()},getAdById:l,getAds:function(e){return d("_getAds | productConfig "+e),i.filter((function(t){return o(t,e)}))},getAdsByProductType:function(e){return i.filter((function(t){return t.productType===e.productType}))},size:a,toArray:function(){return d("_toArray"),i.slice()},printAll:c,getAdByAdViewId:function(e){d("getAdByAdViewId | id "+e+"| loadedCreatives "+i);var t=i.filter((function(t){return t.adViewId===e}));return 0!==t.length?t[0]:null}}}},{}],181:[function(e,t,n){t.exports=function(t,n){var i=e("../DemandSource/DemandEntityBuilder.js"),r=t&&t.instancesMap,a=t&&t.waterfallMap;function o(e,t){var i=a&&a[n.sspProductNames[e]];if(i)return i[t]}return{createDemandEntityConfigObj:function(e){var t=function(e,t){var i=r&&r[n.sspProductNames[e]];if(i)for(var a=0;a<i.length;a++)if(-1!==i[a].instances.indexOf(t))return{demandGroupName:i[a].demandGroupName,isInstance:!0}}(e.productType,e.demandSourceName)||{},a=!0===t.isInstance?n.demandSourceType.instance:n.demandSourceType.demandSource,s={demandGroupName:t.demandGroupName,demandSourceName:e.demandSourceName,demandType:a,isInAppBidding:e.isInAppBidding,isOneFlow:e.isOneFlow,isMultipleAdObjects:!!e.isMultipleAdObjects,isLoadWithAdmFlow:e.isLoadWithAdmFlow,demandSourceId:e.demandSourceId,waterfallPosition:o(e.productType,e.demandSourceName),originalDemandSourceName:e.originalDemandSourceName,adSize:e.adSize};return new i({productType:e.productType},s)}}}},{"../DemandSource/DemandEntityBuilder.js":145}],182:[function(e,t,n){t.exports=function(e,t,n,i){var r="$$";return{handler:function(a){return!!function(e){return e&&"string"==typeof e.data&&e.data.length>0}(a)&&(function(e){return 0===e.data.indexOf(r)}(a)?function(i){var a=i.slice(r.length);if(!a)return!1;var o=n.getParams(a);return n.isDefined(o.event)?(t.log("received event: "+o.event,t.LogLevels.verbose),e.publish("SDKController."+o.event,[o]),!0):n.isDefined(o.name)&&n.isDefined(o.parameters)?(t.log("received event: "+o.name,t.LogLevels.verbose),e.publish("SDKController."+o.name,[o.parameters]),!0):void 0}(a.data):function(r){try{var a=JSON.parse(r);return a.arguments=n.extend(a.arguments,{callback:i(a.id)}),e.publish("SDKController."+a.method,[a.arguments]),!0}catch(e){t.log("SDKController | unable to parse message: "+JSON.stringify(r),t.LogLevels.error)}return!1}(a.data))}}}},{}],183:[function(e,t,n){function i(t,n){var i=e("../../components/adInterfaces/AdInterfaceConfiguration"),r=e("../../components/adInterfaces/BaseFileRepository"),a=e("../../components/adInterfaces/CacheLocation"),o=window.jQuery,s="SDKController | ",l=e("../../patches/PatchAppOrientation"),d=e("./MessageHandler"),c=e("../../presenter/uiConfig.js"),u=e("../../components/Logger.js")(t.Utils),f=e("../AdUnitManager/AdUnitGlobals.js")(n),p=e("../AdPlayer/AdPlayerAssets"),g=e("../AdUnitManager/LibsManager.js")(t),v=e("../../components/DisplayedAdManager.js"),m=e("../AdUnitUrl.js")(f,t.Utils),h=new(e("../AdPlayer/AdPlayerUrl"))(t.Utils),b=e("./mainConfig.js")(),S=new(e("../../components/ExternalConfig"))(t.Utils),y=new(e("../../components/BlacklistService"))(n),A=new(e("../../components/FrameHelper.js"))(u),C=e("./ConfigurationHelper.js"),I=e("../../components/AdOrientationManager"),D=e("../../components/containers/WebViewManager.js"),w=e("../../components/containers/AdViewsManager.js"),P=e("../../components/containers/BannerExternalContainer.js"),O=e("./sessionConfig")(),F=e("../../components/NativeLifeCycleEventsConstants.js"),T=new(e("../../components/NotchFactory.js"))(n),x=e("../../components/token/TokenService.js"),U=e("../UserSegmentation/SegmentationManager"),N=e("../UserSegmentation/SegmentationAllocator.js"),L=e("../../components/NativeAPIAdapter.js"),V=e("../../constants/SDKFeatureNames"),M=new(e("../../patches/PatchCacheFileEncoding")),R,k,K,B,E,j,_,W,G,H,q,J,Q,$,z,X,Y,Z=!1,ee,te,ne=t.Utils,ie=t.JQWrapper,re=t.PubSub,ae=null,oe,se=!1,le=!0,de=!1,ce=n.CB,ue=n.RV,fe=n.OW,pe=n.IS,ge=n.BN,ve=n.errors,me=n.videoStates,he=n.closeButtonStates,be=n.featureCompatibilityMap,Se=n.confirmCloseMsg,ye=n.requiredDeviceInfo,Ae=n.requiredAppInfo,Ce=n.optionalAppInfo,Ie={v:"3.1.247",controllerbn:"201559",controllerId:(new Date).getTime()+"_"+Math.random(),controllerTimeLoaded:(new Date).getTime(),mobileSDKSettings:{protocol:null,defaultProtocol:null,securedProtocol:null,domain:null,overrideDebug:!1,defaultDebug:0,debug:0,appOrientation:null,mobileCarrier:null,connectionType:null,iphoneAppOnIpadDevice:null,deviceOs:"",SDKVersion:null,deviceOSVersion:null,deviceApiLevel:null,bundleId:null,deviceOEM:null,deviceScreenScale:null,"deviceScreenSize[width]":null,"deviceScreenSize[height]":null,"deviceIds[OpenUDID]":null,"deviceIds[IFA]":null,"deviceIds[IDFV]":null,"deviceIds[SERIAL]":null,"deviceIds[AndroidID]":null,"deviceIds[IMEI]":null,"deviceIds[AID]":null,deviceWidthDP:null,deviceHeightDP:null,deviceLanguage:null,deviceModel:null,diskFreeSize:null,geoLocation:null,isLimitAdTrackingEnabled:null,unLocked:null,gpi:null,webviewType:null,allowArbitraryLoads:null,allowArbitraryLoadsInWebContent:null,mcc:null,mnc:null,appVersion:null,batteryLevel:null,safeAreaInsets:null,ext:{}},applicationSettings:{preCache:"device",applicationKey:null,applicationUserId:null,numOfCampaigns:null,campaignId:null,pageSize:null,landingId:null,page:null,applicationUserGender:null,applicationUserAgeGroup:null,applicationUserCreationDate:null,applicationUserCreationDateSignature:null,useClientSideCallbacks:null,SDKPluginType:null,disableCache:null,showDeliveryLimitationsLog:null,country:null,admin:null,placementId:null,consent:null,skd:null},configMapping:{jb:function(){return Ie.mobileSDKSettings.unLocked}},controllerConfig:{fpf:null,destinationMap:null,isSecured:null,segmentId:null,segmentName:null,instancesMap:null,abt:null,waterfallMap:null},userType:SuperSonicGlobalConfig.userType},De={localTime:function(){return(new Date).getTime()},timezoneOffset:function(){return(new Date).getTimezoneOffset()}},we="mobileController.min.css",Pe=SuperSonicGlobalConfig.mobileSDKSettings.isProd?"/versions/"+Ie.v+"/"+we:Ie.v+"/"+we,Oe,Fe,Te,xe,Ue,Ne,Le,Ve=!1,Me=0,Re=3,ke,Ke,Be,Ee={defaultBehavior:0,adunitResponsibility:1},je={close:1,nextFrame:2},_e=n.defaultOrientation,We={none:0,device:1,controller:2},Ge=c.style.defaultControlFrames,He=n.blockedProductsPerApiLevel,qe=n.storeSearchKeys,Je={scrollHeight:""},Qe={RewardedVideo:{},Interstitial:{},OfferWall:Ee.defaultBehavior,Banner:Ee.defaultBehavior},$e={RewardedVideo:{},Interstitial:{},OfferWall:he.close,Banner:he.closeBanner},ze={RewardedVideo:he.close,Interstitial:he.close,OfferWall:he.close,Banner:he.closeBanner},Xe={cdns:[{cdnName:"a.akamaihd.net",assets:["https://akm.ssacdn.com/users/cdn/jsonFile.json","https://akm.ssacdn.com/users/cdn/videoFile.mp4","https://akm.ssacdn.com/users/cdn/imgFile.png"]},{cdnName:"cncn.ssacdn.com",assets:["https://cncn.ssacdn.com/users/cdn/jsonFile.json","https://cncn.ssacdn.com/users/cdn/videoFile.mp4","https://cncn.ssacdn.com/users/cdn/imgFile.png"]},{cdnName:"itcn.ssacdn.com",assets:["https://itcn.ssacdn.com/users/cdn/jsonFile.json","https://itcn.ssacdn.com/users/cdn/videoFile.mp4","https://itcn.ssacdn.com/users/cdn/imgFile.png"]}]},Ye=[{url:"https://pm-gateway.supersonicads.com/test",method:"GET",region:"all"},{url:"https://init.supersonicads.com/admin/healthCheck",method:"GET",region:"all"},{url:"https://ow-gateway.supersonicads.com/delivery/mobilePanel.php",method:"GET",region:"all"}],Ze,et,tt={},nt=!1,it=c.templates.mainDefaultTemplate,rt=c.templates.defaultDialogBoxTemplate,at=c.templates.defaultNavigationTemplate,ot=c.templates.loaderOWTemplate,st=c.templates.loaderOWOfferTemplate,lt=t.Analytics,dt=e("../../modules/SDKController/EventCategories")(),ct=function(e,t){var i=J.getDisplayedAdType(),r={productType:"UnKnown",action:"stopTiming",eventParam:{eName:dt.adClosed,data:{eNameStart:dt.adVisibleToClose}}};if(t&&t.customData&&t.customData.click&&(r.eventParam.data=ne.extend(r.eventParam.data,t.customData.click)),t&&t.frameType&&(r.eventParam.data.frameType=t.frameType),e&&(r.eventParam.data.generalMessage=e),i){i===n.OW&&(r.eventParam.eName=dt.OWClosed,ee.callSDKFunction("removeCloseEventHandler")),r.productType=i;var a=J.getDisplayedAdDemandName();a&&(r.demandSourceName=a);var o={productType:r.productType,demandSourceName:r.demandSourceName};t&&t.customData&&"object"==typeof t.customData&&(o=ne.extend(o,t.customData)),o.ad=J.get(),re.publish("SDKController.Analytics",[r]),re.publish("SDKController.adClosed",[o])}else re.publish("SDKController.Analytics",[r])},ut=function(e,t,n,i){var r,a=e.length,o=!0,s=[],l=null;for(r=0;r<a;r++)ne.isDefined(t[e[r]])||(s.push(e[r]),o=!1);return o||(l=ve.missing+JSON.stringify(s)+" in "+n,ne.isDefined(i)&&i&&ee.callSDKFunction(i,{errMsg:l}),ee.log(l,ee.LogLevels.error)),{didSucceed:o,errMsg:l}},ft=function(){re.subscribe(ce+".initProducts",(function(e,t,n){o.when(Dt(e)).then((function(){"use strict";ne.isDefined(t)&&ee.callSDKFunction(t),wt(e)}),(function(e){"use strict";ne.isDefined(n)&&ee.callSDKFunction(n,{errMsg:e})}))})),re.subscribe(ce+".nativeNavigationPressed",(function(){if(J.isDisplayed()){var e=J.getDisplayedAdType(),t=J.getDisplayedAdDemandName();if(!de){var n,i=J.get()||{};if((n=i.settings||{}).hasOwnProperty("disableBB")&&!n.disableBB||"offerwall"===e.toLowerCase())(t?Qe[e][t]:Qe[e])===Ee.adunitResponsibility?Rt({name:"backButtonPressed"}):Yt()}}})),re.subscribe(ce+".engageEnd",(function(e){if(!vt())if("forceClose"===e.action)ct(),Ht(!1,!1),$.onEngageEnd();else if("secondaryClose"===e.action){var t=J.getDisplayedAdType();G.returnFromNavigationMode(Ft,Je,t,xt),t===fe&&re.publish("SDKController.AdClosed",[J.get()])}})),re.subscribe(ce+".failedToStartStoreActivity",(function(e){if(e){ee.log("failedToStartStoreActivity | params: "+JSON.stringify(e),ee.LogLevels.info);var t={};t.rvnomoreoffersreason=decodeURIComponent(e.url),t.generalMessage=decodeURIComponent(e.errMsg);var n=J.getDisplayedAdType();n&&(t.productType=n),xe.report()(dt.failedToStartStoreActivity,t)}})),re.subscribe(ce+".interceptedUrlToStore",(function(e){J.isDisplayed()&&Rt({name:"interceptedUrlToStore",intercept:!0})})),re.subscribe(ce+".pageFinished",(function(){Rt({name:"pageFinished"})})),re.subscribe(ce+".enterBackground",(function(e){ee.log("entered BG");var t={name:"enterBackground"};e&&ne.isDefined(e.action)&&(t.action=e.action),Rt(t)})),re.subscribe(ce+".enterForeground",(function(e){var t=W.getContainerState();ee.log("entered FG | webview is "+JSON.stringify(t));var i={name:"enterForeground"};e&&ne.isDefined(e.active)&&(i.active=e.active),t.engaged&&t.opened&&Ie.mobileSDKSettings.deviceOs===n.deviceOs.android&&!t.standalone&&(J.isDisplayed()&&ct(),Ht(!1,!1)),Rt(i)})),re.subscribe(ce+".viewableChange",(function(e){var t={name:"viewableChange"};if(e&&ne.isDefined(e.isViewable)){var i=J.getDisplayedAdType();if("Banner"===i&&(e.changeReason===n.viewableChangeReasons.storeKitClose||e.changeReason===n.viewableChangeReasons.storeKitOpen))return void ee.log("viewableChange from Banner storeKit - ignored",ee.LogLevels.info);if(Ve=e.isViewable,ee.StoreKitService.isStoreKitVisible()&&(Rt({name:"viewableChangeInSK",isViewable:Ve}),Ve))return;ee.SKOverlayManager.isSKOverlayVisible()&&Rt({name:"viewableChangeInOV",isViewable:Ve}),ee.log("viewableChange to:"+e.isViewable),ne.isDefined(e.webview)&&"main"!==e.webview||W.setContainerVisibility(e.isViewable),t.isViewable=e.isViewable,J.isDisplayed()&&Qt(),ne.isDefined(e.webview)&&(t.webview=e.webview),i&&(t.productType=i),e.changeReason&&(t.changeReason=e.changeReason)}Rt(t),e&&ne.isDefined(e.isViewable)&&W.triggerRedraw()})),re.subscribe(ce+".deviceStatusChanged",(function(e){var t=ne.extend({name:"deviceStatusChanged"},e);Rt(t),ne.isDefined(e.connectionType)&&(lt.updateBaseData({connectionType:e.connectionType}),le="none"!==e.connectionType&&"notReachable"!==e.connectionType)})),re.subscribe(ce+".parseBandwidth",(function(e){ee.log(JSON.stringify(e),3)})),re.subscribe(ce+".getBandwidthFailed",(function(e){ee.log(JSON.stringify(e),3),ee.log("getBandwidth Failed",ee.LogLevels.error)})),re.subscribe("SDKController.GetConfig",(function(e){e&&e.productType&&re.publish(e.productType+".GetConfig",[e])})),re.subscribe("SDKController.GetCompletionOffers",(function(e){e&&e.productType&&re.publish(e.productType+".GetCompletionOffers",[e])})),re.subscribe("SDKController.ActionClick",(function(e){e&&e.productType&&re.publish(e.productType+".ActionClick",[e])})),re.subscribe("SDKController.OpenUrl",(function(e){ut(["url","method"],e,"openUrl").didSucceed?(ee.log("Request to open external url",ee.LogLevels.info),Tt(e)):ee.log("error calling open url with "+JSON.stringify(e),ee.LogLevels.error)})),re.subscribe("SDKController.nativePixel",(function(e){ut(["url"],e,"nativePixel").didSucceed?(ee.log("Request to send click in native api",ee.LogLevels.info),Yn(e.url)):ee.log("error sending safe click "+JSON.stringify(e),ee.LogLevels.error)})),re.subscribe("SDKController.FirePixel",(function(e){ut(["url"],e,"FirePixel").didSucceed?(ee.log("Request to fire pixel from controller",ee.LogLevels.info),"native"===e.type&&Yn(e.url)||Zn(e)):ee.log("error firing pixel "+JSON.stringify(e),ee.LogLevels.error)})),re.subscribe("SDKController.adEventNotification",(function(e){ee.log("ad notified controller with event: "+JSON.stringify(e),ee.LogLevels.info),ut(["eventName","productType","dsName"],e,"adEventNotification").didSucceed&&ei(e.eventName,e.productType,e.dsName,e.extData)})),re.subscribe("SDKController.hideClose",(function(e){var t=oe.getAdById(ee.AdUtils.getAdId(e),e);if(t){var n=W.getAdViewByAd(t);n.dataset.close="false",W.isViewDisplayed(n,t)&&Pt()}else ee.log("line[1196]: ERROR",ee.LogLevels.error)})),re.subscribe("SDKController.AdClose",(function(e){e.ignoreClick?nn():Yt(e)})),re.subscribe("SDKController.closeAdunit",(function(e){ct(),Ht(!1)})),re.subscribe("SDKController.setBackButtonState",(function(e){if(e&&e.state&&e.productType){var t="default"===e.state?Ee.defaultBehavior:Ee[e.state];e.demandSourceName?Qe[e.productType][e.demandSourceName]=t:Qe[e.productType]=t}})),re.subscribe("SDKController.setCloseButtonState",(function(e){En(e)})),re.subscribe("SDKController.ScrollHeight",(function(e){var t,i,r;ne.isDefined(e.value)&&(t=e.value,ee.log("scroll height is: "+t,ee.LogLevels.info),o.when(Zt()).then((function(e){r=J.getDisplayedAdType(),i=r&&"application"===_e[r]&&j.isAppOrientation("portrait")?Math.max(e.height,e.width):r&&ne.isDefined(r)&&"application"===_e[r]&&j.isAppOrientation("landscape")?Math.min(e.height,e.width):e.height,t<i&&(t=i),ee.log("min scroll height is: "+i+"scroll height was set to: "+t+" screen height: "+e.height,ee.LogLevels.verbose),Je.scrollHeight=t,Ie.mobileSDKSettings.deviceOs!==n.deviceOs.android&&(document.body.style.height=Je.scrollHeight)})))})),re.subscribe("SDKController.scrollTop",(function(){ee.log("scrollTop",ee.LogLevels.verbose),setTimeout((function(){ee.JQWrapper.scrollTop(document,0),ee.JQWrapper.scrollTop(document.body,0)}),1e3)})),re.subscribe("SDKController.getScreenSize",(function(){o.when(Zt()).then((function(e){Rt({name:"screenSize",width:e.width,height:e.height,orientation:e.orientation,scrollTop:e.scrollTop})}))})),re.subscribe("SDKController.showNoConnectionMessage",(function(){var e={productType:fe,message:"You are not connected to the internet, please connect and try again.",yes:"close",no:"OK"};ee.alert(e)})),re.subscribe("SDKController.GetDeviceVolume",(function(e){ne.isDefined(e.callback)&&Vn(e.callback)})),re.subscribe(F.serviceCallback+"."+F.AndroidEvents.onDestroy,(function(e){ee.log("SDKController | received event | onDestroy",ee.LogLevels.verbose),vt()?ee.log("SDKController | onDestroy - shouldAvoidHandleFrameClose, with params: "+JSON.stringify(e),ee.LogLevels.verbose):mt()})),re.subscribe(n.CB+".unauthorizedMessage",(function(e){xe.report(dt.unauthorizedMessage,{generalMessage:JSON.stringify(e)}),ee.log("SDKController | Failed to authorize message",ee.LogLevels.error)})),re.subscribe(n.CB+".linkActivationOnAd",(function(e){e&&e.url&&xe.report(dt.linkActivationOnAd,{generalMessage:e.url})})),re.subscribe("SDKController.onOmidStartSessionRequired",(function(e){xe.report(dt.omidStartSessionRequired,{generalMessage:e})})),re.subscribe("SDKController.onOmidStartSessionSuccess",(function(e){xe.report(dt.omidStartSessionSuccess,{generalMessage:e})})),re.subscribe("SDKController.onOmidFinishSessionRequired",(function(e){xe.report(dt.omidFinishSessionRequired,{generalMessage:e})})),re.subscribe("SDKController.onOmidFinishSessionSuccess",(function(e){xe.report(dt.omidFinishSessionSuccess,{generalMessage:e})})),re.subscribe("SDKController.onOmidServiceFailure",(function(e){xe.report(dt.omidServiceFailure,{generalMessage:e})})),re.subscribe("SDKController.removeContainerError",(function(e){e&&e.errMsg&&xe.report(dt.removeContainerError,{callFailReason:e.errMsg})}))};function pt(){X=e("./videoStateHandler.js")(t.PubSub,ee),Y=e("./nativeConfigHandler.js")(t.PubSub,ee)}function gt(){var e={protocol:Ie.mobileSDKSettings.protocol?Ie.mobileSDKSettings.protocol:"https:",baseData:{productType:"controller"}};xe=lt.createAnalytic(e)}function vt(){var e=Wn(J.get());return!e||!ne.isFunction(e.shouldAvoidHandleFrameClose)||e.shouldAvoidHandleFrameClose()}function mt(){ee.log("SDKController.js | handleFrameDestroyed",ee.LogLevels.verbose),J.isDisplayed()&&ct(n.adClosedErrorReason.unexpectedCloseActivityDestroy),Ht(!1,!1),an()}var ht=function(){document.body.insertAdjacentHTML("beforeend",it+rt+at+ot);for(var e="",t=0;t<10;t++)e+=st;document.querySelectorAll(".loaderOW .offers").forEach((function(t){t.insertAdjacentHTML("afterbegin",e)})),sn()};function bt(){re.subscribe(ce+".acknowledgeMessage",(function(e){K.acknowledgeMessage(e)}))}function St(i){var r=new d(t.PubSub,ee,ne,Fn);t.Msg.init(ee,r.handler,!0),re.init();var a=e("../SDKInterface.js");Fe=new a(Ie.mobileSDKSettings,n,ee,i),K=new L(ee,t,Fe),bt()}function yt(){u.init(Ie.mobileSDKSettings.deviceOs,Fe,Ie.mobileSDKSettings.debug,ee.PixelTrackingService.firePixel),re.subscribe("SDKController.log",(function(e){ne.isDefined(e.debugLevel)&&ne.isDefined(e.msg)&&("string"==typeof e.msg&&(e.msg=decodeURI(e.msg)),ee.log(e.msg,e.debugLevel,e.origin))}))}var At=function(){g.init(u,ee.Cache),f.init(u,Ie.mobileSDKSettings,ee.Cache,cn(),m,g,ee.getEnv(),t,dt),z=new p(n.adPlayerDirectory,Ie.mobileSDKSettings,ee.getEnv(),h,ee.Cache,cn(),t,o),y.init(u),J=new v(ee,xe,dt,n),ee.ProductRouter=e("../ProductRouter.js")(t,ee,n),ee.ProductRouter.initModule(),ee.OfferWall.init({supplyConfig:ee.SupplyConfigurations.getOfferWallConfig()}),M.init(fi())};function Ct(){ee.HTTPService.init(),ee.OrientationService.init(xe),ee.GDPRService.init(),It()&&ee.RingerSwitchService.init(),ee.NativeLifeCycleEventsService.init(),hn();var i=e("../../components/containers/WebView"),r=e("../../components/containers/BackgroundController"),a=e("../../components/containers/NavigationModeView"),o=e("../../components/IframeManager"),s=e("../../components/containers/BannerExternalAdViewService"),l=new r(ee,n,c),d=e("../../components/containers/WPADUtils")(ee),u=new i(t,ee,c.style.forceCloseProperties,n,l,E),f=new o(ee,n,A,J),p=new D(t,ee,n,J);W=new w(ee,f,p,u,J),G=new a(ee,W,u),q=new s(t,ee,n,J),H=new P(t,ee,q,d.generateBannerAdViewId()),Q=new x(t,ee,n,xe,dt),ee.AppUserIdService.init(xe),(R=new U(t,ee)).init(),k=new N(R),ee.AndroidNomediaFileHandler.init(xe),ee.DeviceDataService.init(xe)}function It(){return Ie.mobileSDKSettings.deviceOs===n.deviceOs.ios&&"wk"===Ie.mobileSDKSettings.webviewType}var Dt=function(e){var t=new o.Deferred;ee.log("Products info received: "+JSON.stringify(e),ee.LogLevels.info);var n,i,r,a=Ce.length,s=[];for(n=0;n<a;n++)ne.isDefined(e[Ce[n]])||(Ie.applicationSettings[Ce[n]]=null);for(i in e)e.hasOwnProperty(i)&&i.match(/^custom/)&&s.push(i);return un(s),(r=_.parseConfiguration(e,Ae,Ie.applicationSettings)).didSucceed?t.resolve():t.reject(r.errMsg),t.promise()},wt=function(e){ne.each(e.products,(function(e,n){t.hasOwnProperty(n)&&ne.isFunction(t[n].init)&&t[n].init()}))},Pt=function(){Te.classList.add("ssaOnAdUnitCloseVisible")},Ot=function(){Te.classList.remove("ssaOnAdUnitCloseVisible")},Ft=function(e,t,n){if(Gt()&&Rt({name:"dialogBoxAboutToClose",shouldResume:e}),!t||!Gt()){if(document.getElementById("ssaDialogBox").style.visibility="hidden",document.getElementById("ssaDialogBoxOverlay").style.display="none",ne.isFunction(n))return void n.call();A.getDisplayedAdFrame()&&Rt({name:"showFrame"})}ee.JQWrapper.fadeOut(Ue,100,(function(){document.getElementById("ssaDialogBox").style.visibility="hidden",ee.JQWrapper.fadeOut(document.getElementById("ssaDialogBoxOverlay"),100,(function(){ne.isFunction(n)?n.call():A.getDisplayedAdFrame()&&Rt({name:"showFrame"})}))}))},Tt=function(e,t){var i,r=[],a=null,o=null;function s(){var e=J.getDisplayedAdType();J.isDisplayed()&&re.publish("SDKController.AdOpened",[{productType:e}]),t&&t.call(null)}if(o=re.subscribe(ce+".openUrlFailure",(function(t){clearTimeout(i),re.clearHandlers(r),re.unsubscribe(o);var n=ne.isDefined(t.errMsg)?t.errMsg:"Unknown reason for error",a=J.getDisplayedAdType()||"",s=J.getDisplayedAdStoreId();xe.report(dt.openUrlError,{generalMessage:n,productType:a,storeId:s,custom_a:e.method}),ee.log("SDK failed to open url",ee.LogLevels.verbose)})),a=ui()&&"webview"===e.method?re.subscribe(ce+".openUrlSuccess",(function(){if(clearTimeout(i),re.clearHandlers(r),e.controls){var t=J.getDisplayedAdType();G.changeToNavigationMode(Ft,Te,Je,t,xt)}s()})):re.subscribe(ce+".viewableChange",(function(e){clearTimeout(i),re.clearHandlers(r),!ne.isDefined(e.isViewable)||e.isViewable||Ie.mobileSDKSettings.deviceOs===n.deviceOs.android&&"main"!==e.webview||s()})),r.push(o),r.push(a),"storeKit"===e.method&&(Ie.mobileSDKSettings.deviceOs!==n.deviceOs.ios||ee.isLegacy({ios:"5.17",android:"99"})?e.method="external_browser":e.method="store"),"store"===e.method&&ui()){var l=J.getDisplayedAdType(),d=J.getDisplayedAdDemandName(),c={adProductType:l,adDemandSourceName:d},u=ee.StoreKitService.getStoreObject(e.viewUniqueId,c);if(!ee.StoreKitService.canPresentStoreKitObj(u)){var f={message:"SDKController try to load twice storeKit. viewUniqueId = "+e.viewUniqueId,productType:l,demandSourceName:d};return void re.publish("StoreKit.storeKitCoolDown",[f])}ee.StoreKitService.setStoreKitObjectPresentingProgress(u)}"webview"===e.method&&e.controls?Ie.mobileSDKSettings.deviceOs===n.deviceOs.android?ee.callSDKFunction("openUrl",{url:e.url,method:"webview"},"openUrlSuccess","openUrlFailure"):ee.callSDKFunction("openUrl",{url:e.url,method:e.method,controlFrames:Ge},"openUrlSuccess","openUrlFailure"):ee.callSDKFunction("openUrl",{url:e.url,method:e.method,appId:e.appId,viewUniqueId:e.viewUniqueId,package_name:e.package_name},"openUrlSuccess","openUrlFailure"),i=setTimeout((function(){re.unsubscribe(a),"ios"===ee.getApiData({deviceOs:1}).deviceOs&&parseFloat(ee.getConfigurationHelper().getDeviceOsVersion())<8&&t&&t.call(null)}),500)},xt=function(){ee.JQWrapper.bind(Te,"touchend",Yt),Ut(je.close),ee.JQWrapper.bind(Le,"click",(function(e){e.stopPropagation(),e.preventDefault(),re.publish("SDKController.dialogBoxResume",[J.get()]),Ft(!0,!0)}))},Ut=function(e){ee.JQWrapper.bind(Ne,"click",(function(t){t.stopPropagation(),t.preventDefault();var n=le?e:je.close;switch(re.publish("SDKController.dialogBoxExit",[J.get()]),n){case je.nextFrame:Rt({name:"moveToNextFrame"}),Ft(!1,!0);break;case je.close:J.isDisplayed()?(Rt({name:"confirmCloseClicked"}),Ft(!1,!0)):Ht(!0)}}))};function Nt(e){ee.log(s+"broadcastMessageToAllAdViews"),H.checkStatusOfAdView().then((function(t){t&&t.isExternalAdViewInitiated&&H.sendMessageToExternalAdView(e)})),W.sendMessageToAllAdViews(e)}function Lt(){if(ee.log("getRecoveryInfo",ee.LogLevels.verbose),!tt||!tt.recoveryInfo)return"-1";var e=tt.recoveryInfo;return(e.isRecovered?"1":"0")+"-"+(e.trialNumber?e.trialNumber:"0")+"-"+(e.maxAllowedTrials?e.maxAllowedTrials:"0")}function Vt(e){return e===n.BN&&!ee.isBannerMultipleInstances(e)}function Mt(e,t){if(t)return t.settings.viewType===n.viewTypes.externalView&&Vt(t.productType)?H.sendMessageToExternalAdView(e):(ee.log("sendMessageToDisplayedAdView | posting to DISPLAYED ad unit"),W.sendMessageToAdView(e,t));var i="";try{i=JSON.stringify(e)}catch(e){}ee.log("sendMessageToDisplayedAdView | can't find displayed ad. "+i)}var Rt=function(e,t){if("string"==typeof e)throw new Error("postAdUnitEvent message type not supported "+typeof e);return ee.log(s+"postAdUnitEvent | before posting to ad unit"+JSON.stringify(e)),t?Nt(e):Mt(e,J.get())};function kt(){var e=J.getDisplayedAdType(),t=J.getDisplayedAdDemandName();ee.log("in setDefaultBackAndCloseBehavior with product "+e+" and demand "+t,ee.LogLevels.verbose),e&&(t?($e[e][t]=he.close,Qe[e][t]=Ee.defaultBehavior):($e[e]=he.close,Qe[e]=Ee.defaultBehavior))}function Kt(e){var t=document.getElementById("ssaDialogBox");t.classList.forEach((function(e){e!==n.styleAccordingToProtocol.secured&&e!==n.styleAccordingToProtocol.unsecured||t.classList.remove(e),e.match(/template.*/)&&t.classList.remove(e)}));var i=Ie.mobileSDKSettings.protocol===n.protocol.https?n.styleAccordingToProtocol.secured:n.styleAccordingToProtocol.unsecured;t.classList.add(i),e.settings.templateid&&t.classList.add("template"+e.settings.templateid)}function Bt(e){e?Ot():Pt()}function Et(e){return function(){e&&ee.isBannerMultipleInstances(e.productType)&&J.set(e),Wt()}}var jt=function(e,t){var n=o.Deferred();return ee.log("SDKController | onAdUnitOpen"),Ut(je.close),W.displayContainer(e),o.when(en(e)).then((function(){rn(),Kt(e),W.handleScreenVisible(t,e),n.resolve()})).fail((function(e){n.reject(e)})),n.promise()};function _t(e){e&&(ee.ImpressionsCounterService.increaseImpressionsCounterByInstanceParams(e),Q.updateToken(ee.ImpressionsCounterService.getTokenCounters()))}var Wt=function(){var e=J.get(),t=J.getDisplayedAdType();try{clearTimeout(ke),e?(e.onAdVisibleFlag=!0,$t()):ee.log("_shouldReceiveMessage"),e&&e.settings&&ee.LastSeenCampaignService.setLastDisplayedAdCampaignId(e.cid,t,e.settings),_t(e),e.showAdCallbacks&&e.showAdCallbacks.onShowSuccess(),ee.log("SDKController | onAdVisible"),re.publish("SDKController.AdVisible",[e]),Rt({name:"adVisible",productType:t})}catch(t){throw ee.log("SDKController | onAdVisible | Exception"),e.showAdCallbacks&&e.showAdCallbacks.onShowFailed(n.errors.showAdFailedReasons.onAdVisibleFailed+": "+JSON.stringify(t)),t}};function Gt(){return ne.isVisible(Ue)}var Ht=function(e,t){ee.RingerSwitchService.isInitiated()&&ee.RingerSwitchService.stopListener(),Je.scrollHeight="",document.body.style.height=Je.scrollHeight;var n=function(){qt(t)};Gt()?Ft(!1,e,n):n()};function qt(e){var t=function(){},n=J.get();if(J.reset(),e&&W.displayLoader(n.productType),ee.callSDKFunction("setBackButtonState",{state:We.controller}),e?Ot():t=Jt.bind(this,n),n)return n.engaged=!0,void Cn(n,{preloadNextInBG:!e},t);W.unloadProductFromContainer(),t()}var Jt=function(e){ee.log("SDKController | ad unit close done",ee.LogLevels.verbose),e&&e.isWPAD?(ee.log("SDKController | ad unit close done wpad",ee.LogLevels.verbose),W.hideContainer(e)):(setTimeout((function(){ee.log("SDKController | closing webview with currentAd "+JSON.stringify(e),ee.LogLevels.verbose),W.hideContainer(e)}),250),e&&e.settings&&e.settings.setContainerBGColorBlack&&W.setContainerBGColorTransparent())},Qt=function(){if(!de){var e,t=J.get(),i=J.getDisplayedAdType(),r=J.getDisplayedAdDemandName(),a=J.getDisplayedAdSettings(),o={eventParam:{eName:dt.userClosedBeforeAdVisible},action:"startTiming",productType:i,demandSourceName:r};re.publish("SDKController.Analytics",[o]),t&&t.isScreenVisibleTimedOut||(e=i===n.OW?a&&(a.OLXD||0===a.OLXD)?1e3*a.OLXD:n.closeAndBackDisabledTimerOW:n.closeAndBackDisabledTimer,zt(),de=!0,ke=setTimeout((function(){$t()}),e))}},$t=function(){Xt(),de=!1},zt=function(){document.getElementById("ssaNavigatorCloseButton").classList.add("invisible")},Xt=function(){document.getElementById("ssaNavigatorCloseButton").classList.remove("invisible")},Yt=function(e){W.hideLoader(),nn();var t=J.get(),i=J.getDisplayedAdType(),r=J.getDisplayedAdDemandName();if(!i)return ct(null,e),void Ht(!1);var a,o,s=on(i);switch(!t||t.onAdVisibleFlag||de||(a=t,(o=e.displayedAd)&&a!==o?(s=he.closeBannerDuringShowPatch,e.displayedAd,xe.report(dt.adChangedOnClose,{custom_a:t.productType+" | "+e.displayedAd.productType,custom_b:ee.OMIDService.isAdOmidSupported(t)?1:0,custom_c:ee.OMIDService.isAdOmidSupported(e.displayedAd)?1:0})):(!function(e,t,i){Ke&&(clearTimeout(Ke),re.unsubscribe(Be),e.showAdCallbacks&&e.showAdCallbacks.onShowFailed(n.errors.showAdFailedReasons.userClosedBeforeAdVisible));var r={eventParam:{eName:dt.userClosedBeforeAdVisible},action:"fireEvent",productType:t,demandSourceName:i};re.publish("SDKController.Analytics",[r])}(t,i,r),e&&"touchend"===e.type&&(s=he.close))),s){case he.close:ee.ViewsManager.waitForAllViews().then((function(){an(),ct(null,e),Ht(!1)}));break;case he.closeBanner:an(),Ht(!1);break;case he.closeBannerDuringShowPatch:e.displayedAd.engaged=!0,Cn(e.displayedAd,{preloadNextInBG:!1});break;case he.confirm:Ut(je.close),ee.alert(ee.adUtils.getConfirmCloseMsg(t));break;case he.confirmNextFrame:Ut(je.nextFrame),ee.alert(ee.adUtils.getConfirmCloseMsg(t));break;case he.nextFrame:Rt({name:"moveToNextFrame"});case he.ignore:}},Zt=function(){var e="deviceScreenSize[width]",t="deviceScreenSize[height]",i=n.appInfo.orientation.portrait,r=n.appInfo.orientation.landscape,a=n.defaultOrientation,s=Ie.mobileSDKSettings[e],l=Ie.mobileSDKSettings[e],d=new o.Deferred;return o.when(ee.OrientationService.oldGetOrientation()).then((function(o){var c=J.getDisplayedAdType();!c||a[c]!==r&&a[c]!==i||(o=a[c]),o===r&&(s=Math.max(Ie.mobileSDKSettings[e],Ie.mobileSDKSettings[t]),l=Math.min(Ie.mobileSDKSettings[e],Ie.mobileSDKSettings[t])),o===i&&(s=Math.min(Ie.mobileSDKSettings[e],Ie.mobileSDKSettings[t]),l=Math.max(Ie.mobileSDKSettings[e],Ie.mobileSDKSettings[t])),Ie.mobileSDKSettings.deviceOs===n.deviceOs.android&&(s/=Ie.mobileSDKSettings.deviceScreenScale,l/=Ie.mobileSDKSettings.deviceScreenScale),d.resolve({width:s,height:l,orientation:o,scrollTop:ee.JQWrapper.scrollTop(window)})})),d.promise()},en=function(e){var t=new o.Deferred;if(Ve)return t.resolve();return!e||e.productType!==n.RV&&e.productType!==n.IS||(J.set(e),Ke=setTimeout((function(){Ot(),e.isScreenVisibleTimedOut=!0,re.unsubscribe(Be),t.reject(n.errors.showAdFailedReasons.screenVisibleTimeout)}),e&&e.settings&&e.settings.screenVisibleTimeout||12e3)),Be=re.subscribe(ce+".viewableChange",(function(e){e&&ne.isDefined(e.isViewable)&&e.isViewable&&(ee.log("SDKController | viewableChange(screenVisible) to:"+e.isViewable,ee.LogLevels.info),clearTimeout(Ke),re.unsubscribe(Be),t.resolve())})),t.promise()},tn=function(e){if(e.productType!==n.BN||e.isLoadWithAdmFlow)W.onAdUnitLoaded(e,Bt,Et(e));else{H.onBannerViewLoaded((function(){J.set(e)}),Et())}},nn=function(){ee.callSDKFunction("removeCloseEventHandler",ee.ViewsManager.getDisplayWebViewParams(!1))};function rn(){ee.NativeLifeCycleEventsService.startNotify(F.AndroidEvents.onDestroy)}function an(){ee.NativeLifeCycleEventsService.stopNotify(F.AndroidEvents.onDestroy)}function on(e){var t=J.getDisplayedAdDemandName();if(e)return(t?$e[e][t]:$e[e])||ze[e]}var sn=function(){Te=document.getElementById("ssaNavigatorCloseButton"),Ue=document.getElementById("ssaDialogBox"),Ne=document.getElementById("ssaDialogConfirmBtn"),Le=document.getElementById("ssaDialogCancelBtn"),Oe=document.getElementById("ssaViewWrap"),xt()},ln=function(e){ee.log(e,ee.LogLevels.error)},dn=function(e){var t,n={};return ne.isString(e)?(t=e.split(/\?(.+)/),n.name=t[0],n.parameters=e.split(/parameters=(.+)/)[1],n):null},cn=function(){return Ie.mobileSDKSettings.deviceOs===n.deviceOs.android?"supersonicads":"SSAPublisher"},un=function(e){ne.each(Ie.applicationSettings,(function(t){t.match(/^custom/)&&-1===e.indexOf(t)&&delete Ie.applicationSettings[t]}))},fn=function(){var e={};return ne.each(Ie.applicationSettings,(function(t){t.match(/^custom/)&&(e[t]=Ie.applicationSettings[t])})),e},pn=function(e){var t=Ie.mobileSDKSettings.protocol+"//"+Ie.mobileSDKSettings.domain+"/l/?type={{logType}}&count={{count}}&applicationKey={{applicationKey}}&applicationUserId={{applicationUserId}}&SDKVersion={{SDKVersion}}&deviceOs={{deviceOs}}&deviceOSVersion={{deviceOSVersion}}&{{customQueryString}}",n=new Image,i={},r={logType:"",count:1,applicationKey:Ie.applicationSettings.applicationKey,applicationUserId:Ie.applicationSettings.applicationUserId,SDKVersion:Ie.mobileSDKSettings.SDKVersion,deviceOs:Ie.mobileSDKSettings.deviceOs,deviceOSVersion:Ie.mobileSDKSettings.deviceOSVersion,customQueryString:""};e=ne.extend({"deviceIds[OpenUDID]":Ie.mobileSDKSettings["deviceIds[OpenUDID]"],"deviceIds[IFA]":Ie.mobileSDKSettings["deviceIds[IFA]"],"deviceIds[IDFV]":Ie.mobileSDKSettings["deviceIds[IDFV]"],"deviceIds[SERIAL]":Ie.mobileSDKSettings["deviceIds[SERIAL]"],"deviceIds[AndroidID]":Ie.mobileSDKSettings["deviceIds[AndroidID]"],"deviceIds[IMEI]":Ie.mobileSDKSettings["deviceIds[IMEI]"]},r,e),ne.each(e,(function(e,t){ne.isDefined(r[e])||(i[e]=t)})),ne.isEmptyObject(i)||(e.customQueryString+=ne.serialize(i)),n.src=ne.renderTemplate(t,e)},gn=function(){var e=Ie.mobileSDKSettings;if(e.deviceScreenScale)try{var t=parseInt(e["deviceScreenSize[width]"])/(e.deviceOs!==n.deviceOs.ios?e.deviceScreenScale:1),i=parseInt(e["deviceScreenSize[height]"])/(e.deviceOs!==n.deviceOs.ios?e.deviceScreenScale:1);e.deviceHeightDP=parseInt(i),e.deviceWidthDP=parseInt(t)}catch(e){ee.log("SDKController | Failed to parse screen DP",ee.LogLevels.error)}},vn=function(){var e=new o.Deferred,t=!1,n=Ie.mobileSDKSettings;return li()?(e.resolve(),e.promise()):(ee.CampaignsFilter.checkIfAppInstallOnDevice(["com.google.market","com.android.vending"]).then((function(i){ne.each(i,(function(e,n){n.isInstalled&&(t=!0)})),n.gpi=t,e.resolve()}),(function(){n.gpi=t,e.reject("Unable to check if Google play services is installed on the device")})),e.promise())},mn=function(){var e,t,n,i=[],r=new o.Deferred;return e=re.subscribe(ce+".parseDeviceStatus",(function(e,t){re.clearHandlers(i),ee.log(s+"parseDeviceStatus received");var a=l(e.appOrientation);a.patch&&(xe.report(dt.patchOrientation,{generalMessage:decodeURIComponent(e.appOrientation)}),e.appOrientation=a.appOrientation),(n=_.parseConfiguration(e,ye,Ie.mobileSDKSettings)).didSucceed?(ee.callSDKFunction(t),j.init(Ie.controllerConfig.appOrientation,Ie.mobileSDKSettings),Ie.mobileSDKSettings.appOrientation=j.getOrientation(),Ie.mobileSDKSettings.displaySizeWidth=Ie.mobileSDKSettings["deviceScreenSize[width]"],Ie.mobileSDKSettings.displaySizeHeight=Ie.mobileSDKSettings["deviceScreenSize[height]"],gn(),$=T.create(Ie.mobileSDKSettings),ee.AdvertisingIdService.decideOnAdvertisingId(Ie.mobileSDKSettings,Ie.controllerConfig),r.resolve()):r.reject(n.errMsg)})),i.push(e),t=re.subscribe(ce+".getDeviceStatusFailed",(function(e){re.clearHandlers(i),ln(e),r.reject(ve.device)})),i.push(t),ee.callSDKFunction("getDeviceStatus",{},"parseDeviceStatus","getDeviceStatusFailed"),r.promise()},hn=function(){Ie.mobileSDKSettings.deviceOs!==n.deviceOs.ios&&ee.callSDKFunction("setStoreSearchKeys",{searchKeys:qe[Ie.mobileSDKSettings.deviceOs]})},bn=function(e){return ne.isDefined(Ie[e])&&null!==Ie[e]||ne.isDefined(Ie.applicationSettings[e])&&null!==Ie.applicationSettings[e]||ne.isDefined(Ie.mobileSDKSettings[e])&&null!==Ie.mobileSDKSettings[e]||ne.isDefined(Ie.controllerConfig[e])&&null!==Ie.controllerConfig[e]||ne.isDefined(Ie.configMapping[e])&&null!==Ie.configMapping[e]()},Sn=function(e){return ne.isDefined(De[e])},yn=function(e){var t;return ne.isDefined(Ie[e])?t=Ie[e]:ne.isDefined(Ie.applicationSettings[e])?t=Ie.applicationSettings[e]:ne.isDefined(Ie.mobileSDKSettings[e])?t=Ie.mobileSDKSettings[e]:ne.isDefined(Ie.controllerConfig[e])?t=Ie.controllerConfig[e]:ne.isDefined(Ie.configMapping[e])?t=Ie.configMapping[e]():"customParam"===e&&(t=fn()),t},An=function(){var e,t,n=[],i=new o.Deferred;return e=re.subscribe(ce+".parseCachedFilesMap",(function(e,t){var n,r,a,o={};(a=ut(["path"],e,"parseCachedFileMap")).didSucceed?(n=decodeURIComponent(e.path).split("/"),""!==e.path?o[r=n[n.length-1]]=ne.isDefined(e[r])?e[r]:e:o=e,ee.log("SDKController | successfully received files map:"+JSON.stringify(e),ee.LogLevels.info),delete e.path,On(o).then((function(e){ee.log("SDKController | Finished purging cache on controller init, calling init with sorted:"+JSON.stringify(te.cachePriorityArray),ee.LogLevels.verbose),ee.log("SDKController | The file map after:"+JSON.stringify(e),ee.LogLevels.verbose);var t=ee.Cache.init(e,te.cachePriorityArray);return ee.AdsAssetsManager.init(ee.Cache,Ie.controllerConfig.cacheConfig),t})).then((function(){ee.log("SDKController | Cache module initiated",ee.LogLevels.info),ee.callSDKFunction(t),i.resolve()})).fail((function(e){e="SDKController | Cache module failed to initiated",ee.log(e,ee.LogLevels.error),i.reject(e)}))):i.reject(a.errMsg)})),n.push(e),t=re.subscribe(ce+".getCachedFilesMapFailed",(function(e){ee.log("SDKController | failed to receive files map:"+e,ee.LogLevels.error),i.reject(ve.filemap)})),n.push(t),ee.callSDKFunction("getCachedFilesMap",{path:""},"parseCachedFilesMap","getCachedFilesMapFailed"),i.promise()},Cn=function(e,n,i){n=n||{preloadNextInBG:!0},W.unloadAdView(e),oe.removeAdById(ee.AdUtils.getAdId(e),e);var r=Wn(e),a=!1;r&&ne.isFunction(r.prepareAdToEngageEnd)&&r.prepareAdToEngageEnd(e).then((function(){a=r.getNextAd(!n.preloadNextInBG,e.inventoryId)})),ee.log("engageEnd on controller with :"+e.engaged,ee.LogLevels.verbose),t.PubSub.publish("SDKController.engageEnd",[e,function(){e.engaged&&W.unloadProductFromContainer(e);var t=!n.preloadNextInBG;r&&ne.isFunction(r.attemptToPreloadAd)&&a&&r.attemptToPreloadAd(t,e.inventoryId),i&&i(),X.getState()===me.play&&X.handleOnEngageEnd(e)}])},In=function(){var e=We.controller;return Ie.mobileSDKSettings.deviceOs===n.deviceOs.android&&10==_.getDeviceApiLevel()&&(e=We.device),e},Dn=function(e){return wn(e),Pn(e),e&&e.applicationKey&&(Ie.applicationSettings.applicationKey=e.applicationKey),_.parseConfiguration(e,Ae,Ie.applicationSettings)},wn=function(e){var t,n=Ce.length;for(t=0;t<n;t++)ne.isDefined(e[Ce[t]])||(Ie.applicationSettings[Ce[t]]=null)},Pn=function(e){var t,n=[];for(t in e)e.hasOwnProperty(t)&&t.match(/^custom/)&&n.push(t);un(n)};function On(e){var t,i,r,a=[],s=new o.Deferred,l=[],d=["temp","files","assets","libs","graphicAssets",n.adPlayerDirectory],c=function(){var r=new o.Deferred,s=0;function c(){var t;(t=new o.Deferred,l.length>0&&ne.each(l,(function(t,n){te.cachePriorityArray&&te.cachePriorityArray[n]&&delete te.cachePriorityArray[n],delete e[n]})),"0"!==te.controllerVersion?(te.controllerVersion=Ie.v,ee.setGlobalAppData(te).then((function(){t.resolve()}),(function(){t.reject("NewController: Save app global data failed")}))):t.resolve(),t.promise()).then((function(){r.resolve(e)}),(function(e){r.reject(e)})),re.clearHandlers(a)}function u(e,t){const n=function(){var e=(window.SuperSonicGlobalConfig.controllerConfig.networkConfig||{}).purge||{};return ee.log("purgeConfig: "+JSON.stringify(e),ee.LogLevels.verbose),e}();var i=Ie.mobileSDKSettings.hasOwnProperty(t)&&!1===Ie.mobileSDKSettings[t];return!n[e]&&i}function f(e){return e===n.cacheAdsDirectory||function(e){return-1!==e.indexOf("RewardedVideo")||-1!==e.indexOf("Interstitial")}(e)}return t=re.subscribe(ce+".deleteFolderSuccess",(function(){ee.log("NewController: A new controller version detected. Folder deleted successfully",ee.LogLevels.verbose),++s>=l.length&&c()})),i=re.subscribe(ce+".deleteFolderFailed",(function(e){if(re.clearHandlers(a),ne.isDefined(e.errCode)&&1==e.errCode)ee.log("NewController: The folder requested for deletion was not found. Continue...",ee.LogLevels.verbose),++s>=l.length&&c();else{re.clearHandlers(a),r.reject("NewController: Purge cache for new controller version failed.")}})),function(){var t=u("campaigns","purgeCampaignsCache"),n=u("globals","purgeGlobalsCache");if(t)for(var i in e)f(i)&&d.push(i);n&&d.push("globals")}(),a.push(t),a.push(i),ne.each(e,(function(e,t){-1===d.indexOf(e)&&l.push(e)})),ee.log(l+JSON.stringify(l),ee.LogLevels.verbose),l.length>0?ne.each(l,(function(e,t){ee.deleteFolder(t)})):c(),r.promise()};return ee.getGlobalAppData().then((function(t){ee.log("SDKController | getGlobalAppData: "+JSON.stringify(t),ee.LogLevels.verbose),te=t,r=t.controllerVersion,ne.isDefined(r)&&r!==Ie.v||!ne.isDefined(r)?(ee.log("NewController: A new controller version detected. Purging cache... old: "+r+"new: "+Ie.v,ee.LogLevels.verbose),nt=!0,c().then((function(e){s.resolve(e)}),(function(){s.reject()}))):(ee.log("NewController: Controller version did not change. Saved version: "+r+" Current version: "+Ie.v,ee.LogLevels.verbose),s.resolve(e))}),(function(){ee.log("SDKController | getGlobalAppData: failed! ",ee.LogLevels.verbose),s.reject("getGlobalAppData: failed! ")})),s.promise()}function Fn(e){return function(t){Rt({data:t,id:e},!0)}}function Tn(){return Ie.controllerConfig&&void 0!==Ie.controllerConfig.abTest?Ie.controllerConfig.abTest:-4}function xn(e){Ze||ee.getApplicationInfo(e).then(null,(function(){var e=o.Deferred();return e.resolve(ee.getConfig()),e.promise()})).always((function(e){var t=Un(e);lt.init(t),Ze=!0}))}function Un(e){var t=-1;try{t=parseInt(_.getDeviceApiLevel())}catch(e){ee.log("getAnalyticsBaseData | Error converting deviceApiLevel to Integer "+e,ee.LogLevels.verbose)}return{sdkVersion:e.mobileSDKSettings.SDKVersion,controllerVersion:e.v,controllerbn:e.controllerbn,bundleId:e.mobileSDKSettings.bundleId,connectionType:e.mobileSDKSettings.connectionType,applicationKey:e.applicationSettings.applicationKey,deviceId:Gn(e.mobileSDKSettings),applicationUserId:e.applicationSettings.applicationUserId,deviceOs:e.mobileSDKSettings.deviceOs,deviceOsVersion:_.getDeviceOsVersion(),deviceApiLevel:t,deviceOEM:e.mobileSDKSettings.deviceOEM,deviceModel:e.mobileSDKSettings.deviceModel,appOrientation:j.getOrientation(),env:Ai.getEnv(),lat:e.mobileSDKSettings.isLimitAdTrackingEnabled,abTest:Tn(),usertype:e.userType,platformABGroup:ee.getSDKDataByKey(n.abTests.controllerConfigGroup),mediationType:e.controllerConfig.mediationType,appVersion:e.mobileSDKSettings.appVersion,SDKpluginType:e.applicationSettings.SDKPluginType,isMultipleAdObjects:!!e.applicationSettings.isMultipleAdObjects}}function Nn(e,t){var n,i=[],r=new o.Deferred,a=t.length;for(n=0;n<a;n++)i.push(Ln(e,t[n]));return o.when.apply(null,i).always((function(){ee.deleteFolder(e),r.resolve(0)})),r.promise()}function Ln(e,t){var n=new o.Deferred,i=function(i){var r={timingValue:(new Date).getTime()-undefined,success:i},a=r.success?dt.cdnABTestSuccess:dt.cdnABTestFail,o={eNameStart:dt.cdnABTestSuccess,timingValue:r.timingValue,rvnomoreoffersreason:e,generalMessage:t};xe.trackTimingStop(a,o),n.resolve()};return xe.trackTimingStart(dt.cdnABTestSuccess),ee.cacheAsset(e,t).then(i.bind(null,!0),i.bind(null,!1)),n.promise()}function Vn(e){var t="deviceVolumeSuccess";re.subscribe(ce+"."+t,(function(t){ee.log("Device volume received: "+(t?JSON.stringify(t):"empty")),e&&t&&e.call(null,{deviceVolume:t.deviceVolume||"0"})})),ee.callSDKFunction("getDeviceVolume",{},t,t)}function Mn(){var e="InitSummerySuccess";re.subscribe(ce+"."+e,(function(e){ee.log("InitSummery received: "+(e?JSON.stringify(e):"empty")),e.recoveryInfo&&(tt.recoveryInfo=e.recoveryInfo)})),ee.callSDKFunction("getInitSummery",{},e,e)}function Rn(){var e,t,i=new o.Deferred;return e=re.subscribe(ce+".getDebugParamsSuccess",(function(r){ee.log(s+"getDebugParamsSuccess "+JSON.stringify(r));try{var a={};Ie.mobileSDKSettings.deviceOs===n.deviceOs.android?a=ne.parseJSON(decodeURIComponent(r.SDK5DebugParams)):"object"==typeof r.SDK5DebugParams&&(a=r.SDK5DebugParams),i.resolve(a)}catch(e){ee.log("getSDKDebugParams | getDebugParamsSuccess | parseJSONFailed |"+e,ee.LogLevels.verbose),i.reject("failed to parse received SDK5 params")}re.clearHandlers([e,t])})),t=re.subscribe(ce+".getDebugParamsFailed",(function(n){var r="failed to get debug param";ee.log("getSDKDebugParams | getDebugParamsFailed | "+r,ee.LogLevels.verbose),i.reject(r),re.clearHandlers([e,t])})),ee.callSDKFunction("getUserData",{key:"SDK5DebugParams"},"getDebugParamsSuccess","getDebugParamsFailed"),i.promise()}function kn(e){var t=new o.Deferred;return Rn().then((function(t){return e=ne.extend(e,t),ne.returnResolvedPromise(e)})).always((function(n){t.resolve(n||e)})),t.promise()}function Kn(e){var t="false";!0===e&&(t="true"),ee.callSDKFunction("setAllowFileAccessFromFileURLs",{allowFileAccess:t})}function Bn(){return Ie.mobileSDKSettings&&Ie.mobileSDKSettings.bundleId&&-1!==n.testAppBundleIds.indexOf(Ie.mobileSDKSettings.bundleId)}function En(e){ee.log("setCloseButtonState params "+JSON.stringify(e),ee.LogLevels.verbose),e&&e.state&&e.productType&&(e.demandSourceName?$e[e.productType][e.demandSourceName]=he[e.state]:$e[e.productType]=he[e.state])}function jn(){if(!et){var e=ee.getApiData(b.deviceDataRequestObject);e&&Object.keys(e).length>0&&(et={os:e.deviceOs,osv:e.deviceOSVersion,apilvl:_.getDeviceApiLevel(),sdkv:e.SDKVersion,webviewType:Ie.mobileSDKSettings.webviewType})}return et||{}}function _n(){var e;return Ie.controllerConfig&&!0===Ie.controllerConfig.isSecured?e=n.protocol.https:Ie.mobileSDKSettings.deviceOs===n.deviceOs.android?e=n.protocol.http:Ie.mobileSDKSettings.deviceOs===n.deviceOs.ios&&(Ie.mobileSDKSettings.deviceOSVersion&&!t.VersionUtils.isLower(Ie.mobileSDKSettings.deviceOSVersion,"10")?Ie.mobileSDKSettings.allowArbitraryLoadsInWebContent?(e=n.protocol.http,Z=!0):Ie.mobileSDKSettings.allowArbitraryLoads?e=n.protocol.http:(e=n.protocol.https,Z=!0):e=Ie.mobileSDKSettings.allowArbitraryLoads?n.protocol.http:n.protocol.https),e}function Wn(e){if(e&&e.productType){var t=ee[e.productType];return e.demandSourceName&&t&&(t=t[e.demandSourceName]),t}}function Gn(e){return ui()?Hn(e):e["deviceIds[AID]"]}function Hn(e){return t.VersionUtils.isLower(e.deviceOSVersion,"10")||!0!==e.isLimitAdTrackingEnabled&&"true"!==e.isLimitAdTrackingEnabled?e["deviceIds[IFA]"]:e["deviceIds[IDFV]"]}function qn(){var e="assets",t=ee.Cache.getCacheByType({cacheBase:e}),n=Ie.mobileSDKSettings.jQueryUrls;t&&ee.Cache.getFileIndexInCache(t.cache,n[0])>-1?ee.log(s+"jQuery file already cache"):(ee.log(s+"Start save jQuery to cache"),ee.cacheAsset(e,n).then((function(){ee.log(s+"jQuery file saved successfully")}),(function(){ee.log(s+"jQuery file cache failed")})))}function Jn(){var e=Ie.mobileSDKSettings.controllerPathFolder+Ie.v,t=ee.Cache.getCacheByType({cacheBase:e});t&&ee.Cache.getFileIndexInCache(t.cache,Ie.mobileSDKSettings.controllerJSUrl)>-1?ee.log(s+"controller js file already cache"):$n(e,Ie.mobileSDKSettings.controllerJSUrl)}function Qn(){var e=Ie.mobileSDKSettings.controllerPathFolder+Ie.v,t=ee.Cache.getCacheByType({cacheBase:e}),n=Ie.mobileSDKSettings.rootPath+Pe,i=Ie.mobileSDKSettings.cacheFolderPath+"/"+we;t&&ee.Cache.getFileIndexInCache(t.cache,n)>-1?zn(i):$n(e,n).then((function(){ee.log("updateControllerCssToCache - cache css file succeeded",ee.LogLevels.verbose),zn(i)}),(function(){ee.log("updateControllerCssToCache - cache css file failed",ee.LogLevels.verbose),zn(n)}))}function $n(e,t){return ee.log(s+"Start saving file to cache, url: "+t),ee.cacheAsset(e,t).then((function(){ee.log(s+"File save success | "+t)}),(function(e){return ee.log(s+"File save fail | "+t+" "+e),e}))}function zn(e){if(!document.getElementById("ssaMobileControllerCss")){var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.id="ssaMobileControllerCss",document.head.prepend(t)}document.getElementById("ssaMobileControllerCss").setAttribute("href",e)}function Xn(){qn(),Jn(),Qn(),Ie.mobileSDKSettings.deviceOs===n.deviceOs.android&&ee.AndroidNomediaFileHandler.updateNomediaFileToCache()}function Yn(e){if(!ee.HTTPService.getIsNativeEngineExist())return!1;return ee.HTTPService.GETRequest(e,{allowNative:!0,background:!0,retries:3}),!0}function Zn(e){ee.PixelTrackingService.firePixel(e)}function ei(e,t,n,i){var r,a,s=new o.Deferred,l=[];if(!ne.isString(e)||!ne.isString(t))return ne.returnRejectedPromise("missing or corrupted params");r=re.subscribe(ce+".postAdEventNotificationSuccess",(function(e){ee.log("postAdEventNotificationSuccess"+JSON.stringify(e)),re.clearHandlers(l),s.resolve()})),l.push(r),a=re.subscribe(ce+".postAdEventNotificationFailed",(function(e){var t=e.errMsg?e.errMsg:"unknown reason";ee.log("error calling postAdEventNotificationFailed: "+t,ee.LogLevels.error),re.clearHandlers(l),s.reject(t)})),l.push(a);var d={eventName:e,dsName:n,productType:t,extData:i||{}};return ee.log("Controller - Notifies SDK on Event: "+d.eventName+" in Product: "+d.productType),ee.callSDKFunction("postAdEventNotification",d,"postAdEventNotificationSuccess","postAdEventNotificationFailed"),s.promise()}function ti(e){var t,n=document.getElementById("ssaDialogBox");if("template4"===e)t={dialogText:{maxFontPixels:29,maxHeight:87,parentContainer:n},buttonText:{maxFontPixels:24,maxHeight:43,maxWidth:ni(e).maxDialogBtnTextWidth,parentContainer:Ne}};else t={dialogText:{maxFontPixels:24,maxHeight:87,parentContainer:n},buttonText:{maxFontPixels:20,maxHeight:44,maxWidth:ni(e).maxDialogBtnTextWidth,parentContainer:Ne}};return t}function ni(e){return n.templateStyle[e]?n.templateStyle[e]:n.templateStyle.defaultTemplate}function ii(){var e="",t=document.getElementById("ssaDialogBox"),n=t&&t.classList;for(let t of n)if(t.match(/template.*/)){e=t;break}return e}function ri(e,n,i,r){t.PubSub.publish(ce+"."+e,[n,i,r])}function ai(){for(;nativeQueue.length>0;){var e=nativeQueue.shift();ri(e.name,e.parameters,e.successCallback,e.errorCallback)}}function oi(e){return ee.SDKLimitations.getLimitData(e)}function si(e){ee.OMIDService.isSupported(e)&&ee.OMIDService.init(B);let t=ee.getConfig().mobileSDKSettings,n=t.protocol+"//"+t.cdn+"/ad-player/dist/assets",o=new a(ee,cn());const s=ee.SupplyConfigurations.getNetworkConfigValueByKey("uepfc"),l=ee.SupplyConfigurations.getNetworkConfigValueByKey("adprot");var d=new i(ee,{uepfc:s,adprot:l},n),c=new r(ee,o.getRootAbsolutePath(),xe);ee.ExternalAdProtocols.init({controller:ee,config:d,baseFileRepository:c})}function li(){return ee.CompatibilityService.isFeatureSupportedInNativeSDK(V.limitAppFiltering)||ee.CompatibilityService.isFeatureSupportedInNativeSDK(V.noPackagesInstallationPolling)}function di(){ee.SKOverlayManager.init(),ci()}function ci(){ui()&&ee.callSDKFunction("toggleUDIA",{getByFlag:-1},"toggleUDIAStatusSuccess","toggleUDIAStatusFailed")}function ui(){return pi()===n.deviceOs.ios}function fi(){return pi()===n.deviceOs.android}function pi(){return Ie.mobileSDKSettings.deviceOs}function gi(){return Ie.mobileSDKSettings.gpi}function vi(e){W.unloadAdView(e),bi(e)}function mi(e){e?ee.OMIDService.finishSession(e).always((function(){vi(e),oe.removeAdById(ee.AdUtils.getAdId(e),e)})):ee.log("_unloadAdViewByAd | ad is empty")}function hi(e){var t=oe.getAdByAdViewId(e);t?mi(t):ee.log("unloadAdViewByAdViewId | adViewId is not found in loadedCreatives")}function bi(e){e.productType===n.BN&&ee.callSDKFunction("cleanAdInstance",{demandSourceId:e.demandSourceId,productType:e.productType},"cleanAdInstanceSuccess","cleanAdInstanceFailure")}function Si(e){var t=J.get(),n=oe.getAds(e);if(t){var i=W.getDisplayedAdView(t);ee.log("Removing all current "+e.productType+" frames"),i&&i.hasClass&&i.hasClass(A.getAdUnitClassObj(e).class)&&J.isDisplayed()&&(ct(),Ht())}n.forEach(W.unloadAdView),n.forEach((function(t){ee.log("remove from load creative "+ee.AdUtils.getAdId(t)),oe.removeAdById(ee.AdUtils.getAdId(t),e)}))}function yi(e){if(e){ee.getSegmentationAllocator().addControllerSourceSegment(e.controllerSourceStrategy);var t=e.controllerSourceCode;ne.isDefined(t)&&lt.updateBaseData({controllerSource:t})}}window.onerror=function(e,t,n,i,r){try{if(!r||!r.message)return;var a={url:t,lineNo:n,colNo:i,error:r&&r.message.substring(0,500)||""};ee.log(s+"onError handler. Exception:"+JSON.stringify(a)),xe&&xe.report(dt.controllerException,{generalMessage:e,rvnomoreoffersreason:JSON.stringify(a)})}catch(e){}};var Ai={getAdPlayerAssets:function(){return z},adUnitGlobals:f,Utils:ne,JQWrapper:ie,libsManager:g,adUnitUrl:m,adPlayerUrl:h,LogLevels:{none:0,error:1,info:2,verbose:3},featureMap:be,debugMsg:u.debugMsg,decideUrlProtocolAccordingToHTTPSCompliance:_n,blacklistService:y,jQuery:function(){return o},api:function(){return _n()+"//"+Ie.mobileSDKSettings.domain},apiWithCdn:function(){return Ie.mobileSDKSettings.protocol+"//"+Ie.mobileSDKSettings.serviceCdn},getBaseCdnUrl:function(){return Ie.mobileSDKSettings.protocol+"//"+Ie.mobileSDKSettings.cdn},init:function(t,i){return ee=this,o=window.jQuery,se||(Ie.mobileSDKSettings=ne.extend(Ie.mobileSDKSettings,t.mobileSDKSettings),Ie.controllerConfig=ne.extend(Ie.controllerConfig,t.controllerConfig),B=new(e("../Environment/EnvironmentManager"))({controllerVersion:Ie.mobileSDKSettings.controllerVersion,schema:Ie.mobileSDKSettings.protocol,cdnDomain:Ie.mobileSDKSettings.cdn,scdnDomain:Ie.mobileSDKSettings.scdn,environment:Ie.mobileSDKSettings.env,deviceOs:Ie.mobileSDKSettings.deviceOs,cdnService:Ie.mobileSDKSettings.serviceCdn,stagingCdnDomain:Ie.mobileSDKSettings.domain,domain:Ie.mobileSDKSettings.domain}),Ie.mobileSDKSettings.overrideDebug&&(Ie.mobileSDKSettings.debug=Ie.mobileSDKSettings.defaultDebug),ee.APIConfigurations.init(),_=new C(Ie,ne,n),j=ee.AppOrientationManager,E=new I(u,n,j),oe=new(e("./LoadedCreatives"))(ee),St(i),yt(),gt(),ht(),At(),Ct(),ft(),pt(),yi(Ie.controllerConfig.controllerSourceData),ee.log(s+"Controller initiated"),Y.setNativeConfiguration(O.native[Ie.mobileSDKSettings.deviceOs]),o.when(mn(),An()).then((function(){si(Ie.controllerConfig);var e=_n();f.setProtocol(e),z.setProtocol(e),window.queueValidMessages={},ai(),di()}),(function(e){try{xe.report(dt.initFailed,{generalMessage:decodeURIComponent(e)})}catch(e){}ee.callSDKFunction("initController",{stage:"failed",errMsg:e})})).then((function(){o.when(Xn(),vn()).always((function(){var e={};li()||(e.gpi=Ie.mobileSDKSettings.gpi),e.ici=!0,Q.updateToken(e),ee.CompatibilityService.isFeatureSupportedInNativeSDK(V.initRecovery)&&Mn()}))})).fail((function(e){e?ee.log(s+e):ee.log(s+"failed promise on get app config")})),se=!0,xe.report(dt.controllerInitiated)),se},getConfigurationHelper:function(){return _},getAPIRequiredData:function(){var e=ee.APIConfigurations.getCommonRequiredData(),t=ee.getApiData(e),n=new o.Deferred;return t&&t!=={}?ne.isDefined(t.errMsg)?n.reject(t.errMsg):n.resolve(t):n.reject("Failed to get required parameters"),n.promise()},isIOS:ui,isAndroid:fi,getDeviceOs:pi,isGpi:gi,getApiData:function(e){var t,n={};for(t in e)if(e.hasOwnProperty(t)){if(1===e[t]&&!bn(t)&&!Sn(t)){n={errMsg:ve.missing+t};break}bn(t)?n[t]=yn(t):"customParams"===t?n=ne.extend(n,fn()):Sn(t)&&(n[t]=De[t]())}return n},getSDKDataByKey:function(e){return yn(e)},isAppsInstalledInfoRestricted:li,runFunction:function(e,t,n){var i=dn(e);if(queueValidMessages[i.name])nativeCommunicator.runFunction(e,t,n);else{if("acknowledgeMessage"!==i.name||!window.shouldReportReady){var r,a=!0;r=ne.parseJSON(i.parameters);try{ne.isDefined(i.name)&&ri(i.name,r,t,n)}catch(e){ee.log("error running function:"+i.name+", error:"+e,ee.LogLevels.error),a=!1}return a}nativeCommunicator.runFunction(e,t,n)}},callSDKFunction:function(e,t,n,i){K.callSDKFunction(e,t,n,i)},callSDKFunctionWithCallback:function(e,t,n,i){K.callSDKFunctionWithCallback(e,t,n,i)},callSDKService:function(e,t,n,i,r){K.callSDKService(e,t,n,i,r)},getApplicationInfo:function(e,t){var n,i,r=o.Deferred(),a=function(e,t){re.clearHandlers([n,i]),e?r.resolve(Ie):r.reject(ve.appInfo,t)};if(n=re.subscribe(ce+".parseApplicationInfo",(function(t,n,i){var r;ne.isDefined(t.productType)&&t.productType!==e.productType&&t.demandSourceName!==e.demandSourceName?ee.log(s+"parseApplicationInfo | info sent for the wrong product"):(ee.log(s+"parseApplicationInfo: "+JSON.stringify(t)),delete t.productType,delete t.demandSourceName,(r=Dn(t)).didSucceed?(ne.isDefined(n)&&ee.callSDKFunction(n),a(!0)):(ne.isDefined(i)&&ee.callSDKFunction(i,{errMsg:r.errMsg}),a(!1,r.errMsg)))})),i=re.subscribe(ce+".getApplicationInfoFailed",(function(e){ln(e),a(!1,"Failed retrieving application info")})),ne.isDefined(t)&&t){var l=Dn(t);l.didSucceed?a(!0):(ee.log(l.errMsg,ee.LogLevels.error),a(!1,l.errMsg))}else ee.callSDKFunction("getApplicationInfo",e,"parseApplicationInfo","getApplicationInfoFailed");return r.promise()},setCloseButtonState:En,getEnv:function(){n.environment.production;return Ie.mobileSDKSettings.debug&&parseInt(Ie.mobileSDKSettings.debug)>0&&Ie.mobileSDKSettings.domain!==n.domainUrls.prod?Ie.mobileSDKSettings.domain===n.domainUrls.local?n.environment.develop:n.environment.stage:n.environment.production},getProtocol:function(){return Ie.mobileSDKSettings.protocol},isLegacy:function(e){var n=!0;try{var i="android"===Ie.mobileSDKSettings.deviceOs?e.android:e.ios;n=t.VersionUtils.isLower(Ie.mobileSDKSettings.SDKVersion,i)}catch(e){ee.log(e,ee.LogLevels.error)}return n},cacheAdUnitAssets:function(e,t){var n,i=t.assets,r=t.lastUpdateTime,a=i.length,l=new o.Deferred,d=[],c=0;for(0===a&&l.resolve(0),n=0;n<a;n++)d.push(ee.cacheAsset(e,i[n],r));return o.when.apply(null,d).always((function(){var t=arguments;for(n in t)ee.log(s+"path: "+e+" res: "+t[n],3),t[n]&&c++;l.resolve(c)})),l.promise()},cacheAsset:function(e,t,i,r){var a,l,d,c=[],u=new o.Deferred;if(ne.isString(t)&&(t=[t]),"device"===Ie.applicationSettings.preCache){var f,p={path:ne.isString(e)?e:e.toString(),overrideExistingFile:r},g=-1,v=function(e){u.reject(e),re.clearHandlers(c)},m=function(e){++g>=t.length?v(e||"Index error in array assets url"):(f=t[g],p.file=Z?ne.changeUrlProtocol(f,n.protocol.https):f,ee.log(s+"saveFile | "+p.file+" path: "+decodeURIComponent(p.path)),ee.callSDKFunction("saveFile",p,"preCacheFileSuccess","preCacheFileFailed"))};ne.isDefined(i)&&(p.lastUpdateTime=i.toString()),a=re.subscribe(ce+".assetCached",(function(t){if(!ut(["path","file"],t,"preCacheFileSuccess").didSucceed)return ee.log("error calling assetCached "+JSON.stringify(t),ee.LogLevels.error),void v("error calling assetCached");decodeURIComponent(t.path)===e&&f.match(t.file)&&(re.clearHandlers(c),ee.log(s+"saveFile | success: "+decodeURIComponent(t.path)+"/"+t.file),u.resolve({filePath:decodeURIComponent(t.path)+"/"+t.file,url:f}))})),l=re.subscribe(ce+".assetCachedFailed",(function(t){decodeURIComponent(t.path)===e&&f.match(t.file)&&(ee.log(s+"saveFile | fail "+decodeURIComponent(t.path)+"/"+t.file),m("failed saved file"))})),d=re.subscribe(ce+".preCacheFileFailed",(function(t){decodeURIComponent(t.path)===e&&f.match(t.file)&&(ee.log(t.errMsg+": "+decodeURIComponent(t.path)+"/"+t.file,ee.LogLevels.error),m(t.errMsg))})),c.push(a),c.push(l),c.push(d),m()}else u.resolve(!0);return u.promise()},deleteFolder:function(e){ne.isString(e)||e.toString(),ee.callSDKFunction("deleteFolder",{path:e},"deleteFolderSuccess","deleteFolderFailed")},deleteAsset:function(e,t){var n,i,r=new o.Deferred,a=[];return ne.isString(e)||e.toString(),ne.isString(t)||t.toString(),n=re.subscribe(ce+".deleteFileSuccess",(function(n){if(!ut(["path","file"],n,"deleteFileSuccess").didSucceed)return ee.log("error calling deleteFileSuccess "+JSON.stringify(n),ee.LogLevels.error),r.reject("failed to delete file: "+n.file),void re.clearHandlers(a);decodeURIComponent(n.path)===e&&t.match(n.file)&&(re.clearHandlers(a),ee.log("successfully deleted file: "+decodeURIComponent(n.path)+"/"+n.file),r.resolve())})),a.push(n),i=re.subscribe(ce+".deleteFileFailed",(function(n){if(!ut(["path","file"],n,"deleteFileFailed").didSucceed)return ee.log("error calling deleteFileFailed "+JSON.stringify(n),ee.LogLevels.error),r.reject("failed to delete file: "+n.file),void re.clearHandlers(a);decodeURIComponent(n.path)===e&&t.match(n.file)&&(re.clearHandlers(a),ee.log("failed to delete file: "+n.file),r.reject("failed to delete file: "+n.file))})),a.push(i),ee.callSDKFunction("deleteFile",{path:e,file:t},"deleteFileSuccess","deleteFileFailed"),r.promise()},setBackButtonState:function(e){var t=e?In():We.none;ee.callSDKFunction("setBackButtonState",{state:t})},addAdToLoadedCreatives:function(e){return oe.addAd(e)},isContainerLoaded:function(e){return W.isContainerLoaded(e)},getContainerCreationHandler:function(e){return W.getContainerCreationHandler(e)},loadAdUnitUrl:function(e,t,n,i){W.createAndLoadView(e,t,n,i),oe.addAd(e)},displayAdView:function(e){W.displayAdView(e,Bt,Et(),jt)},updateAdUnitUrl:function(e,t,n,i){W.updateFrameUrl(e,t,n,i),oe.addAd(e)},onAdLoaded:function(e){ee.log(s+"onAdLoaded | "+JSON.stringify(e));var t=function(){ee.log(s+"ad loaded mismatch",ee.LogLevels.error),Me<Re&&(re.publish("SDKController.AdLoadError",[e]),Me++)};if(e&&e.productType)if(oe.getAdById(ee.AdUtils.getAdId(e),e))tn(e);else{var n={eventParam:{eName:dt.mismatchAdLoadError},action:"fireEvent",productType:e.productType};e.demandSourceName&&(n.demandSourceName=e.demandSourceName),re.publish("SDKController.Analytics",[n]),ee.log(s+"onAdLoaded | mismatch from not being in loadedcreatives"),t()}else t()},removeAdUnit:function(e){if(J.isAdDisplayed(e)){var t=Wn(e);kt();var n=!(!t||!ne.isFunction(t.getNextAd))&&t.getNextAd(!0,e.inventoryId);Ht(!1,n)}else{var i=oe.getAdById(ee.AdUtils.getAdId(e),e);i.engaged=!1,Cn(i,{preloadNextInBG:!0})}},removeAdUnitFromExternal:function(e){oe.removeAdById(ee.AdUtils.getAdId(e),e),t.PubSub.publish("SDKController.engageEnd",[e])},unloadAdViewsByProduct:Si,unloadAdViewByAdViewId:hi,isRootFolder:function(e){return ui()?"SSAPublisher"===e:"supersonicads"===e},getCurrentDisplayedAd:function(){return J.get()},setCurrentDisplayedAd:function(e){return J.set(e)},getCurrentDisplayedAdType:function(){return J.getDisplayedAdType()},isAdDisplayed:function(e){return J.isAdDisplayed(e)},getGlobalAppData:function(){var e,t,n,i,r=new o.Deferred;return e=re.subscribe(ce+".parseGlobalData",(function(n){if(i="string"==typeof n.ssaGlobalAppData?ne.parseJSON(decodeURIComponent(n.ssaGlobalAppData)):n.ssaGlobalAppData,ee.log("Full global app data is: "+JSON.stringify(i)),!i)return r.reject("Invalid Global Data response"),void re.clearHandlers([e,t]);r.resolve(i),re.clearHandlers([e,t])})),t=re.subscribe(ce+".getGlobalDataFailed",(function(i){n=ut(["errMsg"],i,"getGlobalDataFailed").didSucceed?i.errMsg:ut(["errMsg"],i,"getGlobalDataFailed").errMsg,r.reject(n),re.clearHandlers([e,t])})),ee.callSDKFunction("getUserData",{key:"ssaGlobalAppData"},"parseGlobalData","getGlobalDataFailed"),r.promise()},setCachePriorityArrayKey:function(e,t){return t?ee.getGlobalAppData().then((function(n){return n.cachePriorityArray=n.cachePriorityArray||{},n.cachePriorityArray[e.cacheBase]=t,ee.setGlobalAppData(n)})):ne.returnResolvedPromise()},setGlobalAppData:function(e){var t,n,i,r=new o.Deferred;return t=re.subscribe(ce+".setGlobalDataSuccess",(function(){r.resolve(),re.clearHandlers([t,n])})),n=re.subscribe(ce+".setGlobalDataFailed",(function(e){i=ut(["errMsg"],e,"setGlobalDataFailed").didSucceed?e.errMsg:ut(["errMsg"],e,"setGlobalDataFailed").errMsg,r.reject(i),re.clearHandlers([t,n])})),ee.callSDKFunction("setUserData",{key:"ssaGlobalAppData",value:JSON.stringify(e)},"setGlobalDataSuccess","setGlobalDataFailed"),r.promise()},getUserData:function(e,t){var n,i,r,a,s=new o.Deferred;return ne.isDefined(t)&&!ne.isDefined(e)?(s.reject("Missing info to retrieve user data."),s.promise()):(n=re.subscribe(ce+".parseUserData",(function(o){return ut(["ssaUserData"],o,"parseUserData").didSucceed?(a="string"==typeof o.ssaUserData?ne.parseJSON(decodeURIComponent(o.ssaUserData)):o.ssaUserData,ee.log("Full user data is: "+JSON.stringify(a)),a?(ne.isDefined(e)&&(a=a[e]||{},ne.isDefined(t)&&(a=a[t]||{})),ee.log("Get user data response: "+JSON.stringify(a)+" for appKey "+e+" and userId "+t),s.resolve(a),void re.clearHandlers([n,i])):(s.reject("Invalid User Data response"),void re.clearHandlers([n,i]))):(r=ut(["errMsg"],o,"parseUserData").errMsg,s.reject(r),void re.clearHandlers([n,i]))})),i=re.subscribe(ce+".getUserDataFailed",(function(e){r=ut(["errMsg"],e,"getUserDataFailed").didSucceed?e.errMsg:ut(["errMsg"],e,"getUserDataFailed").errMsg,s.reject(r),re.clearHandlers([n,i])})),ee.callSDKFunction("getUserData",{key:"ssaUserData"},"parseUserData","getUserDataFailed"),s.promise())},setUserData:function(e,t,n){var i,r,a,s,l=new o.Deferred;return ne.isDefined(e)&&ne.isDefined(t)?(o.when(ee.getUserData()).then((function(o){s=o,ne.isDefined(s[e])||(s[e]={}),ne.isDefined(s[e][t])||(s[e][t]={}),s[e][t]=n==={}?{}:ne.extend(s[e][t],n),i=re.subscribe(ce+".setUserDataSuccess",(function(){l.resolve(),re.clearHandlers([i,r])})),r=re.subscribe(ce+".setUserDataFailed",(function(e){a=ut(["errMsg"],e,"setUserDataFailed").didSucceed?e.errMsg:ut(["errMsg"],e,"setUserDataFailed").errMsg,l.reject(a),re.clearHandlers([i,r])})),ee.callSDKFunction("setUserData",{key:"ssaUserData",value:JSON.stringify(s)},"setUserDataSuccess","setUserDataFailed")}),(function(e){l.reject(e)})),l.promise()):(l.reject("Missing info to set user data."),l.promise())},getConfig:function(){return Ie},getApplicationExternalConfig:function(){return S},isSupportedOsVersion:function(e){return null===_.getDeviceApiLevel().match(He[e][Ie.mobileSDKSettings.deviceOs])},isLimitedDeviceModel:function(){if(!Ie.controllerConfig||-1===n.applicationsLimitations.indexOf(Ie.controllerConfig.applicationKey))return!1;var e=decodeURIComponent(Ie.mobileSDKSettings.deviceModel);return-1!==n.deviceLimitations.indexOf(e)},checkRequiredCallbackParams:function(e,t,n,i){return ut(e,t,n,i)},alert:function(e){var n,i=document.getElementById("ssaDialogText"),r=document.getElementById("ssaDialogBox"),a=ii(),o=ti(a),s=ni(a),l=!1,d=document.getElementById("ssaDialogConfirmBtnText"),c=document.getElementById("ssaDialogCancelBtnText"),u=document.getElementById("ssaDialogBtns");Rt({name:"dialogBoxAboutToOpen"}),r.removeAttribute("style"),r.style.display="block",(!Ve||e&&e.alwaysClose)&&(W.hideLoader(),Ot(),l=!0),Ve||W.displayContainer(e);var f=A.getDisplayedAdFrame();if(f&&t.Msg.postMessage("hideFrame","*",f.contentWindow),u.classList.remove("singleBtn"),"object"==typeof e&&(Le.classList.remove("hidden"),Le.removeAttribute("style"),Ne.classList.remove("hidden"),Ne.removeAttribute("style"),ne.isDefined(e.close)?(n=e.close,d.textContent=e.yes,c.textContent=e.no,ne.calculateTextElementWidth(Ne)>s.minDialogBtnWidth||ne.calculateTextElementWidth(Le)>s.minDialogBtnWidth?(Le.style.width=s.maxDialogBtnWidth+"px",Le.style.left="20px",Ne.style.width=s.maxDialogBtnWidth+"px",Ne.style.left="20px"):(Le.style.width=s.baseDialogBtnWidth+"px",Le.style.left=s.baseDialogBtnWidth+"55px",Ne.style.width=s.baseDialogBtnWidth+"px",Ne.style.left=s.baseDialogBtnWidth+"55px"),(ne.calculateTextElementWidth(Ne)>s.maxDialogBtnTextWidth||ne.calculateTextElementWidth(Le)>s.maxDialogBtnTextWidth||-1!==e.yes.indexOf(" ")||-1!==e.no.indexOf(" "))&&(ne.textfill2(d,o.buttonText),o.buttonText.parentContainer=Le,ne.textfill2(c,o.buttonText))):ne.isDefined(e.message)?(n=e.message,ne.isDefined(e.yes)&&(d.textContent=e.yes),ne.isDefined(e.no)&&(c.textContent=e.no)):n=JSON.stringify(e),l&&(u.classList.add("singleBtn"),Le.classList.add("hidden"),Ne))){var p=Ne.offsetWidth/2;Ne.style.marginLeft=-1*p+"px"}i.textContent=n,ne.textfill2(i,o.dialogText),r.style.visibility="visible";var g=document.getElementById("ssaDialogBoxOverlay");ee.JQWrapper.fadeIn(g,100),ee.JQWrapper.bind(g,"click",(function(e){e.preventDefault()})),ee.JQWrapper.fadeOut(Ue,300)},log:u.log,logEvent:function(e,t){pn(e)},openUrl:function(e,t){Tt(e,t)},postAdUnitEvent:function(e,t){Rt(e,t)},initAnalytics:xn,initBannerExternalService:function(){H.init(),q.init()},getFormattedDeviceData:jn,shouldExtendApiDataWithDebugData:Bn,extendApiDataWithDebugParams:kn,getSDKDebugParams:Rn,getNotchService:function(){return $},getTokenService:function(){return Q},setAllowFileAccessFromFileURLs:Kn,getDeviceId:function(){return Gn(ee.getConfig().mobileSDKSettings)},getSDKLimitationData:oi,addExternalAdViewIdAndSetStatus:function(e){H.addExternalAdViewIdAndSetStatus(e)},getExternalContainer:function(){return H},getAdViewContainer:function(e){return W.getAdViewByAd(e)},onAdVisible:Wt,saveFileToCache:$n,getCacheDirectory:function(){return Ie.mobileSDKSettings.cacheFolderPath},getCacheRootFolder:function(){return Ie.mobileSDKSettings.rootCacheFolder},getSegmentationAllocator:function(){return k},environmentConfiguration:function(){return B},getRecoveryInfo:Lt,isBannerNoneLWS:Vt,isBannerMultipleInstances:function(e){return e===n.BN&&ee.CompatibilityService.isFeatureSupportedInNativeSDK(V.bannerMultipleInstances)},getCacheFileEncodingPatch:function(){return M}};return ee=Ai,Ai}t.exports=function(t){var n=e("../../components/Constants.js"),r=e("../Cache.js"),a=e("../OfferWall/OfferWall.js"),o=e("../BannerFactory.js"),s=e("../../components/HTTPService.js"),l=e("../../components/AdUtils"),d=e("../../components/DemandUtils.js"),c=e("../../components/SupplyConfigurations.js"),u=e("../../components/storeKit/StoreKitService.js"),f=e("../../components/ViewsManager.js"),p=e("../../components/PixelTrackingService.js"),g=e("../../components/OpenURLService.js"),v=e("../../components/OMIDService"),m=e("../../components/adInterfaces"),h=e("../../components/DeviceDataService.js"),b=e("../../components/RingerSwitchService"),S=e("../../components/OrientationService"),y=e("../../components/GDPRservice.js"),A=e("../../components/orientation/AppOrientationManager.js"),C=e("../../components/PermissionService"),I=e("./SDKLimitations"),D=e("../../components/APIConfigurations.js"),w=e("../../components/NativeLifeCycleEventsService.js"),P=e("../../components/LastSeenCampaignService"),O=e("../../components/AndroidNomediaFileHandler.js"),F=e("../../components/ImpressionsCounterService.js"),T=e("../DemandSource/FetchDemand/FetchDirect"),x=e("../../components/ExtraOffers"),U=e("../../components/CampaignsFilter.js"),N=e("../../components/AdvertisingIdService.js"),L=e("../../components/SKAdImpression/SKAdImpressionService"),V=e("../../components/FeatureCompatibilityService"),M=e("../Cache/AdsAssetsNativeCommunicator.js"),R=e("../Cache/AdsAssetsManager.js"),k=e("../../components/SKOverlay/SKOverlayManager.js"),K=e("../../components/SKOverlay/SKOverlayEventDispatcher"),B=e("../../components/AppUserIdService.js"),E=e("./InstancesLoadTimers.js"),j=new i(t,n);return j.Cache=new r(t,j),j.SDKLimitations=new I(j),j.OfferWall=new a(t,j),j.BannerFactory=new o(t,j),j.HTTPService=new s(t,j),j.AdUtils=new l(t,j),j.DemandUtils=new d(t,j,n),j.SupplyConfigurations=new c(j,n,t.Utils),j.StoreKitService=new u(t,j,n),j.ViewsManager=new f(t),j.PixelTrackingService=new p(j),j.OpenURLService=new g(j,n),j.OMIDService=new v(t,j),j.ExternalAdProtocols=new m,j.DeviceDataService=new h(t,j),j.RingerSwitchService=new b(t,j),j.OrientationService=new S(t,j,n),j.GDPRService=new y(t,j,n),j.AppOrientationManager=new A(t,j,n),j.PermissionService=new C(t,j),j.APIConfigurations=new D(j),j.NativeLifeCycleEventsService=new w(t,j,n),j.LastSeenCampaignService=new P(j,n),j.AndroidNomediaFileHandler=new O(j),j.ImpressionsCounterService=new F(n),j.FetchDirectService=new T(window.jQuery.ajax),j.ExtraOffers=new x(n,j.FetchDirectService,j.environmentConfiguration),j.CampaignsFilter=new U(t,j,n),j.AdvertisingIdService=new N(t,j,n),j.SKAdImpressionService=new L(t,j,n),j.CompatibilityService=new V(SuperSonicGlobalConfig.controllerConfig),j.AdsAssetsNativeCommunicator=new M(t,j),j.AdsAssetsManager=new R(t,j,j.AdsAssetsNativeCommunicator),j.SKOverlayManager=new k(t,j,n),j.SKOverlayEventDispatcher=new K(t,j,n),j.AppUserIdService=new B(t,j,n),j.InstancesTimers=new E,j}},{"../../components/APIConfigurations.js":19,"../../components/AdOrientationManager":21,"../../components/AdUtils":22,"../../components/AdvertisingIdService.js":23,"../../components/AndroidNomediaFileHandler.js":26,"../../components/AppUserIdService.js":30,"../../components/BlacklistService":31,"../../components/CampaignsFilter.js":32,"../../components/Constants.js":33,"../../components/DemandUtils.js":34,"../../components/DeviceDataService.js":36,"../../components/DisplayedAdManager.js":37,"../../components/ExternalConfig":38,"../../components/ExtraOffers":39,"../../components/FeatureCompatibilityService":40,"../../components/FrameHelper.js":44,"../../components/GDPRservice.js":46,"../../components/HTTPService.js":47,"../../components/IframeManager":48,"../../components/ImpressionsCounterService.js":49,"../../components/LastSeenCampaignService":52,"../../components/Logger.js":53,"../../components/NativeAPIAdapter.js":56,"../../components/NativeLifeCycleEventsConstants.js":57,"../../components/NativeLifeCycleEventsService.js":58,"../../components/NotchFactory.js":59,"../../components/OMIDService":62,"../../components/OpenURLService.js":66,"../../components/OrientationService":68,"../../components/PermissionService":70,"../../components/PixelTrackingService.js":72,"../../components/RingerSwitchService":75,"../../components/SKAdImpression/SKAdImpressionService":76,"../../components/SKOverlay/SKOverlayEventDispatcher":79,"../../components/SKOverlay/SKOverlayManager.js":80,"../../components/SupplyConfigurations.js":81,"../../components/ViewsManager.js":85,"../../components/adInterfaces":90,"../../components/adInterfaces/AdInterfaceConfiguration":86,"../../components/adInterfaces/BaseFileRepository":87,"../../components/adInterfaces/CacheLocation":88,"../../components/containers/AdViewsManager.js":92,"../../components/containers/BackgroundController":93,"../../components/containers/BannerExternalAdViewService":94,"../../components/containers/BannerExternalContainer.js":95,"../../components/containers/NavigationModeView":101,"../../components/containers/WPADUtils":102,"../../components/containers/WebView":103,"../../components/containers/WebViewManager.js":104,"../../components/orientation/AppOrientationManager.js":106,"../../components/storeKit/StoreKitService.js":114,"../../components/token/TokenService.js":117,"../../constants/SDKFeatureNames":118,"../../modules/SDKController/EventCategories":178,"../../patches/PatchAppOrientation":203,"../../patches/PatchCacheFileEncoding":204,"../../presenter/uiConfig.js":209,"../AdPlayer/AdPlayerAssets":121,"../AdPlayer/AdPlayerUrl":122,"../AdUnitManager/AdUnitGlobals.js":126,"../AdUnitManager/LibsManager.js":129,"../AdUnitUrl.js":130,"../BannerFactory.js":133,"../Cache.js":134,"../Cache/AdsAssetsManager.js":137,"../Cache/AdsAssetsNativeCommunicator.js":138,"../DemandSource/FetchDemand/FetchDirect":148,"../Environment/EnvironmentManager":157,"../OfferWall/OfferWall.js":167,"../ProductRouter.js":172,"../SDKInterface.js":190,"../UserSegmentation/SegmentationAllocator.js":193,"../UserSegmentation/SegmentationManager":195,"./ConfigurationHelper.js":177,"./InstancesLoadTimers.js":179,"./LoadedCreatives":180,"./MessageHandler":182,"./SDKLimitations":184,"./mainConfig.js":186,"./nativeConfigHandler.js":187,"./sessionConfig":188,"./videoStateHandler.js":189}],184:[function(e,t,n){t.exports=function(e){var t=" is not supported";return{getLimitData:function(n){var i={errMsg:"",didSucceed:!0};return e.isSupportedOsVersion(n)?e.isLimitedDeviceModel()&&(i.errMsg="Device"+t,i.didSucceed=!1):(i.errMsg="Operating system version "+e.getApiData({deviceOSVersion:1}).deviceOSVersion+t,i.didSucceed=!1),i}}}},{}],185:[function(e,t,n){t.exports=function(e,t,n){var i={v:function(e){return e.match(/^[0-9]+?[.]?[0-9]+?[.]?[0-9]+$/)},appOrientation:function(e){var t=e;return"portrait"===(t=t.toLowerCase())||"landscape"===t||"none"===t},connectionType:function(e){var t=decodeURIComponent(e);return"wifi"===(t=t.toLowerCase())||t.match(/^mobile\[.+\]$/)||"3g"===t||"none"===t},iphoneAppOnIpadDevice:function(e){var t=parseInt(e);return 0===t||1===t},deviceOs:function(e){return e&&""!==e},SDKVersion:function(e){return e&&""!==e},deviceOSVersion:function(e){return e&&""!==e},deviceApiLevel:function(e){return e&&""!==e},bundleId:function(e){return e&&""!==e},"deviceIds[OpenUDID]":function(t){return e.isDefined(t)},"deviceIds[IFA]":function(t){return e.isDefined(t)},"deviceIds[SERIAL]":function(t){return e.isDefined(t)},"deviceIds[AndroidID]":function(t){return e.isDefined(t)},"deviceIds[IMEI]":function(t){return e.isDefined(t)},"deviceIds[AID]":function(t){return e.isDefined(t)},deviceScreenScale:function(){return!0},"deviceScreenSize[width]":function(){return!0},"deviceScreenSize[height]":function(){return!0},diskFreeSize:function(e){var t=parseInt(e);return!isNaN(t)&&t>=0},showDeliveryLimitationsLog:function(){return!0},country:function(e){return e&&""!==e},debug:function(n){return e.isDefined(t[n])},disableCache:function(e){var t=parseInt(e);return 0===t||1===t},disableSession:function(e){var t=parseInt(e);return 0===t||1===t},applicationKey:function(e){return e&&""!==e},applicationUserId:function(e){return e&&""!==e},applicationUserGender:function(e){return"unknown"===e||"female"===e||"females"===e||"male"===e||"males"===e||"both"===e},applicationUserAgeGroup:function(e){var t=parseInt(e);return t>=0&&t<=9},applicationUserCreationDate:function(e){return e.match(/^(19|20)\d\d([- /.])(0[1-9]|1[012])\2(0[1-9]|[12][0-9]|3[01])$/)},maxVideoLength:function(e){var t=parseInt(e);return!isNaN(t)&&t>=0},itemCount:function(e){var t=parseInt(e);return!isNaN(t)&&t>0},minimumOfferCommission:function(e){var t=parseFloat(e);return!isNaN(t)&&t>=0},demoCampaigns:function(e){var t=parseInt(e);return 0===t||1===t},numOfCampaigns:function(e){var t=parseInt(e);return!isNaN(t)&&t>=0},campaignId:function(e){var t=parseInt(e);return!isNaN(t)&&t>0},pageSize:function(e){var t=parseInt(e);return!isNaN(t)&&t>=0},landingId:function(e){var t=parseInt(e);return!isNaN(t)&&t>0},page:function(e){var t=parseInt(e);return!isNaN(t)&&t>0},admin:function(e){var t=parseInt(e);return 0===t||1===t},useClientSideCallbacks:function(e){var t=e.toString();return"true"===t||"false"===t},unLocked:function(e){var t=e.toString();return"true"===t||"false"===t},isLimitAdTrackingEnabled:function(t){return e.isDefined(t)},placementId:function(e){var t=parseInt(e);return!isNaN(t)&&t>=0},allowArbitraryLoads:function(e){var t=e.toString();return"true"===t||"false"===t},allowArbitraryLoadsInWebContent:function(e){var t=e.toString();return"true"===t||"false"===t}};function r(e,t,n){n[e]=t}return function(t,a){var o,s=!0,l=null;for(o in t){if(e.isDefined(i[o])&&!1===i[o](t[o])){l=n.invalid+o,s=!1;break}r(o,t[o],a)}return{didSucceed:s,errMsg:l}}}},{}],186:[function(e,t,n){t.exports=function(){return{deviceDataRequestObject:{deviceOs:1,SDKVersion:1,deviceOSVersion:1,deviceApiLevel:0}}}},{}],187:[function(e,t,n){function i(t,n){var i=e("../../components/Constants.js");return t.subscribe(i.CB+".nativeConfigSuccess",(function(e){n.log("nativeConfig update successfully.",n.LogLevels.error)})),t.subscribe(i.CB+".nativeConfigFailed",(function(e){n.log("nativeConfig failed to update.",n.LogLevels.error)})),{setNativeConfiguration:function(e){e&&n.callSDKFunction("setNativeConfiguration",e,"nativeConfigSuccess","nativeConfigFailed")}}}var r;t.exports=function(e,t){return r||(r=new i(e,t)),r}},{"../../components/Constants.js":33}],188:[function(e,t,n){t.exports=function(){return{native:{ios:{supportViewControllerFromAdapter:!0,allowOrientationFromAppDelegate:!0}}}}},{}],189:[function(e,t,n){function i(t,n){var i=e("../../components/Constants.js"),r=i.videoStates,a=i.RV,o=r.none;return t.subscribe("SDKController.AdStarted",(function(){n.log("VideoStateHandler | AdStarted",n.LogLevels.verbose),o=r.play,n.callSDKFunction("onVideoStatusChanged",{status:"started",productType:a})})),t.subscribe("SDKController.AdPlaying",(function(){n.log("VideoStateHandler | AdPlaying",n.LogLevels.verbose),o=r.play,n.callSDKFunction("onVideoStatusChanged",{status:"playing",productType:a})})),t.subscribe("SDKController.AdPaused",(function(){n.log("VideoStateHandler | AdPaused",n.LogLevels.verbose),o=r.stop,n.callSDKFunction("onVideoStatusChanged",{status:"paused",productType:a})})),t.subscribe("SDKController.AdVideoEnded",(function(){n.log("VideoStateHandler | AdVideoEnded",n.LogLevels.verbose),o=r.stop,n.callSDKFunction("onVideoStatusChanged",{status:"ended",productType:a})})),{handleOnEngageEnd:function(){n.log("VideoStateHandler | handleOnEngageEnd onVideoStatusChanged stopped from engaged end",n.LogLevels.verbose),o=r.none,n.callSDKFunction("onVideoStatusChanged",{status:"stopped",productType:a})},getState:function(){return o}}}var r;t.exports=function(e,t){return r||(r=new i(e,t)),r}},{"../../components/Constants.js":33}],190:[function(e,t,n){var i=e("./iOSSDKInterface.js"),r=e("./iOSSDKInterface_WK.js"),a=e("./androidSDKInterface.js");t.exports=function(e,t,n,o){"use strict";var s,l="undefined";switch(e.deviceOs){case t.deviceOs.android:s=new a(o,n,l);break;case t.deviceOs.ios:s="wk"===e.webviewType?new r(l):new i(l);break;default:s=new i(l)}return s}},{"./androidSDKInterface.js":199,"./iOSSDKInterface.js":200,"./iOSSDKInterface_WK.js":201}],191:[function(e,t,n){function i(e){var t,n,i={},r={},a=!1,o=function(a,o){var s=null;i=t.Utils,(r=t.PubSub).init(),i.isDefined(a.mobileSDKSettings)&&(s=(n=t.SDKController).init(a,o)),e.when(s).then((function(){a.products&&i.each(a.products,(function(e){i.isDefined(e.init)&&e.init(a[e])}))}),(function(){console.log("Failed to initiate controller")}))},s={init:function(e,n){return t=this,o(e,n),a=!0},log:function(e,t){n&&n.log&&n.log(e,t||n.LogLevels.error)}};return s}t.exports=function(t,n,r,a){var o=e("../components/Utils.js"),s=e("../components/JQWrapper.js"),l=e("../components/PubSub.js"),d=e("../components/Msg.js"),c=e("../components/VersionUtils"),u=e("./AdAssets.js"),f=e("./VastUtils.js"),p=n.Analytics,g=new i(t),v={};g.PubSub=new l(g),g.Msg=new d,g.AdAssets=new u,g.VastUtils=new f(g.AdAssets);var m=["KuduAnalyticsProvider"];(n.productionDebug||n.SuperSonicGlobalConfig&&n.SuperSonicGlobalConfig.mobileSDKSettings&&"www.supersonicads.com"!==n.SuperSonicGlobalConfig.mobileSDKSettings.domain)&&m.push("QAAnalyticsProvider"),n.SuperSonicGlobalConfig&&n.SuperSonicGlobalConfig.mobileSDKSettings&&n.SuperSonicGlobalConfig.mobileSDKSettings.protocol&&(v.isSecured="https:"===n.SuperSonicGlobalConfig.mobileSDKSettings.protocol);var h={};return n.SuperSonicGlobalConfig&&n.SuperSonicGlobalConfig.controllerConfig&&n.SuperSonicGlobalConfig.controllerConfig.networkConfig&&n.SuperSonicGlobalConfig.controllerConfig.networkConfig.events&&n.SuperSonicGlobalConfig.controllerConfig.networkConfig.events.disabledEventsObj&&(h=n.SuperSonicGlobalConfig.controllerConfig.networkConfig.events.disabledEventsObj),g.Analytics=p(h),g.Analytics.setProvidersHandlers(m),g.Analytics.setProvidersConfig(v),g.PubSub.subscribe("updateEventsBaseData",(function(e){e&&"object"!=typeof e||g.Analytics.updateBaseData(e)})),g.Utils=new o(g,n,r,a),g.JQWrapper=new s(g,n,r,a),g.VersionUtils=new c,g}},{"../components/JQWrapper.js":51,"../components/Msg.js":54,"../components/PubSub.js":73,"../components/Utils.js":82,"../components/VersionUtils":84,"./AdAssets.js":120,"./VastUtils.js":197}],192:[function(e,t,n){"use strict";var i,r;Object.defineProperty(n,"__esModule",{value:!0}),n.StoreType=n.StoreConfig=void 0,n.StoreType=i,function(e){e[e.Unknown=0]="Unknown",e[e.iOSStore=1]="iOSStore",e[e.GooglePlay=2]="GooglePlay",e[e.Aura=3]="Aura",e[e.GoogleMarket=4]="GoogleMarket",e[e.Samsung=5]="Samsung",e[e.Amazon=6]="Amazon",e[e.Huawei=7]="Huawei"}(i||(n.StoreType=i={})),function(e){e.AuraAppLink="ֿ*apps.hoolapp.com*"}(r||(r={}));class a{static getSettingsToOverrideById(e,t){if(e===i.Aura)return a.getAuraOverrideSettings(t)}static getAuraOverrideSettings(e){var t,n,i;const{aft:r}=null!==(n=null===(t=e.sp)||void 0===t?void 0:t.t)&&void 0!==n?n:{},{sctop:a}=null!==(i=e.sp)&&void 0!==i?i:{};return{sp:{enable:!0,h:3,t:{mft:[0,1,2],aft:r},sctop:a}}}getSettingsToOverride(e,t){var n;return null!==(n=a.getSettingsToOverrideById(e,t))&&void 0!==n?n:{}}isAlternativeAndroidStoreUrl(e){return new RegExp("(?<!http:|https:)//|"+r.AuraAppLink).test(e)}isGoogleStoreUrl(e){return-1!==e.indexOf("play.google.com/store/apps/details")||0===e.lastIndexOf("market://",0)}}n.StoreConfig=a,t.exports=a},{}],193:[function(e,t,n){t.exports=function(t){var n=e("./SegmentsRepository");function i(e,n){t.addSegment(e,n)}return{addCellularNetworkTypeSegment:function(e){var t,r=n.cellularNetworkType;-1===e?t=r.cellularNetworkTypeUnknown:"notReachable"===e?t=r.cellularNetworkTypeNotReachable:"wifi"===e?t=r.cellularNetworkTypeWifi:-1!==["CTRadioAccessTechnologyGPRS","CTRadioAccessTechnologyEdge","CTRadioAccessTechnologyCDMA1x"].indexOf(e)?t=r.cellularNetworkType2G:-1!==["CTRadioAccessTechnologyWCDMA","CTRadioAccessTechnologyHSDPA","CTRadioAccessTechnologyHSUPA","CTRadioAccessTechnologyCDMAEVDORev0","CTRadioAccessTechnologyCDMAEVDORevA","CTRadioAccessTechnologyCDMAEVDORevB","CTRadioAccessTechnologyeHRPD"].indexOf(e)?t=r.cellularNetworkType3G:"CTRadioAccessTechnologyLTE"===e&&(t=r.cellularNetworkType4G),i(t,r)},addIsSDCardAvailableSegment:function(e){var t,r=n.isSDCardAvailable;-1===e?t=r.isSDCardAvailableUnknown:"true"===e?t=r.isSDCardAvailableTrue:"false"===e&&(t=r.isSDCardAvailableFalse),i(t,r)},addTotalDeviceRAMSegment:function(e){var t=n.totalDeviceRAM,r=-1===e?e:parseInt(e)/1073741824;i(-1===e?t.totalDeviceRAMUnknown:r<1?t.totalDeviceRAMUnder1GB:r<2?t.totalDeviceRAMUnder2GB:r<3?t.totalDeviceRAMUnder3GB:r<4?t.totalDeviceRAMUnder4GB:r<6?t.totalDeviceRAMUnder6GB:r<8?t.totalDeviceRAMUnder8GB:r<12?t.totalDeviceRAMUnder12GB:t.totalDeviceRAM12GBAndAbove,t)},addIsChargingSegment:function(e){var t,r=n.isCharging;-1===e?t=r.isChargingUnknown:"true"===e?t=r.isChargingTrue:"false"===e&&(t=r.isChargingFalse),i(t,r)},addAirplaneModeSegment:function(e){var t,r=n.airplaneMode;-1===e?t=r.airplaneModeUnknown:"true"===e?t=r.airplaneModeTrue:"false"===e&&(t=r.airplaneModeFalse),i(t,r)},addChargingTypeSegment:function(e){var t=n.chargingType;i(-1===e?t.chargingTypeUnknown:"1"===e?t.chargingTypeAC:"2"===e?t.chargingTypeUSB:"4"===e?t.chargingTypeWireless:t.chargingTypeNone,t)},addStayOnWhenPluggedInSegment:function(e){var t,r=n.stayOnWhenPluggedIn;-1===e?t=r.stayOnWhenPluggedInUnknown:"true"===e?t=r.stayOnWhenPluggedInTrue:"false"===e&&(t=r.stayOnWhenPluggedInFalse),i(t,r)},addBatteryLevelSegment:function(e){var t,r=n.batteryLevel;void 0===e||e<0||(e<=20?t=r.batteryLowestFifth:e<=40?t=r.batterySecondFifth:e<=60?t=r.batteryThirdFifth:e<=80?t=r.batteryFourthFifth:e<=100&&(t=r.batteryHighestFifth)),i(t,r)},addAdLevelCacheSegment:function(e){i(e,n.adLevelCache)},addControllerSourceSegment:function(e){var t=n.controllerSourceStrategy;switch(e){case 0:i(t.fetchFromServerNoFallback,t);break;case 1:i(t.fetchFromServerWithLocalFallback,t);break;case 2:i(t.fetchForNextSessionLoadFromLocal,t)}}}}},{"./SegmentsRepository":196}],194:[function(e,t,n){t.exports={events:{receivedFromAdunit:{addSegment:"SDKController.addSegment",getSegments:"SDKController.getSegments",clearSegmentFromGroup:"SDKController.clearSegmentFromGroup"},sendToAdunit:{updateUserSegments:"updateUserSegments"}}}},{}],195:[function(e,t,n){t.exports=function(t,n){var i="SegmentationManager | ",r=e("./SegmentationConstants"),a=e("./SegmentsRepository"),o=[];function s(e,t){var n=function(e,t){if(!function(e){return!isNaN(e)}(e)||function(e){return-1!==o.indexOf(e)}(e)||!function(e,t){return l(t)&&function(e,t){for(var n=Object.keys(t),i=0;i<n.length;i++){if(e===t[n[i]])return!0}return!1}(e,t)}(e,t))return!1;for(var n=Object.keys(t),i=0;i<n.length;i++)for(var r=t[n[i]],a=0;a<o.length;a++)if(o[a]===r)return o[a]=e,!0;return o.push(e),!0}(e,t);n&&c()}function l(e){return e&&"object"==typeof e}function d(e){if(l(e))for(var t=Object.keys(e),n=0;n<o.length;n++)for(var i=0;i<t.length;i++){var r=e[t[i]];if(o[n]===r)return o.splice(n,1),void c()}}function c(){t.PubSub.publish("updateEventsBaseData",[{segments:o.toString()}]),n.postAdUnitEvent({name:r.events.sendToAdunit.updateUserSegments,segments:o},!0)}return{init:function(){t.PubSub.subscribe(r.events.receivedFromAdunit.addSegment,(function(e){s(e.segment,e.segmentGroup)})),t.PubSub.subscribe(r.events.receivedFromAdunit.getSegments,(function(e){if(n.log(i+" controller - getSegments received"),e.getSegmentsCallback){var t=e.getSegmentsCallback;n.log(i+"send back to adunit "+t+" with data: "+JSON.stringify(o)),n.postAdUnitEvent({name:t,segments:o},!0)}e.callback&&(n.log(i+"send callback to ad-player with data: "+JSON.stringify(o)),e.callback.call(null,o))})),t.PubSub.subscribe(r.events.receivedFromAdunit.clearSegmentFromGroup,(function(e){d(e.segmentGroup)}))},addSegment:s,getUserSegmentsObjectsAsArray:function(){return o},clearSegmentFromGroup:d,segmentsRepository:a}}},{"./SegmentationConstants":194,"./SegmentsRepository":196}],196:[function(e,t,n){t.exports={batteryLevel:{batteryLowestFifth:101,batterySecondFifth:102,batteryThirdFifth:103,batteryFourthFifth:104,batteryHighestFifth:105},cellularNetworkType:{cellularNetworkTypeWifi:117,cellularNetworkType2G:118,cellularNetworkType3G:119,cellularNetworkType4G:120,cellularNetworkTypeNotReachable:121,cellularNetworkTypeUnknown:122},isCharging:{isChargingTrue:123,isChargingFalse:124,isChargingUnknown:125},airplaneMode:{airplaneModeTrue:126,airplaneModeFalse:127,airplaneModeUnknown:128},stayOnWhenPluggedIn:{stayOnWhenPluggedInTrue:129,stayOnWhenPluggedInFalse:130,stayOnWhenPluggedInUnknown:131},chargingType:{chargingTypeAC:132,chargingTypeUSB:133,chargingTypeWireless:134,chargingTypeNone:135,chargingTypeUnknown:136},totalDeviceRAM:{totalDeviceRAMUnder1GB:137,totalDeviceRAMUnder2GB:138,totalDeviceRAMUnder3GB:139,totalDeviceRAMUnder4GB:140,totalDeviceRAMUnder6GB:141,totalDeviceRAMUnder8GB:142,totalDeviceRAMUnder12GB:143,totalDeviceRAM12GBAndAbove:144,totalDeviceRAMUnknown:145},isSDCardAvailable:{isSDCardAvailableTrue:146,isSDCardAvailableFalse:147,isSDCardAvailableUnknown:148},adLevelCache:{adLevelCacheTimeoutControl:154,adLevelCacheTimeoutFiveMinutes:155,adLevelCacheTimeoutThirtySeconds:156},controllerSourceStrategy:{fetchFromServerNoFallback:151,fetchFromServerWithLocalFallback:152,fetchForNextSessionLoadFromLocal:153}}},{}],197:[function(e,t,n){t.exports=function(e){function t(e){if(e)return!e.controllerSpace||e.controllerSpace.viewCount}function n(e,t){return e?(e.controllerSpace||(e.controllerSpace={}),e.controllerSpace.viewCount=t,e):e}function i(t){return!!t&&(e.extractVastSource(t).length>0||t.ext&&t.ext.videoData&&!0===t.ext.videoData.isVast)}return{getVastViewCount:t,setVastViewCount:n,setMaxVastCount:function(e){e&&i(e)&&"number"==typeof e.ext.vastExhaustIndex&&e.ext.vastExhaustIndex>0&&n(e,e.ext.vastExhaustIndex)},isVastCampaign:i,isThereVastCampaign:function(e){if(!e||!Array.isArray(e))return!1;for(var t=!1,n=0;n<e.length;n++)if(i(e[n])){t=!0;break}return t},areAllCampaignTypesAreVast:function(e){if(!e||!Array.isArray(e)||0===e.length)return!1;for(var t=!0,n=0;n<e.length;n++)if(!i(e[n])){t=!1;break}return t},incrementVastViewCount:function(e){return e&&i(e)?(e.controllerSpace||(e.controllerSpace={}),e.controllerSpace.viewCount=e.controllerSpace.viewCount?e.controllerSpace.viewCount+1:1,e.controllerSpace.viewCount):-1},isVastCanPlayAgain:function(e){return!!e&&(i(e)&&e.ext.vastExhaustIndex&&t(e)<e.ext.vastExhaustIndex)},getVastViewCountForEvent:function(e){return"number"==typeof e?e:-1}}}},{}],198:[function(e,t,n){(function(t){"use strict";var n=e("./SonicCore.js"),i=e("./SDKController/SDKController.js"),r="undefined";var a=t.SonicCore=t.SSA_CORE=new n(t.jQuery,t,document,r);a.SDKController=new i(a,r),"function"==typeof sonicAsyncInit&&sonicAsyncInit()})(window)},{"./SDKController/SDKController.js":183,"./SonicCore.js":191}],199:[function(e,t,n){function i(e,t,n){function i(t,n){var i=e.hashMessage(t,n);Android.messageHandler(t,JSON.stringify(n),i)}function r(e,t){Android[e](JSON.stringify(t))}function a(e,t){return void 0!==e&&e[t]}var o={postMessage:function(n,o){if(a(window.Android,e?"messageHandler":n))try{e?i(n,o):r(n,o)}catch(e){t.log("Error running function "+n+" error:"+JSON.stringify(e),t.LogLevels.error)}else t.log("Error calling SDK function "+n,t.LogLevels.error)}},s={postMessage:function(e){typeof e.eventName!==n&&typeof e.prefix!==n&&typeof e.parameters!==n&&("function"==typeof o[e.eventName]?o[e.eventName](e.parameters):o.postMessage(e.eventName,e.parameters))},acknowledgeMessage:function(){return!0}};return s}t.exports=i},{}],200:[function(e,t,n){function i(e){var t=function(e,t,n){var r=e+"://"+t+"?",a=Object.keys(n).map((function(e){return n[e]="object"==typeof n[e]?JSON.stringify(n[e]):n[e],encodeURIComponent(e)+"="+encodeURIComponent(n[e])})).join("&").replace(/%20/g,"+");i(r+a)},n=function(e){var t=document.createElement("IFRAME");t.setAttribute("src",e),document.documentElement.appendChild(t),t.parentNode.removeChild(t),t=null},i=function(e){0===a.length?(a.push("1"),n(e)):a.push(e)},r={postMessage:function(e,n,i){t(e,n,i)}},a=[],o={postMessage:function(t){typeof t.eventName!==e&&typeof t.prefix!==e&&typeof t.parameters!==e&&("function"==typeof r[t.eventName]?r[t.eventName](t.parameters):r.postMessage(t.prefix,t.eventName,t.parameters))},acknowledgeMessage:function(){if(0!==a.length){var e=a.shift();"1"===e&&0!==a.length&&(e=a.shift()),void 0!==e&&"1"!==e&&n(e)}}};return o}t.exports=i},{}],201:[function(e,t,n){function i(e){var t=function(e,t,n){var r=e+"://"+t+"?",a=Object.keys(n).map((function(e){return n[e]="object"==typeof n[e]?JSON.stringify(n[e]):n[e],encodeURIComponent(e)+"="+encodeURIComponent(n[e])})).join("&").replace(/%20/g,"+");i(r+a)},n=function(e){void 0!==window.webkit.messageHandlers&&void 0!==window.webkit.messageHandlers.supersonicMainMsgHandler&&window.webkit.messageHandlers.supersonicMainMsgHandler.postMessage(e)},i=function(e){0===a.length?(a.push("1"),n(e)):a.push(e)},r={postMessage:function(e,n,i){t(e,n,i)}},a=[],o={postMessage:function(t){typeof t.eventName!==e&&typeof t.prefix!==e&&typeof t.parameters!==e&&("function"==typeof r[t.eventName]?r[t.eventName](t.parameters):r.postMessage(t.prefix,t.eventName,t.parameters))},acknowledgeMessage:function(){if(0!==a.length){var e=a.shift();"1"===e&&0!==a.length&&(e=a.shift()),void 0!==e&&"1"!==e&&n(e)}}};return o}t.exports=i},{}],202:[function(e,t,n){t.exports=function(e,t,n,i){var r=!1,a=!1,o=!1,s=!0,l=i.CB+".enterBackground",d=i.CB+".enterForeground",c=i.CB+".deviceStatusChanged",u="prdTaskManager | ";return{init:function(){r||(e.PubSub.subscribe(i.taskManager+".Engaged",(function(i){e.Utils.isDefined(i.duringEngage)&&i.productType===n&&(a=i.duringEngage,t.log(u+"duringEngage "+a))})),e.PubSub.subscribe(l,(function(){t.log(u+l),o=!0})),e.PubSub.subscribe(d,(function(){t.log(u+d),o=!1})),e.PubSub.subscribe(c,(function(t){e.Utils.isDefined(t.connectionType)&&(s="none"!==t.connectionType&&"notReachable"!==t.connectionType)})),r=!0)},canEngage:function(){return!a&&s},isConnected:function(){return s},setConnection:function(e){s=e},canInitCallToApi:function(){var t=new jQuery.Deferred;return o?e.PubSub.subscribeOnce(d,(function(){t.resolve()})):t.resolve(),t.promise()},getStatusMsg:function(){return"product TM - duringEngage:"+a+" appInBackground:"+o+" isConnected:"+s},getStatus:function(){return{duringEngage:a,appInBackground:o,isConnected:s}},publish:function(t,n){e.PubSub.publish(i.taskManager+"."+t,n)}}}},{}],203:[function(e,t,n){t.exports=function(e){return e&&"unknown"!==e?{appOrientation:e}:{appOrientation:"none",patch:!0}}},{}],204:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});t.exports=class{init(e){this.isAndroid=e}isFileNameMatches(e,t){if(e===t)return!0;const n=this.isAndroid?this._decodeFileNameForAndroid(e):this._decodeFileNameForIOS(e);return n===t||n===decodeURIComponent(t)}getCachedFileName(e,t){return t?this._encodeFileNameForAndroid(e):this._encodeFileNameForIOS(e)}_decodeFileNameForAndroid(e){return decodeURIComponent(decodeURIComponent(e))}_decodeFileNameForIOS(e){return decodeURIComponent(e).replace(/ /,"+")}_encodeFileNameForAndroid(e){return this._javaURLEncode(this._javaURLEncode(e))}_encodeFileNameForIOS(e){const t={"'":"%27","(":"%28",")":"%29","~":"%7E","?":"%3F"};return encodeURI(e).replace(/([?'()~])/g,(function(e){return t[e]}))}_javaURLEncode(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%3F":"?"};return encodeURIComponent(e).replace(/([!'()~]|%3F)/g,(function(e){return t[e]}))}}},{}],205:[function(e,t,n){t.exports=function(e,t,n){var i="ios"===t.getConfig().mobileSDKSettings.deviceOs&&n;return i&&(t.log("PATCH | LoadAfterLoad | create listener for instance: "+JSON.stringify(n)),e.PubSub.subscribe("freeSDK5StateToAllowLoadAfterLoad",(function(e){(function(e){return t.log("PATCH | LoadAfterLoad | subscribe called for: "+JSON.stringify(n)+" , with params:"+JSON.stringify(e)),e&&n&&n.demandGroupName===e.demandGroupName&&n.productType===e.productType&&n.demandSourceName!==e.demandSourceName})(e)&&(t.log("PATCH | LoadAfterLoad | perform callSDKFunction with: "+JSON.stringify(e)),t.callSDKFunction("loadInterstitialFail",{demandSourceName:n.demandSourceName}))}))),{onShowSuccess:function(t){i&&e.PubSub.publish("freeSDK5StateToAllowLoadAfterLoad",[{productType:t.productType,demandGroupName:t.demandGroupName,demandSourceName:t.demandSourceName}])}}}},{}],206:[function(e,t,n){t.exports=function(t,n){var i=e("../constants/SDKFeatureNames"),r=new(e("../components/VersionUtils"));return{shouldBlock:function(e){return(!n||!n.isFeatureSupportedInNativeSDK(i.storeKitDismissVCOnFinishCallback))&&!r.isLower(e,"13.2")}}}},{"../components/VersionUtils":84,"../constants/SDKFeatureNames":118}],207:[function(e,t,n){t.exports=function(e,t){function n(){var n=decodeURIComponent(e.deviceModel);return-1!==t.iphoneXDeviceModels.indexOf(n)}function i(){var i=e.deviceWidthDP,r=e.deviceHeightDP;return n()&&function(e,n){var i=t.iphoneXDeviceResolution;for(var r in i)if(i.hasOwnProperty(r)&&i[r].width&&i[r].height&&(e===i[r].width&&n===i[r].height||e===i[r].height&&n===i[r].width))return!0;return!1}(i,r)}return{hasNotch:n,onEngageEnd:function(){i()&&0},onSetConfig:function(e){return n()&&function(e){return e.settings&&e.settings.standaloneView}(e)},className:"PatchesIphoneX"}}},{}],208:[function(e,t,n){t.exports=function(e){var t={android:/^\b[1][0-9]\b|\b[2][0]\b/,ios:/^[8|9]/},n=["6f1e481d","8b4f1525","eb9e7b59","e3d3fd81","6e5f428d","afb2a685","cf01b28d","992991cd","11ade170d","d026bf4d","c3ecb00d"],i=["6abeab6d","6863f09d","499b4845","4cbeec05","70fc4915"].concat(["6c982dc5","6c97f43d"]);function r(e,t){return!!t.controllerConfig&&e.indexOf(t.controllerConfig.applicationKey)>-1}return{shouldFail:function(n){return!!r(i,n)&&null!==e.getDeviceApiLevel().match(t[n.mobileSDKSettings.deviceOs])},shouldSetAppOrientationPortrait:function(t){if(!r(n,t))return!1;var i=parseInt(e.getDeviceApiLevel());return/iPhone/.test(t.mobileSDKSettings.deviceModel)&&i>15}}}},{}],209:[function(e,t,n){t.exports={templates:{mainDefaultTemplate:'<div id="ssaLoaderWrap" class="hidden">                <div id="spin" class="container">                    <div class="spinner">                        <div class="bar1"></div>                        <div class="bar2"></div>                        <div class="bar3"></div>                        <div class="bar4"></div>                        <div class="bar5"></div>                        <div class="bar6"></div>                        <div class="bar7"></div>                        <div class="bar8"></div>                        <div class="bar9"></div>                        <div class="bar10"></div>                        <div class="bar11"></div>                        <div class="bar12"></div>                    </div>                </div>            </div>',defaultDialogBoxTemplate:'<div id="ssaDialogBoxOverlay"></div>            <div id="ssaDialogBox" class="dialogBox">            <div id="ssaDialogBoxTextContainer">            <div><p id="ssaDialogText">Are you sure you want to quit the offer?</p></div>            </div>        <footer id="ssaDialogBtns">            <a id="ssaDialogCancelBtn" class="dialogBtn"><span id="ssaDialogCancelBtnText">Cancel</span></a>            <a id="ssaDialogConfirmBtn1"" class="dialogBtn"><span id="ssaDialogConfirmBtnText">OK</span></a>        </footer>        </div>',defaultNavigationTemplate:'            <div id="ssaNavigator" class="defaultNavigation">                <ul class="ssaList">                    <li><div data-edge="top|left" id="ssaNavigatorBackButton" class="ssaNavigationBtn ssaControllerButton ssaBackButton"><div class="innerWrapper"></div></div></li>                    <li><div data-edge="top|right" id="ssaNavigatorCloseButton" class="ssaNavigationBtn ssaControllerButton ssaCloseButton"><div class="innerWrapper"></div></div></li>                </ul>            </div>',loaderOWTemplate:'<div class="loaderOW hidden">        <div class="header">        </div>        <div class="progressbarWrap">            <div class="progressbar"></div>        </div>        <div class="offers">        <div class="shine"></div>        </div>    </div>',loaderOWOfferTemplate:'<div class="offer">        <div class="offerWrap">        <div class="offerImg"></div>        <div class="offerDetails">        <div>        <span class="offerText">Loading Info...</span>        </div>        <div class="offerEarn">        <div class="badge"></div>        <div class="callToAction">Loading...</div>        </div>        </div>        <div class="offerBtn"></div>        </div>        </div>'},style:{forceCloseProperties:{disable:{width:0,height:0,position:"top-right"}},backgroundColors:{transparent:"transparent",black:"#000000",darkGrey:"#1A1A1A",semiTransparent:"rgba(0,0,0,0.7)"},iconBGConfig:{},defaultControlFrames:[{width:28,height:28,position:"top-right"},{width:30,height:30,position:"top-left"}]},settings:{}}},{}],210:[function(e,t,n){"use strict";var i;Object.defineProperty(n,"__esModule",{value:!0}),n.AdType=void 0,n.AdType=i,function(e){e.CPVI="CPVI",e.CustomEndCard="customEndCard",e.MRAID="MRAID",e.PlayableAd="playableAd",e.ImageInterstitial="imageInterstitial",e.StaticBanner="staticBanner",e.AppTrailerMarketplace="AT_MP",e.IECMarketplace="IEC_MP"}(i||(n.AdType=i={}))},{}],211:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0})},{}],212:[function(e,t,n){"use strict";var i,r,a;Object.defineProperty(n,"__esModule",{value:!0}),n.Protocol=n.Environment=n.DeviceOs=void 0,n.DeviceOs=i,function(e){e.Android="android",e.IOS="ios"}(i||(n.DeviceOs=i={})),n.Environment=r,function(e){e.Develop="dev",e.Production="prod",e.Stage="stage"}(r||(n.Environment=r={})),n.Protocol=a,function(e){e.Http="http:",e.Https="https:",e.File="file:"}(a||(n.Protocol=a={}))},{}],213:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=e("./ad");Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===i[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return i[e]}}))}));var r=e("./common");Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===r[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return r[e]}}))}));var a=e("./interfaces/externalContainer");Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===a[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return a[e]}}))}));var o=e("./cache");Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in n&&n[e]===o[e]||Object.defineProperty(n,e,{enumerable:!0,get:function(){return o[e]}}))}))},{"./ad":210,"./cache":211,"./common":212,"./interfaces/externalContainer":214}],214:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0})},{}]},{},[198]);